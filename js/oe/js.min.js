/*
: Licensed under The MIT License. See license.txt and http://www.datejs.com/license/. 
 @website: http://www.datejs.com/
: Licensed under The MIT License. See license.txt and http://www.datejs.com/license/. 
 @website: http://www.datejs.com/
: Licensed under The MIT License. See license.txt and http://www.datejs.com/license/. 
 @website: http://www.datejs.com/
: Licensed under The MIT License. See license.txt and http://www.datejs.com/license/. 
 @website: http://www.datejs.com/
*/
Date.CultureInfo={name:"zh-CN",englishName:"Chinese (People's Republic of China)",nativeName:"\u4e2d\u6587(\u4e2d\u534e\u4eba\u6c11\u5171\u548c\u56fd)",dayNames:["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],abbreviatedDayNames:["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],shortestDayNames:["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],firstLetterDayNames:["\u65e5",
"\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],monthNames:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"],abbreviatedMonthNames:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"],amDesignator:"\u4e0a\u5348",
pmDesignator:"\u4e0b\u5348",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"ymd",formatPatterns:{shortDate:"yyyy/M/d",longDate:"yyyy'\u5e74'M'\u6708'd'\u65e5'",shortTime:"H:mm",longTime:"H:mm:ss",fullDateTime:"yyyy'\u5e74'M'\u6708'd'\u65e5' H:mm:ss",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"M'\u6708'd'\u65e5'",yearMonth:"yyyy'\u5e74'M'\u6708'"},regexPatterns:{jan:/^\u4e00\u6708/i,feb:/^\u4e8c\u6708/i,
mar:/^\u4e09\u6708/i,apr:/^\u56db\u6708/i,may:/^\u4e94\u6708/i,jun:/^\u516d\u6708/i,jul:/^\u4e03\u6708/i,aug:/^\u516b\u6708/i,sep:/^\u4e5d\u6708/i,oct:/^\u5341\u6708/i,nov:/^\u5341\u4e00\u6708/i,dec:/^\u5341\u4e8c\u6708/i,sun:/^\u661f\u671f\u65e5/i,mon:/^\u661f\u671f\u4e00/i,tue:/^\u661f\u671f\u4e8c/i,wed:/^\u661f\u671f\u4e09/i,thu:/^\u661f\u671f\u56db/i,fri:/^\u661f\u671f\u4e94/i,sat:/^\u661f\u671f\u516d/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,
yesterday:/^yes(terday)?/i,today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",
offset:"-000"},{name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]};
(function(){var $D=Date,$P=$D.prototype,p=function(s,l){if(!l)l=2;return("000"+s).slice(l*-1)};$P.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this};$P.setTimeToNow=function(){var n=new Date;this.setHours(n.getHours());this.setMinutes(n.getMinutes());this.setSeconds(n.getSeconds());this.setMilliseconds(n.getMilliseconds());return this};$D.today=function(){return(new Date).clearTime()};$D.compare=function(date1,date2){if(isNaN(date1)||isNaN(date2))throw new Error(date1+
" - "+date2);else if(date1 instanceof Date&&date2 instanceof Date)return date1<date2?-1:date1>date2?1:0;else throw new TypeError(date1+" - "+date2);};$D.equals=function(date1,date2){return date1.compareTo(date2)===0};$D.getDayNumberFromName=function(name){var n=$D.CultureInfo.dayNames,m=$D.CultureInfo.abbreviatedDayNames,o=$D.CultureInfo.shortestDayNames,s=name.toLowerCase();for(var i=0;i<n.length;i++)if(n[i].toLowerCase()==s||m[i].toLowerCase()==s||o[i].toLowerCase()==s)return i;return-1};$D.getMonthNumberFromName=
function(name){var n=$D.CultureInfo.monthNames,m=$D.CultureInfo.abbreviatedMonthNames,s=name.toLowerCase();for(var i=0;i<n.length;i++)if(n[i].toLowerCase()==s||m[i].toLowerCase()==s)return i;return-1};$D.isLeapYear=function(year){return year%4===0&&year%100!==0||year%400===0};$D.getDaysInMonth=function(year,month){return[31,$D.isLeapYear(year)?29:28,31,30,31,30,31,31,30,31,30,31][month]};$D.getTimezoneAbbreviation=function(offset){var z=$D.CultureInfo.timezones,p;for(var i=0;i<z.length;i++)if(z[i].offset===
offset)return z[i].name;return null};$D.getTimezoneOffset=function(name){var z=$D.CultureInfo.timezones,p;for(var i=0;i<z.length;i++)if(z[i].name===name.toUpperCase())return z[i].offset;return null};$P.clone=function(){return new Date(this.getTime())};$P.compareTo=function(date){return Date.compare(this,date)};$P.equals=function(date){return Date.equals(this,date||new Date)};$P.between=function(start,end){return this.getTime()>=start.getTime()&&this.getTime()<=end.getTime()};$P.isAfter=function(date){return this.compareTo(date||
new Date)===1};$P.isBefore=function(date){return this.compareTo(date||new Date)===-1};$P.isToday=$P.isSameDay=function(date){return this.clone().clearTime().equals((date||new Date).clone().clearTime())};$P.addMilliseconds=function(value){this.setMilliseconds(this.getMilliseconds()+value*1);return this};$P.addSeconds=function(value){return this.addMilliseconds(value*1E3)};$P.addMinutes=function(value){return this.addMilliseconds(value*6E4)};$P.addHours=function(value){return this.addMilliseconds(value*
36E5)};$P.addDays=function(value){this.setDate(this.getDate()+value*1);return this};$P.addWeeks=function(value){return this.addDays(value*7)};$P.addMonths=function(value){var n=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+value*1);this.setDate(Math.min(n,$D.getDaysInMonth(this.getFullYear(),this.getMonth())));return this};$P.addYears=function(value){return this.addMonths(value*12)};$P.add=function(config){if(typeof config=="number"){this._orient=config;return this}var x=config;if(x.milliseconds)this.addMilliseconds(x.milliseconds);
if(x.seconds)this.addSeconds(x.seconds);if(x.minutes)this.addMinutes(x.minutes);if(x.hours)this.addHours(x.hours);if(x.weeks)this.addWeeks(x.weeks);if(x.months)this.addMonths(x.months);if(x.years)this.addYears(x.years);if(x.days)this.addDays(x.days);return this};var $y,$m,$d;$P.getWeek=function(){var a,b,c,d,e,f,g,n,s,w;$y=!$y?this.getFullYear():$y;$m=!$m?this.getMonth()+1:$m;$d=!$d?this.getDate():$d;if($m<=2){a=$y-1;b=(a/4|0)-(a/100|0)+(a/400|0);c=((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0);s=b-c;e=
0;f=$d-1+31*($m-1)}else{a=$y;b=(a/4|0)-(a/100|0)+(a/400|0);c=((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0);s=b-c;e=s+1;f=$d+(153*($m-3)+2)/5+58+s}g=(a+b)%7;d=(f+g-e)%7;n=f+3-d|0;if(n<0)w=53-((g-s)/5|0);else if(n>364+s)w=1;else w=(n/7|0)+1;$y=$m=$d=null;return w};$P.getISOWeek=function(){$y=this.getUTCFullYear();$m=this.getUTCMonth()+1;$d=this.getUTCDate();return p(this.getWeek())};$P.setWeek=function(n){return this.moveToDayOfWeek(1).addWeeks(n-this.getWeek())};var validate=function(n,min,max,name){if(typeof n==
"undefined")return false;else if(typeof n!="number")throw new TypeError(n+" is not a Number.");else if(n<min||n>max)throw new RangeError(n+" is not a valid value for "+name+".");return true};$D.validateMillisecond=function(value){return validate(value,0,999,"millisecond")};$D.validateSecond=function(value){return validate(value,0,59,"second")};$D.validateMinute=function(value){return validate(value,0,59,"minute")};$D.validateHour=function(value){return validate(value,0,23,"hour")};$D.validateDay=
function(value,year,month){return validate(value,1,$D.getDaysInMonth(year,month),"day")};$D.validateMonth=function(value){return validate(value,0,11,"month")};$D.validateYear=function(value){return validate(value,0,9999,"year")};$P.set=function(config){if($D.validateMillisecond(config.millisecond))this.addMilliseconds(config.millisecond-this.getMilliseconds());if($D.validateSecond(config.second))this.addSeconds(config.second-this.getSeconds());if($D.validateMinute(config.minute))this.addMinutes(config.minute-
this.getMinutes());if($D.validateHour(config.hour))this.addHours(config.hour-this.getHours());if($D.validateMonth(config.month))this.addMonths(config.month-this.getMonth());if($D.validateYear(config.year))this.addYears(config.year-this.getFullYear());if($D.validateDay(config.day,this.getFullYear(),this.getMonth()))this.addDays(config.day-this.getDate());if(config.timezone)this.setTimezone(config.timezone);if(config.timezoneOffset)this.setTimezoneOffset(config.timezoneOffset);if(config.week&&validate(config.week,
0,53,"week"))this.setWeek(config.week);return this};$P.moveToFirstDayOfMonth=function(){return this.set({day:1})};$P.moveToLastDayOfMonth=function(){return this.set({day:$D.getDaysInMonth(this.getFullYear(),this.getMonth())})};$P.moveToNthOccurrence=function(dayOfWeek,occurrence){var shift=0;if(occurrence>0)shift=occurrence-1;else if(occurrence===-1){this.moveToLastDayOfMonth();if(this.getDay()!==dayOfWeek)this.moveToDayOfWeek(dayOfWeek,-1);return this}return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(dayOfWeek,
+1).addWeeks(shift)};$P.moveToDayOfWeek=function(dayOfWeek,orient){var diff=(dayOfWeek-this.getDay()+7*(orient||+1))%7;return this.addDays(diff===0?diff+=7*(orient||+1):diff)};$P.moveToMonth=function(month,orient){var diff=(month-this.getMonth()+12*(orient||+1))%12;return this.addMonths(diff===0?diff+=12*(orient||+1):diff)};$P.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/864E5)+1};$P.getTimezone=function(){return $D.getTimezoneAbbreviation(this.getUTCOffset())};
$P.setTimezoneOffset=function(offset){var here=this.getTimezoneOffset(),there=Number(offset)*-6/10;return this.addMinutes(there-here)};$P.setTimezone=function(offset){return this.setTimezoneOffset($D.getTimezoneOffset(offset))};$P.hasDaylightSavingTime=function(){return Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset()};$P.isDaylightSavingTime=function(){return Date.today().set({month:0,day:1}).getTimezoneOffset()!=this.getTimezoneOffset()};
$P.getUTCOffset=function(){var n=this.getTimezoneOffset()*-10/6,r;if(n<0){r=(n-1E4).toString();return r.charAt(0)+r.substr(2)}else{r=(n+1E4).toString();return"+"+r.substr(1)}};$P.getElapsed=function(date){return(date||new Date)-this};if(!$P.toISOString)$P.toISOString=function(){function f(n){return n<10?"0"+n:n}return'"'+this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+'Z"'};$P._toString=$P.toString;
$P.toString=function(format){var x=this;if(format&&format.length==1){var c=$D.CultureInfo.formatPatterns;x.t=x.toString;switch(format){case "d":return x.t(c.shortDate);case "D":return x.t(c.longDate);case "F":return x.t(c.fullDateTime);case "m":return x.t(c.monthDay);case "r":return x.t(c.rfc1123);case "s":return x.t(c.sortableDateTime);case "t":return x.t(c.shortTime);case "T":return x.t(c.longTime);case "u":return x.t(c.universalSortableDateTime);case "y":return x.t(c.yearMonth)}}var ord=function(n){switch(n*
1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};return format?format.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(m){if(m.charAt(0)==="\\")return m.replace("\\","");x.h=x.getHours;switch(m){case "hh":return p(x.h()<13?x.h()===0?12:x.h():x.h()-12);case "h":return x.h()<13?x.h()===0?12:x.h():x.h()-12;case "HH":return p(x.h());case "H":return x.h();case "mm":return p(x.getMinutes());case "m":return x.getMinutes();
case "ss":return p(x.getSeconds());case "s":return x.getSeconds();case "yyyy":return p(x.getFullYear(),4);case "yy":return p(x.getFullYear());case "dddd":return $D.CultureInfo.dayNames[x.getDay()];case "ddd":return $D.CultureInfo.abbreviatedDayNames[x.getDay()];case "dd":return p(x.getDate());case "d":return x.getDate();case "MMMM":return $D.CultureInfo.monthNames[x.getMonth()];case "MMM":return $D.CultureInfo.abbreviatedMonthNames[x.getMonth()];case "MM":return p(x.getMonth()+1);case "M":return x.getMonth()+
1;case "t":return x.h()<12?$D.CultureInfo.amDesignator.substring(0,1):$D.CultureInfo.pmDesignator.substring(0,1);case "tt":return x.h()<12?$D.CultureInfo.amDesignator:$D.CultureInfo.pmDesignator;case "S":return ord(x.getDate());default:return m}}):this._toString()}})();
(function(){Date.Parsing={Exception:function(s){this.message="Parse error at '"+s.substring(0,10)+" ...'"}};var $P=Date.Parsing;var _=$P.Operators={rtoken:function(r){return function(s){var mx=s.match(r);if(mx)return[mx[0],s.substring(mx[0].length)];else throw new $P.Exception(s);}},token:function(s){return function(s){return _.rtoken(new RegExp("^s*"+s+"s*"))(s)}},stoken:function(s){return _.rtoken(new RegExp("^"+s))},until:function(p){return function(s){var qx=[],rx=null;while(s.length){try{rx=
p.call(this,s)}catch(e){qx.push(rx[0]);s=rx[1];continue}break}return[qx,s]}},many:function(p){return function(s){var rx=[],r=null;while(s.length){try{r=p.call(this,s)}catch(e){return[rx,s]}rx.push(r[0]);s=r[1]}return[rx,s]}},optional:function(p){return function(s){var r=null;try{r=p.call(this,s)}catch(e){return[null,s]}return[r[0],r[1]]}},not:function(p){return function(s){try{p.call(this,s)}catch(e){return[null,s]}throw new $P.Exception(s);}},ignore:function(p){return p?function(s){var r=null;r=
p.call(this,s);return[null,r[1]]}:null},product:function(){var px=arguments[0],qx=Array.prototype.slice.call(arguments,1),rx=[];for(var i=0;i<px.length;i++)rx.push(_.each(px[i],qx));return rx},cache:function(rule){var cache={},r=null;return function(s){try{r=cache[s]=cache[s]||rule.call(this,s)}catch(e){r=cache[s]=e}if(r instanceof $P.Exception)throw r;else return r}},any:function(){var px=arguments;return function(s){var r=null;for(var i=0;i<px.length;i++){if(px[i]==null)continue;try{r=px[i].call(this,
s)}catch(e){r=null}if(r)return r}throw new $P.Exception(s);}},each:function(){var px=arguments;return function(s){var rx=[],r=null;for(var i=0;i<px.length;i++){if(px[i]==null)continue;try{r=px[i].call(this,s)}catch(e){throw new $P.Exception(s);}rx.push(r[0]);s=r[1]}return[rx,s]}},all:function(){var px=arguments,_=_;return _.each(_.optional(px))},sequence:function(px,d,c){d=d||_.rtoken(/^\s*/);c=c||null;if(px.length==1)return px[0];return function(s){var r=null,q=null;var rx=[];for(var i=0;i<px.length;i++){try{r=
px[i].call(this,s)}catch(e){break}rx.push(r[0]);try{q=d.call(this,r[1])}catch(ex){q=null;break}s=q[1]}if(!r)throw new $P.Exception(s);if(q)throw new $P.Exception(q[1]);if(c)try{r=c.call(this,r[1])}catch(ey){throw new $P.Exception(r[1]);}return[rx,r?r[1]:s]}},between:function(d1,p,d2){d2=d2||d1;var _fn=_.each(_.ignore(d1),p,_.ignore(d2));return function(s){var rx=_fn.call(this,s);return[[rx[0][0],r[0][2]],rx[1]]}},list:function(p,d,c){d=d||_.rtoken(/^\s*/);c=c||null;return p instanceof Array?_.each(_.product(p.slice(0,
-1),_.ignore(d)),p.slice(-1),_.ignore(c)):_.each(_.many(_.each(p,_.ignore(d))),px,_.ignore(c))},set:function(px,d,c){d=d||_.rtoken(/^\s*/);c=c||null;return function(s){var r=null,p=null,q=null,rx=null,best=[[],s],last=false;for(var i=0;i<px.length;i++){q=null;p=null;r=null;last=px.length==1;try{r=px[i].call(this,s)}catch(e){continue}rx=[[r[0]],r[1]];if(r[1].length>0&&!last)try{q=d.call(this,r[1])}catch(ex){last=true}else last=true;if(!last&&q[1].length===0)last=true;if(!last){var qx=[];for(var j=
0;j<px.length;j++)if(i!=j)qx.push(px[j]);p=_.set(qx,d).call(this,q[1]);if(p[0].length>0){rx[0]=rx[0].concat(p[0]);rx[1]=p[1]}}if(rx[1].length<best[1].length)best=rx;if(best[1].length===0)break}if(best[0].length===0)return best;if(c){try{q=c.call(this,best[1])}catch(ey){throw new $P.Exception(best[1]);}best[1]=q[1]}return best}},forward:function(gr,fname){return function(s){return gr[fname].call(this,s)}},replace:function(rule,repl){return function(s){var r=rule.call(this,s);return[repl,r[1]]}},process:function(rule,
fn){return function(s){var r=rule.call(this,s);return[fn.call(this,r[0]),r[1]]}},min:function(min,rule){return function(s){var rx=rule.call(this,s);if(rx[0].length<min)throw new $P.Exception(s);return rx}}};var _generator=function(op){return function(){var args=null,rx=[];if(arguments.length>1)args=Array.prototype.slice.call(arguments);else if(arguments[0]instanceof Array)args=arguments[0];if(args)for(var i=0,px=args.shift();i<px.length;i++){args.unshift(px[i]);rx.push(op.apply(null,args));args.shift();
return rx}else return op.apply(null,arguments)}};var gx="optional not ignore cache".split(/\s/);for(var i=0;i<gx.length;i++)_[gx[i]]=_generator(_[gx[i]]);var _vector=function(op){return function(){if(arguments[0]instanceof Array)return op.apply(null,arguments[0]);else return op.apply(null,arguments)}};var vx="each any all".split(/\s/);for(var j=0;j<vx.length;j++)_[vx[j]]=_vector(_[vx[j]])})();
(function(){var $D=Date,$P=$D.prototype;var flattenAndCompact=function(ax){var rx=[];for(var i=0;i<ax.length;i++)if(ax[i]instanceof Array)rx=rx.concat(flattenAndCompact(ax[i]));else if(ax[i])rx.push(ax[i]);return rx};$D.Grammar={};$D.Translator={hour:function(s){return function(){this.hour=Number(s)}},minute:function(s){return function(){this.minute=Number(s)}},second:function(s){return function(){this.second=Number(s)}},meridian:function(s){return function(){this.meridian=s.slice(0,1).toLowerCase()}},
timezone:function(s){return function(){var n=s.replace(/[^\d\+\-]/g,"");if(n.length)this.timezoneOffset=Number(n);else this.timezone=s.toLowerCase()}},day:function(x){var s=x[0];return function(){this.day=Number(s.match(/\d+/)[0])}},month:function(s){return function(){this.month=s.length==3?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(s)/4:Number(s)-1}},year:function(s){return function(){var n=Number(s);this.year=s.length>2?n:n+(n+2E3<$D.CultureInfo.twoDigitYearMax?2E3:1900)}},rday:function(s){return function(){switch(s){case "yesterday":this.days=
-1;break;case "tomorrow":this.days=1;break;case "today":this.days=0;break;case "now":this.days=0;this.now=true;break}}},finishExact:function(x){x=x instanceof Array?x:[x];for(var i=0;i<x.length;i++)if(x[i])x[i].call(this);var now=new Date;if((this.hour||this.minute)&&!this.month&&!this.year&&!this.day)this.day=now.getDate();if(!this.year)this.year=now.getFullYear();if(!this.month&&this.month!==0)this.month=now.getMonth();if(!this.day)this.day=1;if(!this.hour)this.hour=0;if(!this.minute)this.minute=
0;if(!this.second)this.second=0;if(this.meridian&&this.hour)if(this.meridian=="p"&&this.hour<12)this.hour=this.hour+12;else if(this.meridian=="a"&&this.hour==12)this.hour=0;if(this.day>$D.getDaysInMonth(this.year,this.month))throw new RangeError(this.day+" is not a valid value for days.");var r=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);if(this.timezone)r.set({timezone:this.timezone});else if(this.timezoneOffset)r.set({timezoneOffset:this.timezoneOffset});return r},
finish:function(x){x=x instanceof Array?flattenAndCompact(x):[x];if(x.length===0)return null;for(var i=0;i<x.length;i++)if(typeof x[i]=="function")x[i].call(this);var today=$D.today();if(this.now&&!this.unit&&!this.operator)return new Date;else if(this.now)today=new Date;var expression=!!(this.days&&this.days!==null||this.orient||this.operator);var gap,mod,orient;orient=this.orient=="past"||this.operator=="subtract"?-1:1;if(!this.now&&"hour minute second".indexOf(this.unit)!=-1)today.setTimeToNow();
if(this.month||this.month===0)if("year day hour minute second".indexOf(this.unit)!=-1){this.value=this.month+1;this.month=null;expression=true}if(!expression&&this.weekday&&!this.day&&!this.days){var temp=Date[this.weekday]();this.day=temp.getDate();if(!this.month)this.month=temp.getMonth();this.year=temp.getFullYear()}if(expression&&this.weekday&&this.unit!="month"){this.unit="day";gap=$D.getDayNumberFromName(this.weekday)-today.getDay();mod=7;this.days=gap?(gap+orient*mod)%mod:orient*mod}if(this.month&&
this.unit=="day"&&this.operator){this.value=this.month+1;this.month=null}if(this.value!=null&&this.month!=null&&this.year!=null)this.day=this.value*1;if(this.month&&!this.day&&this.value){today.set({day:this.value*1});if(!expression)this.day=this.value*1}if(!this.month&&this.value&&this.unit=="month"&&!this.now){this.month=this.value;expression=true}if(expression&&(this.month||this.month===0)&&this.unit!="year"){this.unit="month";gap=this.month-today.getMonth();mod=12;this.months=gap?(gap+orient*
mod)%mod:orient*mod;this.month=null}if(!this.unit)this.unit="day";if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null)this[this.unit+"s"]=this[this.unit+"s"]+(this.operator=="add"?1:-1)+(this.value||0)*orient;else if(this[this.unit+"s"]==null||this.operator!=null){if(!this.value)this.value=1;this[this.unit+"s"]=this.value*orient}if(this.meridian&&this.hour)if(this.meridian=="p"&&this.hour<12)this.hour=this.hour+12;else if(this.meridian=="a"&&this.hour==
12)this.hour=0;if(this.weekday&&!this.day&&!this.days){var temp=Date[this.weekday]();this.day=temp.getDate();if(temp.getMonth()!==today.getMonth())this.month=temp.getMonth()}if((this.month||this.month===0)&&!this.day)this.day=1;if(!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month)return Date.today().setWeek(this.value);if(expression&&this.timezone&&this.day&&this.days)this.day=this.days;return expression?today.add(this):today.set(this)}};var _=$D.Parsing.Operators,
g=$D.Grammar,t=$D.Translator,_fn;g.datePartDelimiter=_.rtoken(/^([\s\-\.\,\/\x27]+)/);g.timePartDelimiter=_.stoken(":");g.whiteSpace=_.rtoken(/^\s*/);g.generalDelimiter=_.rtoken(/^(([\s\,]|at|@|on)+)/);var _C={};g.ctoken=function(keys){var fn=_C[keys];if(!fn){var c=$D.CultureInfo.regexPatterns;var kx=keys.split(/\s+/),px=[];for(var i=0;i<kx.length;i++)px.push(_.replace(_.rtoken(c[kx[i]]),kx[i]));fn=_C[keys]=_.any.apply(null,px)}return fn};g.ctoken2=function(key){return _.rtoken($D.CultureInfo.regexPatterns[key])};
g.h=_.cache(_.process(_.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),t.hour));g.hh=_.cache(_.process(_.rtoken(/^(0[0-9]|1[0-2])/),t.hour));g.H=_.cache(_.process(_.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),t.hour));g.HH=_.cache(_.process(_.rtoken(/^([0-1][0-9]|2[0-3])/),t.hour));g.m=_.cache(_.process(_.rtoken(/^([0-5][0-9]|[0-9])/),t.minute));g.mm=_.cache(_.process(_.rtoken(/^[0-5][0-9]/),t.minute));g.s=_.cache(_.process(_.rtoken(/^([0-5][0-9]|[0-9])/),t.second));g.ss=_.cache(_.process(_.rtoken(/^[0-5][0-9]/),t.second));
g.hms=_.cache(_.sequence([g.H,g.m,g.s],g.timePartDelimiter));g.t=_.cache(_.process(g.ctoken2("shortMeridian"),t.meridian));g.tt=_.cache(_.process(g.ctoken2("longMeridian"),t.meridian));g.z=_.cache(_.process(_.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),t.timezone));g.zz=_.cache(_.process(_.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),t.timezone));g.zzz=_.cache(_.process(g.ctoken2("timezone"),t.timezone));g.timeSuffix=_.each(_.ignore(g.whiteSpace),_.set([g.tt,g.zzz]));g.time=_.each(_.optional(_.ignore(_.stoken("T"))),
g.hms,g.timeSuffix);g.d=_.cache(_.process(_.each(_.rtoken(/^([0-2]\d|3[0-1]|\d)/),_.optional(g.ctoken2("ordinalSuffix"))),t.day));g.dd=_.cache(_.process(_.each(_.rtoken(/^([0-2]\d|3[0-1])/),_.optional(g.ctoken2("ordinalSuffix"))),t.day));g.ddd=g.dddd=_.cache(_.process(g.ctoken("sun mon tue wed thu fri sat"),function(s){return function(){this.weekday=s}}));g.M=_.cache(_.process(_.rtoken(/^(1[0-2]|0\d|\d)/),t.month));g.MM=_.cache(_.process(_.rtoken(/^(1[0-2]|0\d)/),t.month));g.MMM=g.MMMM=_.cache(_.process(g.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),
t.month));g.y=_.cache(_.process(_.rtoken(/^(\d\d?)/),t.year));g.yy=_.cache(_.process(_.rtoken(/^(\d\d)/),t.year));g.yyy=_.cache(_.process(_.rtoken(/^(\d\d?\d?\d?)/),t.year));g.yyyy=_.cache(_.process(_.rtoken(/^(\d\d\d\d)/),t.year));_fn=function(){return _.each(_.any.apply(null,arguments),_.not(g.ctoken2("timeContext")))};g.day=_fn(g.d,g.dd);g.month=_fn(g.M,g.MMM);g.year=_fn(g.yyyy,g.yy);g.orientation=_.process(g.ctoken("past future"),function(s){return function(){this.orient=s}});g.operator=_.process(g.ctoken("add subtract"),
function(s){return function(){this.operator=s}});g.rday=_.process(g.ctoken("yesterday tomorrow today now"),t.rday);g.unit=_.process(g.ctoken("second minute hour day week month year"),function(s){return function(){this.unit=s}});g.value=_.process(_.rtoken(/^\d\d?(st|nd|rd|th)?/),function(s){return function(){this.value=s.replace(/\D/g,"")}});g.expression=_.set([g.rday,g.operator,g.value,g.unit,g.orientation,g.ddd,g.MMM]);_fn=function(){return _.set(arguments,g.datePartDelimiter)};g.mdy=_fn(g.ddd,g.month,
g.day,g.year);g.ymd=_fn(g.ddd,g.year,g.month,g.day);g.dmy=_fn(g.ddd,g.day,g.month,g.year);g.date=function(s){return(g[$D.CultureInfo.dateElementOrder]||g.mdy).call(this,s)};g.format=_.process(_.many(_.any(_.process(_.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(fmt){if(g[fmt])return g[fmt];else throw $D.Parsing.Exception(fmt);}),_.process(_.rtoken(/^[^dMyhHmstz]+/),function(s){return _.ignore(_.stoken(s))}))),function(rules){return _.process(_.each.apply(null,rules),t.finishExact)});
var _F={};var _get=function(f){return _F[f]=_F[f]||g.format(f)[0]};g.formats=function(fx){if(fx instanceof Array){var rx=[];for(var i=0;i<fx.length;i++)rx.push(_get(fx[i]));return _.any.apply(null,rx)}else return _get(fx)};g._formats=g.formats(['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy",
"dMyyyy","yyyy","Mdyy","dMyy","d"]);g._start=_.process(_.set([g.date,g.time,g.expression],g.generalDelimiter,g.whiteSpace),t.finish);g.start=function(s){try{var r=g._formats.call({},s);if(r[1].length===0)return r}catch(e){}return g._start.call({},s)};$D._parse=$D.parse;$D.parse=function(s){var r=null;if(!s)return null;if(s instanceof Date)return s;try{r=$D.Grammar.start.call({},s.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"))}catch(e){return null}return r[1].length===0?r[0]:null};$D.getParseFunction=function(fx){var fn=
$D.Grammar.formats(fx);return function(s){var r=null;try{r=fn.call({},s)}catch(e){return null}return r[1].length===0?r[0]:null}};$D.parseExact=function(s,fx){return $D.getParseFunction(fx)(s)}})();
(function(){var $D=Date,$P=$D.prototype,$N=Number.prototype;$P._orient=+1;$P._nth=null;$P._is=false;$P._same=false;$P._isSecond=false;$N._dateElement="day";$P.next=function(){this._orient=+1;return this};$D.next=function(){return $D.today().next()};$P.last=$P.prev=$P.previous=function(){this._orient=-1;return this};$D.last=$D.prev=$D.previous=function(){return $D.today().last()};$P.is=function(){this._is=true;return this};$P.same=function(){this._same=true;this._isSecond=false;return this};$P.today=
function(){return this.same().day()};$P.weekday=function(){if(this._is){this._is=false;return!this.is().sat()&&!this.is().sun()}return false};$P.at=function(time){return typeof time==="string"?$D.parse(this.toString("d")+" "+time):this.set(time)};$N.fromNow=$N.after=function(date){var c={};c[this._dateElement]=this;return(!date?new Date:date.clone()).add(c)};$N.ago=$N.before=function(date){var c={};c[this._dateElement]=this*-1;return(!date?new Date:date.clone()).add(c)};var dx="sunday monday tuesday wednesday thursday friday saturday".split(/\s/),
mx="january february march april may june july august september october november december".split(/\s/),px="Millisecond Second Minute Hour Day Week Month Year".split(/\s/),pxf="Milliseconds Seconds Minutes Hours Date Week Month FullYear".split(/\s/),nth="final first second third fourth fifth".split(/\s/),de;$P.toObject=function(){var o={};for(var i=0;i<px.length;i++)o[px[i].toLowerCase()]=this["get"+pxf[i]]();return o};$D.fromObject=function(config){config.week=null;return Date.today().set(config)};
var df=function(n){return function(){if(this._is){this._is=false;return this.getDay()==n}if(this._nth!==null){if(this._isSecond)this.addSeconds(this._orient*-1);this._isSecond=false;var ntemp=this._nth;this._nth=null;var temp=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(n,ntemp);if(this>temp)throw new RangeError($D.getDayName(n)+" does not occur "+ntemp+" times in the month of "+$D.getMonthName(temp.getMonth())+" "+temp.getFullYear()+".");return this}return this.moveToDayOfWeek(n,
this._orient)}};var sdf=function(n){return function(){var t=$D.today(),shift=n-t.getDay();if(n===0&&$D.CultureInfo.firstDayOfWeek===1&&t.getDay()!==0)shift=shift+7;return t.addDays(shift)}};for(var i=0;i<dx.length;i++){$D[dx[i].toUpperCase()]=$D[dx[i].toUpperCase().substring(0,3)]=i;$D[dx[i]]=$D[dx[i].substring(0,3)]=sdf(i);$P[dx[i]]=$P[dx[i].substring(0,3)]=df(i)}var mf=function(n){return function(){if(this._is){this._is=false;return this.getMonth()===n}return this.moveToMonth(n,this._orient)}};
var smf=function(n){return function(){return $D.today().set({month:n,day:1})}};for(var j=0;j<mx.length;j++){$D[mx[j].toUpperCase()]=$D[mx[j].toUpperCase().substring(0,3)]=j;$D[mx[j]]=$D[mx[j].substring(0,3)]=smf(j);$P[mx[j]]=$P[mx[j].substring(0,3)]=mf(j)}var ef=function(j){return function(){if(this._isSecond){this._isSecond=false;return this}if(this._same){this._same=this._is=false;var o1=this.toObject(),o2=(arguments[0]||new Date).toObject(),v="",k=j.toLowerCase();for(var m=px.length-1;m>-1;m--){v=
px[m].toLowerCase();if(o1[v]!=o2[v])return false;if(k==v)break}return true}if(j.substring(j.length-1)!="s")j+="s";return this["add"+j](this._orient)}};var nf=function(n){return function(){this._dateElement=n;return this}};for(var k=0;k<px.length;k++){de=px[k].toLowerCase();$P[de]=$P[de+"s"]=ef(px[k]);$N[de]=$N[de+"s"]=nf(de)}$P._ss=ef("Second");var nthfn=function(n){return function(dayOfWeek){if(this._same)return this._ss(arguments[0]);if(dayOfWeek||dayOfWeek===0)return this.moveToNthOccurrence(dayOfWeek,
n);this._nth=n;if(n===2&&(dayOfWeek===undefined||dayOfWeek===null)){this._isSecond=true;return this.addSeconds(this._orient)}return this}};for(var l=0;l<nth.length;l++)$P[nth[l]]=l===0?nthfn(-1):nthfn(l)})();
(function(){var $D=Date,$P=$D.prototype,$f=[],p=function(s,l){if(!l)l=2;return("000"+s).slice(l*-1)};$D.normalizeFormat=function(format){$f=[];var t=(new Date).$format(format);return $f.join("")};$D.strftime=function(format,time){return(new Date(time*1E3)).$format(format)};$D.strtotime=function(time){var d=$D.parse(time);d.addMinutes(d.getTimezoneOffset()*-1);return Math.round($D.UTC(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate(),d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds())/
1E3)};$P.$format=function(format){var x=this,y,t=function(v){$f.push(v);return x.toString(v)};return format?format.replace(/(%|\\)?.|%%/g,function(m){if(m.charAt(0)==="\\"||m.substring(0,2)==="%%")return m.replace("\\","").replace("%%","%");switch(m){case "d":case "%d":return t("dd");case "D":case "%a":return t("ddd");case "j":case "%e":return t("d");case "l":case "%A":return t("dddd");case "N":case "%u":return x.getDay()+1;case "S":return t("S");case "w":case "%w":return x.getDay();case "z":return x.getOrdinalNumber();
case "%j":return p(x.getOrdinalNumber(),3);case "%U":var d1=x.clone().set({month:0,day:1}).addDays(-1).moveToDayOfWeek(0),d2=x.clone().addDays(1).moveToDayOfWeek(0,-1);return d2<d1?"00":p((d2.getOrdinalNumber()-d1.getOrdinalNumber())/7+1);case "W":case "%V":return x.getISOWeek();case "%W":return p(x.getWeek());case "F":case "%B":return t("MMMM");case "m":case "%m":return t("MM");case "M":case "%b":case "%h":return t("MMM");case "n":return t("M");case "t":return $D.getDaysInMonth(x.getFullYear(),x.getMonth());
case "L":return $D.isLeapYear(x.getFullYear())?1:0;case "o":case "%G":return x.setWeek(x.getISOWeek()).toString("yyyy");case "%g":return x.$format("%G").slice(-2);case "Y":case "%Y":return t("yyyy");case "y":case "%y":return t("yy");case "a":case "%p":return t("tt").toLowerCase();case "A":return t("tt").toUpperCase();case "g":case "%I":return t("h");case "G":return t("H");case "h":return t("hh");case "H":case "%H":return t("HH");case "i":case "%M":return t("mm");case "s":case "%S":return t("ss");
case "u":return p(x.getMilliseconds(),3);case "I":return x.isDaylightSavingTime()?1:0;case "O":return x.getUTCOffset();case "P":y=x.getUTCOffset();return y.substring(0,y.length-2)+":"+y.substring(y.length-2);case "e":case "T":case "%z":case "%Z":return x.getTimezone();case "Z":return x.getTimezoneOffset()*-60;case "B":var now=new Date;return Math.floor((now.getHours()*3600+now.getMinutes()*60+now.getSeconds()+(now.getTimezoneOffset()+60)*60)/86.4);case "c":return x.toISOString().replace(/\"/g,"");
case "U":return $D.strtotime("now");case "%c":return t("d")+" "+t("t");case "%C":return Math.floor(x.getFullYear()/100+1);case "%D":return t("MM/dd/yy");case "%n":return"\\n";case "%t":return"\\t";case "%r":return t("hh:mm tt");case "%R":return t("H:mm");case "%T":return t("H:mm:ss");case "%x":return t("d");case "%X":return t("t");default:$f.push(m);return m}}):this._toString()};if(!$P.format)$P.format=$P.$format})();
(function(window,undefined){var document=window.document,navigator=window.navigator,location=window.location;var jQuery=function(){var jQuery=function(selector,context){return new jQuery.fn.init(selector,context,rootjQuery)},_jQuery=window.jQuery,_$=window.$,rootjQuery,quickExpr=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,rnotwhite=/\S/,trimLeft=/^\s+/,trimRight=/\s+$/,rdigit=/\d/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,rvalidchars=/^[\],:{}\s]*$/,rvalidescape=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,
rvalidtokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rwebkit=/(webkit)[ \/]([\w.]+)/,ropera=/(opera)(?:.*version)?[ \/]([\w.]+)/,rmsie=/(msie) ([\w.]+)/,rmozilla=/(mozilla)(?:.*? rv:([\w.]+))?/,rdashAlpha=/-([a-z]|[0-9])/ig,rmsPrefix=/^-ms-/,fcamelCase=function(all,letter){return(letter+"").toUpperCase()},userAgent=navigator.userAgent,browserMatch,readyList,DOMContentLoaded,toString=Object.prototype.toString,hasOwn=Object.prototype.hasOwnProperty,
push=Array.prototype.push,slice=Array.prototype.slice,trim=String.prototype.trim,indexOf=Array.prototype.indexOf,class2type={};jQuery.fn=jQuery.prototype={constructor:jQuery,init:function(selector,context,rootjQuery){var match,elem,ret,doc;if(!selector)return this;if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this}if(selector==="body"&&!context&&document.body){this.context=document;this[0]=document.body;this.selector=selector;this.length=1;return this}if(typeof selector===
"string"){if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3)match=[null,selector,null];else match=quickExpr.exec(selector);if(match&&(match[1]||!context))if(match[1]){context=context instanceof jQuery?context[0]:context;doc=context?context.ownerDocument||context:document;ret=rsingleTag.exec(selector);if(ret)if(jQuery.isPlainObject(context)){selector=[document.createElement(ret[1])];jQuery.fn.attr.call(selector,context,true)}else selector=[doc.createElement(ret[1])];
else{ret=jQuery.buildFragment([match[1]],[doc]);selector=(ret.cacheable?jQuery.clone(ret.fragment):ret.fragment).childNodes}return jQuery.merge(this,selector)}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){if(elem.id!==match[2])return rootjQuery.find(selector);this.length=1;this[0]=elem}this.context=document;this.selector=selector;return this}else if(!context||context.jquery)return(context||rootjQuery).find(selector);else return this.constructor(context).find(selector)}else if(jQuery.isFunction(selector))return rootjQuery.ready(selector);
if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context}return jQuery.makeArray(selector,this)},selector:"",jquery:"1.6.4",length:0,size:function(){return this.length},toArray:function(){return slice.call(this,0)},get:function(num){return num==null?this.toArray():num<0?this[this.length+num]:this[num]},pushStack:function(elems,name,selector){var ret=this.constructor();if(jQuery.isArray(elems))push.apply(ret,elems);else jQuery.merge(ret,elems);ret.prevObject=
this;ret.context=this.context;if(name==="find")ret.selector=this.selector+(this.selector?" ":"")+selector;else if(name)ret.selector=this.selector+"."+name+"("+selector+")";return ret},each:function(callback,args){return jQuery.each(this,callback,args)},ready:function(fn){jQuery.bindReady();readyList.done(fn);return this},eq:function(i){return i===-1?this.slice(i):this.slice(i,+i+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(slice.apply(this,
arguments),"slice",slice.call(arguments).join(","))},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:[].sort,splice:[].splice};jQuery.fn.init.prototype=jQuery.fn;jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=
arguments[1]||{};i=2}if(typeof target!=="object"&&!jQuery.isFunction(target))target={};if(length===i){target=this;--i}for(;i<length;i++)if((options=arguments[i])!=null)for(name in options){src=target[name];copy=options[name];if(target===copy)continue;if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[]}else clone=src&&jQuery.isPlainObject(src)?src:{};target[name]=jQuery.extend(deep,clone,copy)}else if(copy!==
undefined)target[name]=copy}return target};jQuery.extend({noConflict:function(deep){if(window.$===jQuery)window.$=_$;if(deep&&window.jQuery===jQuery)window.jQuery=_jQuery;return jQuery},isReady:false,readyWait:1,holdReady:function(hold){if(hold)jQuery.readyWait++;else jQuery.ready(true)},ready:function(wait){if(wait===true&&!--jQuery.readyWait||wait!==true&&!jQuery.isReady){if(!document.body)return setTimeout(jQuery.ready,1);jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0)return;readyList.resolveWith(document,
[jQuery]);if(jQuery.fn.trigger)jQuery(document).trigger("ready").unbind("ready")}},bindReady:function(){if(readyList)return;readyList=jQuery._Deferred();if(document.readyState==="complete")return setTimeout(jQuery.ready,1);if(document.addEventListener){document.addEventListener("DOMContentLoaded",DOMContentLoaded,false);window.addEventListener("load",jQuery.ready,false)}else if(document.attachEvent){document.attachEvent("onreadystatechange",DOMContentLoaded);window.attachEvent("onload",jQuery.ready);
var toplevel=false;try{toplevel=window.frameElement==null}catch(e){}if(document.documentElement.doScroll&&toplevel)doScrollCheck()}},isFunction:function(obj){return jQuery.type(obj)==="function"},isArray:Array.isArray||function(obj){return jQuery.type(obj)==="array"},isWindow:function(obj){return obj&&typeof obj==="object"&&"setInterval"in obj},isNaN:function(obj){return obj==null||!rdigit.test(obj)||isNaN(obj)},type:function(obj){return obj==null?String(obj):class2type[toString.call(obj)]||"object"},
isPlainObject:function(obj){if(!obj||jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj))return false;try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return false}catch(e){return false}var key;for(key in obj);return key===undefined||hasOwn.call(obj,key)},isEmptyObject:function(obj){for(var name in obj)return false;return true},error:function(msg){throw msg;},parseJSON:function(data){if(typeof data!=="string"||!data)return null;
data=jQuery.trim(data);if(window.JSON&&window.JSON.parse)return window.JSON.parse(data);if(rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,"")))return(new Function("return "+data))();jQuery.error("Invalid JSON: "+data)},parseXML:function(data){var xml,tmp;try{if(window.DOMParser){tmp=new DOMParser;xml=tmp.parseFromString(data,"text/xml")}else{xml=new ActiveXObject("Microsoft.XMLDOM");xml.async="false";xml.loadXML(data)}}catch(e){xml=undefined}if(!xml||
!xml.documentElement||xml.getElementsByTagName("parsererror").length)jQuery.error("Invalid XML: "+data);return xml},noop:function(){},globalEval:function(data){if(data&&rnotwhite.test(data))(window.execScript||function(data){window["eval"].call(window,data)})(data)},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toUpperCase()===name.toUpperCase()},each:function(object,callback,args){var name,
i=0,length=object.length,isObj=length===undefined||jQuery.isFunction(object);if(args)if(isObj)for(name in object){if(callback.apply(object[name],args)===false)break}else for(;i<length;){if(callback.apply(object[i++],args)===false)break}else if(isObj)for(name in object){if(callback.call(object[name],name,object[name])===false)break}else for(;i<length;)if(callback.call(object[i],i,object[i++])===false)break;return object},trim:trim?function(text){return text==null?"":trim.call(text)}:function(text){return text==
null?"":text.toString().replace(trimLeft,"").replace(trimRight,"")},makeArray:function(array,results){var ret=results||[];if(array!=null){var type=jQuery.type(array);if(array.length==null||type==="string"||type==="function"||type==="regexp"||jQuery.isWindow(array))push.call(ret,array);else jQuery.merge(ret,array)}return ret},inArray:function(elem,array){if(!array)return-1;if(indexOf)return indexOf.call(array,elem);for(var i=0,length=array.length;i<length;i++)if(array[i]===elem)return i;return-1},
merge:function(first,second){var i=first.length,j=0;if(typeof second.length==="number")for(var l=second.length;j<l;j++)first[i++]=second[j];else while(second[j]!==undefined)first[i++]=second[j++];first.length=i;return first},grep:function(elems,callback,inv){var ret=[],retVal;inv=!!inv;for(var i=0,length=elems.length;i<length;i++){retVal=!!callback(elems[i],i);if(inv!==retVal)ret.push(elems[i])}return ret},map:function(elems,callback,arg){var value,key,ret=[],i=0,length=elems.length,isArray=elems instanceof
jQuery||length!==undefined&&typeof length==="number"&&(length>0&&elems[0]&&elems[length-1]||length===0||jQuery.isArray(elems));if(isArray)for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null)ret[ret.length]=value}else for(key in elems){value=callback(elems[key],key,arg);if(value!=null)ret[ret.length]=value}return ret.concat.apply([],ret)},guid:1,proxy:function(fn,context){if(typeof context==="string"){var tmp=fn[context];context=fn;fn=tmp}if(!jQuery.isFunction(fn))return undefined;var args=
slice.call(arguments,2),proxy=function(){return fn.apply(context,args.concat(slice.call(arguments)))};proxy.guid=fn.guid=fn.guid||proxy.guid||jQuery.guid++;return proxy},access:function(elems,key,value,exec,fn,pass){var length=elems.length;if(typeof key==="object"){for(var k in key)jQuery.access(elems,k,key[k],exec,fn,value);return elems}if(value!==undefined){exec=!pass&&exec&&jQuery.isFunction(value);for(var i=0;i<length;i++)fn(elems[i],key,exec?value.call(elems[i],i,fn(elems[i],key)):value,pass);
return elems}return length?fn(elems[0],key):undefined},now:function(){return(new Date).getTime()},uaMatch:function(ua){ua=ua.toLowerCase();var match=rwebkit.exec(ua)||ropera.exec(ua)||rmsie.exec(ua)||ua.indexOf("compatible")<0&&rmozilla.exec(ua)||[];return{browser:match[1]||"",version:match[2]||"0"}},sub:function(){function jQuerySub(selector,context){return new jQuerySub.fn.init(selector,context)}jQuery.extend(true,jQuerySub,this);jQuerySub.superclass=this;jQuerySub.fn=jQuerySub.prototype=this();
jQuerySub.fn.constructor=jQuerySub;jQuerySub.sub=this.sub;jQuerySub.fn.init=function init(selector,context){if(context&&context instanceof jQuery&&!(context instanceof jQuerySub))context=jQuerySub(context);return jQuery.fn.init.call(this,selector,context,rootjQuerySub)};jQuerySub.fn.init.prototype=jQuerySub.fn;var rootjQuerySub=jQuerySub(document);return jQuerySub},browser:{}});jQuery.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(i,name){class2type["[object "+
name+"]"]=name.toLowerCase()});browserMatch=jQuery.uaMatch(userAgent);if(browserMatch.browser){jQuery.browser[browserMatch.browser]=true;jQuery.browser.version=browserMatch.version}if(jQuery.browser.webkit)jQuery.browser.safari=true;if(rnotwhite.test("\u00a0")){trimLeft=/^[\s\xA0]+/;trimRight=/[\s\xA0]+$/}rootjQuery=jQuery(document);if(document.addEventListener)DOMContentLoaded=function(){document.removeEventListener("DOMContentLoaded",DOMContentLoaded,false);jQuery.ready()};else if(document.attachEvent)DOMContentLoaded=
function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",DOMContentLoaded);jQuery.ready()}};function doScrollCheck(){if(jQuery.isReady)return;try{document.documentElement.doScroll("left")}catch(e){setTimeout(doScrollCheck,1);return}jQuery.ready()}return jQuery}();var promiseMethods="done fail isResolved isRejected promise then always pipe".split(" "),sliceDeferred=[].slice;jQuery.extend({_Deferred:function(){var callbacks=[],fired,firing,cancelled,deferred={done:function(){if(!cancelled){var args=
arguments,i,length,elem,type,_fired;if(fired){_fired=fired;fired=0}for(i=0,length=args.length;i<length;i++){elem=args[i];type=jQuery.type(elem);if(type==="array")deferred.done.apply(deferred,elem);else if(type==="function")callbacks.push(elem)}if(_fired)deferred.resolveWith(_fired[0],_fired[1])}return this},resolveWith:function(context,args){if(!cancelled&&!fired&&!firing){args=args||[];firing=1;try{while(callbacks[0])callbacks.shift().apply(context,args)}finally{fired=[context,args];firing=0}}return this},
resolve:function(){deferred.resolveWith(this,arguments);return this},isResolved:function(){return!!(firing||fired)},cancel:function(){cancelled=1;callbacks=[];return this}};return deferred},Deferred:function(func){var deferred=jQuery._Deferred(),failDeferred=jQuery._Deferred(),promise;jQuery.extend(deferred,{then:function(doneCallbacks,failCallbacks){deferred.done(doneCallbacks).fail(failCallbacks);return this},always:function(){return deferred.done.apply(deferred,arguments).fail.apply(this,arguments)},
fail:failDeferred.done,rejectWith:failDeferred.resolveWith,reject:failDeferred.resolve,isRejected:failDeferred.isResolved,pipe:function(fnDone,fnFail){return jQuery.Deferred(function(newDefer){jQuery.each({done:[fnDone,"resolve"],fail:[fnFail,"reject"]},function(handler,data){var fn=data[0],action=data[1],returned;if(jQuery.isFunction(fn))deferred[handler](function(){returned=fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise))returned.promise().then(newDefer.resolve,newDefer.reject);
else newDefer[action+"With"](this===deferred?newDefer:this,[returned])});else deferred[handler](newDefer[action])})}).promise()},promise:function(obj){if(obj==null){if(promise)return promise;promise=obj={}}var i=promiseMethods.length;while(i--)obj[promiseMethods[i]]=deferred[promiseMethods[i]];return obj}});deferred.done(failDeferred.cancel).fail(deferred.cancel);delete deferred.cancel;if(func)func.call(deferred,deferred);return deferred},when:function(firstParam){var args=arguments,i=0,length=args.length,
count=length,deferred=length<=1&&firstParam&&jQuery.isFunction(firstParam.promise)?firstParam:jQuery.Deferred();function resolveFunc(i){return function(value){args[i]=arguments.length>1?sliceDeferred.call(arguments,0):value;if(!--count)deferred.resolveWith(deferred,sliceDeferred.call(args,0))}}if(length>1){for(;i<length;i++)if(args[i]&&jQuery.isFunction(args[i].promise))args[i].promise().then(resolveFunc(i),deferred.reject);else--count;if(!count)deferred.resolveWith(deferred,args)}else if(deferred!==
firstParam)deferred.resolveWith(deferred,length?[firstParam]:[]);return deferred.promise()}});jQuery.support=function(){var div=document.createElement("div"),documentElement=document.documentElement,all,a,select,opt,input,marginDiv,support,fragment,body,testElementParent,testElement,testElementStyle,tds,events,eventName,i,isSupported;div.setAttribute("className","t");div.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";all=div.getElementsByTagName("*");
a=div.getElementsByTagName("a")[0];if(!all||!all.length||!a)return{};select=document.createElement("select");opt=select.appendChild(document.createElement("option"));input=div.getElementsByTagName("input")[0];support={leadingWhitespace:div.firstChild.nodeType===3,tbody:!div.getElementsByTagName("tbody").length,htmlSerialize:!!div.getElementsByTagName("link").length,style:/top/.test(a.getAttribute("style")),hrefNormalized:a.getAttribute("href")==="/a",opacity:/^0.55$/.test(a.style.opacity),cssFloat:!!a.style.cssFloat,
checkOn:input.value==="on",optSelected:opt.selected,getSetAttribute:div.className!=="t",submitBubbles:true,changeBubbles:true,focusinBubbles:false,deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true};input.checked=true;support.noCloneChecked=input.cloneNode(true).checked;select.disabled=true;support.optDisabled=!opt.disabled;try{delete div.test}catch(e){support.deleteExpando=false}if(!div.addEventListener&&div.attachEvent&&div.fireEvent){div.attachEvent("onclick",
function(){support.noCloneEvent=false});div.cloneNode(true).fireEvent("onclick")}input=document.createElement("input");input.value="t";input.setAttribute("type","radio");support.radioValue=input.value==="t";input.setAttribute("checked","checked");div.appendChild(input);fragment=document.createDocumentFragment();fragment.appendChild(div.firstChild);support.checkClone=fragment.cloneNode(true).cloneNode(true).lastChild.checked;div.innerHTML="";div.style.width=div.style.paddingLeft="1px";body=document.getElementsByTagName("body")[0];
testElement=document.createElement(body?"div":"body");testElementStyle={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(body)jQuery.extend(testElementStyle,{position:"absolute",left:"-1000px",top:"-1000px"});for(i in testElementStyle)testElement.style[i]=testElementStyle[i];testElement.appendChild(div);testElementParent=body||documentElement;testElementParent.insertBefore(testElement,testElementParent.firstChild);support.appendChecked=input.checked;support.boxModel=div.offsetWidth===
2;if("zoom"in div.style){div.style.display="inline";div.style.zoom=1;support.inlineBlockNeedsLayout=div.offsetWidth===2;div.style.display="";div.innerHTML="<div style='width:4px;'></div>";support.shrinkWrapBlocks=div.offsetWidth!==2}div.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";tds=div.getElementsByTagName("td");isSupported=tds[0].offsetHeight===0;tds[0].style.display="";tds[1].style.display="none";support.reliableHiddenOffsets=isSupported&&tds[0].offsetHeight===
0;div.innerHTML="";if(document.defaultView&&document.defaultView.getComputedStyle){marginDiv=document.createElement("div");marginDiv.style.width="0";marginDiv.style.marginRight="0";div.appendChild(marginDiv);support.reliableMarginRight=(parseInt((document.defaultView.getComputedStyle(marginDiv,null)||{marginRight:0}).marginRight,10)||0)===0}testElement.innerHTML="";testElementParent.removeChild(testElement);if(div.attachEvent)for(i in{submit:1,change:1,focusin:1}){eventName="on"+i;isSupported=eventName in
div;if(!isSupported){div.setAttribute(eventName,"return;");isSupported=typeof div[eventName]==="function"}support[i+"Bubbles"]=isSupported}testElement=fragment=select=opt=body=marginDiv=div=input=null;return support}();jQuery.boxModel=jQuery.support.boxModel;var rbrace=/^(?:\{.*\}|\[.*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({cache:{},uuid:0,expando:"jQuery"+(jQuery.fn.jquery+Math.random()).replace(/\D/g,""),noData:{"embed":true,"object":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000","applet":true},
hasData:function(elem){elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando];return!!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data,pvt){if(!jQuery.acceptData(elem))return;var thisCache,ret,internalKey=jQuery.expando,getByName=typeof name==="string",isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:elem[jQuery.expando]&&jQuery.expando;if((!id||pvt&&id&&cache[id]&&!cache[id][internalKey])&&getByName&&data===undefined)return;if(!id)if(isNode)elem[jQuery.expando]=
id=++jQuery.uuid;else id=jQuery.expando;if(!cache[id]){cache[id]={};if(!isNode)cache[id].toJSON=jQuery.noop}if(typeof name==="object"||typeof name==="function")if(pvt)cache[id][internalKey]=jQuery.extend(cache[id][internalKey],name);else cache[id]=jQuery.extend(cache[id],name);thisCache=cache[id];if(pvt){if(!thisCache[internalKey])thisCache[internalKey]={};thisCache=thisCache[internalKey]}if(data!==undefined)thisCache[jQuery.camelCase(name)]=data;if(name==="events"&&!thisCache[name])return thisCache[internalKey]&&
thisCache[internalKey].events;if(getByName){ret=thisCache[name];if(ret==null)ret=thisCache[jQuery.camelCase(name)]}else ret=thisCache;return ret},removeData:function(elem,name,pvt){if(!jQuery.acceptData(elem))return;var thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(!cache[id])return;if(name){thisCache=pvt?cache[id][internalKey]:cache[id];if(thisCache){if(!thisCache[name])name=jQuery.camelCase(name);delete thisCache[name];
if(!isEmptyDataObject(thisCache))return}}if(pvt){delete cache[id][internalKey];if(!isEmptyDataObject(cache[id]))return}var internalCache=cache[id][internalKey];if(jQuery.support.deleteExpando||!cache.setInterval)delete cache[id];else cache[id]=null;if(internalCache){cache[id]={};if(!isNode)cache[id].toJSON=jQuery.noop;cache[id][internalKey]=internalCache}else if(isNode)if(jQuery.support.deleteExpando)delete elem[jQuery.expando];else if(elem.removeAttribute)elem.removeAttribute(jQuery.expando);else elem[jQuery.expando]=
null},_data:function(elem,name,data){return jQuery.data(elem,name,data,true)},acceptData:function(elem){if(elem.nodeName){var match=jQuery.noData[elem.nodeName.toLowerCase()];if(match)return!(match===true||elem.getAttribute("classid")!==match)}return true}});jQuery.fn.extend({data:function(key,value){var data=null;if(typeof key==="undefined"){if(this.length){data=jQuery.data(this[0]);if(this[0].nodeType===1){var attr=this[0].attributes,name;for(var i=0,l=attr.length;i<l;i++){name=attr[i].name;if(name.indexOf("data-")===
0){name=jQuery.camelCase(name.substring(5));dataAttr(this[0],name,data[name])}}}}return data}else if(typeof key==="object")return this.each(function(){jQuery.data(this,key)});var parts=key.split(".");parts[1]=parts[1]?"."+parts[1]:"";if(value===undefined){data=this.triggerHandler("getData"+parts[1]+"!",[parts[0]]);if(data===undefined&&this.length){data=jQuery.data(this[0],key);data=dataAttr(this[0],key,data)}return data===undefined&&parts[1]?this.data(parts[0]):data}else return this.each(function(){var $this=
jQuery(this),args=[parts[0],value];$this.triggerHandler("setData"+parts[1]+"!",args);jQuery.data(this,key,value);$this.triggerHandler("changeData"+parts[1]+"!",args)})},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}});function dataAttr(elem,key,data){if(data===undefined&&elem.nodeType===1){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data===
"null"?null:!jQuery.isNaN(data)?parseFloat(data):rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}jQuery.data(elem,key,data)}else data=undefined}return data}function isEmptyDataObject(obj){for(var name in obj)if(name!=="toJSON")return false;return true}function handleQueueMarkDefer(elem,type,src){var deferDataKey=type+"defer",queueDataKey=type+"queue",markDataKey=type+"mark",defer=jQuery.data(elem,deferDataKey,undefined,true);if(defer&&(src==="queue"||!jQuery.data(elem,queueDataKey,undefined,
true))&&(src==="mark"||!jQuery.data(elem,markDataKey,undefined,true)))setTimeout(function(){if(!jQuery.data(elem,queueDataKey,undefined,true)&&!jQuery.data(elem,markDataKey,undefined,true)){jQuery.removeData(elem,deferDataKey,true);defer.resolve()}},0)}jQuery.extend({_mark:function(elem,type){if(elem){type=(type||"fx")+"mark";jQuery.data(elem,type,(jQuery.data(elem,type,undefined,true)||0)+1,true)}},_unmark:function(force,elem,type){if(force!==true){type=elem;elem=force;force=false}if(elem){type=
type||"fx";var key=type+"mark",count=force?0:(jQuery.data(elem,key,undefined,true)||1)-1;if(count)jQuery.data(elem,key,count,true);else{jQuery.removeData(elem,key,true);handleQueueMarkDefer(elem,type,"mark")}}},queue:function(elem,type,data){if(elem){type=(type||"fx")+"queue";var q=jQuery.data(elem,type,undefined,true);if(data)if(!q||jQuery.isArray(data))q=jQuery.data(elem,type,jQuery.makeArray(data),true);else q.push(data);return q||[]}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,
type),fn=queue.shift(),defer;if(fn==="inprogress")fn=queue.shift();if(fn){if(type==="fx")queue.unshift("inprogress");fn.call(elem,function(){jQuery.dequeue(elem,type)})}if(!queue.length){jQuery.removeData(elem,type+"queue",true);handleQueueMarkDefer(elem,type,"queue")}}});jQuery.fn.extend({queue:function(type,data){if(typeof type!=="string"){data=type;type="fx"}if(data===undefined)return jQuery.queue(this[0],type);return this.each(function(){var queue=jQuery.queue(this,type,data);if(type==="fx"&&
queue[0]!=="inprogress")jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},delay:function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(){var elem=this;setTimeout(function(){jQuery.dequeue(elem,type)},time)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,object){if(typeof type!=="string"){object=type;type=undefined}type=type||"fx";var defer=jQuery.Deferred(),
elements=this,i=elements.length,count=1,deferDataKey=type+"defer",queueDataKey=type+"queue",markDataKey=type+"mark",tmp;function resolve(){if(!--count)defer.resolveWith(elements,[elements])}while(i--)if(tmp=jQuery.data(elements[i],deferDataKey,undefined,true)||(jQuery.data(elements[i],queueDataKey,undefined,true)||jQuery.data(elements[i],markDataKey,undefined,true))&&jQuery.data(elements[i],deferDataKey,jQuery._Deferred(),true)){count++;tmp.done(resolve)}resolve();return defer.promise()}});var rclass=
/[\n\t\r]/g,rspace=/\s+/,rreturn=/\r/g,rtype=/^(?:button|input)$/i,rfocusable=/^(?:button|input|object|select|textarea)$/i,rclickable=/^a(?:rea)?$/i,rboolean=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,nodeHook,boolHook;jQuery.fn.extend({attr:function(name,value){return jQuery.access(this,name,value,true,jQuery.attr)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})},prop:function(name,
value){return jQuery.access(this,name,value,true,jQuery.prop)},removeProp:function(name){name=jQuery.propFix[name]||name;return this.each(function(){try{this[name]=undefined;delete this[name]}catch(e){}})},addClass:function(value){var classNames,i,l,elem,setClass,c,cl;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))});if(value&&typeof value==="string"){classNames=value.split(rspace);for(i=0,l=this.length;i<l;i++){elem=this[i];if(elem.nodeType===
1)if(!elem.className&&classNames.length===1)elem.className=value;else{setClass=" "+elem.className+" ";for(c=0,cl=classNames.length;c<cl;c++)if(!~setClass.indexOf(" "+classNames[c]+" "))setClass+=classNames[c]+" ";elem.className=jQuery.trim(setClass)}}}return this},removeClass:function(value){var classNames,i,l,elem,className,c,cl;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))});if(value&&typeof value==="string"||value===undefined){classNames=
(value||"").split(rspace);for(i=0,l=this.length;i<l;i++){elem=this[i];if(elem.nodeType===1&&elem.className)if(value){className=(" "+elem.className+" ").replace(rclass," ");for(c=0,cl=classNames.length;c<cl;c++)className=className.replace(" "+classNames[c]+" "," ");elem.className=jQuery.trim(className)}else elem.className=""}}return this},toggleClass:function(value,stateVal){var type=typeof value,isBool=typeof stateVal==="boolean";if(jQuery.isFunction(value))return this.each(function(i){jQuery(this).toggleClass(value.call(this,
i,this.className,stateVal),stateVal)});return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),state=stateVal,classNames=value.split(rspace);while(className=classNames[i++]){state=isBool?state:!self.hasClass(className);self[state?"addClass":"removeClass"](className)}}else if(type==="undefined"||type==="boolean"){if(this.className)jQuery._data(this,"__className__",this.className);this.className=this.className||value===false?"":jQuery._data(this,"__className__")||""}})},
hasClass:function(selector){var className=" "+selector+" ";for(var i=0,l=this.length;i<l;i++)if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>-1)return true;return false},val:function(value){var hooks,ret,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.nodeName.toLowerCase()]||jQuery.valHooks[elem.type];if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined)return ret;ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,
""):ret==null?"":ret}return undefined}var isFunction=jQuery.isFunction(value);return this.each(function(i){var self=jQuery(this),val;if(this.nodeType!==1)return;if(isFunction)val=value.call(this,i,self.val());else val=value;if(val==null)val="";else if(typeof val==="number")val+="";else if(jQuery.isArray(val))val=jQuery.map(val,function(value){return value==null?"":value+""});hooks=jQuery.valHooks[this.nodeName.toLowerCase()]||jQuery.valHooks[this.type];if(!hooks||!("set"in hooks)||hooks.set(this,
val,"value")===undefined)this.value=val})}});jQuery.extend({valHooks:{option:{get:function(elem){var val=elem.attributes.value;return!val||val.specified?elem.value:elem.text}},select:{get:function(elem){var value,index=elem.selectedIndex,values=[],options=elem.options,one=elem.type==="select-one";if(index<0)return null;for(var i=one?index:0,max=one?index+1:options.length;i<max;i++){var option=options[i];if(option.selected&&(jQuery.support.optDisabled?!option.disabled:option.getAttribute("disabled")===
null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one)return value;values.push(value)}}if(one&&!values.length&&options.length)return jQuery(options[index]).val();return values},set:function(elem,value){var values=jQuery.makeArray(value);jQuery(elem).find("option").each(function(){this.selected=jQuery.inArray(jQuery(this).val(),values)>=0});if(!values.length)elem.selectedIndex=-1;return values}}},attrFn:{val:true,css:true,html:true,
text:true,data:true,width:true,height:true,offset:true},attrFix:{tabindex:"tabIndex"},attr:function(elem,name,value,pass){var nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2)return undefined;if(pass&&name in jQuery.attrFn)return jQuery(elem)[name](value);if(!("getAttribute"in elem))return jQuery.prop(elem,name,value);var ret,hooks,notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.attrFix[name]||name;hooks=jQuery.attrHooks[name];if(!hooks)if(rboolean.test(name))hooks=boolHook;
else if(nodeHook)hooks=nodeHook}if(value!==undefined)if(value===null){jQuery.removeAttr(elem,name);return undefined}else if(hooks&&"set"in hooks&&notxml&&(ret=hooks.set(elem,value,name))!==undefined)return ret;else{elem.setAttribute(name,""+value);return value}else if(hooks&&"get"in hooks&&notxml&&(ret=hooks.get(elem,name))!==null)return ret;else{ret=elem.getAttribute(name);return ret===null?undefined:ret}},removeAttr:function(elem,name){var propName;if(elem.nodeType===1){name=jQuery.attrFix[name]||
name;jQuery.attr(elem,name,"");elem.removeAttribute(name);if(rboolean.test(name)&&(propName=jQuery.propFix[name]||name)in elem)elem[propName]=false}},attrHooks:{type:{set:function(elem,value){if(rtype.test(elem.nodeName)&&elem.parentNode)jQuery.error("type property can't be changed");else if(!jQuery.support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val)elem.value=val;return value}}},value:{get:function(elem,name){if(nodeHook&&
jQuery.nodeName(elem,"button"))return nodeHook.get(elem,name);return name in elem?elem.value:null},set:function(elem,value,name){if(nodeHook&&jQuery.nodeName(elem,"button"))return nodeHook.set(elem,value,name);elem.value=value}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},
prop:function(elem,name,value){var nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2)return undefined;var ret,hooks,notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name]}if(value!==undefined)if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined)return ret;else return elem[name]=value;else if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null)return ret;else return elem[name]},propHooks:{tabIndex:{get:function(elem){var attributeNode=
elem.getAttributeNode("tabindex");return attributeNode&&attributeNode.specified?parseInt(attributeNode.value,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:undefined}}}});jQuery.attrHooks.tabIndex=jQuery.propHooks.tabIndex;boolHook={get:function(elem,name){var attrNode;return jQuery.prop(elem,name)===true||(attrNode=elem.getAttributeNode(name))&&attrNode.nodeValue!==false?name.toLowerCase():undefined},set:function(elem,value,name){var propName;if(value===false)jQuery.removeAttr(elem,
name);else{propName=jQuery.propFix[name]||name;if(propName in elem)elem[propName]=true;elem.setAttribute(name,name.toLowerCase())}return name}};if(!jQuery.support.getSetAttribute){nodeHook=jQuery.valHooks.button={get:function(elem,name){var ret;ret=elem.getAttributeNode(name);return ret&&ret.nodeValue!==""?ret.nodeValue:undefined},set:function(elem,value,name){var ret=elem.getAttributeNode(name);if(!ret){ret=document.createAttribute(name);elem.setAttributeNode(ret)}return ret.nodeValue=value+""}};
jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],{set:function(elem,value){if(value===""){elem.setAttribute(name,"auto");return value}}})})}if(!jQuery.support.hrefNormalized)jQuery.each(["href","src","width","height"],function(i,name){jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],{get:function(elem){var ret=elem.getAttribute(name,2);return ret===null?undefined:ret}})});if(!jQuery.support.style)jQuery.attrHooks.style={get:function(elem){return elem.style.cssText.toLowerCase()||
undefined},set:function(elem,value){return elem.style.cssText=""+value}};if(!jQuery.support.optSelected)jQuery.propHooks.selected=jQuery.extend(jQuery.propHooks.selected,{get:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;if(parent.parentNode)parent.parentNode.selectedIndex}return null}});if(!jQuery.support.checkOn)jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={get:function(elem){return elem.getAttribute("value")===null?"on":elem.value}}});jQuery.each(["radio",
"checkbox"],function(){jQuery.valHooks[this]=jQuery.extend(jQuery.valHooks[this],{set:function(elem,value){if(jQuery.isArray(value))return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0}})});var rnamespaces=/\.(.*)$/,rformElems=/^(?:textarea|input|select)$/i,rperiod=/\./g,rspaces=/ /g,rescape=/[^\w\s.|`]/g,fcleanup=function(nm){return nm.replace(rescape,"\\$&")};jQuery.event={add:function(elem,types,handler,data){if(elem.nodeType===3||elem.nodeType===8)return;if(handler===false)handler=
returnFalse;else if(!handler)return;var handleObjIn,handleObj;if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler}if(!handler.guid)handler.guid=jQuery.guid++;var elemData=jQuery._data(elem);if(!elemData)return;var events=elemData.events,eventHandle=elemData.handle;if(!events)elemData.events=events={};if(!eventHandle)elemData.handle=eventHandle=function(e){return typeof jQuery!=="undefined"&&(!e||jQuery.event.triggered!==e.type)?jQuery.event.handle.apply(eventHandle.elem,arguments):
undefined};eventHandle.elem=elem;types=types.split(" ");var type,i=0,namespaces;while(type=types[i++]){handleObj=handleObjIn?jQuery.extend({},handleObjIn):{handler:handler,data:data};if(type.indexOf(".")>-1){namespaces=type.split(".");type=namespaces.shift();handleObj.namespace=namespaces.slice(0).sort().join(".")}else{namespaces=[];handleObj.namespace=""}handleObj.type=type;if(!handleObj.guid)handleObj.guid=handler.guid;var handlers=events[type],special=jQuery.event.special[type]||{};if(!handlers){handlers=
events[type]=[];if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false)if(elem.addEventListener)elem.addEventListener(type,eventHandle,false);else if(elem.attachEvent)elem.attachEvent("on"+type,eventHandle)}if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid)handleObj.handler.guid=handler.guid}handlers.push(handleObj);jQuery.event.global[type]=true}elem=null},global:{},remove:function(elem,types,handler,pos){if(elem.nodeType===3||elem.nodeType===8)return;
if(handler===false)handler=returnFalse;var ret,type,fn,j,i=0,all,namespaces,namespace,special,eventType,handleObj,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem),events=elemData&&elemData.events;if(!elemData||!events)return;if(types&&types.type){handler=types.handler;types=types.type}if(!types||typeof types==="string"&&types.charAt(0)==="."){types=types||"";for(type in events)jQuery.event.remove(elem,type+types);return}types=types.split(" ");while(type=types[i++]){origType=type;handleObj=
null;all=type.indexOf(".")<0;namespaces=[];if(!all){namespaces=type.split(".");type=namespaces.shift();namespace=new RegExp("(^|\\.)"+jQuery.map(namespaces.slice(0).sort(),fcleanup).join("\\.(?:.*\\.)?")+"(\\.|$)")}eventType=events[type];if(!eventType)continue;if(!handler){for(j=0;j<eventType.length;j++){handleObj=eventType[j];if(all||namespace.test(handleObj.namespace)){jQuery.event.remove(elem,origType,handleObj.handler,j);eventType.splice(j--,1)}}continue}special=jQuery.event.special[type]||{};
for(j=pos||0;j<eventType.length;j++){handleObj=eventType[j];if(handler.guid===handleObj.guid){if(all||namespace.test(handleObj.namespace)){if(pos==null)eventType.splice(j--,1);if(special.remove)special.remove.call(elem,handleObj)}if(pos!=null)break}}if(eventType.length===0||pos!=null&&eventType.length===1){if(!special.teardown||special.teardown.call(elem,namespaces)===false)jQuery.removeEvent(elem,type,elemData.handle);ret=null;delete events[type]}}if(jQuery.isEmptyObject(events)){var handle=elemData.handle;
if(handle)handle.elem=null;delete elemData.events;delete elemData.handle;if(jQuery.isEmptyObject(elemData))jQuery.removeData(elem,undefined,true)}},customEvent:{"getData":true,"setData":true,"changeData":true},trigger:function(event,data,elem,onlyHandlers){var type=event.type||event,namespaces=[],exclusive;if(type.indexOf("!")>=0){type=type.slice(0,-1);exclusive=true}if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort()}if((!elem||jQuery.event.customEvent[type])&&
!jQuery.event.global[type])return;event=typeof event==="object"?event[jQuery.expando]?event:new jQuery.Event(type,event):new jQuery.Event(type);event.type=type;event.exclusive=exclusive;event.namespace=namespaces.join(".");event.namespace_re=new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.)?")+"(\\.|$)");if(onlyHandlers||!elem){event.preventDefault();event.stopPropagation()}if(!elem){jQuery.each(jQuery.cache,function(){var internalKey=jQuery.expando,internalCache=this[internalKey];if(internalCache&&
internalCache.events&&internalCache.events[type])jQuery.event.trigger(event,data,internalCache.handle.elem)});return}if(elem.nodeType===3||elem.nodeType===8)return;event.result=undefined;event.target=elem;data=data!=null?jQuery.makeArray(data):[];data.unshift(event);var cur=elem,ontype=type.indexOf(":")<0?"on"+type:"";do{var handle=jQuery._data(cur,"handle");event.currentTarget=cur;if(handle)handle.apply(cur,data);if(ontype&&jQuery.acceptData(cur)&&cur[ontype]&&cur[ontype].apply(cur,data)===false){event.result=
false;event.preventDefault()}cur=cur.parentNode||cur.ownerDocument||cur===event.target.ownerDocument&&window}while(cur&&!event.isPropagationStopped());if(!event.isDefaultPrevented()){var old,special=jQuery.event.special[type]||{};if((!special._default||special._default.call(elem.ownerDocument,event)===false)&&!(type==="click"&&jQuery.nodeName(elem,"a"))&&jQuery.acceptData(elem)){try{if(ontype&&elem[type]){old=elem[ontype];if(old)elem[ontype]=null;jQuery.event.triggered=type;elem[type]()}}catch(ieError){}if(old)elem[ontype]=
old;jQuery.event.triggered=undefined}}return event.result},handle:function(event){event=jQuery.event.fix(event||window.event);var handlers=((jQuery._data(this,"events")||{})[event.type]||[]).slice(0),run_all=!event.exclusive&&!event.namespace,args=Array.prototype.slice.call(arguments,0);args[0]=event;event.currentTarget=this;for(var j=0,l=handlers.length;j<l;j++){var handleObj=handlers[j];if(run_all||event.namespace_re.test(handleObj.namespace)){event.handler=handleObj.handler;event.data=handleObj.data;
event.handleObj=handleObj;var ret=handleObj.handler.apply(this,args);if(ret!==undefined){event.result=ret;if(ret===false){event.preventDefault();event.stopPropagation()}}if(event.isImmediatePropagationStopped())break}}return event.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),
fix:function(event){if(event[jQuery.expando])return event;var originalEvent=event;event=jQuery.Event(originalEvent);for(var i=this.props.length,prop;i;){prop=this.props[--i];event[prop]=originalEvent[prop]}if(!event.target)event.target=event.srcElement||document;if(event.target.nodeType===3)event.target=event.target.parentNode;if(!event.relatedTarget&&event.fromElement)event.relatedTarget=event.fromElement===event.target?event.toElement:event.fromElement;if(event.pageX==null&&event.clientX!=null){var eventDocument=
event.target.ownerDocument||document,doc=eventDocument.documentElement,body=eventDocument.body;event.pageX=event.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=event.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}if(event.which==null&&(event.charCode!=null||event.keyCode!=null))event.which=event.charCode!=null?event.charCode:event.keyCode;if(!event.metaKey&&event.ctrlKey)event.metaKey=
event.ctrlKey;if(!event.which&&event.button!==undefined)event.which=event.button&1?1:event.button&2?3:event.button&4?2:0;return event},guid:1E8,proxy:jQuery.proxy,special:{ready:{setup:jQuery.bindReady,teardown:jQuery.noop},live:{add:function(handleObj){jQuery.event.add(this,liveConvert(handleObj.origType,handleObj.selector),jQuery.extend({},handleObj,{handler:liveHandler,guid:handleObj.handler.guid}))},remove:function(handleObj){jQuery.event.remove(this,liveConvert(handleObj.origType,handleObj.selector),
handleObj)}},beforeunload:{setup:function(data,namespaces,eventHandle){if(jQuery.isWindow(this))this.onbeforeunload=eventHandle},teardown:function(namespaces,eventHandle){if(this.onbeforeunload===eventHandle)this.onbeforeunload=null}}}};jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){if(elem.removeEventListener)elem.removeEventListener(type,handle,false)}:function(elem,type,handle){if(elem.detachEvent)elem.detachEvent("on"+type,handle)};jQuery.Event=function(src,props){if(!this.preventDefault)return new jQuery.Event(src,
props);if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=src.defaultPrevented||src.returnValue===false||src.getPreventDefault&&src.getPreventDefault()?returnTrue:returnFalse}else this.type=src;if(props)jQuery.extend(this,props);this.timeStamp=jQuery.now();this[jQuery.expando]=true};function returnFalse(){return false}function returnTrue(){return true}jQuery.Event.prototype={preventDefault:function(){this.isDefaultPrevented=returnTrue;var e=this.originalEvent;if(!e)return;
if(e.preventDefault)e.preventDefault();else e.returnValue=false},stopPropagation:function(){this.isPropagationStopped=returnTrue;var e=this.originalEvent;if(!e)return;if(e.stopPropagation)e.stopPropagation();e.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue;this.stopPropagation()},isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse};var withinElement=function(event){var related=event.relatedTarget,
inside=false,eventType=event.type;event.type=event.data;if(related!==this){if(related)inside=jQuery.contains(this,related);if(!inside){jQuery.event.handle.apply(this,arguments);event.type=eventType}}},delegate=function(event){event.type=event.data;jQuery.event.handle.apply(this,arguments)};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={setup:function(data){jQuery.event.add(this,fix,data&&data.selector?delegate:withinElement,orig)},teardown:function(data){jQuery.event.remove(this,
fix,data&&data.selector?delegate:withinElement)}}});if(!jQuery.support.submitBubbles)jQuery.event.special.submit={setup:function(data,namespaces){if(!jQuery.nodeName(this,"form")){jQuery.event.add(this,"click.specialSubmit",function(e){var elem=e.target,type=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.type:"";if((type==="submit"||type==="image")&&jQuery(elem).closest("form").length)trigger("submit",this,arguments)});jQuery.event.add(this,"keypress.specialSubmit",function(e){var elem=
e.target,type=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.type:"";if((type==="text"||type==="password")&&jQuery(elem).closest("form").length&&e.keyCode===13)trigger("submit",this,arguments)})}else return false},teardown:function(namespaces){jQuery.event.remove(this,".specialSubmit")}};if(!jQuery.support.changeBubbles){var changeFilters,getVal=function(elem){var type=jQuery.nodeName(elem,"input")?elem.type:"",val=elem.value;if(type==="radio"||type==="checkbox")val=elem.checked;
else if(type==="select-multiple")val=elem.selectedIndex>-1?jQuery.map(elem.options,function(elem){return elem.selected}).join("-"):"";else if(jQuery.nodeName(elem,"select"))val=elem.selectedIndex;return val},testChange=function testChange(e){var elem=e.target,data,val;if(!rformElems.test(elem.nodeName)||elem.readOnly)return;data=jQuery._data(elem,"_change_data");val=getVal(elem);if(e.type!=="focusout"||elem.type!=="radio")jQuery._data(elem,"_change_data",val);if(data===undefined||val===data)return;
if(data!=null||val){e.type="change";e.liveFired=undefined;jQuery.event.trigger(e,arguments[1],elem)}};jQuery.event.special.change={filters:{focusout:testChange,beforedeactivate:testChange,click:function(e){var elem=e.target,type=jQuery.nodeName(elem,"input")?elem.type:"";if(type==="radio"||type==="checkbox"||jQuery.nodeName(elem,"select"))testChange.call(this,e)},keydown:function(e){var elem=e.target,type=jQuery.nodeName(elem,"input")?elem.type:"";if(e.keyCode===13&&!jQuery.nodeName(elem,"textarea")||
e.keyCode===32&&(type==="checkbox"||type==="radio")||type==="select-multiple")testChange.call(this,e)},beforeactivate:function(e){var elem=e.target;jQuery._data(elem,"_change_data",getVal(elem))}},setup:function(data,namespaces){if(this.type==="file")return false;for(var type in changeFilters)jQuery.event.add(this,type+".specialChange",changeFilters[type]);return rformElems.test(this.nodeName)},teardown:function(namespaces){jQuery.event.remove(this,".specialChange");return rformElems.test(this.nodeName)}};
changeFilters=jQuery.event.special.change.filters;changeFilters.focus=changeFilters.beforeactivate}function trigger(type,elem,args){var event=jQuery.extend({},args[0]);event.type=type;event.originalEvent={};event.liveFired=undefined;jQuery.event.handle.call(elem,event);if(event.isDefaultPrevented())args[0].preventDefault()}if(!jQuery.support.focusinBubbles)jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var attaches=0;jQuery.event.special[fix]={setup:function(){if(attaches++===0)document.addEventListener(orig,
handler,true)},teardown:function(){if(--attaches===0)document.removeEventListener(orig,handler,true)}};function handler(donor){var e=jQuery.event.fix(donor);e.type=fix;e.originalEvent={};jQuery.event.trigger(e,null,e.target);if(e.isDefaultPrevented())donor.preventDefault()}});jQuery.each(["bind","one"],function(i,name){jQuery.fn[name]=function(type,data,fn){var handler;if(typeof type==="object"){for(var key in type)this[name](key,data,type[key],fn);return this}if(arguments.length===2||data===false){fn=
data;data=undefined}if(name==="one"){handler=function(event){jQuery(this).unbind(event,handler);return fn.apply(this,arguments)};handler.guid=fn.guid||jQuery.guid++}else handler=fn;if(type==="unload"&&name!=="one")this.one(type,data,fn);else for(var i=0,l=this.length;i<l;i++)jQuery.event.add(this[i],type,handler,data);return this}});jQuery.fn.extend({unbind:function(type,fn){if(typeof type==="object"&&!type.preventDefault)for(var key in type)this.unbind(key,type[key]);else for(var i=0,l=this.length;i<
l;i++)jQuery.event.remove(this[i],type,fn);return this},delegate:function(selector,types,data,fn){return this.live(types,data,fn,selector)},undelegate:function(selector,types,fn){if(arguments.length===0)return this.unbind("live");else return this.die(types,null,fn,selector)},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){if(this[0])return jQuery.event.trigger(type,data,this[0],true)},toggle:function(fn){var args=arguments,
guid=fn.guid||jQuery.guid++,i=0,toggler=function(event){var lastToggle=(jQuery.data(this,"lastToggle"+fn.guid)||0)%i;jQuery.data(this,"lastToggle"+fn.guid,lastToggle+1);event.preventDefault();return args[lastToggle].apply(this,arguments)||false};toggler.guid=guid;while(i<args.length)args[i++].guid=guid;return this.click(toggler)},hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}});var liveMap={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};
jQuery.each(["live","die"],function(i,name){jQuery.fn[name]=function(types,data,fn,origSelector){var type,i=0,match,namespaces,preType,selector=origSelector||this.selector,context=origSelector?this:jQuery(this.context);if(typeof types==="object"&&!types.preventDefault){for(var key in types)context[name](key,data,types[key],selector);return this}if(name==="die"&&!types&&origSelector&&origSelector.charAt(0)==="."){context.unbind(origSelector);return this}if(data===false||jQuery.isFunction(data)){fn=
data||returnFalse;data=undefined}types=(types||"").split(" ");while((type=types[i++])!=null){match=rnamespaces.exec(type);namespaces="";if(match){namespaces=match[0];type=type.replace(rnamespaces,"")}if(type==="hover"){types.push("mouseenter"+namespaces,"mouseleave"+namespaces);continue}preType=type;if(liveMap[type]){types.push(liveMap[type]+namespaces);type=type+namespaces}else type=(liveMap[type]||type)+namespaces;if(name==="live")for(var j=0,l=context.length;j<l;j++)jQuery.event.add(context[j],
"live."+liveConvert(type,selector),{data:data,selector:selector,handler:fn,origType:type,origHandler:fn,preType:preType});else context.unbind("live."+liveConvert(type,selector),fn)}return this}});function liveHandler(event){var stop,maxLevel,related,match,handleObj,elem,j,i,l,data,close,namespace,ret,elems=[],selectors=[],events=jQuery._data(this,"events");if(event.liveFired===this||!events||!events.live||event.target.disabled||event.button&&event.type==="click")return;if(event.namespace)namespace=
new RegExp("(^|\\.)"+event.namespace.split(".").join("\\.(?:.*\\.)?")+"(\\.|$)");event.liveFired=this;var live=events.live.slice(0);for(j=0;j<live.length;j++){handleObj=live[j];if(handleObj.origType.replace(rnamespaces,"")===event.type)selectors.push(handleObj.selector);else live.splice(j--,1)}match=jQuery(event.target).closest(selectors,event.currentTarget);for(i=0,l=match.length;i<l;i++){close=match[i];for(j=0;j<live.length;j++){handleObj=live[j];if(close.selector===handleObj.selector&&(!namespace||
namespace.test(handleObj.namespace))&&!close.elem.disabled){elem=close.elem;related=null;if(handleObj.preType==="mouseenter"||handleObj.preType==="mouseleave"){event.type=handleObj.preType;related=jQuery(event.relatedTarget).closest(handleObj.selector)[0];if(related&&jQuery.contains(elem,related))related=elem}if(!related||related!==elem)elems.push({elem:elem,handleObj:handleObj,level:close.level})}}}for(i=0,l=elems.length;i<l;i++){match=elems[i];if(maxLevel&&match.level>maxLevel)break;event.currentTarget=
match.elem;event.data=match.handleObj.data;event.handleObj=match.handleObj;ret=match.handleObj.origHandler.apply(match.elem,arguments);if(ret===false||event.isPropagationStopped()){maxLevel=match.level;if(ret===false)stop=false;if(event.isImmediatePropagationStopped())break}}return stop}function liveConvert(type,selector){return(type&&type!=="*"?type+".":"")+selector.replace(rperiod,"`").replace(rspaces,"&")}jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+
"change select submit keydown keypress keyup error").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){if(fn==null){fn=data;data=null}return arguments.length>0?this.bind(name,data,fn):this.trigger(name)};if(jQuery.attrFn)jQuery.attrFn[name]=true});(function(){var chunker=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,done=0,toString=Object.prototype.toString,hasDuplicate=false,baseHasDuplicate=true,
rBackslash=/\\/g,rNonWord=/\W/;[0,0].sort(function(){baseHasDuplicate=false;return 0});var Sizzle=function(selector,context,results,seed){results=results||[];context=context||document;var origContext=context;if(context.nodeType!==1&&context.nodeType!==9)return[];if(!selector||typeof selector!=="string")return results;var m,set,checkSet,extra,ret,cur,pop,i,prune=true,contextXML=Sizzle.isXML(context),parts=[],soFar=selector;do{chunker.exec("");m=chunker.exec(soFar);if(m){soFar=m[3];parts.push(m[1]);
if(m[2]){extra=m[3];break}}}while(m);if(parts.length>1&&origPOS.exec(selector))if(parts.length===2&&Expr.relative[parts[0]])set=posProcess(parts[0]+parts[1],context);else{set=Expr.relative[parts[0]]?[context]:Sizzle(parts.shift(),context);while(parts.length){selector=parts.shift();if(Expr.relative[selector])selector+=parts.shift();set=posProcess(selector,set)}}else{if(!seed&&parts.length>1&&context.nodeType===9&&!contextXML&&Expr.match.ID.test(parts[0])&&!Expr.match.ID.test(parts[parts.length-1])){ret=
Sizzle.find(parts.shift(),context,contextXML);context=ret.expr?Sizzle.filter(ret.expr,ret.set)[0]:ret.set[0]}if(context){ret=seed?{expr:parts.pop(),set:makeArray(seed)}:Sizzle.find(parts.pop(),parts.length===1&&(parts[0]==="~"||parts[0]==="+")&&context.parentNode?context.parentNode:context,contextXML);set=ret.expr?Sizzle.filter(ret.expr,ret.set):ret.set;if(parts.length>0)checkSet=makeArray(set);else prune=false;while(parts.length){cur=parts.pop();pop=cur;if(!Expr.relative[cur])cur="";else pop=parts.pop();
if(pop==null)pop=context;Expr.relative[cur](checkSet,pop,contextXML)}}else checkSet=parts=[]}if(!checkSet)checkSet=set;if(!checkSet)Sizzle.error(cur||selector);if(toString.call(checkSet)==="[object Array]")if(!prune)results.push.apply(results,checkSet);else if(context&&context.nodeType===1)for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&(checkSet[i]===true||checkSet[i].nodeType===1&&Sizzle.contains(context,checkSet[i])))results.push(set[i])}else for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&checkSet[i].nodeType===
1)results.push(set[i])}else makeArray(checkSet,results);if(extra){Sizzle(extra,origContext,results,seed);Sizzle.uniqueSort(results)}return results};Sizzle.uniqueSort=function(results){if(sortOrder){hasDuplicate=baseHasDuplicate;results.sort(sortOrder);if(hasDuplicate)for(var i=1;i<results.length;i++)if(results[i]===results[i-1])results.splice(i--,1)}return results};Sizzle.matches=function(expr,set){return Sizzle(expr,null,null,set)};Sizzle.matchesSelector=function(node,expr){return Sizzle(expr,null,
null,[node]).length>0};Sizzle.find=function(expr,context,isXML){var set;if(!expr)return[];for(var i=0,l=Expr.order.length;i<l;i++){var match,type=Expr.order[i];if(match=Expr.leftMatch[type].exec(expr)){var left=match[1];match.splice(1,1);if(left.substr(left.length-1)!=="\\"){match[1]=(match[1]||"").replace(rBackslash,"");set=Expr.find[type](match,context,isXML);if(set!=null){expr=expr.replace(Expr.match[type],"");break}}}}if(!set)set=typeof context.getElementsByTagName!=="undefined"?context.getElementsByTagName("*"):
[];return{set:set,expr:expr}};Sizzle.filter=function(expr,set,inplace,not){var match,anyFound,old=expr,result=[],curLoop=set,isXMLFilter=set&&set[0]&&Sizzle.isXML(set[0]);while(expr&&set.length){for(var type in Expr.filter)if((match=Expr.leftMatch[type].exec(expr))!=null&&match[2]){var found,item,filter=Expr.filter[type],left=match[1];anyFound=false;match.splice(1,1);if(left.substr(left.length-1)==="\\")continue;if(curLoop===result)result=[];if(Expr.preFilter[type]){match=Expr.preFilter[type](match,
curLoop,inplace,result,not,isXMLFilter);if(!match)anyFound=found=true;else if(match===true)continue}if(match)for(var i=0;(item=curLoop[i])!=null;i++)if(item){found=filter(item,match,i,curLoop);var pass=not^!!found;if(inplace&&found!=null)if(pass)anyFound=true;else curLoop[i]=false;else if(pass){result.push(item);anyFound=true}}if(found!==undefined){if(!inplace)curLoop=result;expr=expr.replace(Expr.match[type],"");if(!anyFound)return[];break}}if(expr===old)if(anyFound==null)Sizzle.error(expr);else break;
old=expr}return curLoop};Sizzle.error=function(msg){throw"Syntax error, unrecognized expression: "+msg;};var Expr=Sizzle.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,
POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(elem){return elem.getAttribute("href")},type:function(elem){return elem.getAttribute("type")}},relative:{"+":function(checkSet,part){var isPartStr=typeof part==="string",isTag=isPartStr&&!rNonWord.test(part),isPartStrNotTag=isPartStr&&!isTag;if(isTag)part=part.toLowerCase();
for(var i=0,l=checkSet.length,elem;i<l;i++)if(elem=checkSet[i]){while((elem=elem.previousSibling)&&elem.nodeType!==1);checkSet[i]=isPartStrNotTag||elem&&elem.nodeName.toLowerCase()===part?elem||false:elem===part}if(isPartStrNotTag)Sizzle.filter(part,checkSet,true)},">":function(checkSet,part){var elem,isPartStr=typeof part==="string",i=0,l=checkSet.length;if(isPartStr&&!rNonWord.test(part)){part=part.toLowerCase();for(;i<l;i++){elem=checkSet[i];if(elem){var parent=elem.parentNode;checkSet[i]=parent.nodeName.toLowerCase()===
part?parent:false}}}else{for(;i<l;i++){elem=checkSet[i];if(elem)checkSet[i]=isPartStr?elem.parentNode:elem.parentNode===part}if(isPartStr)Sizzle.filter(part,checkSet,true)}},"":function(checkSet,part,isXML){var nodeCheck,doneName=done++,checkFn=dirCheck;if(typeof part==="string"&&!rNonWord.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck}checkFn("parentNode",part,doneName,checkSet,nodeCheck,isXML)},"~":function(checkSet,part,isXML){var nodeCheck,doneName=done++,checkFn=dirCheck;
if(typeof part==="string"&&!rNonWord.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck}checkFn("previousSibling",part,doneName,checkSet,nodeCheck,isXML)}},find:{ID:function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m&&m.parentNode?[m]:[]}},NAME:function(match,context){if(typeof context.getElementsByName!=="undefined"){var ret=[],results=context.getElementsByName(match[1]);for(var i=0,l=results.length;i<
l;i++)if(results[i].getAttribute("name")===match[1])ret.push(results[i]);return ret.length===0?null:ret}},TAG:function(match,context){if(typeof context.getElementsByTagName!=="undefined")return context.getElementsByTagName(match[1])}},preFilter:{CLASS:function(match,curLoop,inplace,result,not,isXML){match=" "+match[1].replace(rBackslash,"")+" ";if(isXML)return match;for(var i=0,elem;(elem=curLoop[i])!=null;i++)if(elem)if(not^(elem.className&&(" "+elem.className+" ").replace(/[\t\n\r]/g," ").indexOf(match)>=
0)){if(!inplace)result.push(elem)}else if(inplace)curLoop[i]=false;return false},ID:function(match){return match[1].replace(rBackslash,"")},TAG:function(match,curLoop){return match[1].replace(rBackslash,"").toLowerCase()},CHILD:function(match){if(match[1]==="nth"){if(!match[2])Sizzle.error(match[0]);match[2]=match[2].replace(/^\+|\s*/g,"");var test=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(match[2]==="even"&&"2n"||match[2]==="odd"&&"2n+1"||!/\D/.test(match[2])&&"0n+"+match[2]||match[2]);match[2]=test[1]+
(test[2]||1)-0;match[3]=test[3]-0}else if(match[2])Sizzle.error(match[0]);match[0]=done++;return match},ATTR:function(match,curLoop,inplace,result,not,isXML){var name=match[1]=match[1].replace(rBackslash,"");if(!isXML&&Expr.attrMap[name])match[1]=Expr.attrMap[name];match[4]=(match[4]||match[5]||"").replace(rBackslash,"");if(match[2]==="~=")match[4]=" "+match[4]+" ";return match},PSEUDO:function(match,curLoop,inplace,result,not){if(match[1]==="not")if((chunker.exec(match[3])||"").length>1||/^\w/.test(match[3]))match[3]=
Sizzle(match[3],null,null,curLoop);else{var ret=Sizzle.filter(match[3],curLoop,inplace,true^not);if(!inplace)result.push.apply(result,ret);return false}else if(Expr.match.POS.test(match[0])||Expr.match.CHILD.test(match[0]))return true;return match},POS:function(match){match.unshift(true);return match}},filters:{enabled:function(elem){return elem.disabled===false&&elem.type!=="hidden"},disabled:function(elem){return elem.disabled===true},checked:function(elem){return elem.checked===true},selected:function(elem){if(elem.parentNode)elem.parentNode.selectedIndex;
return elem.selected===true},parent:function(elem){return!!elem.firstChild},empty:function(elem){return!elem.firstChild},has:function(elem,i,match){return!!Sizzle(match[3],elem).length},header:function(elem){return/h\d/i.test(elem.nodeName)},text:function(elem){var attr=elem.getAttribute("type"),type=elem.type;return elem.nodeName.toLowerCase()==="input"&&"text"===type&&(attr===type||attr===null)},radio:function(elem){return elem.nodeName.toLowerCase()==="input"&&"radio"===elem.type},checkbox:function(elem){return elem.nodeName.toLowerCase()===
"input"&&"checkbox"===elem.type},file:function(elem){return elem.nodeName.toLowerCase()==="input"&&"file"===elem.type},password:function(elem){return elem.nodeName.toLowerCase()==="input"&&"password"===elem.type},submit:function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&"submit"===elem.type},image:function(elem){return elem.nodeName.toLowerCase()==="input"&&"image"===elem.type},reset:function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||
name==="button")&&"reset"===elem.type},button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&"button"===elem.type||name==="button"},input:function(elem){return/input|select|textarea|button/i.test(elem.nodeName)},focus:function(elem){return elem===elem.ownerDocument.activeElement}},setFilters:{first:function(elem,i){return i===0},last:function(elem,i,match,array){return i===array.length-1},even:function(elem,i){return i%2===0},odd:function(elem,i){return i%2===1},lt:function(elem,
i,match){return i<match[3]-0},gt:function(elem,i,match){return i>match[3]-0},nth:function(elem,i,match){return match[3]-0===i},eq:function(elem,i,match){return match[3]-0===i}},filter:{PSEUDO:function(elem,match,i,array){var name=match[1],filter=Expr.filters[name];if(filter)return filter(elem,i,match,array);else if(name==="contains")return(elem.textContent||elem.innerText||Sizzle.getText([elem])||"").indexOf(match[3])>=0;else if(name==="not"){var not=match[3];for(var j=0,l=not.length;j<l;j++)if(not[j]===
elem)return false;return true}else Sizzle.error(name)},CHILD:function(elem,match){var type=match[1],node=elem;switch(type){case "only":case "first":while(node=node.previousSibling)if(node.nodeType===1)return false;if(type==="first")return true;node=elem;case "last":while(node=node.nextSibling)if(node.nodeType===1)return false;return true;case "nth":var first=match[2],last=match[3];if(first===1&&last===0)return true;var doneName=match[0],parent=elem.parentNode;if(parent&&(parent.sizcache!==doneName||
!elem.nodeIndex)){var count=0;for(node=parent.firstChild;node;node=node.nextSibling)if(node.nodeType===1)node.nodeIndex=++count;parent.sizcache=doneName}var diff=elem.nodeIndex-last;if(first===0)return diff===0;else return diff%first===0&&diff/first>=0}},ID:function(elem,match){return elem.nodeType===1&&elem.getAttribute("id")===match},TAG:function(elem,match){return match==="*"&&elem.nodeType===1||elem.nodeName.toLowerCase()===match},CLASS:function(elem,match){return(" "+(elem.className||elem.getAttribute("class"))+
" ").indexOf(match)>-1},ATTR:function(elem,match){var name=match[1],result=Expr.attrHandle[name]?Expr.attrHandle[name](elem):elem[name]!=null?elem[name]:elem.getAttribute(name),value=result+"",type=match[2],check=match[4];return result==null?type==="!=":type==="="?value===check:type==="*="?value.indexOf(check)>=0:type==="~="?(" "+value+" ").indexOf(check)>=0:!check?value&&result!==false:type==="!="?value!==check:type==="^="?value.indexOf(check)===0:type==="$="?value.substr(value.length-check.length)===
check:type==="|="?value===check||value.substr(0,check.length+1)===check+"-":false},POS:function(elem,match,i,array){var name=match[2],filter=Expr.setFilters[name];if(filter)return filter(elem,i,match,array)}}};var origPOS=Expr.match.POS,fescape=function(all,num){return"\\"+(num-0+1)};for(var type in Expr.match){Expr.match[type]=new RegExp(Expr.match[type].source+/(?![^\[]*\])(?![^\(]*\))/.source);Expr.leftMatch[type]=new RegExp(/(^(?:.|\r|\n)*?)/.source+Expr.match[type].source.replace(/\\(\d+)/g,
fescape))}var makeArray=function(array,results){array=Array.prototype.slice.call(array,0);if(results){results.push.apply(results,array);return results}return array};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(e){makeArray=function(array,results){var i=0,ret=results||[];if(toString.call(array)==="[object Array]")Array.prototype.push.apply(ret,array);else if(typeof array.length==="number")for(var l=array.length;i<l;i++)ret.push(array[i]);else for(;array[i];i++)ret.push(array[i]);
return ret}}var sortOrder,siblingCheck;if(document.documentElement.compareDocumentPosition)sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1};else{sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}else if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var al,bl,ap=[],bp=[],aup=a.parentNode,bup=b.parentNode,cur=aup;if(aup===
bup)return siblingCheck(a,b);else if(!aup)return-1;else if(!bup)return 1;while(cur){ap.unshift(cur);cur=cur.parentNode}cur=bup;while(cur){bp.unshift(cur);cur=cur.parentNode}al=ap.length;bl=bp.length;for(var i=0;i<al&&i<bl;i++)if(ap[i]!==bp[i])return siblingCheck(ap[i],bp[i]);return i===al?siblingCheck(a,bp[i],-1):siblingCheck(ap[i],b,1)};siblingCheck=function(a,b,ret){if(a===b)return ret;var cur=a.nextSibling;while(cur){if(cur===b)return-1;cur=cur.nextSibling}return 1}}Sizzle.getText=function(elems){var ret=
"",elem;for(var i=0;elems[i];i++){elem=elems[i];if(elem.nodeType===3||elem.nodeType===4)ret+=elem.nodeValue;else if(elem.nodeType!==8)ret+=Sizzle.getText(elem.childNodes)}return ret};(function(){var form=document.createElement("div"),id="script"+(new Date).getTime(),root=document.documentElement;form.innerHTML="<a name='"+id+"'/>";root.insertBefore(form,root.firstChild);if(document.getElementById(id)){Expr.find.ID=function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=
context.getElementById(match[1]);return m?m.id===match[1]||typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id").nodeValue===match[1]?[m]:undefined:[]}};Expr.filter.ID=function(elem,match){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return elem.nodeType===1&&node&&node.nodeValue===match}}root.removeChild(form);root=form=null})();(function(){var div=document.createElement("div");div.appendChild(document.createComment(""));if(div.getElementsByTagName("*").length>
0)Expr.find.TAG=function(match,context){var results=context.getElementsByTagName(match[1]);if(match[1]==="*"){var tmp=[];for(var i=0;results[i];i++)if(results[i].nodeType===1)tmp.push(results[i]);results=tmp}return results};div.innerHTML="<a href='#'></a>";if(div.firstChild&&typeof div.firstChild.getAttribute!=="undefined"&&div.firstChild.getAttribute("href")!=="#")Expr.attrHandle.href=function(elem){return elem.getAttribute("href",2)};div=null})();if(document.querySelectorAll)(function(){var oldSizzle=
Sizzle,div=document.createElement("div"),id="__sizzle__";div.innerHTML="<p class='TEST'></p>";if(div.querySelectorAll&&div.querySelectorAll(".TEST").length===0)return;Sizzle=function(query,context,extra,seed){context=context||document;if(!seed&&!Sizzle.isXML(context)){var match=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(query);if(match&&(context.nodeType===1||context.nodeType===9))if(match[1])return makeArray(context.getElementsByTagName(query),extra);else if(match[2]&&Expr.find.CLASS&&context.getElementsByClassName)return makeArray(context.getElementsByClassName(match[2]),
extra);if(context.nodeType===9){if(query==="body"&&context.body)return makeArray([context.body],extra);else if(match&&match[3]){var elem=context.getElementById(match[3]);if(elem&&elem.parentNode){if(elem.id===match[3])return makeArray([elem],extra)}else return makeArray([],extra)}try{return makeArray(context.querySelectorAll(query),extra)}catch(qsaError){}}else if(context.nodeType===1&&context.nodeName.toLowerCase()!=="object"){var oldContext=context,old=context.getAttribute("id"),nid=old||id,hasParent=
context.parentNode,relativeHierarchySelector=/^\s*[+~]/.test(query);if(!old)context.setAttribute("id",nid);else nid=nid.replace(/'/g,"\\$&");if(relativeHierarchySelector&&hasParent)context=context.parentNode;try{if(!relativeHierarchySelector||hasParent)return makeArray(context.querySelectorAll("[id='"+nid+"'] "+query),extra)}catch(pseudoError){}finally{if(!old)oldContext.removeAttribute("id")}}}return oldSizzle(query,context,extra,seed)};for(var prop in oldSizzle)Sizzle[prop]=oldSizzle[prop];div=
null})();(function(){var html=document.documentElement,matches=html.matchesSelector||html.mozMatchesSelector||html.webkitMatchesSelector||html.msMatchesSelector;if(matches){var disconnectedMatch=!matches.call(document.createElement("div"),"div"),pseudoWorks=false;try{matches.call(document.documentElement,"[test!='']:sizzle")}catch(pseudoError){pseudoWorks=true}Sizzle.matchesSelector=function(node,expr){expr=expr.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!Sizzle.isXML(node))try{if(pseudoWorks||
!Expr.match.PSEUDO.test(expr)&&!/!=/.test(expr)){var ret=matches.call(node,expr);if(ret||!disconnectedMatch||node.document&&node.document.nodeType!==11)return ret}}catch(e){}return Sizzle(expr,null,null,[node]).length>0}}})();(function(){var div=document.createElement("div");div.innerHTML="<div class='test e'></div><div class='test'></div>";if(!div.getElementsByClassName||div.getElementsByClassName("e").length===0)return;div.lastChild.className="e";if(div.getElementsByClassName("e").length===1)return;
Expr.order.splice(1,0,"CLASS");Expr.find.CLASS=function(match,context,isXML){if(typeof context.getElementsByClassName!=="undefined"&&!isXML)return context.getElementsByClassName(match[1])};div=null})();function dirNodeCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){var match=false;elem=elem[dir];while(elem){if(elem.sizcache===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===1&&!isXML){elem.sizcache=doneName;elem.sizset=
i}if(elem.nodeName.toLowerCase()===cur){match=elem;break}elem=elem[dir]}checkSet[i]=match}}}function dirCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){var match=false;elem=elem[dir];while(elem){if(elem.sizcache===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===1){if(!isXML){elem.sizcache=doneName;elem.sizset=i}if(typeof cur!=="string"){if(elem===cur){match=true;break}}else if(Sizzle.filter(cur,[elem]).length>0){match=
elem;break}}elem=elem[dir]}checkSet[i]=match}}}if(document.documentElement.contains)Sizzle.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):true)};else if(document.documentElement.compareDocumentPosition)Sizzle.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)};else Sizzle.contains=function(){return false};Sizzle.isXML=function(elem){var documentElement=(elem?elem.ownerDocument||elem:0).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};var posProcess=
function(selector,context){var match,tmpSet=[],later="",root=context.nodeType?[context]:context;while(match=Expr.match.PSEUDO.exec(selector)){later+=match[0];selector=selector.replace(Expr.match.PSEUDO,"")}selector=Expr.relative[selector]?selector+"*":selector;for(var i=0,l=root.length;i<l;i++)Sizzle(selector,root[i],tmpSet);return Sizzle.filter(later,tmpSet)};jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.filters;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;
jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains})();var runtil=/Until$/,rparentsprev=/^(?:parents|prevUntil|prevAll)/,rmultiselector=/,/,isSimple=/^.[^:#\[\.,]*$/,slice=Array.prototype.slice,POS=jQuery.expr.match.POS,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.fn.extend({find:function(selector){var self=this,i,l;if(typeof selector!=="string")return jQuery(selector).filter(function(){for(i=0,l=self.length;i<l;i++)if(jQuery.contains(self[i],this))return true});
var ret=this.pushStack("","find",selector),length,n,r;for(i=0,l=this.length;i<l;i++){length=ret.length;jQuery.find(selector,this[i],ret);if(i>0)for(n=length;n<ret.length;n++)for(r=0;r<length;r++)if(ret[r]===ret[n]){ret.splice(n--,1);break}}return ret},has:function(target){var targets=jQuery(target);return this.filter(function(){for(var i=0,l=targets.length;i<l;i++)if(jQuery.contains(this,targets[i]))return true})},not:function(selector){return this.pushStack(winnow(this,selector,false),"not",selector)},
filter:function(selector){return this.pushStack(winnow(this,selector,true),"filter",selector)},is:function(selector){return!!selector&&(typeof selector==="string"?jQuery.filter(selector,this).length>0:this.filter(selector).length>0)},closest:function(selectors,context){var ret=[],i,l,cur=this[0];if(jQuery.isArray(selectors)){var match,selector,matches={},level=1;if(cur&&selectors.length){for(i=0,l=selectors.length;i<l;i++){selector=selectors[i];if(!matches[selector])matches[selector]=POS.test(selector)?
jQuery(selector,context||this.context):selector}while(cur&&cur.ownerDocument&&cur!==context){for(selector in matches){match=matches[selector];if(match.jquery?match.index(cur)>-1:jQuery(cur).is(match))ret.push({selector:selector,elem:cur,level:level})}cur=cur.parentNode;level++}}return ret}var pos=POS.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(i=0,l=this.length;i<l;i++){cur=this[i];while(cur)if(pos?pos.index(cur)>-1:jQuery.find.matchesSelector(cur,selectors)){ret.push(cur);
break}else{cur=cur.parentNode;if(!cur||!cur.ownerDocument||cur===context||cur.nodeType===11)break}}ret=ret.length>1?jQuery.unique(ret):ret;return this.pushStack(ret,"closest",selectors)},index:function(elem){if(!elem)return this[0]&&this[0].parentNode?this.prevAll().length:-1;if(typeof elem==="string")return jQuery.inArray(this[0],jQuery(elem));return jQuery.inArray(elem.jquery?elem[0]:elem,this)},add:function(selector,context){var set=typeof selector==="string"?jQuery(selector,context):jQuery.makeArray(selector&&
selector.nodeType?[selector]:selector),all=jQuery.merge(this.get(),set);return this.pushStack(isDisconnected(set[0])||isDisconnected(all[0])?all:jQuery.unique(all))},andSelf:function(){return this.add(this.prevObject)}});function isDisconnected(node){return!node||!node.parentNode||node.parentNode.nodeType===11}jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,
i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return jQuery.nth(elem,2,"nextSibling")},prev:function(elem){return jQuery.nth(elem,2,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling(elem.parentNode.firstChild,
elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.makeArray(elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until),args=slice.call(arguments);if(!runtil.test(name))selector=until;if(selector&&typeof selector==="string")ret=jQuery.filter(selector,ret);ret=this.length>1&&!guaranteedUnique[name]?jQuery.unique(ret):
ret;if((this.length>1||rmultiselector.test(selector))&&rparentsprev.test(name))ret=ret.reverse();return this.pushStack(ret,name,args.join(","))}});jQuery.extend({filter:function(expr,elems,not){if(not)expr=":not("+expr+")";return elems.length===1?jQuery.find.matchesSelector(elems[0],expr)?[elems[0]]:[]:jQuery.find.matches(expr,elems)},dir:function(elem,dir,until){var matched=[],cur=elem[dir];while(cur&&cur.nodeType!==9&&(until===undefined||cur.nodeType!==1||!jQuery(cur).is(until))){if(cur.nodeType===
1)matched.push(cur);cur=cur[dir]}return matched},nth:function(cur,result,dir,elem){result=result||1;var num=0;for(;cur;cur=cur[dir])if(cur.nodeType===1&&++num===result)break;return cur},sibling:function(n,elem){var r=[];for(;n;n=n.nextSibling)if(n.nodeType===1&&n!==elem)r.push(n);return r}});function winnow(elements,qualifier,keep){qualifier=qualifier||0;if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){var retVal=!!qualifier.call(elem,i,elem);return retVal===keep});else if(qualifier.nodeType)return jQuery.grep(elements,
function(elem,i){return elem===qualifier===keep});else if(typeof qualifier==="string"){var filtered=jQuery.grep(elements,function(elem){return elem.nodeType===1});if(isSimple.test(qualifier))return jQuery.filter(qualifier,filtered,!keep);else qualifier=jQuery.filter(qualifier,filtered)}return jQuery.grep(elements,function(elem,i){return jQuery.inArray(elem,qualifier)>=0===keep})}var rinlinejQuery=/ jQuery\d+="(?:\d+|null)"/g,rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,
rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnocache=/<(?:script|object|embed|option|style)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/\/(java|ecma)script/i,rcleanScript=/^\s*<!(?:\[CDATA\[|\-\-)/,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],
area:[1,"<map>","</map>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;if(!jQuery.support.htmlSerialize)wrapMap._default=[1,"div<div>","</div>"];jQuery.fn.extend({text:function(text){if(jQuery.isFunction(text))return this.each(function(i){var self=jQuery(this);self.text(text.call(this,i,self.text()))});if(typeof text!=="object"&&text!==undefined)return this.empty().append((this[0]&&this[0].ownerDocument||
document).createTextNode(text));return jQuery.text(this)},wrapAll:function(html){if(jQuery.isFunction(html))return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))});if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode)wrap.insertBefore(this[0]);wrap.map(function(){var elem=this;while(elem.firstChild&&elem.firstChild.nodeType===1)elem=elem.firstChild;return elem}).append(this)}return this},wrapInner:function(html){if(jQuery.isFunction(html))return this.each(function(i){jQuery(this).wrapInner(html.call(this,
i))});return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length)contents.wrapAll(html);else self.append(html)})},wrap:function(html){return this.each(function(){jQuery(this).wrapAll(html)})},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body"))jQuery(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,true,function(elem){if(this.nodeType===1)this.appendChild(elem)})},prepend:function(){return this.domManip(arguments,
true,function(elem){if(this.nodeType===1)this.insertBefore(elem,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,false,function(elem){this.parentNode.insertBefore(elem,this)});else if(arguments.length){var set=jQuery(arguments[0]);set.push.apply(set,this.toArray());return this.pushStack(set,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,false,function(elem){this.parentNode.insertBefore(elem,this.nextSibling)});
else if(arguments.length){var set=this.pushStack(this,"after",arguments);set.push.apply(set,jQuery(arguments[0]).toArray());return set}},remove:function(selector,keepData){for(var i=0,elem;(elem=this[i])!=null;i++)if(!selector||jQuery.filter(selector,[elem]).length){if(!keepData&&elem.nodeType===1){jQuery.cleanData(elem.getElementsByTagName("*"));jQuery.cleanData([elem])}if(elem.parentNode)elem.parentNode.removeChild(elem)}return this},empty:function(){for(var i=0,elem;(elem=this[i])!=null;i++){if(elem.nodeType===
1)jQuery.cleanData(elem.getElementsByTagName("*"));while(elem.firstChild)elem.removeChild(elem.firstChild)}return this},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){if(value===undefined)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(rinlinejQuery,
""):null;else if(typeof value==="string"&&!rnocache.test(value)&&(jQuery.support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(var i=0,l=this.length;i<l;i++)if(this[i].nodeType===1){jQuery.cleanData(this[i].getElementsByTagName("*"));this[i].innerHTML=value}}catch(e){this.empty().append(value)}}else if(jQuery.isFunction(value))this.each(function(i){var self=jQuery(this);self.html(value.call(this,
i,self.html()))});else this.empty().append(value);return this},replaceWith:function(value){if(this[0]&&this[0].parentNode){if(jQuery.isFunction(value))return this.each(function(i){var self=jQuery(this),old=self.html();self.replaceWith(value.call(this,i,old))});if(typeof value!=="string")value=jQuery(value).detach();return this.each(function(){var next=this.nextSibling,parent=this.parentNode;jQuery(this).remove();if(next)jQuery(next).before(value);else jQuery(parent).append(value)})}else return this.length?
this.pushStack(jQuery(jQuery.isFunction(value)?value():value),"replaceWith",value):this},detach:function(selector){return this.remove(selector,true)},domManip:function(args,table,callback){var results,first,fragment,parent,value=args[0],scripts=[];if(!jQuery.support.checkClone&&arguments.length===3&&typeof value==="string"&&rchecked.test(value))return this.each(function(){jQuery(this).domManip(args,table,callback,true)});if(jQuery.isFunction(value))return this.each(function(i){var self=jQuery(this);
args[0]=value.call(this,i,table?self.html():undefined);self.domManip(args,table,callback)});if(this[0]){parent=value&&value.parentNode;if(jQuery.support.parentNode&&parent&&parent.nodeType===11&&parent.childNodes.length===this.length)results={fragment:parent};else results=jQuery.buildFragment(args,this,scripts);fragment=results.fragment;if(fragment.childNodes.length===1)first=fragment=fragment.firstChild;else first=fragment.firstChild;if(first){table=table&&jQuery.nodeName(first,"tr");for(var i=0,
l=this.length,lastIndex=l-1;i<l;i++)callback.call(table?root(this[i],first):this[i],results.cacheable||l>1&&i<lastIndex?jQuery.clone(fragment,true,true):fragment)}if(scripts.length)jQuery.each(scripts,evalScript)}return this}});function root(elem,cur){return jQuery.nodeName(elem,"table")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function cloneCopyEvent(src,dest){if(dest.nodeType!==1||!jQuery.hasData(src))return;var internalKey=jQuery.expando,
oldData=jQuery.data(src),curData=jQuery.data(dest,oldData);if(oldData=oldData[internalKey]){var events=oldData.events;curData=curData[internalKey]=jQuery.extend({},oldData);if(events){delete curData.handle;curData.events={};for(var type in events)for(var i=0,l=events[type].length;i<l;i++)jQuery.event.add(dest,type+(events[type][i].namespace?".":"")+events[type][i].namespace,events[type][i],events[type][i].data)}}}function cloneFixAttributes(src,dest){var nodeName;if(dest.nodeType!==1)return;if(dest.clearAttributes)dest.clearAttributes();
if(dest.mergeAttributes)dest.mergeAttributes(src);nodeName=dest.nodeName.toLowerCase();if(nodeName==="object")dest.outerHTML=src.outerHTML;else if(nodeName==="input"&&(src.type==="checkbox"||src.type==="radio")){if(src.checked)dest.defaultChecked=dest.checked=src.checked;if(dest.value!==src.value)dest.value=src.value}else if(nodeName==="option")dest.selected=src.defaultSelected;else if(nodeName==="input"||nodeName==="textarea")dest.defaultValue=src.defaultValue;dest.removeAttribute(jQuery.expando)}
jQuery.buildFragment=function(args,nodes,scripts){var fragment,cacheable,cacheresults,doc;if(nodes&&nodes[0])doc=nodes[0].ownerDocument||nodes[0];if(!doc.createDocumentFragment)doc=document;if(args.length===1&&typeof args[0]==="string"&&args[0].length<512&&doc===document&&args[0].charAt(0)==="<"&&!rnocache.test(args[0])&&(jQuery.support.checkClone||!rchecked.test(args[0]))){cacheable=true;cacheresults=jQuery.fragments[args[0]];if(cacheresults&&cacheresults!==1)fragment=cacheresults}if(!fragment){fragment=
doc.createDocumentFragment();jQuery.clean(args,doc,fragment,scripts)}if(cacheable)jQuery.fragments[args[0]]=cacheresults?fragment:1;return{fragment:fragment,cacheable:cacheable}};jQuery.fragments={};jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var ret=[],insert=jQuery(selector),parent=this.length===1&&this[0].parentNode;if(parent&&parent.nodeType===11&&parent.childNodes.length===
1&&insert.length===1){insert[original](this[0]);return this}else{for(var i=0,l=insert.length;i<l;i++){var elems=(i>0?this.clone(true):this).get();jQuery(insert[i])[original](elems);ret=ret.concat(elems)}return this.pushStack(ret,name,insert.selector)}}});function getAll(elem){if("getElementsByTagName"in elem)return elem.getElementsByTagName("*");else if("querySelectorAll"in elem)return elem.querySelectorAll("*");else return[]}function fixDefaultChecked(elem){if(elem.type==="checkbox"||elem.type===
"radio")elem.defaultChecked=elem.checked}function findInputs(elem){if(jQuery.nodeName(elem,"input"))fixDefaultChecked(elem);else if("getElementsByTagName"in elem)jQuery.grep(elem.getElementsByTagName("input"),fixDefaultChecked)}jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var clone=elem.cloneNode(true),srcElements,destElements,i;if((!jQuery.support.noCloneEvent||!jQuery.support.noCloneChecked)&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){cloneFixAttributes(elem,
clone);srcElements=getAll(elem);destElements=getAll(clone);for(i=0;srcElements[i];++i)if(destElements[i])cloneFixAttributes(srcElements[i],destElements[i])}if(dataAndEvents){cloneCopyEvent(elem,clone);if(deepDataAndEvents){srcElements=getAll(elem);destElements=getAll(clone);for(i=0;srcElements[i];++i)cloneCopyEvent(srcElements[i],destElements[i])}}srcElements=destElements=null;return clone},clean:function(elems,context,fragment,scripts){var checkScriptType;context=context||document;if(typeof context.createElement===
"undefined")context=context.ownerDocument||context[0]&&context[0].ownerDocument||document;var ret=[],j;for(var i=0,elem;(elem=elems[i])!=null;i++){if(typeof elem==="number")elem+="";if(!elem)continue;if(typeof elem==="string")if(!rhtml.test(elem))elem=context.createTextNode(elem);else{elem=elem.replace(rxhtmlTag,"<$1></$2>");var tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,depth=wrap[0],div=context.createElement("div");div.innerHTML=wrap[1]+elem+wrap[2];
while(depth--)div=div.lastChild;if(!jQuery.support.tbody){var hasBody=rtbody.test(elem),tbody=tag==="table"&&!hasBody?div.firstChild&&div.firstChild.childNodes:wrap[1]==="<table>"&&!hasBody?div.childNodes:[];for(j=tbody.length-1;j>=0;--j)if(jQuery.nodeName(tbody[j],"tbody")&&!tbody[j].childNodes.length)tbody[j].parentNode.removeChild(tbody[j])}if(!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(elem))div.insertBefore(context.createTextNode(rleadingWhitespace.exec(elem)[0]),div.firstChild);
elem=div.childNodes}var len;if(!jQuery.support.appendChecked)if(elem[0]&&typeof(len=elem.length)==="number")for(j=0;j<len;j++)findInputs(elem[j]);else findInputs(elem);if(elem.nodeType)ret.push(elem);else ret=jQuery.merge(ret,elem)}if(fragment){checkScriptType=function(elem){return!elem.type||rscriptType.test(elem.type)};for(i=0;ret[i];i++)if(scripts&&jQuery.nodeName(ret[i],"script")&&(!ret[i].type||ret[i].type.toLowerCase()==="text/javascript"))scripts.push(ret[i].parentNode?ret[i].parentNode.removeChild(ret[i]):
ret[i]);else{if(ret[i].nodeType===1){var jsTags=jQuery.grep(ret[i].getElementsByTagName("script"),checkScriptType);ret.splice.apply(ret,[i+1,0].concat(jsTags))}fragment.appendChild(ret[i])}}return ret},cleanData:function(elems){var data,id,cache=jQuery.cache,internalKey=jQuery.expando,special=jQuery.event.special,deleteExpando=jQuery.support.deleteExpando;for(var i=0,elem;(elem=elems[i])!=null;i++){if(elem.nodeName&&jQuery.noData[elem.nodeName.toLowerCase()])continue;id=elem[jQuery.expando];if(id){data=
cache[id]&&cache[id][internalKey];if(data&&data.events){for(var type in data.events)if(special[type])jQuery.event.remove(elem,type);else jQuery.removeEvent(elem,type,data.handle);if(data.handle)data.handle.elem=null}if(deleteExpando)delete elem[jQuery.expando];else if(elem.removeAttribute)elem.removeAttribute(jQuery.expando);delete cache[id]}}}});function evalScript(i,elem){if(elem.src)jQuery.ajax({url:elem.src,async:false,dataType:"script"});else jQuery.globalEval((elem.text||elem.textContent||elem.innerHTML||
"").replace(rcleanScript,"/*$0*/"));if(elem.parentNode)elem.parentNode.removeChild(elem)}var ralpha=/alpha\([^)]*\)/i,ropacity=/opacity=([^)]*)/,rupper=/([A-Z]|^ms)/g,rnumpx=/^-?\d+(?:px)?$/i,rnum=/^-?\d/,rrelNum=/^([\-+])=([\-+.\de]+)/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssWidth=["Left","Right"],cssHeight=["Top","Bottom"],curCSS,getComputedStyle,currentStyle;jQuery.fn.css=function(name,value){if(arguments.length===2&&value===undefined)return this;return jQuery.access(this,
name,value,true,function(elem,name,value){return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)})};jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity","opacity");return ret===""?"1":ret}else return elem.style.opacity}}},cssNumber:{"fillOpacity":true,"fontWeight":true,"lineHeight":true,"opacity":true,"orphans":true,"widows":true,"zIndex":true,"zoom":true},cssProps:{"float":jQuery.support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,
name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style)return;var ret,type,origName=jQuery.camelCase(name),style=elem.style,hooks=jQuery.cssHooks[origName];name=jQuery.cssProps[origName]||origName;if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rrelNum.exec(value))){value=+(ret[1]+1)*+ret[2]+parseFloat(jQuery.css(elem,name));type="number"}if(value==null||type==="number"&&isNaN(value))return;if(type==="number"&&!jQuery.cssNumber[origName])value+="px";if(!hooks||
!("set"in hooks)||(value=hooks.set(elem,value))!==undefined)try{style[name]=value}catch(e){}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined)return ret;return style[name]}},css:function(elem,name,extra){var ret,hooks;name=jQuery.camelCase(name);hooks=jQuery.cssHooks[name];name=jQuery.cssProps[name]||name;if(name==="cssFloat")name="float";if(hooks&&"get"in hooks&&(ret=hooks.get(elem,true,extra))!==undefined)return ret;else if(curCSS)return curCSS(elem,name)},swap:function(elem,
options,callback){var old={};for(var name in options){old[name]=elem.style[name];elem.style[name]=options[name]}callback.call(elem);for(name in options)elem.style[name]=old[name]}});jQuery.curCSS=jQuery.css;jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){var val;if(computed){if(elem.offsetWidth!==0)return getWH(elem,name,extra);else jQuery.swap(elem,cssShow,function(){val=getWH(elem,name,extra)});return val}},set:function(elem,value){if(rnumpx.test(value)){value=
parseFloat(value);if(value>=0)return value+"px"}else return value}}});if(!jQuery.support.opacity)jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?parseFloat(RegExp.$1)/100+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNaN(value)?"":"alpha(opacity="+value*100+")",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=
1;if(value>=1&&jQuery.trim(filter.replace(ralpha,""))===""){style.removeAttribute("filter");if(currentStyle&&!currentStyle.filter)return}style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity}};jQuery(function(){if(!jQuery.support.reliableMarginRight)jQuery.cssHooks.marginRight={get:function(elem,computed){var ret;jQuery.swap(elem,{"display":"inline-block"},function(){if(computed)ret=curCSS(elem,"margin-right","marginRight");else ret=elem.style.marginRight});return ret}}});
if(document.defaultView&&document.defaultView.getComputedStyle)getComputedStyle=function(elem,name){var ret,defaultView,computedStyle;name=name.replace(rupper,"-$1").toLowerCase();if(!(defaultView=elem.ownerDocument.defaultView))return undefined;if(computedStyle=defaultView.getComputedStyle(elem,null)){ret=computedStyle.getPropertyValue(name);if(ret===""&&!jQuery.contains(elem.ownerDocument.documentElement,elem))ret=jQuery.style(elem,name)}return ret};if(document.documentElement.currentStyle)currentStyle=
function(elem,name){var left,ret=elem.currentStyle&&elem.currentStyle[name],rsLeft=elem.runtimeStyle&&elem.runtimeStyle[name],style=elem.style;if(!rnumpx.test(ret)&&rnum.test(ret)){left=style.left;if(rsLeft)elem.runtimeStyle.left=elem.currentStyle.left;style.left=name==="fontSize"?"1em":ret||0;ret=style.pixelLeft+"px";style.left=left;if(rsLeft)elem.runtimeStyle.left=rsLeft}return ret===""?"auto":ret};curCSS=getComputedStyle||currentStyle;function getWH(elem,name,extra){var val=name==="width"?elem.offsetWidth:
elem.offsetHeight,which=name==="width"?cssWidth:cssHeight;if(val>0){if(extra!=="border")jQuery.each(which,function(){if(!extra)val-=parseFloat(jQuery.css(elem,"padding"+this))||0;if(extra==="margin")val+=parseFloat(jQuery.css(elem,extra+this))||0;else val-=parseFloat(jQuery.css(elem,"border"+this+"Width"))||0});return val+"px"}val=curCSS(elem,name,name);if(val<0||val==null)val=elem.style[name]||0;val=parseFloat(val)||0;if(extra)jQuery.each(which,function(){val+=parseFloat(jQuery.css(elem,"padding"+
this))||0;if(extra!=="padding")val+=parseFloat(jQuery.css(elem,"border"+this+"Width"))||0;if(extra==="margin")val+=parseFloat(jQuery.css(elem,extra+this))||0});return val+"px"}if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.hidden=function(elem){var width=elem.offsetWidth,height=elem.offsetHeight;return width===0&&height===0||!jQuery.support.reliableHiddenOffsets&&(elem.style.display||jQuery.css(elem,"display"))==="none"};jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)}}var r20=
/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rhash=/#.*$/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,rinput=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,rlocalProtocol=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rquery=/\?/,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,rselectTextarea=/^(?:select|textarea)/i,rspacesAjax=/\s+/,rts=/([?&])_=[^&]*/,rurl=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,
_load=jQuery.fn.load,prefilters={},transports={},ajaxLocation,ajaxLocParts,allTypes=["*/"]+["*"];try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a");ajaxLocation.href="";ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*"}if(jQuery.isFunction(func)){var dataTypes=
dataTypeExpression.toLowerCase().split(rspacesAjax),i=0,length=dataTypes.length,dataType,list,placeBefore;for(;i<length;i++){dataType=dataTypes[i];placeBefore=/^\+/.test(dataType);if(placeBefore)dataType=dataType.substr(1)||"*";list=structure[dataType]=structure[dataType]||[];list[placeBefore?"unshift":"push"](func)}}}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,dataType,inspected){dataType=dataType||options.dataTypes[0];inspected=inspected||{};inspected[dataType]=
true;var list=structure[dataType],i=0,length=list?list.length:0,executeOnly=structure===prefilters,selection;for(;i<length&&(executeOnly||!selection);i++){selection=list[i](options,originalOptions,jqXHR);if(typeof selection==="string")if(!executeOnly||inspected[selection])selection=undefined;else{options.dataTypes.unshift(selection);selection=inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,selection,inspected)}}if((executeOnly||!selection)&&!inspected["*"])selection=inspectPrefiltersOrTransports(structure,
options,originalOptions,jqXHR,"*",inspected);return selection}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)if(src[key]!==undefined)(flatOptions[key]?target:deep||(deep={}))[key]=src[key];if(deep)jQuery.extend(true,target,deep)}jQuery.fn.extend({load:function(url,params,callback){if(typeof url!=="string"&&_load)return _load.apply(this,arguments);else if(!this.length)return this;var off=url.indexOf(" ");if(off>=0){var selector=url.slice(off,
url.length);url=url.slice(0,off)}var type="GET";if(params)if(jQuery.isFunction(params)){callback=params;params=undefined}else if(typeof params==="object"){params=jQuery.param(params,jQuery.ajaxSettings.traditional);type="POST"}var self=this;jQuery.ajax({url:url,type:type,dataType:"html",data:params,complete:function(jqXHR,status,responseText){responseText=jqXHR.responseText;if(jqXHR.isResolved()){jqXHR.done(function(r){responseText=r});self.html(selector?jQuery("<div>").append(responseText.replace(rscript,
"")).find(selector):responseText)}if(callback)self.each(callback,[responseText,status,jqXHR])}});return this},serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?jQuery.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||rselectTextarea.test(this.nodeName)||rinput.test(this.type))}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?
jQuery.map(val,function(val,i){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});jQuery.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(i,o){jQuery.fn[o]=function(f){return this.bind(o,f)}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined}return jQuery.ajax({type:method,
url:url,data:data,success:callback,dataType:type})}});jQuery.extend({getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},ajaxSetup:function(target,settings){if(settings)ajaxExtend(target,jQuery.ajaxSettings);else{settings=target;target=jQuery.ajaxSettings}ajaxExtend(target,settings);return target},ajaxSettings:{url:ajaxLocation,isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,
type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":allTypes},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":window.String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{context:true,url:true}},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),
ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined}options=options||{};var s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=callbackContext!==s&&(callbackContext.nodeType||callbackContext instanceof jQuery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery._Deferred(),statusCode=s.statusCode||{},ifModifiedKey,requestHeaders={},requestHeadersNames={},
responseHeadersString,responseHeaders,transport,timeoutTimer,parts,state=0,fireGlobals,i,jqXHR={readyState:0,setRequestHeader:function(name,value){if(!state){var lname=name.toLowerCase();name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value}return this},getAllResponseHeaders:function(){return state===2?responseHeadersString:null},getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while(match=rheaders.exec(responseHeadersString))responseHeaders[match[1].toLowerCase()]=
match[2]}match=responseHeaders[key.toLowerCase()]}return match===undefined?null:match},overrideMimeType:function(type){if(!state)s.mimeType=type;return this},abort:function(statusText){statusText=statusText||"abort";if(transport)transport.abort(statusText);done(0,statusText);return this}};function done(status,nativeStatusText,responses,headers){if(state===2)return;state=2;if(timeoutTimer)clearTimeout(timeoutTimer);transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;
var isSuccess,success,error,statusText=nativeStatusText,response=responses?ajaxHandleResponses(s,jqXHR,responses):undefined,lastModified,etag;if(status>=200&&status<300||status===304){if(s.ifModified){if(lastModified=jqXHR.getResponseHeader("Last-Modified"))jQuery.lastModified[ifModifiedKey]=lastModified;if(etag=jqXHR.getResponseHeader("Etag"))jQuery.etag[ifModifiedKey]=etag}if(status===304){statusText="notmodified";isSuccess=true}else try{success=ajaxConvert(s,response);statusText="success";isSuccess=
true}catch(e){statusText="parsererror";error=e}}else{error=statusText;if(!statusText||status){statusText="error";if(status<0)status=0}}jqXHR.status=status;jqXHR.statusText=""+(nativeStatusText||statusText);if(isSuccess)deferred.resolveWith(callbackContext,[success,statusText,jqXHR]);else deferred.rejectWith(callbackContext,[jqXHR,statusText,error]);jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals)globalEventContext.trigger("ajax"+(isSuccess?"Success":"Error"),[jqXHR,s,isSuccess?success:
error]);completeDeferred.resolveWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!--jQuery.active)jQuery.event.trigger("ajaxStop")}}deferred.promise(jqXHR);jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;jqXHR.complete=completeDeferred.done;jqXHR.statusCode=function(map){if(map){var tmp;if(state<2)for(tmp in map)statusCode[tmp]=[statusCode[tmp],map[tmp]];else{tmp=map[jqXHR.status];jqXHR.then(tmp,tmp)}}return this};s.url=((url||s.url)+
"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().split(rspacesAjax);if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!=ajaxLocParts[1]||parts[2]!=ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?80:443))!=(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?80:443))))}if(s.data&&s.processData&&typeof s.data!=="string")s.data=jQuery.param(s.data,s.traditional);inspectPrefiltersOrTransports(prefilters,
s,options,jqXHR);if(state===2)return false;fireGlobals=s.global;s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);if(fireGlobals&&jQuery.active++===0)jQuery.event.trigger("ajaxStart");if(!s.hasContent){if(s.data){s.url+=(rquery.test(s.url)?"&":"?")+s.data;delete s.data}ifModifiedKey=s.url;if(s.cache===false){var ts=jQuery.now(),ret=s.url.replace(rts,"$1_="+ts);s.url=ret+(ret===s.url?(rquery.test(s.url)?"&":"?")+"_="+ts:"")}}if(s.data&&s.hasContent&&s.contentType!==false||options.contentType)jqXHR.setRequestHeader("Content-Type",
s.contentType);if(s.ifModified){ifModifiedKey=ifModifiedKey||s.url;if(jQuery.lastModified[ifModifiedKey])jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[ifModifiedKey]);if(jQuery.etag[ifModifiedKey])jqXHR.setRequestHeader("If-None-Match",jQuery.etag[ifModifiedKey])}jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);
if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){jqXHR.abort();return false}for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport)done(-1,"No Transport");else{jqXHR.readyState=1;if(fireGlobals)globalEventContext.trigger("ajaxSend",[jqXHR,s]);if(s.async&&s.timeout>0)timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout);try{state=1;transport.send(requestHeaders,done)}catch(e){if(state<
2)done(-1,e);else jQuery.error(e)}}return jqXHR},param:function(a,traditional){var s=[],add=function(key,value){value=jQuery.isFunction(value)?value():value;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined)traditional=jQuery.ajaxSettings.traditional;if(jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(var prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,
"+")}});function buildParams(prefix,obj,traditional,add){if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix))add(prefix,v);else buildParams(prefix+"["+(typeof v==="object"||jQuery.isArray(v)?i:"")+"]",v,traditional,add)});else if(!traditional&&obj!=null&&typeof obj==="object")for(var name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add);else add(prefix,obj)}jQuery.extend({active:0,lastModified:{},etag:{}});function ajaxHandleResponses(s,jqXHR,
responses){var contents=s.contents,dataTypes=s.dataTypes,responseFields=s.responseFields,ct,type,finalDataType,firstDataType;for(type in responseFields)if(type in responses)jqXHR[responseFields[type]]=responses[type];while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined)ct=s.mimeType||jqXHR.getResponseHeader("content-type")}if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||
s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}if(!firstDataType)firstDataType=type}finalDataType=finalDataType||firstDataType}if(finalDataType){if(finalDataType!==dataTypes[0])dataTypes.unshift(finalDataType);return responses[finalDataType]}}function ajaxConvert(s,response){if(s.dataFilter)response=s.dataFilter(response,s.dataType);var dataTypes=s.dataTypes,converters={},i,key,length=dataTypes.length,tmp,current=dataTypes[0],prev,conversion,conv,conv1,conv2;for(i=1;i<length;i++){if(i===
1)for(key in s.converters)if(typeof key==="string")converters[key.toLowerCase()]=s.converters[key];prev=current;current=dataTypes[i];if(current==="*")current=prev;else if(prev!=="*"&&prev!==current){conversion=prev+" "+current;conv=converters[conversion]||converters["* "+current];if(!conv){conv2=undefined;for(conv1 in converters){tmp=conv1.split(" ");if(tmp[0]===prev||tmp[0]==="*"){conv2=converters[tmp[1]+" "+current];if(conv2){conv1=converters[conv1];if(conv1===true)conv=conv2;else if(conv2===true)conv=
conv1;break}}}}if(!(conv||conv2))jQuery.error("No conversion from "+conversion.replace(" "," to "));if(conv!==true)response=conv?conv(response):conv2(conv1(response))}}return response}var jsc=jQuery.now(),jsre=/(\=)\?(&|$)|\?\?/i;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return jQuery.expando+"_"+jsc++}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var inspectData=s.contentType==="application/x-www-form-urlencoded"&&typeof s.data==="string";if(s.dataTypes[0]===
"jsonp"||s.jsonp!==false&&(jsre.test(s.url)||inspectData&&jsre.test(s.data))){var responseContainer,jsonpCallback=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,previous=window[jsonpCallback],url=s.url,data=s.data,replace="$1"+jsonpCallback+"$2";if(s.jsonp!==false){url=url.replace(jsre,replace);if(s.url===url){if(inspectData)data=data.replace(jsre,replace);if(s.data===data)url+=(/\?/.test(url)?"&":"?")+s.jsonp+"="+jsonpCallback}}s.url=url;s.data=data;window[jsonpCallback]=
function(response){responseContainer=[response]};jqXHR.always(function(){window[jsonpCallback]=previous;if(responseContainer&&jQuery.isFunction(previous))window[jsonpCallback](responseContainer[0])});s.converters["script json"]=function(){if(!responseContainer)jQuery.error(jsonpCallback+" was not called");return responseContainer[0]};s.dataTypes[0]="json";return"script"}});jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
contents:{script:/javascript|ecmascript/},converters:{"text script":function(text){jQuery.globalEval(text);return text}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined)s.cache=false;if(s.crossDomain){s.type="GET";s.global=false}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||document.getElementsByTagName("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script");script.async="async";
if(s.scriptCharset)script.charset=s.scriptCharset;script.src=s.url;script.onload=script.onreadystatechange=function(_,isAbort){if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;if(head&&script.parentNode)head.removeChild(script);script=undefined;if(!isAbort)callback(200,"success")}};head.insertBefore(script,head.firstChild)},abort:function(){if(script)script.onload(0,1)}}}});var xhrOnUnloadAbort=window.ActiveXObject?function(){for(var key in xhrCallbacks)xhrCallbacks[key](0,
1)}:false,xhrId=0,xhrCallbacks;function createStandardXHR(){try{return new window.XMLHttpRequest}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}jQuery.ajaxSettings.xhr=window.ActiveXObject?function(){return!this.isLocal&&createStandardXHR()||createActiveXHR()}:createStandardXHR;(function(xhr){jQuery.extend(jQuery.support,{ajax:!!xhr,cors:!!xhr&&"withCredentials"in xhr})})(jQuery.ajaxSettings.xhr());if(jQuery.support.ajax)jQuery.ajaxTransport(function(s){if(!s.crossDomain||
jQuery.support.cors){var callback;return{send:function(headers,complete){var xhr=s.xhr(),handle,i;if(s.username)xhr.open(s.type,s.url,s.async,s.username,s.password);else xhr.open(s.type,s.url,s.async);if(s.xhrFields)for(i in s.xhrFields)xhr[i]=s.xhrFields[i];if(s.mimeType&&xhr.overrideMimeType)xhr.overrideMimeType(s.mimeType);if(!s.crossDomain&&!headers["X-Requested-With"])headers["X-Requested-With"]="XMLHttpRequest";try{for(i in headers)xhr.setRequestHeader(i,headers[i])}catch(_){}xhr.send(s.hasContent&&
s.data||null);callback=function(_,isAbort){var status,statusText,responseHeaders,responses,xml;try{if(callback&&(isAbort||xhr.readyState===4)){callback=undefined;if(handle){xhr.onreadystatechange=jQuery.noop;if(xhrOnUnloadAbort)delete xhrCallbacks[handle]}if(isAbort){if(xhr.readyState!==4)xhr.abort()}else{status=xhr.status;responseHeaders=xhr.getAllResponseHeaders();responses={};xml=xhr.responseXML;if(xml&&xml.documentElement)responses.xml=xml;responses.text=xhr.responseText;try{statusText=xhr.statusText}catch(e){statusText=
""}if(!status&&s.isLocal&&!s.crossDomain)status=responses.text?200:404;else if(status===1223)status=204}}}catch(firefoxAccessException){if(!isAbort)complete(-1,firefoxAccessException)}if(responses)complete(status,statusText,responses,responseHeaders)};if(!s.async||xhr.readyState===4)callback();else{handle=++xhrId;if(xhrOnUnloadAbort){if(!xhrCallbacks){xhrCallbacks={};jQuery(window).unload(xhrOnUnloadAbort)}xhrCallbacks[handle]=callback}xhr.onreadystatechange=callback}},abort:function(){if(callback)callback(0,
1)}}}});var elemdisplay={},iframe,iframeDoc,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,timerId,fxAttrs=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],fxNow;jQuery.fn.extend({show:function(speed,easing,callback){var elem,display;if(speed||speed===0)return this.animate(genFx("show",3),speed,easing,callback);else{for(var i=0,j=this.length;i<j;i++){elem=this[i];if(elem.style){display=
elem.style.display;if(!jQuery._data(elem,"olddisplay")&&display==="none")display=elem.style.display="";if(display===""&&jQuery.css(elem,"display")==="none")jQuery._data(elem,"olddisplay",defaultDisplay(elem.nodeName))}}for(i=0;i<j;i++){elem=this[i];if(elem.style){display=elem.style.display;if(display===""||display==="none")elem.style.display=jQuery._data(elem,"olddisplay")||""}}return this}},hide:function(speed,easing,callback){if(speed||speed===0)return this.animate(genFx("hide",3),speed,easing,
callback);else{for(var i=0,j=this.length;i<j;i++)if(this[i].style){var display=jQuery.css(this[i],"display");if(display!=="none"&&!jQuery._data(this[i],"olddisplay"))jQuery._data(this[i],"olddisplay",display)}for(i=0;i<j;i++)if(this[i].style)this[i].style.display="none";return this}},_toggle:jQuery.fn.toggle,toggle:function(fn,fn2,callback){var bool=typeof fn==="boolean";if(jQuery.isFunction(fn)&&jQuery.isFunction(fn2))this._toggle.apply(this,arguments);else if(fn==null||bool)this.each(function(){var state=
bool?fn:jQuery(this).is(":hidden");jQuery(this)[state?"show":"hide"]()});else this.animate(genFx("toggle",3),fn,fn2,callback);return this},fadeTo:function(speed,to,easing,callback){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var optall=jQuery.speed(speed,easing,callback);if(jQuery.isEmptyObject(prop))return this.each(optall.complete,[false]);prop=jQuery.extend({},prop);return this[optall.queue===
false?"each":"queue"](function(){if(optall.queue===false)jQuery._mark(this);var opt=jQuery.extend({},optall),isElement=this.nodeType===1,hidden=isElement&&jQuery(this).is(":hidden"),name,val,p,display,e,parts,start,end,unit;opt.animatedProperties={};for(p in prop){name=jQuery.camelCase(p);if(p!==name){prop[name]=prop[p];delete prop[p]}val=prop[name];if(jQuery.isArray(val)){opt.animatedProperties[name]=val[1];val=prop[name]=val[0]}else opt.animatedProperties[name]=opt.specialEasing&&opt.specialEasing[name]||
opt.easing||"swing";if(val==="hide"&&hidden||val==="show"&&!hidden)return opt.complete.call(this);if(isElement&&(name==="height"||name==="width")){opt.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY];if(jQuery.css(this,"display")==="inline"&&jQuery.css(this,"float")==="none")if(!jQuery.support.inlineBlockNeedsLayout)this.style.display="inline-block";else{display=defaultDisplay(this.nodeName);if(display==="inline")this.style.display="inline-block";else{this.style.display="inline";
this.style.zoom=1}}}}if(opt.overflow!=null)this.style.overflow="hidden";for(p in prop){e=new jQuery.fx(this,opt,p);val=prop[p];if(rfxtypes.test(val))e[val==="toggle"?hidden?"show":"hide":val]();else{parts=rfxnum.exec(val);start=e.cur();if(parts){end=parseFloat(parts[2]);unit=parts[3]||(jQuery.cssNumber[p]?"":"px");if(unit!=="px"){jQuery.style(this,p,(end||1)+unit);start=(end||1)/e.cur()*start;jQuery.style(this,p,start+unit)}if(parts[1])end=(parts[1]==="-="?-1:1)*end+start;e.custom(start,end,unit)}else e.custom(start,
val,"")}}return true})},stop:function(clearQueue,gotoEnd){if(clearQueue)this.queue([]);this.each(function(){var timers=jQuery.timers,i=timers.length;if(!gotoEnd)jQuery._unmark(true,this);while(i--)if(timers[i].elem===this){if(gotoEnd)timers[i](true);timers.splice(i,1)}});if(!gotoEnd)this.dequeue();return this}});function createFxNow(){setTimeout(clearFxNow,0);return fxNow=jQuery.now()}function clearFxNow(){fxNow=undefined}function genFx(type,num){var obj={};jQuery.each(fxAttrs.concat.apply([],fxAttrs.slice(0,
num)),function(){obj[this]=type});return obj}jQuery.each({slideDown:genFx("show",1),slideUp:genFx("hide",1),slideToggle:genFx("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}});jQuery.extend({speed:function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&
speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;opt.old=opt.complete;opt.complete=function(noUnmark){if(jQuery.isFunction(opt.old))opt.old.call(this);if(opt.queue!==false)jQuery.dequeue(this);else if(noUnmark!==false)jQuery._unmark(this)};return opt},easing:{linear:function(p,n,firstNum,diff){return firstNum+
diff*p},swing:function(p,n,firstNum,diff){return(-Math.cos(p*Math.PI)/2+0.5)*diff+firstNum}},timers:[],fx:function(elem,options,prop){this.options=options;this.elem=elem;this.prop=prop;options.orig=options.orig||{}}});jQuery.fx.prototype={update:function(){if(this.options.step)this.options.step.call(this.elem,this.now,this);(jQuery.fx.step[this.prop]||jQuery.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];
var parsed,r=jQuery.css(this.elem,this.prop);return isNaN(parsed=parseFloat(r))?!r||r==="auto"?0:r:parsed},custom:function(from,to,unit){var self=this,fx=jQuery.fx;this.startTime=fxNow||createFxNow();this.start=from;this.end=to;this.unit=unit||this.unit||(jQuery.cssNumber[this.prop]?"":"px");this.now=this.start;this.pos=this.state=0;function t(gotoEnd){return self.step(gotoEnd)}t.elem=this.elem;if(t()&&jQuery.timers.push(t)&&!timerId)timerId=setInterval(fx.tick,fx.interval)},show:function(){this.options.orig[this.prop]=
jQuery.style(this.elem,this.prop);this.options.show=true;this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());jQuery(this.elem).show()},hide:function(){this.options.orig[this.prop]=jQuery.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(gotoEnd){var t=fxNow||createFxNow(),done=true,elem=this.elem,options=this.options,i,n;if(gotoEnd||t>=options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();options.animatedProperties[this.prop]=
true;for(i in options.animatedProperties)if(options.animatedProperties[i]!==true)done=false;if(done){if(options.overflow!=null&&!jQuery.support.shrinkWrapBlocks)jQuery.each(["","X","Y"],function(index,value){elem.style["overflow"+value]=options.overflow[index]});if(options.hide)jQuery(elem).hide();if(options.hide||options.show)for(var p in options.animatedProperties)jQuery.style(elem,p,options.orig[p]);options.complete.call(elem)}return false}else{if(options.duration==Infinity)this.now=t;else{n=t-
this.startTime;this.state=n/options.duration;this.pos=jQuery.easing[options.animatedProperties[this.prop]](this.state,n,0,1,options.duration);this.now=this.start+(this.end-this.start)*this.pos}this.update()}return true}};jQuery.extend(jQuery.fx,{tick:function(){for(var timers=jQuery.timers,i=0;i<timers.length;++i)if(!timers[i]())timers.splice(i--,1);if(!timers.length)jQuery.fx.stop()},interval:13,stop:function(){clearInterval(timerId);timerId=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(fx){jQuery.style(fx.elem,
"opacity",fx.now)},_default:function(fx){if(fx.elem.style&&fx.elem.style[fx.prop]!=null)fx.elem.style[fx.prop]=(fx.prop==="width"||fx.prop==="height"?Math.max(0,fx.now):fx.now)+fx.unit;else fx.elem[fx.prop]=fx.now}}});if(jQuery.expr&&jQuery.expr.filters)jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};function defaultDisplay(nodeName){if(!elemdisplay[nodeName]){var body=document.body,elem=jQuery("<"+nodeName+">").appendTo(body),
display=elem.css("display");elem.remove();if(display==="none"||display===""){if(!iframe){iframe=document.createElement("iframe");iframe.frameBorder=iframe.width=iframe.height=0}body.appendChild(iframe);if(!iframeDoc||!iframe.createElement){iframeDoc=(iframe.contentWindow||iframe.contentDocument).document;iframeDoc.write((document.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>");iframeDoc.close()}elem=iframeDoc.createElement(nodeName);iframeDoc.body.appendChild(elem);display=jQuery.css(elem,
"display");body.removeChild(iframe)}elemdisplay[nodeName]=display}return elemdisplay[nodeName]}var rtable=/^t(?:able|d|h)$/i,rroot=/^(?:body|html)$/i;if("getBoundingClientRect"in document.documentElement)jQuery.fn.offset=function(options){var elem=this[0],box;if(options)return this.each(function(i){jQuery.offset.setOffset(this,options,i)});if(!elem||!elem.ownerDocument)return null;if(elem===elem.ownerDocument.body)return jQuery.offset.bodyOffset(elem);try{box=elem.getBoundingClientRect()}catch(e){}var doc=
elem.ownerDocument,docElem=doc.documentElement;if(!box||!jQuery.contains(docElem,elem))return box?{top:box.top,left:box.left}:{top:0,left:0};var body=doc.body,win=getWindow(doc),clientTop=docElem.clientTop||body.clientTop||0,clientLeft=docElem.clientLeft||body.clientLeft||0,scrollTop=win.pageYOffset||jQuery.support.boxModel&&docElem.scrollTop||body.scrollTop,scrollLeft=win.pageXOffset||jQuery.support.boxModel&&docElem.scrollLeft||body.scrollLeft,top=box.top+scrollTop-clientTop,left=box.left+scrollLeft-
clientLeft;return{top:top,left:left}};else jQuery.fn.offset=function(options){var elem=this[0];if(options)return this.each(function(i){jQuery.offset.setOffset(this,options,i)});if(!elem||!elem.ownerDocument)return null;if(elem===elem.ownerDocument.body)return jQuery.offset.bodyOffset(elem);jQuery.offset.initialize();var computedStyle,offsetParent=elem.offsetParent,prevOffsetParent=elem,doc=elem.ownerDocument,docElem=doc.documentElement,body=doc.body,defaultView=doc.defaultView,prevComputedStyle=defaultView?
defaultView.getComputedStyle(elem,null):elem.currentStyle,top=elem.offsetTop,left=elem.offsetLeft;while((elem=elem.parentNode)&&elem!==body&&elem!==docElem){if(jQuery.offset.supportsFixedPosition&&prevComputedStyle.position==="fixed")break;computedStyle=defaultView?defaultView.getComputedStyle(elem,null):elem.currentStyle;top-=elem.scrollTop;left-=elem.scrollLeft;if(elem===offsetParent){top+=elem.offsetTop;left+=elem.offsetLeft;if(jQuery.offset.doesNotAddBorder&&!(jQuery.offset.doesAddBorderForTableAndCells&&
rtable.test(elem.nodeName))){top+=parseFloat(computedStyle.borderTopWidth)||0;left+=parseFloat(computedStyle.borderLeftWidth)||0}prevOffsetParent=offsetParent;offsetParent=elem.offsetParent}if(jQuery.offset.subtractsBorderForOverflowNotVisible&&computedStyle.overflow!=="visible"){top+=parseFloat(computedStyle.borderTopWidth)||0;left+=parseFloat(computedStyle.borderLeftWidth)||0}prevComputedStyle=computedStyle}if(prevComputedStyle.position==="relative"||prevComputedStyle.position==="static"){top+=
body.offsetTop;left+=body.offsetLeft}if(jQuery.offset.supportsFixedPosition&&prevComputedStyle.position==="fixed"){top+=Math.max(docElem.scrollTop,body.scrollTop);left+=Math.max(docElem.scrollLeft,body.scrollLeft)}return{top:top,left:left}};jQuery.offset={initialize:function(){var body=document.body,container=document.createElement("div"),innerDiv,checkDiv,table,td,bodyMarginTop=parseFloat(jQuery.css(body,"marginTop"))||0,html="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";
jQuery.extend(container.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"});container.innerHTML=html;body.insertBefore(container,body.firstChild);innerDiv=container.firstChild;checkDiv=innerDiv.firstChild;td=innerDiv.nextSibling.firstChild.firstChild;this.doesNotAddBorder=checkDiv.offsetTop!==5;this.doesAddBorderForTableAndCells=td.offsetTop===5;checkDiv.style.position="fixed";checkDiv.style.top="20px";this.supportsFixedPosition=checkDiv.offsetTop===
20||checkDiv.offsetTop===15;checkDiv.style.position=checkDiv.style.top="";innerDiv.style.overflow="hidden";innerDiv.style.position="relative";this.subtractsBorderForOverflowNotVisible=checkDiv.offsetTop===-5;this.doesNotIncludeMarginInBodyOffset=body.offsetTop!==bodyMarginTop;body.removeChild(container);jQuery.offset.initialize=jQuery.noop},bodyOffset:function(body){var top=body.offsetTop,left=body.offsetLeft;jQuery.offset.initialize();if(jQuery.offset.doesNotIncludeMarginInBodyOffset){top+=parseFloat(jQuery.css(body,
"marginTop"))||0;left+=parseFloat(jQuery.css(body,"marginLeft"))||0}return{top:top,left:left}},setOffset:function(elem,options,i){var position=jQuery.css(elem,"position");if(position==="static")elem.style.position="relative";var curElem=jQuery(elem),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=(position==="absolute"||position==="fixed")&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,props={},curPosition={},curTop,curLeft;if(calculatePosition){curPosition=
curElem.position();curTop=curPosition.top;curLeft=curPosition.left}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0}if(jQuery.isFunction(options))options=options.call(elem,i,curOffset);if(options.top!=null)props.top=options.top-curOffset.top+curTop;if(options.left!=null)props.left=options.left-curOffset.left+curLeft;if("using"in options)options.using.call(elem,props);else curElem.css(props)}};jQuery.fn.extend({position:function(){if(!this[0])return null;var elem=this[0],offsetParent=
this.offsetParent(),offset=this.offset(),parentOffset=rroot.test(offsetParent[0].nodeName)?{top:0,left:0}:offsetParent.offset();offset.top-=parseFloat(jQuery.css(elem,"marginTop"))||0;offset.left-=parseFloat(jQuery.css(elem,"marginLeft"))||0;parentOffset.top+=parseFloat(jQuery.css(offsetParent[0],"borderTopWidth"))||0;parentOffset.left+=parseFloat(jQuery.css(offsetParent[0],"borderLeftWidth"))||0;return{top:offset.top-parentOffset.top,left:offset.left-parentOffset.left}},offsetParent:function(){return this.map(function(){var offsetParent=
this.offsetParent||document.body;while(offsetParent&&!rroot.test(offsetParent.nodeName)&&jQuery.css(offsetParent,"position")==="static")offsetParent=offsetParent.offsetParent;return offsetParent})}});jQuery.each(["Left","Top"],function(i,name){var method="scroll"+name;jQuery.fn[method]=function(val){var elem,win;if(val===undefined){elem=this[0];if(!elem)return null;win=getWindow(elem);return win?"pageXOffset"in win?win[i?"pageYOffset":"pageXOffset"]:jQuery.support.boxModel&&win.document.documentElement[method]||
win.document.body[method]:elem[method]}return this.each(function(){win=getWindow(this);if(win)win.scrollTo(!i?val:jQuery(win).scrollLeft(),i?val:jQuery(win).scrollTop());else this[method]=val})}});function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:false}jQuery.each(["Height","Width"],function(i,name){var type=name.toLowerCase();jQuery.fn["inner"+name]=function(){var elem=this[0];return elem&&elem.style?parseFloat(jQuery.css(elem,type,"padding")):
null};jQuery.fn["outer"+name]=function(margin){var elem=this[0];return elem&&elem.style?parseFloat(jQuery.css(elem,type,margin?"margin":"border")):null};jQuery.fn[type]=function(size){var elem=this[0];if(!elem)return size==null?null:this;if(jQuery.isFunction(size))return this.each(function(i){var self=jQuery(this);self[type](size.call(this,i,self[type]()))});if(jQuery.isWindow(elem)){var docElemProp=elem.document.documentElement["client"+name],body=elem.document.body;return elem.document.compatMode===
"CSS1Compat"&&docElemProp||body&&body["client"+name]||docElemProp}else if(elem.nodeType===9)return Math.max(elem.documentElement["client"+name],elem.body["scroll"+name],elem.documentElement["scroll"+name],elem.body["offset"+name],elem.documentElement["offset"+name]);else if(size===undefined){var orig=jQuery.css(elem,type),ret=parseFloat(orig);return jQuery.isNaN(ret)?orig:ret}else return this.css(type,typeof size==="string"?size:size+"px")}});window.jQuery=window.$=jQuery})(window);
(function($){function safe_add(x,y){var lsw=(x&65535)+(y&65535),msw=(x>>16)+(y>>16)+(lsw>>16);return msw<<16|lsw&65535}function bit_rol(num,cnt){return num<<cnt|num>>>32-cnt}function md5_cmn(q,a,b,x,s,t){return safe_add(bit_rol(safe_add(safe_add(a,q),safe_add(x,t)),s),b)}function md5_ff(a,b,c,d,x,s,t){return md5_cmn(b&c|~b&d,a,b,x,s,t)}function md5_gg(a,b,c,d,x,s,t){return md5_cmn(b&d|c&~d,a,b,x,s,t)}function md5_hh(a,b,c,d,x,s,t){return md5_cmn(b^c^d,a,b,x,s,t)}function md5_ii(a,b,c,d,x,s,t){return md5_cmn(c^
(b|~d),a,b,x,s,t)}function binl_md5(x,len){x[len>>5]|=128<<len%32;x[(len+64>>>9<<4)+14]=len;var i,olda,oldb,oldc,oldd,a=1732584193,b=-271733879,c=-1732584194,d=271733878;for(i=0;i<x.length;i+=16){olda=a;oldb=b;oldc=c;oldd=d;a=md5_ff(a,b,c,d,x[i],7,-680876936);d=md5_ff(d,a,b,c,x[i+1],12,-389564586);c=md5_ff(c,d,a,b,x[i+2],17,606105819);b=md5_ff(b,c,d,a,x[i+3],22,-1044525330);a=md5_ff(a,b,c,d,x[i+4],7,-176418897);d=md5_ff(d,a,b,c,x[i+5],12,1200080426);c=md5_ff(c,d,a,b,x[i+6],17,-1473231341);b=md5_ff(b,
c,d,a,x[i+7],22,-45705983);a=md5_ff(a,b,c,d,x[i+8],7,1770035416);d=md5_ff(d,a,b,c,x[i+9],12,-1958414417);c=md5_ff(c,d,a,b,x[i+10],17,-42063);b=md5_ff(b,c,d,a,x[i+11],22,-1990404162);a=md5_ff(a,b,c,d,x[i+12],7,1804603682);d=md5_ff(d,a,b,c,x[i+13],12,-40341101);c=md5_ff(c,d,a,b,x[i+14],17,-1502002290);b=md5_ff(b,c,d,a,x[i+15],22,1236535329);a=md5_gg(a,b,c,d,x[i+1],5,-165796510);d=md5_gg(d,a,b,c,x[i+6],9,-1069501632);c=md5_gg(c,d,a,b,x[i+11],14,643717713);b=md5_gg(b,c,d,a,x[i],20,-373897302);a=md5_gg(a,
b,c,d,x[i+5],5,-701558691);d=md5_gg(d,a,b,c,x[i+10],9,38016083);c=md5_gg(c,d,a,b,x[i+15],14,-660478335);b=md5_gg(b,c,d,a,x[i+4],20,-405537848);a=md5_gg(a,b,c,d,x[i+9],5,568446438);d=md5_gg(d,a,b,c,x[i+14],9,-1019803690);c=md5_gg(c,d,a,b,x[i+3],14,-187363961);b=md5_gg(b,c,d,a,x[i+8],20,1163531501);a=md5_gg(a,b,c,d,x[i+13],5,-1444681467);d=md5_gg(d,a,b,c,x[i+2],9,-51403784);c=md5_gg(c,d,a,b,x[i+7],14,1735328473);b=md5_gg(b,c,d,a,x[i+12],20,-1926607734);a=md5_hh(a,b,c,d,x[i+5],4,-378558);d=md5_hh(d,
a,b,c,x[i+8],11,-2022574463);c=md5_hh(c,d,a,b,x[i+11],16,1839030562);b=md5_hh(b,c,d,a,x[i+14],23,-35309556);a=md5_hh(a,b,c,d,x[i+1],4,-1530992060);d=md5_hh(d,a,b,c,x[i+4],11,1272893353);c=md5_hh(c,d,a,b,x[i+7],16,-155497632);b=md5_hh(b,c,d,a,x[i+10],23,-1094730640);a=md5_hh(a,b,c,d,x[i+13],4,681279174);d=md5_hh(d,a,b,c,x[i],11,-358537222);c=md5_hh(c,d,a,b,x[i+3],16,-722521979);b=md5_hh(b,c,d,a,x[i+6],23,76029189);a=md5_hh(a,b,c,d,x[i+9],4,-640364487);d=md5_hh(d,a,b,c,x[i+12],11,-421815835);c=md5_hh(c,
d,a,b,x[i+15],16,530742520);b=md5_hh(b,c,d,a,x[i+2],23,-995338651);a=md5_ii(a,b,c,d,x[i],6,-198630844);d=md5_ii(d,a,b,c,x[i+7],10,1126891415);c=md5_ii(c,d,a,b,x[i+14],15,-1416354905);b=md5_ii(b,c,d,a,x[i+5],21,-57434055);a=md5_ii(a,b,c,d,x[i+12],6,1700485571);d=md5_ii(d,a,b,c,x[i+3],10,-1894986606);c=md5_ii(c,d,a,b,x[i+10],15,-1051523);b=md5_ii(b,c,d,a,x[i+1],21,-2054922799);a=md5_ii(a,b,c,d,x[i+8],6,1873313359);d=md5_ii(d,a,b,c,x[i+15],10,-30611744);c=md5_ii(c,d,a,b,x[i+6],15,-1560198380);b=md5_ii(b,
c,d,a,x[i+13],21,1309151649);a=md5_ii(a,b,c,d,x[i+4],6,-145523070);d=md5_ii(d,a,b,c,x[i+11],10,-1120210379);c=md5_ii(c,d,a,b,x[i+2],15,718787259);b=md5_ii(b,c,d,a,x[i+9],21,-343485551);a=safe_add(a,olda);b=safe_add(b,oldb);c=safe_add(c,oldc);d=safe_add(d,oldd)}return[a,b,c,d]}function binl2rstr(input){var i,output="";for(i=0;i<input.length*32;i+=8)output+=String.fromCharCode(input[i>>5]>>>i%32&255);return output}function rstr2binl(input){var i,output=[];output[(input.length>>2)-1]=undefined;for(i=
0;i<output.length;i+=1)output[i]=0;for(i=0;i<input.length*8;i+=8)output[i>>5]|=(input.charCodeAt(i/8)&255)<<i%32;return output}function rstr_md5(s){return binl2rstr(binl_md5(rstr2binl(s),s.length*8))}function rstr_hmac_md5(key,data){var i,bkey=rstr2binl(key),ipad=[],opad=[],hash;ipad[15]=opad[15]=undefined;if(bkey.length>16)bkey=binl_md5(bkey,key.length*8);for(i=0;i<16;i+=1){ipad[i]=bkey[i]^909522486;opad[i]=bkey[i]^1549556828}hash=binl_md5(ipad.concat(rstr2binl(data)),512+data.length*8);return binl2rstr(binl_md5(opad.concat(hash),
512+128))}function rstr2hex(input){var hex_tab="0123456789abcdef",output="",x,i;for(i=0;i<input.length;i+=1){x=input.charCodeAt(i);output+=hex_tab.charAt(x>>>4&15)+hex_tab.charAt(x&15)}return output}function str2rstr_utf8(input){return unescape(encodeURIComponent(input))}function raw_md5(s){return rstr_md5(str2rstr_utf8(s))}function hex_md5(s){return rstr2hex(raw_md5(s))}function raw_hmac_md5(k,d){return rstr_hmac_md5(str2rstr_utf8(k),str2rstr_utf8(d))}function hex_hmac_md5(k,d){return rstr2hex(raw_hmac_md5(k,
d))}$.md5=function(string,key,raw){if(!key)if(!raw)return hex_md5(string);else return raw_md5(string);if(!raw)return hex_hmac_md5(key,string);else return raw_hmac_md5(key,string)}})(typeof jQuery==="function"?jQuery:this);
(function($){$.fn.ajaxSubmit=function(options){if(!this.length){log("ajaxSubmit: skipping submit process - no element selected");return this}var method,action,url,$form=this;if(typeof options=="function")options={success:options};method=this.attr("method");action=this.attr("action");url=typeof action==="string"?$.trim(action):"";url=url||window.location.href||"";if(url)url=(url.match(/^([^#]+)/)||[])[1];options=$.extend(true,{url:url,success:$.ajaxSettings.success,type:method||"GET",iframeSrc:/^https/i.test(window.location.href||
"")?"javascript:false":"about:blank"},options);var veto={};this.trigger("form-pre-serialize",[this,options,veto]);if(veto.veto){log("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(options.beforeSerialize&&options.beforeSerialize(this,options)===false){log("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var n,v,a=this.formToArray(options.semantic);if(options.data){options.extraData=options.data;for(n in options.data)if(options.data[n]instanceof Array)for(var k in options.data[n])a.push({name:n,
value:options.data[n][k]});else{v=options.data[n];v=$.isFunction(v)?v():v;a.push({name:n,value:v})}}if(options.beforeSubmit&&options.beforeSubmit(a,this,options)===false){log("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[a,this,options,veto]);if(veto.veto){log("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var q=$.param(a);if(options.type.toUpperCase()=="GET"){options.url+=(options.url.indexOf("?")>=0?"&":"?")+q;
options.data=null}else options.data=q;var callbacks=[];if(options.resetForm)callbacks.push(function(){$form.resetForm()});if(options.clearForm)callbacks.push(function(){$form.clearForm()});if(!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(data){var fn=options.replaceTarget?"replaceWith":"html";$(options.target)[fn](data).each(oldSuccess,arguments)})}else if(options.success)callbacks.push(options.success);options.success=function(data,status,
xhr){var context=options.context||options;for(var i=0,max=callbacks.length;i<max;i++)callbacks[i].apply(context,[data,status,xhr||$form,$form])};var fileInputs=$("input:file",this).length>0;var mp="multipart/form-data";var multipart=$form.attr("enctype")==mp||$form.attr("encoding")==mp;if(options.iframe!==false&&(fileInputs||options.iframe||multipart))if(options.closeKeepAlive)$.get(options.closeKeepAlive,function(){fileUpload(a)});else fileUpload(a);else{if($.browser.msie&&method=="get"){var ieMeth=
$form[0].getAttribute("method");if(typeof ieMeth==="string")options.type=ieMeth}$.ajax(options)}this.trigger("form-submit-notify",[this,options]);return this;function fileUpload(a){var form=$form[0],el,i,s,g,id,$io,io,xhr,sub,n,timedOut,timeoutHandle;var useProp=!!$.fn.prop;if(a)for(i=0;i<a.length;i++){el=$(form[a[i].name]);el[useProp?"prop":"attr"]("disabled",false)}if($(":input[name=submit],:input[id=submit]",form).length){alert('Error: Form elements must not have name or id of "submit".');return}s=
$.extend(true,{},$.ajaxSettings,options);s.context=s.context||s;id="jqFormIO"+(new Date).getTime();if(s.iframeTarget){$io=$(s.iframeTarget);n=$io.attr("name");if(n==null)$io.attr("name",id);else id=n}else{$io=$('<iframe name="'+id+'" src="'+s.iframeSrc+'" />');$io.css({position:"absolute",top:"-1000px",left:"-1000px"})}io=$io[0];xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},
abort:function(status){var e=status==="timeout"?"timeout":"aborted";log("aborting upload... "+e);this.aborted=1;$io.attr("src",s.iframeSrc);xhr.error=e;s.error&&s.error.call(s.context,xhr,e,status);g&&$.event.trigger("ajaxError",[xhr,s,e]);s.complete&&s.complete.call(s.context,xhr,e)}};g=s.global;if(g&&!$.active++)$.event.trigger("ajaxStart");if(g)$.event.trigger("ajaxSend",[xhr,s]);if(s.beforeSend&&s.beforeSend.call(s.context,xhr,s)===false){if(s.global)$.active--;return}if(xhr.aborted)return;sub=
form.clk;if(sub){n=sub.name;if(n&&!sub.disabled){s.extraData=s.extraData||{};s.extraData[n]=sub.value;if(sub.type=="image"){s.extraData[n+".x"]=form.clk_x;s.extraData[n+".y"]=form.clk_y}}}var CLIENT_TIMEOUT_ABORT=1;var SERVER_ABORT=2;function getDoc(frame){var doc=frame.contentWindow?frame.contentWindow.document:frame.contentDocument?frame.contentDocument:frame.document;return doc}function doSubmit(){var t=$form.attr("target"),a=$form.attr("action");form.setAttribute("target",id);if(!method)form.setAttribute("method",
"POST");if(a!=s.url)form.setAttribute("action",s.url);if(!s.skipEncodingOverride&&(!method||/post/i.test(method)))$form.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});if(s.timeout)timeoutHandle=setTimeout(function(){timedOut=true;cb(CLIENT_TIMEOUT_ABORT)},s.timeout);function checkState(){try{var state=getDoc(io).readyState;log("state = "+state);if(state.toLowerCase()=="uninitialized")setTimeout(checkState,50)}catch(e){log("Server abort: ",e," (",e.name,")");cb(SERVER_ABORT);
timeoutHandle&&clearTimeout(timeoutHandle);timeoutHandle=undefined}}var extraInputs=[];try{if(s.extraData)for(var n in s.extraData)extraInputs.push($('<input type="hidden" name="'+n+'" />').attr("value",s.extraData[n]).appendTo(form)[0]);if(!s.iframeTarget){$io.appendTo("body");io.attachEvent?io.attachEvent("onload",cb):io.addEventListener("load",cb,false)}setTimeout(checkState,15);form.submit()}finally{form.setAttribute("action",a);if(t)form.setAttribute("target",t);else $form.removeAttr("target");
$(extraInputs).remove()}}if(s.forceSync)doSubmit();else setTimeout(doSubmit,10);var data,doc,domCheckCount=50,callbackProcessed;function cb(e){if(xhr.aborted||callbackProcessed)return;try{doc=getDoc(io)}catch(ex){log("cannot access response document: ",ex);e=SERVER_ABORT}if(e===CLIENT_TIMEOUT_ABORT&&xhr){xhr.abort("timeout");return}else if(e==SERVER_ABORT&&xhr){xhr.abort("server abort");return}if(!doc||doc.location.href==s.iframeSrc)if(!timedOut)return;io.detachEvent?io.detachEvent("onload",cb):io.removeEventListener("load",
cb,false);var status="success",errMsg;try{if(timedOut)throw"timeout";var isXml=s.dataType=="xml"||doc.XMLDocument||$.isXMLDoc(doc);log("isXml="+isXml);if(!isXml&&window.opera&&(doc.body==null||doc.body.innerHTML==""))if(--domCheckCount){log("requeing onLoad callback, DOM not available");setTimeout(cb,250);return}var docRoot=doc.body?doc.body:doc.documentElement;xhr.responseText=docRoot?docRoot.innerHTML:null;xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc;if(isXml)s.dataType="xml";xhr.getResponseHeader=
function(header){var headers={"content-type":s.dataType};return headers[header]};if(docRoot){xhr.status=Number(docRoot.getAttribute("status"))||xhr.status;xhr.statusText=docRoot.getAttribute("statusText")||xhr.statusText}var dt=s.dataType||"";var scr=/(json|script|text)/.test(dt.toLowerCase());if(scr||s.textarea){var ta=doc.getElementsByTagName("textarea")[0];if(ta){xhr.responseText=ta.value;xhr.status=Number(ta.getAttribute("status"))||xhr.status;xhr.statusText=ta.getAttribute("statusText")||xhr.statusText}else if(scr){var pre=
doc.getElementsByTagName("pre")[0];var b=doc.getElementsByTagName("body")[0];if(pre)xhr.responseText=pre.textContent?pre.textContent:pre.innerHTML;else if(b)xhr.responseText=b.innerHTML}}else if(s.dataType=="xml"&&!xhr.responseXML&&xhr.responseText!=null)xhr.responseXML=toXml(xhr.responseText);try{data=httpData(xhr,s.dataType,s)}catch(e){status="parsererror";xhr.error=errMsg=e||status}}catch(e){log("error caught: ",e);status="error";xhr.error=errMsg=e||status}if(xhr.aborted){log("upload aborted");
status=null}if(xhr.status)status=xhr.status>=200&&xhr.status<300||xhr.status===304?"success":"error";if(status==="success"){s.success&&s.success.call(s.context,data,"success",xhr);g&&$.event.trigger("ajaxSuccess",[xhr,s])}else if(status){if(errMsg==undefined)errMsg=xhr.statusText;s.error&&s.error.call(s.context,xhr,status,errMsg);g&&$.event.trigger("ajaxError",[xhr,s,errMsg])}g&&$.event.trigger("ajaxComplete",[xhr,s]);if(g&&!--$.active)$.event.trigger("ajaxStop");s.complete&&s.complete.call(s.context,
xhr,status);callbackProcessed=true;if(s.timeout)clearTimeout(timeoutHandle);setTimeout(function(){if(!s.iframeTarget)$io.remove();xhr.responseXML=null},100)}var toXml=$.parseXML||function(s,doc){if(window.ActiveXObject){doc=new ActiveXObject("Microsoft.XMLDOM");doc.async="false";doc.loadXML(s)}else doc=(new DOMParser).parseFromString(s,"text/xml");return doc&&doc.documentElement&&doc.documentElement.nodeName!="parsererror"?doc:null};var parseJSON=$.parseJSON||function(s){return window["eval"]("("+
s+")")};var httpData=function(xhr,type,s){var ct=xhr.getResponseHeader("content-type")||"",xml=type==="xml"||!type&&ct.indexOf("xml")>=0,data=xml?xhr.responseXML:xhr.responseText;if(xml&&data.documentElement.nodeName==="parsererror")$.error&&$.error("parsererror");if(s&&s.dataFilter)data=s.dataFilter(data,type);if(typeof data==="string")if(type==="json"||!type&&ct.indexOf("json")>=0)data=parseJSON(data);else if(type==="script"||!type&&ct.indexOf("javascript")>=0)$.globalEval(data);return data}}};
$.fn.ajaxForm=function(options){if(this.length===0){var o={s:this.selector,c:this.context};if(!$.isReady&&o.s){log("DOM not ready, queuing ajaxForm");$(function(){$(o.s,o.c).ajaxForm(options)});return this}log("terminating; zero elements found by selector"+($.isReady?"":" (DOM not ready)"));return this}return this.ajaxFormUnbind().bind("submit.form-plugin",function(e){if(!e.isDefaultPrevented()){e.preventDefault();$(this).ajaxSubmit(options)}}).bind("click.form-plugin",function(e){var target=e.target;
var $el=$(target);if(!$el.is(":submit,input:image")){var t=$el.closest(":submit");if(t.length==0)return;target=t[0]}var form=this;form.clk=target;if(target.type=="image")if(e.offsetX!=undefined){form.clk_x=e.offsetX;form.clk_y=e.offsetY}else if(typeof $.fn.offset=="function"){var offset=$el.offset();form.clk_x=e.pageX-offset.left;form.clk_y=e.pageY-offset.top}else{form.clk_x=e.pageX-target.offsetLeft;form.clk_y=e.pageY-target.offsetTop}setTimeout(function(){form.clk=form.clk_x=form.clk_y=null},100)})};
$.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};$.fn.formToArray=function(semantic){var a=[];if(this.length===0)return a;var form=this[0];var els=semantic?form.getElementsByTagName("*"):form.elements;if(!els)return a;var i,j,n,v,el,max,jmax;for(i=0,max=els.length;i<max;i++){el=els[i];n=el.name;if(!n)continue;if(semantic&&form.clk&&el.type=="image"){if(!el.disabled&&form.clk==el){a.push({name:n,value:$(el).val()});a.push({name:n+".x",value:form.clk_x},{name:n+
".y",value:form.clk_y})}continue}v=$.fieldValue(el,true);if(v&&v.constructor==Array)for(j=0,jmax=v.length;j<jmax;j++)a.push({name:n,value:v[j]});else if(v!==null&&typeof v!="undefined")a.push({name:n,value:v})}if(!semantic&&form.clk){var $input=$(form.clk),input=$input[0];n=input.name;if(n&&!input.disabled&&input.type=="image"){a.push({name:n,value:$input.val()});a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y})}}return a};$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic))};
$.fn.fieldSerialize=function(successful){var a=[];this.each(function(){var n=this.name;if(!n)return;var v=$.fieldValue(this,successful);if(v&&v.constructor==Array)for(var i=0,max=v.length;i<max;i++)a.push({name:n,value:v[i]});else if(v!==null&&typeof v!="undefined")a.push({name:this.name,value:v})});return $.param(a)};$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;i<max;i++){var el=this[i];var v=$.fieldValue(el,successful);if(v===null||typeof v=="undefined"||v.constructor==
Array&&!v.length)continue;v.constructor==Array?$.merge(val,v):val.push(v)}return val};$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(successful===undefined)successful=true;if(successful&&(!n||el.disabled||t=="reset"||t=="button"||(t=="checkbox"||t=="radio")&&!el.checked||(t=="submit"||t=="image")&&el.form&&el.form.clk!=el||tag=="select"&&el.selectedIndex==-1))return null;if(tag=="select"){var index=el.selectedIndex;if(index<0)return null;var a=[],ops=
el.options;var one=t=="select-one";var max=one?index+1:ops.length;for(var i=one?index:0;i<max;i++){var op=ops[i];if(op.selected){var v=op.value;if(!v)v=op.attributes&&op.attributes["value"]&&!op.attributes["value"].specified?op.text:op.value;if(one)return v;a.push(v)}}return a}return $(el).val()};$.fn.clearForm=function(){return this.each(function(){$("input,select,textarea",this).clearFields()})};$.fn.clearFields=$.fn.clearInputs=function(){var re=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;
return this.each(function(){var t=this.type,tag=this.tagName.toLowerCase();if(re.test(t)||tag=="textarea")this.value="";else if(t=="checkbox"||t=="radio")this.checked=false;else if(tag=="select")this.selectedIndex=-1})};$.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)this.reset()})};$.fn.enable=function(b){if(b===undefined)b=true;return this.each(function(){this.disabled=!b})};$.fn.selected=function(select){if(select===
undefined)select=true;return this.each(function(){var t=this.type;if(t=="checkbox"||t=="radio")this.checked=select;else if(this.tagName.toLowerCase()=="option"){var $sel=$(this).parent("select");if(select&&$sel[0]&&$sel[0].type=="select-one")$sel.find("option").selected(false);this.selected=select}})};function log(){var msg="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log)window.console.log(msg);else if(window.opera&&window.opera.postError)window.opera.postError(msg)}
})(jQuery);
(function($){$.extend($.fn,{validate:function(options){if(!this.length){options&&options.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");return}var validator=$.data(this[0],"validator");if(validator)return validator;validator=new $.validator(options,this[0]);$.data(this[0],"validator",validator);if(validator.settings.onsubmit){this.find("input, button").filter(".cancel").click(function(){validator.cancelSubmit=true});if(validator.settings.submitHandler)this.find("input, button").filter(":submit").click(function(){validator.submitButton=this});
this.submit(function(event){if(validator.settings.debug)event.preventDefault();function handle(){if(validator.settings.submitHandler){if(validator.submitButton)var hidden=$("<input type='hidden'/>").attr("name",validator.submitButton.name).val(validator.submitButton.value).appendTo(validator.currentForm);validator.settings.submitHandler.call(validator,validator.currentForm);if(validator.submitButton)hidden.remove();return false}return true}if(validator.cancelSubmit){validator.cancelSubmit=false;return handle()}if(validator.form()){if(validator.pendingRequest){validator.formSubmitted=
true;return false}return handle()}else{validator.focusInvalid();return false}})}return validator},valid:function(){if($(this[0]).is("form"))return this.validate().form();else{var valid=true;var validator=$(this[0].form).validate();this.each(function(){valid&=validator.element(this)});return valid}},removeAttrs:function(attributes){var result={},$element=this;$.each(attributes.split(/\s/),function(index,value){result[value]=$element.attr(value);$element.removeAttr(value)});return result},rules:function(command,
argument){var element=this[0];if(command){var settings=$.data(element.form,"validator").settings;var staticRules=settings.rules;var existingRules=$.validator.staticRules(element);switch(command){case "add":$.extend(existingRules,$.validator.normalizeRule(argument));staticRules[element.name]=existingRules;if(argument.messages)settings.messages[element.name]=$.extend(settings.messages[element.name],argument.messages);break;case "remove":if(!argument){delete staticRules[element.name];return existingRules}var filtered=
{};$.each(argument.split(/\s/),function(index,method){filtered[method]=existingRules[method];delete existingRules[method]});return filtered}}var data=$.validator.normalizeRules($.extend({},$.validator.metadataRules(element),$.validator.classRules(element),$.validator.attributeRules(element),$.validator.staticRules(element)),element);if(data.required){var param=data.required;delete data.required;data=$.extend({required:param},data)}return data}});$.extend($.expr[":"],{blank:function(a){return!$.trim(""+
a.value)},filled:function(a){return!!$.trim(""+a.value)},unchecked:function(a){return!a.checked}});$.validator=function(options,form){this.settings=$.extend(true,{},$.validator.defaults,options);this.currentForm=form;this.init()};$.validator.format=function(source,params){if(arguments.length==1)return function(){var args=$.makeArray(arguments);args.unshift(source);return $.validator.format.apply(this,args)};if(arguments.length>2&&params.constructor!=Array)params=$.makeArray(arguments).slice(1);if(params.constructor!=
Array)params=[params];$.each(params,function(i,n){source=source.replace(new RegExp("\\{"+i+"\\}","g"),n)});return source};$.extend($.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:true,errorContainer:$([]),errorLabelContainer:$([]),onsubmit:true,ignore:[],ignoreTitle:false,onfocusin:function(element){this.lastActive=element;if(this.settings.focusCleanup&&!this.blockFocusCleanup){this.settings.unhighlight&&this.settings.unhighlight.call(this,
element,this.settings.errorClass,this.settings.validClass);this.addWrapper(this.errorsFor(element)).hide()}},onfocusout:function(element){if(!this.checkable(element)&&(element.name in this.submitted||!this.optional(element)))this.element(element)},onkeyup:function(element){if(element.name in this.submitted||element==this.lastElement)this.element(element)},onclick:function(element){if(element.name in this.submitted)this.element(element);else if(element.parentNode.name in this.submitted)this.element(element.parentNode)},
highlight:function(element,errorClass,validClass){if(element.type==="radio")this.findByName(element.name).addClass(errorClass).removeClass(validClass);else $(element).addClass(errorClass).removeClass(validClass)},unhighlight:function(element,errorClass,validClass){if(element.type==="radio")this.findByName(element.name).removeClass(errorClass).addClass(validClass);else $(element).removeClass(errorClass).addClass(validClass)}},setDefaults:function(settings){$.extend($.validator.defaults,settings)},
messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:$.validator.format("Please enter no more than {0} characters."),
minlength:$.validator.format("Please enter at least {0} characters."),rangelength:$.validator.format("Please enter a value between {0} and {1} characters long."),range:$.validator.format("Please enter a value between {0} and {1}."),max:$.validator.format("Please enter a value less than or equal to {0}."),min:$.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:false,prototype:{init:function(){this.labelContainer=$(this.settings.errorLabelContainer);this.errorContext=
this.labelContainer.length&&this.labelContainer||$(this.currentForm);this.containers=$(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var groups=this.groups={};$.each(this.settings.groups,function(key,value){$.each(value.split(/\s/),function(index,name){groups[name]=key})});var rules=this.settings.rules;$.each(rules,function(key,value){rules[key]=$.validator.normalizeRule(value)});
function delegate(event){var validator=$.data(this[0].form,"validator"),eventType="on"+event.type.replace(/^validate/,"");validator.settings[eventType]&&validator.settings[eventType].call(validator,this[0])}$(this.currentForm).validateDelegate(":text, :password, :file, select, textarea","focusin focusout keyup",delegate).validateDelegate(":radio, :checkbox, select, option","click",delegate);if(this.settings.invalidHandler)$(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},
form:function(){this.checkForm();$.extend(this.submitted,this.errorMap);this.invalid=$.extend({},this.errorMap);if(!this.valid())$(this.currentForm).triggerHandler("invalid-form",[this]);this.showErrors();return this.valid()},checkForm:function(){this.prepareForm();for(var i=0,elements=this.currentElements=this.elements();elements[i];i++)this.check(elements[i]);return this.valid()},element:function(element){element=this.clean(element);this.lastElement=element;this.prepareElement(element);this.currentElements=
$(element);var result=this.check(element);if(result)delete this.invalid[element.name];else this.invalid[element.name]=true;if(!this.numberOfInvalids())this.toHide=this.toHide.add(this.containers);this.showErrors();return result},showErrors:function(errors){if(errors){$.extend(this.errorMap,errors);this.errorList=[];for(var name in errors)this.errorList.push({message:errors[name],element:this.findByName(name)[0]});this.successList=$.grep(this.successList,function(element){return!(element.name in errors)})}this.settings.showErrors?
this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){if($.fn.resetForm)$(this.currentForm).resetForm();this.submitted={};this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(obj){var count=0;for(var i in obj)count++;return count},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return this.size()==
0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{$(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(e){}},findLastActive:function(){var lastActive=this.lastActive;return lastActive&&$.grep(this.errorList,function(n){return n.element.name==lastActive.name}).length==1&&lastActive},elements:function(){var validator=this,rulesCache={};return $(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&
validator.settings.debug&&window.console&&console.error("%o has no name assigned",this);if(this.name in rulesCache||!validator.objectLength($(this).rules()))return false;rulesCache[this.name]=true;return true})},clean:function(selector){return $(selector)[0]},errors:function(){return $(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=$([]);this.toHide=$([]);this.currentElements=$([])},prepareForm:function(){this.reset();
this.toHide=this.errors().add(this.containers)},prepareElement:function(element){this.reset();this.toHide=this.errorsFor(element)},check:function(element){element=this.clean(element);if(this.checkable(element))element=this.findByName(element.name).not(this.settings.ignore)[0];var rules=$(element).rules();var dependencyMismatch=false;for(var method in rules){var rule={method:method,parameters:rules[method]};try{var result=$.validator.methods[method].call(this,element.value.replace(/\r/g,""),element,
rule.parameters);if(result=="dependency-mismatch"){dependencyMismatch=true;continue}dependencyMismatch=false;if(result=="pending"){this.toHide=this.toHide.not(this.errorsFor(element));return}if(!result){this.formatAndAdd(element,rule);return false}}catch(e){this.settings.debug&&window.console&&console.log("exception occured when checking element "+element.id+", check the '"+rule.method+"' method",e);throw e;}}if(dependencyMismatch)return;if(this.objectLength(rules))this.successList.push(element);
return true},customMetaMessage:function(element,method){if(!$.metadata)return;var meta=this.settings.meta?$(element).metadata()[this.settings.meta]:$(element).metadata();return meta&&meta.messages&&meta.messages[method]},customMessage:function(name,method){var m=this.settings.messages[name];return m&&(m.constructor==String?m:m[method])},findDefined:function(){for(var i=0;i<arguments.length;i++)if(arguments[i]!==undefined)return arguments[i];return undefined},defaultMessage:function(element,method){return this.findDefined(this.customMessage(element.name,
method),this.customMetaMessage(element,method),!this.settings.ignoreTitle&&element.title||undefined,$.validator.messages[method],"<strong>Warning: No message defined for "+element.name+"</strong>")},formatAndAdd:function(element,rule){var message=this.defaultMessage(element,rule.method),theregex=/\$?\{(\d+)\}/g;if(typeof message=="function")message=message.call(this,rule.parameters,element);else if(theregex.test(message))message=jQuery.format(message.replace(theregex,"{$1}"),rule.parameters);this.errorList.push({message:message,
element:element});this.errorMap[element.name]=message;this.submitted[element.name]=message},addWrapper:function(toToggle){if(this.settings.wrapper)toToggle=toToggle.add(toToggle.parent(this.settings.wrapper));return toToggle},defaultShowErrors:function(){for(var i=0;this.errorList[i];i++){var error=this.errorList[i];this.settings.highlight&&this.settings.highlight.call(this,error.element,this.settings.errorClass,this.settings.validClass);this.showLabel(error.element,error.message)}if(this.errorList.length)this.toShow=
this.toShow.add(this.containers);if(this.settings.success)for(var i=0;this.successList[i];i++)this.showLabel(this.successList[i]);if(this.settings.unhighlight)for(var i=0,elements=this.validElements();elements[i];i++)this.settings.unhighlight.call(this,elements[i],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return $(this.errorList).map(function(){return this.element})},
showLabel:function(element,message){var label=this.errorsFor(element);if(label.length){label.removeClass().addClass(this.settings.errorClass);label.attr("generated")&&label.html(message)}else{label=$("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(element),generated:true}).addClass(this.settings.errorClass).html(message||"");if(this.settings.wrapper)label=label.hide().show().wrap("<"+this.settings.wrapper+"/>").parent();if(!this.labelContainer.append(label).length)this.settings.errorPlacement?
this.settings.errorPlacement(label,$(element)):label.insertAfter(element)}if(!message&&this.settings.success){label.text("");typeof this.settings.success=="string"?label.addClass(this.settings.success):this.settings.success(label)}this.toShow=this.toShow.add(label)},errorsFor:function(element){var name=this.idOrName(element);return this.errors().filter(function(){return $(this).attr("for")==name})},idOrName:function(element){return this.groups[element.name]||(this.checkable(element)?element.name:
element.id||element.name)},checkable:function(element){return/radio|checkbox/i.test(element.type)},findByName:function(name){var form=this.currentForm;return $(document.getElementsByName(name)).map(function(index,element){return element.form==form&&element.name==name&&element||null})},getLength:function(value,element){switch(element.nodeName.toLowerCase()){case "select":return $("option:selected",element).length;case "input":if(this.checkable(element))return this.findByName(element.name).filter(":checked").length}return value.length},
depend:function(param,element){return this.dependTypes[typeof param]?this.dependTypes[typeof param](param,element):true},dependTypes:{"boolean":function(param,element){return param},"string":function(param,element){return!!$(param,element.form).length},"function":function(param,element){return param(element)}},optional:function(element){return!$.validator.methods.required.call(this,$.trim(element.value),element)&&"dependency-mismatch"},startRequest:function(element){if(!this.pending[element.name]){this.pendingRequest++;
this.pending[element.name]=true}},stopRequest:function(element,valid){this.pendingRequest--;if(this.pendingRequest<0)this.pendingRequest=0;delete this.pending[element.name];if(valid&&this.pendingRequest==0&&this.formSubmitted&&this.form()){$(this.currentForm).submit();this.formSubmitted=false}else if(!valid&&this.pendingRequest==0&&this.formSubmitted){$(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=false}},previousValue:function(element){return $.data(element,"previousValue")||
$.data(element,"previousValue",{old:null,valid:true,message:this.defaultMessage(element,"remote")})}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},dateDE:{dateDE:true},number:{number:true},numberDE:{numberDE:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(className,rules){className.constructor==String?this.classRuleSettings[className]=rules:$.extend(this.classRuleSettings,className)},classRules:function(element){var rules=
{};var classes=$(element).attr("class");classes&&$.each(classes.split(" "),function(){if(this in $.validator.classRuleSettings)$.extend(rules,$.validator.classRuleSettings[this])});return rules},attributeRules:function(element){var rules={};var $element=$(element);for(var method in $.validator.methods){var value=$element.attr(method);if(value)rules[method]=value}if(rules.maxlength&&/-1|2147483647|524288/.test(rules.maxlength))delete rules.maxlength;return rules},metadataRules:function(element){if(!$.metadata)return{};
var meta=$.data(element.form,"validator").settings.meta;return meta?$(element).metadata()[meta]:$(element).metadata()},staticRules:function(element){var rules={};var validator=$.data(element.form,"validator");if(validator.settings.rules)rules=$.validator.normalizeRule(validator.settings.rules[element.name])||{};return rules},normalizeRules:function(rules,element){$.each(rules,function(prop,val){if(val===false){delete rules[prop];return}if(val.param||val.depends){var keepRule=true;switch(typeof val.depends){case "string":keepRule=
!!$(val.depends,element.form).length;break;case "function":keepRule=val.depends.call(element,element);break}if(keepRule)rules[prop]=val.param!==undefined?val.param:true;else delete rules[prop]}});$.each(rules,function(rule,parameter){rules[rule]=$.isFunction(parameter)?parameter(element):parameter});$.each(["minlength","maxlength","min","max"],function(){if(rules[this])rules[this]=Number(rules[this])});$.each(["rangelength","range"],function(){if(rules[this])rules[this]=[Number(rules[this][0]),Number(rules[this][1])]});
if($.validator.autoCreateRanges){if(rules.min&&rules.max){rules.range=[rules.min,rules.max];delete rules.min;delete rules.max}if(rules.minlength&&rules.maxlength){rules.rangelength=[rules.minlength,rules.maxlength];delete rules.minlength;delete rules.maxlength}}if(rules.messages)delete rules.messages;return rules},normalizeRule:function(data){if(typeof data=="string"){var transformed={};$.each(data.split(/\s/),function(){transformed[this]=true});data=transformed}return data},addMethod:function(name,
method,message){$.validator.methods[name]=method;$.validator.messages[name]=message!=undefined?message:$.validator.messages[name];if(method.length<3)$.validator.addClassRules(name,$.validator.normalizeRule(name))},methods:{required:function(value,element,param){if(!this.depend(param,element))return"dependency-mismatch";switch(element.nodeName.toLowerCase()){case "select":var val=$(element).val();return val&&val.length>0;case "input":if(this.checkable(element))return this.getLength(value,element)>
0;default:return $.trim(value).length>0}},remote:function(value,element,param){if(this.optional(element))return"dependency-mismatch";var previous=this.previousValue(element);if(!this.settings.messages[element.name])this.settings.messages[element.name]={};previous.originalMessage=this.settings.messages[element.name].remote;this.settings.messages[element.name].remote=previous.message;param=typeof param=="string"&&{url:param}||param;if(this.pending[element.name])return"pending";if(previous.old===value)return previous.valid;
previous.old=value;var validator=this;this.startRequest(element);var data={};data[element.name]=value;$.ajax($.extend(true,{url:param,mode:"abort",port:"validate"+element.name,dataType:"json",data:data,success:function(response){validator.settings.messages[element.name].remote=previous.originalMessage;var valid=response===true;if(valid){var submitted=validator.formSubmitted;validator.prepareElement(element);validator.formSubmitted=submitted;validator.successList.push(element);validator.showErrors()}else{var errors=
{};var message=response||validator.defaultMessage(element,"remote");errors[element.name]=previous.message=$.isFunction(message)?message(value):message;validator.showErrors(errors)}previous.valid=valid;validator.stopRequest(element,valid)}},param));return"pending"},minlength:function(value,element,param){return this.optional(element)||this.getLength($.trim(value),element)>=param},maxlength:function(value,element,param){return this.optional(element)||this.getLength($.trim(value),element)<=param},rangelength:function(value,
element,param){var length=this.getLength($.trim(value),element);return this.optional(element)||length>=param[0]&&length<=param[1]},min:function(value,element,param){return this.optional(element)||value>=param},max:function(value,element,param){return this.optional(element)||value<=param},range:function(value,element,param){return this.optional(element)||value>=param[0]&&value<=param[1]},email:function(value,element){return this.optional(element)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(value)},
url:function(value,element){return this.optional(element)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(value)},
date:function(value,element){return this.optional(element)||!/Invalid|NaN/.test(new Date(value))},dateISO:function(value,element){return this.optional(element)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(value)},number:function(value,element){return this.optional(element)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(value)},digits:function(value,element){return this.optional(element)||/^\d+$/.test(value)},creditcard:function(value,element){if(this.optional(element))return"dependency-mismatch";if(/[^0-9-]+/.test(value))return false;
var nCheck=0,nDigit=0,bEven=false;value=value.replace(/\D/g,"");for(var n=value.length-1;n>=0;n--){var cDigit=value.charAt(n);var nDigit=parseInt(cDigit,10);if(bEven)if((nDigit*=2)>9)nDigit-=9;nCheck+=nDigit;bEven=!bEven}return nCheck%10==0},accept:function(value,element,param){param=typeof param=="string"?param.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(element)||value.match(new RegExp(".("+param+")$","i"))},equalTo:function(value,element,param){var target=$(param).unbind(".validate-equalTo").bind("blur.validate-equalTo",
function(){$(element).valid()});return value==target.val()}}});$.format=$.validator.format})(jQuery);
(function($){var pendingRequests={};if($.ajaxPrefilter)$.ajaxPrefilter(function(settings,_,xhr){var port=settings.port;if(settings.mode=="abort"){if(pendingRequests[port])pendingRequests[port].abort();pendingRequests[port]=xhr}});else{var ajax=$.ajax;$.ajax=function(settings){var mode=("mode"in settings?settings:$.ajaxSettings).mode,port=("port"in settings?settings:$.ajaxSettings).port;if(mode=="abort"){if(pendingRequests[port])pendingRequests[port].abort();return pendingRequests[port]=ajax.apply(this,
arguments)}return ajax.apply(this,arguments)}}})(jQuery);
(function($){if(!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener)$.each({focus:"focusin",blur:"focusout"},function(original,fix){$.event.special[fix]={setup:function(){this.addEventListener(original,handler,true)},teardown:function(){this.removeEventListener(original,handler,true)},handler:function(e){arguments[0]=$.event.fix(e);arguments[0].type=fix;return $.event.handle.apply(this,arguments)}};function handler(e){e=$.event.fix(e);e.type=fix;return $.event.handle.call(this,
e)}});$.extend($.fn,{validateDelegate:function(delegate,type,handler){return this.bind(type,function(event){var target=$(event.target);if(target.is(delegate))return handler.apply(target,arguments)})}})})(jQuery);
(function($,window){"$:nomunge";var undefined,aps=Array.prototype.slice,decode=decodeURIComponent,jq_param=$.param,jq_param_fragment,jq_deparam,jq_deparam_fragment,jq_bbq=$.bbq=$.bbq||{},jq_bbq_pushState,jq_bbq_getState,jq_elemUrlAttr,jq_event_special=$.event.special,str_hashchange="hashchange",str_querystring="querystring",str_fragment="fragment",str_elemUrlAttr="elemUrlAttr",str_location="location",str_href="href",str_src="src",re_trim_querystring=/^.*\?|#.*$/g,re_trim_fragment=/^.*\#/,re_no_escape,
elemUrlAttr_cache={};function is_string(arg){return typeof arg==="string"}function curry(func){var args=aps.call(arguments,1);return function(){return func.apply(this,args.concat(aps.call(arguments)))}}function get_fragment(url){return url.replace(/^[^#]*#?(.*)$/,"$1")}function get_querystring(url){return url.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function jq_param_sub(is_fragment,get_func,url,params,merge_mode){var result,qs,matches,url_params,hash;if(params!==undefined){matches=url.match(is_fragment?
/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/);hash=matches[3]||"";if(merge_mode===2&&is_string(params))qs=params.replace(is_fragment?re_trim_fragment:re_trim_querystring,"");else{url_params=jq_deparam(matches[2]);params=is_string(params)?jq_deparam[is_fragment?str_fragment:str_querystring](params):params;qs=merge_mode===2?params:merge_mode===1?$.extend({},params,url_params):$.extend({},url_params,params);qs=jq_param(qs);if(is_fragment)qs=qs.replace(re_no_escape,decode)}result=matches[1]+(is_fragment?
"#":qs||!matches[1]?"?":"")+qs+hash}else result=get_func(url!==undefined?url:window[str_location][str_href]);return result}jq_param[str_querystring]=curry(jq_param_sub,0,get_querystring);jq_param[str_fragment]=jq_param_fragment=curry(jq_param_sub,1,get_fragment);jq_param_fragment.noEscape=function(chars){chars=chars||"";var arr=$.map(chars.split(""),encodeURIComponent);re_no_escape=new RegExp(arr.join("|"),"g")};jq_param_fragment.noEscape(",/");$.deparam=jq_deparam=function(params,coerce){var obj=
{},coerce_types={"true":!0,"false":!1,"null":null};$.each(params.replace(/\+/g," ").split("&"),function(j,v){var param=v.split("="),key=decode(param[0]),val,cur=obj,i=0,keys=key.split("]["),keys_last=keys.length-1;if(/\[/.test(keys[0])&&/\]$/.test(keys[keys_last])){keys[keys_last]=keys[keys_last].replace(/\]$/,"");keys=keys.shift().split("[").concat(keys);keys_last=keys.length-1}else keys_last=0;if(param.length===2){val=decode(param[1]);if(coerce)val=val&&!isNaN(val)?+val:val==="undefined"?undefined:
coerce_types[val]!==undefined?coerce_types[val]:val;if(keys_last)for(;i<=keys_last;i++){key=keys[i]===""?cur.length:keys[i];cur=cur[key]=i<keys_last?cur[key]||(keys[i+1]&&isNaN(keys[i+1])?{}:[]):val}else if($.isArray(obj[key]))obj[key].push(val);else if(obj[key]!==undefined)obj[key]=[obj[key],val];else obj[key]=val}else if(key)obj[key]=coerce?undefined:""});return obj};function jq_deparam_sub(is_fragment,url_or_params,coerce){if(url_or_params===undefined||typeof url_or_params==="boolean"){coerce=
url_or_params;url_or_params=jq_param[is_fragment?str_fragment:str_querystring]()}else url_or_params=is_string(url_or_params)?url_or_params.replace(is_fragment?re_trim_fragment:re_trim_querystring,""):url_or_params;return jq_deparam(url_or_params,coerce)}jq_deparam[str_querystring]=curry(jq_deparam_sub,0);jq_deparam[str_fragment]=jq_deparam_fragment=curry(jq_deparam_sub,1);$[str_elemUrlAttr]||($[str_elemUrlAttr]=function(obj){return $.extend(elemUrlAttr_cache,obj)})({a:str_href,base:str_href,iframe:str_src,
img:str_src,input:str_src,form:"action",link:str_href,script:str_src});jq_elemUrlAttr=$[str_elemUrlAttr];function jq_fn_sub(mode,force_attr,params,merge_mode){if(!is_string(params)&&typeof params!=="object"){merge_mode=params;params=force_attr;force_attr=undefined}return this.each(function(){var that=$(this),attr=force_attr||jq_elemUrlAttr()[(this.nodeName||"").toLowerCase()]||"",url=attr&&that.attr(attr)||"";that.attr(attr,jq_param[mode](url,params,merge_mode))})}$.fn[str_querystring]=curry(jq_fn_sub,
str_querystring);$.fn[str_fragment]=curry(jq_fn_sub,str_fragment);jq_bbq.pushState=jq_bbq_pushState=function(params,merge_mode){if(is_string(params)&&/^#/.test(params)&&merge_mode===undefined)merge_mode=2;var has_args=params!==undefined,url=jq_param_fragment(window[str_location][str_href],has_args?params:{},has_args?merge_mode:2);window[str_location][str_href]=url+(/#/.test(url)?"":"#")};jq_bbq.getState=jq_bbq_getState=function(key,coerce){return key===undefined||typeof key==="boolean"?jq_deparam_fragment(key):
jq_deparam_fragment(coerce)[key]};jq_bbq.removeState=function(arr){var state={};if(arr!==undefined){state=jq_bbq_getState();$.each($.isArray(arr)?arr:arguments,function(i,v){delete state[v]})}jq_bbq_pushState(state,2)};jq_event_special[str_hashchange]=$.extend(jq_event_special[str_hashchange],{add:function(handleObj){var old_handler;function new_handler(e){var hash=e[str_fragment]=jq_param_fragment();e.getState=function(key,coerce){return key===undefined||typeof key==="boolean"?jq_deparam(hash,key):
jq_deparam(hash,coerce)[key]};old_handler.apply(this,arguments)}if($.isFunction(handleObj)){old_handler=handleObj;return new_handler}else{old_handler=handleObj.handler;handleObj.handler=new_handler}}})})(jQuery,this);
(function($,window,undefined){"$:nomunge";var fake_onhashchange,jq_event_special=$.event.special,str_location="location",str_hashchange="hashchange",str_href="href",browser=$.browser,mode=document.documentMode,is_old_ie=browser.msie&&(mode===undefined||mode<8),supports_onhashchange="on"+str_hashchange in window&&!is_old_ie;function get_fragment(url){url=url||window[str_location][str_href];return url.replace(/^[^#]*#?(.*)$/,"$1")}$[str_hashchange+"Delay"]=100;jq_event_special[str_hashchange]=$.extend(jq_event_special[str_hashchange],
{setup:function(){if(supports_onhashchange)return false;$(fake_onhashchange.start)},teardown:function(){if(supports_onhashchange)return false;$(fake_onhashchange.stop)}});fake_onhashchange=function(){var self={},timeout_id,iframe,set_history,get_history;function init(){set_history=get_history=function(val){return val};if(is_old_ie){iframe=$('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow;get_history=function(){return get_fragment(iframe.document[str_location][str_href])};
set_history=function(hash,history_hash){if(hash!==history_hash){var doc=iframe.document;doc.open().close();doc[str_location].hash="#"+hash}};set_history(get_fragment())}}self.start=function(){if(timeout_id)return;var last_hash=get_fragment();set_history||init();(function loopy(){var hash=get_fragment(),history_hash=get_history(last_hash);if(hash!==last_hash){set_history(last_hash=hash,history_hash);$(window).trigger(str_hashchange)}else if(history_hash!==last_hash)window[str_location][str_href]=window[str_location][str_href].replace(/#.*/,
"")+"#"+history_hash;timeout_id=setTimeout(loopy,$[str_hashchange+"Delay"])})()};self.stop=function(){if(!iframe){timeout_id&&clearTimeout(timeout_id);timeout_id=0}};return self}()})(jQuery,this);
(function($){var menu,shadow,trigger,content,hash,currentTarget;var defaults={menuStyle:{listStyle:"none",padding:"1px",margin:"0px",backgroundColor:"#fff",border:"1px solid #999",width:"100px"},itemStyle:{margin:"0px",color:"#000",display:"block",cursor:"default",padding:"3px",border:"1px solid #fff",backgroundColor:"transparent"},itemHoverStyle:{border:"1px solid #0a246a",backgroundColor:"#b6bdd2"},eventPosX:"pageX",eventPosY:"pageY",shadow:true,onContextMenu:null,onShowMenu:null};$.fn.contextMenu=
function(id,options){if(!menu)menu=$('<div id="jqContextMenu"></div>').hide().css({position:"absolute",zIndex:"2000"}).appendTo("body").bind("click",function(e){e.stopPropagation()});if(!shadow)shadow=$("<div></div>").css({backgroundColor:"#000",position:"absolute",opacity:0.2,zIndex:499}).appendTo("body").hide();hash=hash||[];hash.push({id:id,menuStyle:$.extend({},defaults.menuStyle,options.menuStyle||{}),itemStyle:$.extend({},defaults.itemStyle,options.itemStyle||{}),itemHoverStyle:$.extend({},
defaults.itemHoverStyle,options.itemHoverStyle||{}),bindings:options.bindings||{},shadow:options.shadow||options.shadow===false?options.shadow:defaults.shadow,onContextMenu:options.onContextMenu||defaults.onContextMenu,onShowMenu:options.onShowMenu||defaults.onShowMenu,eventPosX:options.eventPosX||defaults.eventPosX,eventPosY:options.eventPosY||defaults.eventPosY});var index=hash.length-1;var callback=function(e){var bShowContext=!!hash[index].onContextMenu?hash[index].onContextMenu(e):true;if(bShowContext)display(index,
this,e,options);return false};if(!options.noRightClick)$(this).bind("contextmenu",callback);if(options.leftClickToo||options.noRightClick)$(this).click(callback);return this};function display(index,trigger,e,options){var cur=hash[index];content=$("#"+cur.id).find("ul:first").clone(true);content.css(cur.menuStyle).find("li").css(cur.itemStyle).hover(function(){$(this).css(cur.itemHoverStyle)},function(){$(this).css(cur.itemStyle)}).find("img").css({verticalAlign:"middle",paddingRight:"2px"});menu.html(content);
if(!!cur.onShowMenu)menu=cur.onShowMenu(e,menu);$.each(cur.bindings,function(id,func){$("#"+id,menu).bind("click",function(e){hide();func(trigger,currentTarget)})});menu.css({"left":e[cur.eventPosX],"top":e[cur.eventPosY]}).show();if(cur.shadow)shadow.css({width:menu.width(),height:menu.height(),left:e.pageX+2,top:e.pageY+2}).show();$(document).one("click",hide)}function hide(){menu.hide();shadow.hide()}$.contextMenu={defaults:function(userDefaults){$.each(userDefaults,function(i,val){if(typeof val==
"object"&&defaults[i])$.extend(defaults[i],val);else defaults[i]=val})}}})(jQuery);$(function(){$("div.contextMenu").hide()});
(function($){if(/1\.(0|1|2)\.(0|1|2)/.test($.fn.jquery)||/^1.1/.test($.fn.jquery)){alert("blockUI requires jQuery v1.2.3 or later!  You are using v"+$.fn.jquery);return}$.fn._fadeIn=$.fn.fadeIn;var noOp=function(){};var mode=document.documentMode||0;var setExpr=$.browser.msie&&($.browser.version<8&&!mode||mode<8);var ie6=$.browser.msie&&/MSIE 6.0/.test(navigator.userAgent)&&!mode;$.blockUI=function(opts){install(window,opts)};$.unblockUI=function(opts){remove(window,opts)};$.growlUI=function(title,
message,timeout,onClose){var $m=$('<div class="growlUI"></div>');if(title)$m.append("<h1>"+title+"</h1>");if(message)$m.append("<h2>"+message+"</h2>");if(timeout==undefined)timeout=3E3;$.blockUI({message:$m,fadeIn:700,fadeOut:1E3,centerY:false,timeout:timeout,showOverlay:false,onUnblock:onClose,css:$.blockUI.defaults.growlCSS})};$.fn.block=function(opts){return this.unblock({fadeOut:0}).each(function(){if($.css(this,"position")=="static")this.style.position="relative";if($.browser.msie)this.style.zoom=
1;install(this,opts)})};$.fn.unblock=function(opts){return this.each(function(){remove(this,opts)})};$.blockUI.version=2.39;$.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:true,theme:false,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:0.6,cursor:"wait"},growlCSS:{width:"350px",top:"10px",
left:"",right:"10px",border:"none",padding:"5px",opacity:0.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:false,baseZ:1E3,centerX:true,centerY:true,allowBodyStretch:true,bindEvents:true,constrainTabKey:true,fadeIn:200,fadeOut:400,timeout:0,showOverlay:true,focusInput:true,applyPlatformOpacityRules:true,onBlock:null,
onUnblock:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg"};var pageBlock=null;var pageBlockEls=[];function install(el,opts){var full=el==window;var msg=opts&&opts.message!==undefined?opts.message:undefined;opts=$.extend({},$.blockUI.defaults,opts||{});opts.overlayCSS=$.extend({},$.blockUI.defaults.overlayCSS,opts.overlayCSS||{});var css=$.extend({},$.blockUI.defaults.css,opts.css||{});var themedCSS=$.extend({},$.blockUI.defaults.themedCSS,opts.themedCSS||{});msg=msg===undefined?opts.message:
msg;if(full&&pageBlock)remove(window,{fadeOut:0});if(msg&&typeof msg!="string"&&(msg.parentNode||msg.jquery)){var node=msg.jquery?msg[0]:msg;var data={};$(el).data("blockUI.history",data);data.el=node;data.parent=node.parentNode;data.display=node.style.display;data.position=node.style.position;if(data.parent)data.parent.removeChild(node)}$(el).data("blockUI.onUnblock",opts.onUnblock);var z=opts.baseZ;var lyr1=$.browser.msie||opts.forceIframe?$('<iframe class="blockUI" style="z-index:'+z++ +';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+
opts.iframeSrc+'"></iframe>'):$('<div class="blockUI" style="display:none"></div>');var lyr2=opts.theme?$('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+z++ +';display:none"></div>'):$('<div class="blockUI blockOverlay" style="z-index:'+z++ +';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>');var lyr3,s;if(opts.theme&&full)s='<div class="blockUI '+opts.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(z+10)+
';display:none;position:fixed">'+'<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(opts.title||"&nbsp;")+"</div>"+'<div class="ui-widget-content ui-dialog-content"></div>'+"</div>";else if(opts.theme)s='<div class="blockUI '+opts.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(z+10)+';display:none;position:absolute">'+'<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(opts.title||"&nbsp;")+"</div>"+'<div class="ui-widget-content ui-dialog-content"></div>'+
"</div>";else if(full)s='<div class="blockUI '+opts.blockMsgClass+' blockPage" style="z-index:'+(z+10)+';display:none;position:fixed"></div>';else s='<div class="blockUI '+opts.blockMsgClass+' blockElement" style="z-index:'+(z+10)+';display:none;position:absolute"></div>';lyr3=$(s);if(msg)if(opts.theme){lyr3.css(themedCSS);lyr3.addClass("ui-widget-content")}else lyr3.css(css);if(!opts.theme&&(!opts.applyPlatformOpacityRules||!($.browser.mozilla&&/Linux/.test(navigator.platform))))lyr2.css(opts.overlayCSS);
lyr2.css("position",full?"fixed":"absolute");if($.browser.msie||opts.forceIframe)lyr1.css("opacity",0);var layers=[lyr1,lyr2,lyr3],$par=full?$("body"):$(el);$.each(layers,function(){this.appendTo($par)});if(opts.theme&&opts.draggable&&$.fn.draggable)lyr3.draggable({handle:".ui-dialog-titlebar",cancel:"li"});var expr=setExpr&&(!$.boxModel||$("object,embed",full?null:el).length>0);if(ie6||expr){if(full&&opts.allowBodyStretch&&$.boxModel)$("html,body").css("height","100%");if((ie6||!$.boxModel)&&!full){var t=
sz(el,"borderTopWidth"),l=sz(el,"borderLeftWidth");var fixT=t?"(0 - "+t+")":0;var fixL=l?"(0 - "+l+")":0}$.each([lyr1,lyr2,lyr3],function(i,o){var s=o[0].style;s.position="absolute";if(i<2){full?s.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.boxModel?0:"+opts.quirksmodeOffsetHack+') + "px"'):s.setExpression("height",'this.parentNode.offsetHeight + "px"');full?s.setExpression("width",'jQuery.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):
s.setExpression("width",'this.parentNode.offsetWidth + "px"');if(fixL)s.setExpression("left",fixL);if(fixT)s.setExpression("top",fixT)}else if(opts.centerY){if(full)s.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"');s.marginTop=0}else if(!opts.centerY&&full){var top=opts.css&&opts.css.top?parseInt(opts.css.top):
0;var expression="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+top+') + "px"';s.setExpression("top",expression)}})}if(msg){if(opts.theme)lyr3.find(".ui-widget-content").append(msg);else lyr3.append(msg);if(msg.jquery||msg.nodeType)$(msg).show()}if(($.browser.msie||opts.forceIframe)&&opts.showOverlay)lyr1.show();if(opts.fadeIn){var cb=opts.onBlock?opts.onBlock:noOp;var cb1=opts.showOverlay&&!msg?cb:noOp;var cb2=msg?cb:noOp;if(opts.showOverlay)lyr2._fadeIn(opts.fadeIn,
cb1);if(msg)lyr3._fadeIn(opts.fadeIn,cb2)}else{if(opts.showOverlay)lyr2.show();if(msg)lyr3.show();if(opts.onBlock)opts.onBlock()}bind(1,el,opts);if(full){pageBlock=lyr3[0];pageBlockEls=$(":input:enabled:visible",pageBlock);if(opts.focusInput)setTimeout(focus,20)}else center(lyr3[0],opts.centerX,opts.centerY);if(opts.timeout){var to=setTimeout(function(){full?$.unblockUI(opts):$(el).unblock(opts)},opts.timeout);$(el).data("blockUI.timeout",to)}}function remove(el,opts){var full=el==window;var $el=
$(el);var data=$el.data("blockUI.history");var to=$el.data("blockUI.timeout");if(to){clearTimeout(to);$el.removeData("blockUI.timeout")}opts=$.extend({},$.blockUI.defaults,opts||{});bind(0,el,opts);if(opts.onUnblock===null){opts.onUnblock=$el.data("blockUI.onUnblock");$el.removeData("blockUI.onUnblock")}var els;if(full)els=$("body").children().filter(".blockUI").add("body > .blockUI");else els=$(".blockUI",el);if(full)pageBlock=pageBlockEls=null;if(opts.fadeOut){els.fadeOut(opts.fadeOut);setTimeout(function(){reset(els,
data,opts,el)},opts.fadeOut)}else reset(els,data,opts,el)}function reset(els,data,opts,el){els.each(function(i,o){if(this.parentNode)this.parentNode.removeChild(this)});if(data&&data.el){data.el.style.display=data.display;data.el.style.position=data.position;if(data.parent)data.parent.appendChild(data.el);$(el).removeData("blockUI.history")}if(typeof opts.onUnblock=="function")opts.onUnblock(el,opts)}function bind(b,el,opts){var full=el==window,$el=$(el);if(!b&&(full&&!pageBlock||!full&&!$el.data("blockUI.isBlocked")))return;
if(!full)$el.data("blockUI.isBlocked",b);if(!opts.bindEvents||b&&!opts.showOverlay)return;var events="mousedown mouseup keydown keypress";b?$(document).bind(events,opts,handler):$(document).unbind(events,handler)}function handler(e){if(e.keyCode&&e.keyCode==9)if(pageBlock&&e.data.constrainTabKey){var els=pageBlockEls;var fwd=!e.shiftKey&&e.target===els[els.length-1];var back=e.shiftKey&&e.target===els[0];if(fwd||back){setTimeout(function(){focus(back)},10);return false}}var opts=e.data;if($(e.target).parents("div."+
opts.blockMsgClass).length>0)return true;return $(e.target).parents().children().filter("div.blockUI").length==0}function focus(back){if(!pageBlockEls)return;var e=pageBlockEls[back===true?pageBlockEls.length-1:0];if(e)e.focus()}function center(el,x,y){var p=el.parentNode,s=el.style;var l=(p.offsetWidth-el.offsetWidth)/2-sz(p,"borderLeftWidth");var t=(p.offsetHeight-el.offsetHeight)/2-sz(p,"borderTopWidth");if(x)s.left=l>0?l+"px":"0";if(y)s.top=t>0?t+"px":"0"}function sz(el,p){return parseInt($.css(el,
p))||0}})(jQuery);
(function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:7,interval:100,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if(Math.abs(pX-cX)+Math.abs(pY-cY)<cfg.sensitivity){$(ob).unbind("mousemove",track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev])}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}};var delay=function(ev,
ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev])};var handleHover=function(e){var p=(e.type=="mouseover"?e.fromElement:e.toElement)||e.relatedTarget;while(p&&p!=this)try{p=p.parentNode}catch(e){p=this}if(p==this)return false;var ev=jQuery.extend({},e);var ob=this;if(ob.hoverIntent_t)ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if(e.type=="mouseover"){pX=ev.pageX;pY=ev.pageY;$(ob).bind("mousemove",track);if(ob.hoverIntent_s!=1)ob.hoverIntent_t=
setTimeout(function(){compare(ev,ob)},cfg.interval)}else{$(ob).unbind("mousemove",track);if(ob.hoverIntent_s==1)ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)}};return this.mouseover(handleHover).mouseout(handleHover)}})(jQuery);
(function($){$.fn.superfish=function(op){var sf=$.fn.superfish,c=sf.c,$arrow=$(['<span class="',c.arrowClass,'"> &#187;</span>'].join("")),over=function(){var $$=$(this),menu=getMenu($$);clearTimeout(menu.sfTimer);$$.showSuperfishUl().siblings().hideSuperfishUl()},out=function(){var $$=$(this),menu=getMenu($$),o=sf.op;clearTimeout(menu.sfTimer);menu.sfTimer=setTimeout(function(){o.retainPath=$.inArray($$[0],o.$path)>-1;$$.hideSuperfishUl();if(o.$path.length&&$$.parents(["li.",o.hoverClass].join("")).length<
1)over.call(o.$path)},o.delay)},getMenu=function($menu){var menu=$menu.parents(["ul.",c.menuClass,":first"].join(""))[0];sf.op=sf.o[menu.serial];return menu},addArrow=function($a){$a.addClass(c.anchorClass).append($arrow.clone())};return this.each(function(){var s=this.serial=sf.o.length;var o=$.extend({},sf.defaults,op);o.$path=$("li."+o.pathClass,this).slice(0,o.pathLevels).each(function(){$(this).addClass([o.hoverClass,c.bcClass].join(" ")).filter("li:has(ul)").removeClass(o.pathClass)});sf.o[s]=
sf.op=o;$("li:has(ul)",this)[$.fn.hoverIntent&&!o.disableHI?"hoverIntent":"hover"](over,out).each(function(){if(o.autoArrows)addArrow($(">a:first-child",this))}).not("."+c.bcClass).hideSuperfishUl();var $a=$("a",this);$a.each(function(i){var $li=$a.eq(i).parents("li");$a.eq(i).focus(function(){over.call($li)}).blur(function(){out.call($li)})});o.onInit.call(this)}).each(function(){var menuClasses=[c.menuClass];if(sf.op.dropShadows&&!($.browser.msie&&$.browser.version<7))menuClasses.push(c.shadowClass);
$(this).addClass(menuClasses.join(" "))})};var sf=$.fn.superfish;sf.o=[];sf.op={};sf.IE7fix=function(){var o=sf.op;if($.browser.msie&&$.browser.version>6&&o.dropShadows&&o.animation.opacity!=undefined)this.toggleClass(sf.c.shadowClass+"-off")};sf.c={bcClass:"sf-breadcrumb",menuClass:"sf-js-enabled",anchorClass:"sf-with-ul",arrowClass:"sf-sub-indicator",shadowClass:"sf-shadow"};sf.defaults={hoverClass:"sfHover",pathClass:"overideThisToUse",pathLevels:1,delay:800,animation:{opacity:"show"},speed:"normal",
autoArrows:true,dropShadows:true,disableHI:false,onInit:function(){},onBeforeShow:function(){},onShow:function(){},onHide:function(){}};$.fn.extend({hideSuperfishUl:function(){var o=sf.op,not=o.retainPath===true?o.$path:"";o.retainPath=false;var $ul=$(["li.",o.hoverClass].join(""),this).add(this).not(not).removeClass(o.hoverClass).find(">ul").hide().css("visibility","hidden");o.onHide.call($ul);return this},showSuperfishUl:function(){var o=sf.op,sh=sf.c.shadowClass+"-off",$ul=this.addClass(o.hoverClass).find(">ul:hidden").css("visibility",
"visible");sf.IE7fix.call($ul);o.onBeforeShow.call($ul);$ul.animate(o.animation,o.speed,function(){sf.IE7fix.call($ul);o.onShow.call($ul)});return this}})})(jQuery);
(function(a,b){function d(b){return!a(b).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}function c(b,c){var e=b.nodeName.toLowerCase();if("area"===e){var f=b.parentNode,g=f.name,h;if(!b.href||!g||f.nodeName.toLowerCase()!=="map")return!1;h=a("img[usemap=#"+g+"]")[0];return!!h&&d(h)}return(/input|select|textarea|button|object/.test(e)?!b.disabled:"a"==e?b.href||c:c)&&d(b)}a.ui=a.ui||{};a.ui.version||(a.extend(a.ui,{version:"1.8.17",
keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({propAttr:a.fn.prop||a.fn.attr,_focus:a.fn.focus,focus:function(b,c){return typeof b=="number"?this.each(function(){var d=
this;setTimeout(function(){a(d).focus(),c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?b=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):b=this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,
"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length){var d=a(this[0]),e,f;while(d.length&&d[0]!==document){e=d.css("position");if(e==="absolute"||e==="relative"||e==="fixed"){f=parseInt(d.css("zIndex"),10);if(!isNaN(f)&&f!==0)return f}d=d.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":
"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(c,d){function h(b,c,d,f){a.each(e,function(){c-=parseFloat(a.curCSS(b,"padding"+this,!0))||0,d&&(c-=parseFloat(a.curCSS(b,"border"+this+"Width",!0))||0),f&&(c-=parseFloat(a.curCSS(b,"margin"+this,!0))||0)});return c}var e=d==="Width"?["Left","Right"]:["Top","Bottom"],f=d.toLowerCase(),g={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,
outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){if(c===b)return g["inner"+d].call(this);return this.each(function(){a(this).css(f,h(this,c)+"px")})},a.fn["outer"+d]=function(b,c){if(typeof b!="number")return g["outer"+d].call(this,b);return this.each(function(){a(this).css(f,h(this,b,!0,c)+"px")})}}),a.extend(a.expr[":"],{data:function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,
"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),a.support.minHeight=c.offsetHeight===100,a.support.selectstart="onselectstart"in c,b.removeChild(c).style.display="none"}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e=a.ui[b].prototype;for(var f in d)e.plugins[f]=e.plugins[f]||[],e.plugins[f].push([c,d[f]])},call:function(a,b,c){var d=a.plugins[b];
if(!!d&&!!a.element[0].parentNode)for(var e=0;e<d.length;e++)a.options[d[e][0]]&&d[e][1].apply(a.element,c)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(b,c){if(a(b).css("overflow")==="hidden")return!1;var d=c&&c==="left"?"scrollLeft":"scrollTop",e=!1;if(b[d]>0)return!0;b[d]=1,e=b[d]>0,b[d]=0;return e},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(b,c,d,e,f,g){return a.ui.isOverAxis(b,d,f)&&
a.ui.isOverAxis(c,e,g)}}))})(jQuery);
(function(a,b){if(a.cleanData){var c=a.cleanData;a.cleanData=function(b){for(var d=0,e;(e=b[d])!=null;d++)try{a(e).triggerHandler("remove")}catch(f){}c(b)}}else{var d=a.fn.remove;a.fn.remove=function(b,c){return this.each(function(){c||(!b||a.filter(b,[this]).length)&&a("*",this).add([this]).each(function(){try{a(this).triggerHandler("remove")}catch(b){}});return d.call(a(this),b,c)})}}a.widget=function(b,c,d){var e=b.split(".")[0],f;b=b.split(".")[1],f=e+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][f]=
function(c){return!!a.data(c,b)},a[e]=a[e]||{},a[e][b]=function(a,b){arguments.length&&this._createWidget(a,b)};var g=new c;g.options=a.extend(!0,{},g.options),a[e][b].prototype=a.extend(!0,g,{namespace:e,widgetName:b,widgetEventPrefix:a[e][b].prototype.widgetEventPrefix||b,widgetBaseClass:f},d),a.widget.bridge(b,a[e][b])},a.widget.bridge=function(c,d){a.fn[c]=function(e){var f=typeof e=="string",g=Array.prototype.slice.call(arguments,1),h=this;e=!f&&g.length?a.extend.apply(null,[!0,e].concat(g)):
e;if(f&&e.charAt(0)==="_")return h;f?this.each(function(){var d=a.data(this,c),f=d&&a.isFunction(d[e])?d[e].apply(d,g):d;if(f!==d&&f!==b){h=f;return!1}}):this.each(function(){var b=a.data(this,c);b?b.option(e||{})._init():a.data(this,c,new d(e,this))});return h}},a.Widget=function(a,b){arguments.length&&this._createWidget(a,b)},a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(b,c){a.data(c,this.widgetName,this),this.element=a(c),this.options=
a.extend(!0,{},this.options,this._getCreateOptions(),b);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()}),this._create(),this._trigger("create"),this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+
"-disabled "+"ui-state-disabled")},widget:function(){return this.element},option:function(c,d){var e=c;if(arguments.length===0)return a.extend({},this.options);if(typeof c=="string"){if(d===b)return this.options[c];e={},e[c]=d}this._setOptions(e);return this},_setOptions:function(b){var c=this;a.each(b,function(a,b){c._setOption(a,b)});return this},_setOption:function(a,b){this.options[a]=b,a==="disabled"&&this.widget()[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled"+" "+"ui-state-disabled").attr("aria-disabled",
b);return this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(b,c,d){var e,f,g=this.options[b];d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent;if(f)for(e in f)e in c||(c[e]=f[e]);this.element.trigger(c,d);return!(a.isFunction(g)&&g.call(this.element[0],c,d)===!1||c.isDefaultPrevented())}}})(jQuery);
(function(a,b){var c=!1;a(document).mouseup(function(a){c=!1}),a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){if(!0===a.data(c.target,b.widgetName+".preventClickEvent")){a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation();return!1}}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+
this.widgetName)},_mouseDown:function(b){if(!c){this._mouseStarted&&this._mouseUp(b),this._mouseDownEvent=b;var d=this,e=b.which==1,f=typeof this.options.cancel=="string"&&b.target.nodeName?a(b.target).closest(this.options.cancel).length:!1;if(!e||f||!this._mouseCapture(b))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)){this._mouseStarted=
this._mouseStart(b)!==!1;if(!this._mouseStarted){b.preventDefault();return!0}}!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),b.preventDefault(),c=!0;return!0}},_mouseMove:function(b){if(a.browser.msie&&
!(document.documentMode>=9)&&!b.button)return this._mouseUp(b);if(this._mouseStarted){this._mouseDrag(b);return b.preventDefault()}this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b));return!this._mouseStarted},_mouseUp:function(b){a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&
(this._mouseStarted=!1,b.target==this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b));return!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(a){return this.mouseDelayMet},_mouseStart:function(a){},_mouseDrag:function(a){},_mouseStop:function(a){},_mouseCapture:function(a){return!0}})})(jQuery);
(function(a,b){a.ui=a.ui||{};var c=/left|center|right/,d=/top|center|bottom/,e="center",f={},g=a.fn.position,h=a.fn.offset;a.fn.position=function(b){if(!b||!b.of)return g.apply(this,arguments);b=a.extend({},b);var h=a(b.of),i=h[0],j=(b.collision||"flip").split(" "),k=b.offset?b.offset.split(" "):[0,0],l,m,n;i.nodeType===9?(l=h.width(),m=h.height(),n={top:0,left:0}):i.setTimeout?(l=h.width(),m=h.height(),n={top:h.scrollTop(),left:h.scrollLeft()}):i.preventDefault?(b.at="left top",l=m=0,n={top:b.of.pageY,
left:b.of.pageX}):(l=h.outerWidth(),m=h.outerHeight(),n=h.offset()),a.each(["my","at"],function(){var a=(b[this]||"").split(" ");a.length===1&&(a=c.test(a[0])?a.concat([e]):d.test(a[0])?[e].concat(a):[e,e]),a[0]=c.test(a[0])?a[0]:e,a[1]=d.test(a[1])?a[1]:e,b[this]=a}),j.length===1&&(j[1]=j[0]),k[0]=parseInt(k[0],10)||0,k.length===1&&(k[1]=k[0]),k[1]=parseInt(k[1],10)||0,b.at[0]==="right"?n.left+=l:b.at[0]===e&&(n.left+=l/2),b.at[1]==="bottom"?n.top+=m:b.at[1]===e&&(n.top+=m/2),n.left+=k[0],n.top+=
k[1];return this.each(function(){var c=a(this),d=c.outerWidth(),g=c.outerHeight(),h=parseInt(a.curCSS(this,"marginLeft",!0))||0,i=parseInt(a.curCSS(this,"marginTop",!0))||0,o=d+h+(parseInt(a.curCSS(this,"marginRight",!0))||0),p=g+i+(parseInt(a.curCSS(this,"marginBottom",!0))||0),q=a.extend({},n),r;b.my[0]==="right"?q.left-=d:b.my[0]===e&&(q.left-=d/2),b.my[1]==="bottom"?q.top-=g:b.my[1]===e&&(q.top-=g/2),f.fractions||(q.left=Math.round(q.left),q.top=Math.round(q.top)),r={left:q.left-h,top:q.top-i},
a.each(["left","top"],function(c,e){a.ui.position[j[c]]&&a.ui.position[j[c]][e](q,{targetWidth:l,targetHeight:m,elemWidth:d,elemHeight:g,collisionPosition:r,collisionWidth:o,collisionHeight:p,offset:k,my:b.my,at:b.at})}),a.fn.bgiframe&&c.bgiframe(),c.offset(a.extend(q,{using:b.using}))})},a.ui.position={fit:{left:function(b,c){var d=a(window),e=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft();b.left=e>0?b.left-e:Math.max(b.left-c.collisionPosition.left,b.left)},top:function(b,c){var d=
a(window),e=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop();b.top=e>0?b.top-e:Math.max(b.top-c.collisionPosition.top,b.top)}},flip:{left:function(b,c){if(c.at[0]!==e){var d=a(window),f=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft(),g=c.my[0]==="left"?-c.elemWidth:c.my[0]==="right"?c.elemWidth:0,h=c.at[0]==="left"?c.targetWidth:-c.targetWidth,i=-2*c.offset[0];b.left+=c.collisionPosition.left<0?g+h+i:f>0?g+h+i:0}},top:function(b,c){if(c.at[1]!==e){var d=a(window),
f=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop(),g=c.my[1]==="top"?-c.elemHeight:c.my[1]==="bottom"?c.elemHeight:0,h=c.at[1]==="top"?c.targetHeight:-c.targetHeight,i=-2*c.offset[1];b.top+=c.collisionPosition.top<0?g+h+i:f>0?g+h+i:0}}}},a.offset.setOffset||(a.offset.setOffset=function(b,c){/static/.test(a.curCSS(b,"position"))&&(b.style.position="relative");var d=a(b),e=d.offset(),f=parseInt(a.curCSS(b,"top",!0),10)||0,g=parseInt(a.curCSS(b,"left",!0),10)||0,h={top:c.top-e.top+
f,left:c.left-e.left+g};"using"in c?c.using.call(b,h):d.css(h)},a.fn.offset=function(b){var c=this[0];if(!c||!c.ownerDocument)return null;if(b)return this.each(function(){a.offset.setOffset(this,b)});return h.call(this)}),function(){var b=document.getElementsByTagName("body")[0],c=document.createElement("div"),d,e,g,h,i;d=document.createElement(b?"div":"body"),g={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},b&&jQuery.extend(g,{position:"absolute",left:"-1000px",top:"-1000px"});
for(var j in g)d.style[j]=g[j];d.appendChild(c),e=b||document.documentElement,e.insertBefore(d,e.firstChild),c.style.cssText="position: absolute; left: 10.7432222px; top: 10.432325px; height: 30px; width: 201px;",h=a(c).offset(function(a,b){return b}).offset(),d.innerHTML="",e.removeChild(d),i=h.top+h.left+(b?2E3:0),f.fractions=i>21&&i<22}()})(jQuery);
(function(a,b){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&
(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},destroy:function(){if(!!this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy();return this}},_mouseCapture:function(b){var c=this.options;if(this.helper||c.disabled||a(b.target).is(".ui-resizable-handle"))return!1;
this.handle=this._getHandle(b);if(!this.handle)return!1;c.iframeFix&&a(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(a(this).offset()).appendTo("body")});return!0},_mouseStart:function(b){var c=this.options;this.helper=this._createHelper(b),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=
this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,
this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),c.containment&&this._setContainment();if(this._trigger("start",b)===!1){this._clear();return!1}this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.helper.addClass("ui-draggable-dragging"),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b);return!0},_mouseDrag:function(b,c){this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute");
if(!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1){this._mouseUp({});return!1}this.position=d.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";a.ui.ddmanager&&a.ui.ddmanager.drag(this,b);return!1},_mouseStop:function(b){var c=!1;a.ui.ddmanager&&!this.options.dropBehaviour&&(c=a.ui.ddmanager.drop(this,b)),this.dropped&&(c=this.dropped,this.dropped=
!1);if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return!1;if(this.options.revert=="invalid"&&!c||this.options.revert=="valid"&&c||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,c)){var d=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){d._trigger("stop",b)!==!1&&d._clear()})}else this._trigger("stop",b)!==!1&&this._clear();return!1},_mouseUp:function(b){this.options.iframeFix===
!0&&a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b);return a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(b){var c=!this.options.handle||!a(this.options.handle,this.element).length?!0:!1;a(this.options.handle,this.element).find("*").andSelf().each(function(){this==b.target&&(c=!0)});return c},_createHelper:function(b){var c=
this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):c.helper=="clone"?this.element.clone().removeAttr("id"):this.element;d.parents("body").length||d.appendTo(c.appendTo=="parent"?this.element[0].parentNode:c.appendTo),d[0]!=this.element[0]&&!/(fixed|absolute)/.test(d.css("position"))&&d.css("position","absolute");return d},_adjustOffsetFromHelper:function(b){typeof b=="string"&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=
b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=
this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),
10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},
_setContainment:function(){var b=this.options;b.containment=="parent"&&(b.containment=this.helper[0].parentNode);if(b.containment=="document"||b.containment=="window")this.containment=[b.containment=="document"?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,b.containment=="document"?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(b.containment=="document"?0:a(window).scrollLeft())+a(b.containment=="document"?document:window).width()-this.helperProportions.width-
this.margins.left,(b.containment=="document"?0:a(window).scrollTop())+(a(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)&&b.containment.constructor!=Array){var c=a(b.containment),d=c[0];if(!d)return;var e=c.offset(),f=a(d).css("overflow")!="hidden";this.containment=[(parseInt(a(d).css("borderLeftWidth"),10)||0)+(parseInt(a(d).css("paddingLeft"),10)||0),(parseInt(a(d).css("borderTopWidth"),
10)||0)+(parseInt(a(d).css("paddingTop"),10)||0),(f?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(a(d).css("borderLeftWidth"),10)||0)-(parseInt(a(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(f?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(a(d).css("borderTopWidth"),10)||0)-(parseInt(a(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c}else b.containment.constructor==
Array&&(this.containment=b.containment)},_convertPositionTo:function(b,c){c||(c=this.position);var d=b=="absolute"?1:-1,e=this.options,f=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=/(html|body)/i.test(f[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():
g?0:f.scrollTop())*d),left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:f.scrollLeft())*d)}},_generatePosition:function(b){var c=this.options,d=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(d[0].tagName),f=b.pageX,g=b.pageY;
if(this.originalPosition){var h;if(this.containment){if(this.relative_container){var i=this.relative_container.offset();h=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]}else h=this.containment;b.pageX-this.offset.click.left<h[0]&&(f=h[0]+this.offset.click.left),b.pageY-this.offset.click.top<h[1]&&(g=h[1]+this.offset.click.top),b.pageX-this.offset.click.left>h[2]&&(f=h[2]+this.offset.click.left),b.pageY-this.offset.click.top>h[3]&&(g=h[3]+
this.offset.click.top)}if(c.grid){var j=c.grid[1]?this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1]:this.originalPageY;g=h?j-this.offset.click.top<h[1]||j-this.offset.click.top>h[3]?j-this.offset.click.top<h[1]?j+c.grid[1]:j-c.grid[1]:j:j;var k=c.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0]:this.originalPageX;f=h?k-this.offset.click.left<h[0]||k-this.offset.click.left>h[2]?k-this.offset.click.left<h[0]?k+c.grid[0]:k-c.grid[0]:k:k}}return{top:g-
this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),
this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,d){d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),b=="drag"&&(this.positionAbs=this._convertPositionTo("absolute"));return a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(a){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.extend(a.ui.draggable,{version:"1.8.17"}),
a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[],a(e.connectToSortable).each(function(){var c=a.data(this,"sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?
(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,d.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,c){var d=a(this).data("draggable"),e=this,f=function(b){var c=this.offset.click.top,d=this.offset.click.left,
e=this.positionAbs.top,f=this.positionAbs.left,g=b.height,h=b.width,i=b.top,j=b.left;return a.ui.isOver(e+c,f+d,i,j,g,h)};a.each(d.sortables,function(f){this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",
!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,
d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&
this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(b,c){var d=a("body"),e=a(this).data("draggable").options;d.css("cursor")&&(e._cursor=d.css("cursor")),d.css("cursor",e.cursor)},stop:function(b,c){var d=a(this).data("draggable").options;d._cursor&&a("body").css("cursor",d._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("draggable").options;d.css("opacity")&&
(e._opacity=d.css("opacity")),d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(b,c){var d=a(this).data("draggable");d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"&&(d.overflowOffset=d.scrollParent.offset())},drag:function(b,c){var d=a(this).data("draggable"),e=d.options,f=!1;if(d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"){if(!e.axis||
e.axis!="x")d.overflowOffset.top+d.scrollParent[0].offsetHeight-b.pageY<e.scrollSensitivity?d.scrollParent[0].scrollTop=f=d.scrollParent[0].scrollTop+e.scrollSpeed:b.pageY-d.overflowOffset.top<e.scrollSensitivity&&(d.scrollParent[0].scrollTop=f=d.scrollParent[0].scrollTop-e.scrollSpeed);if(!e.axis||e.axis!="y")d.overflowOffset.left+d.scrollParent[0].offsetWidth-b.pageX<e.scrollSensitivity?d.scrollParent[0].scrollLeft=f=d.scrollParent[0].scrollLeft+e.scrollSpeed:b.pageX-d.overflowOffset.left<e.scrollSensitivity&&
(d.scrollParent[0].scrollLeft=f=d.scrollParent[0].scrollLeft-e.scrollSpeed)}else{if(!e.axis||e.axis!="x")b.pageY-a(document).scrollTop()<e.scrollSensitivity?f=a(document).scrollTop(a(document).scrollTop()-e.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<e.scrollSensitivity&&(f=a(document).scrollTop(a(document).scrollTop()+e.scrollSpeed));if(!e.axis||e.axis!="y")b.pageX-a(document).scrollLeft()<e.scrollSensitivity?f=a(document).scrollLeft(a(document).scrollLeft()-e.scrollSpeed):
a(window).width()-(b.pageX-a(document).scrollLeft())<e.scrollSensitivity&&(f=a(document).scrollLeft(a(document).scrollLeft()+e.scrollSpeed))}f!==!1&&a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(d,b)}}),a.ui.plugin.add("draggable","snap",{start:function(b,c){var d=a(this).data("draggable"),e=d.options;d.snapElements=[],a(e.snap.constructor!=String?e.snap.items||":data(draggable)":e.snap).each(function(){var b=a(this),c=b.offset();this!=d.element[0]&&d.snapElements.push({item:this,
width:b.outerWidth(),height:b.outerHeight(),top:c.top,left:c.left})})},drag:function(b,c){var d=a(this).data("draggable"),e=d.options,f=e.snapTolerance,g=c.offset.left,h=g+d.helperProportions.width,i=c.offset.top,j=i+d.helperProportions.height;for(var k=d.snapElements.length-1;k>=0;k--){var l=d.snapElements[k].left,m=l+d.snapElements[k].width,n=d.snapElements[k].top,o=n+d.snapElements[k].height;if(!(l-f<g&&g<m+f&&n-f<i&&i<o+f||l-f<g&&g<m+f&&n-f<j&&j<o+f||l-f<h&&h<m+f&&n-f<i&&i<o+f||l-f<h&&h<m+f&&
n-f<j&&j<o+f)){d.snapElements[k].snapping&&d.options.snap.release&&d.options.snap.release.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[k].item})),d.snapElements[k].snapping=!1;continue}if(e.snapMode!="inner"){var p=Math.abs(n-j)<=f,q=Math.abs(o-i)<=f,r=Math.abs(l-h)<=f,s=Math.abs(m-g)<=f;p&&(c.position.top=d._convertPositionTo("relative",{top:n-d.helperProportions.height,left:0}).top-d.margins.top),q&&(c.position.top=d._convertPositionTo("relative",{top:o,left:0}).top-d.margins.top),
r&&(c.position.left=d._convertPositionTo("relative",{top:0,left:l-d.helperProportions.width}).left-d.margins.left),s&&(c.position.left=d._convertPositionTo("relative",{top:0,left:m}).left-d.margins.left)}var t=p||q||r||s;if(e.snapMode!="outer"){var p=Math.abs(n-i)<=f,q=Math.abs(o-j)<=f,r=Math.abs(l-g)<=f,s=Math.abs(m-h)<=f;p&&(c.position.top=d._convertPositionTo("relative",{top:n,left:0}).top-d.margins.top),q&&(c.position.top=d._convertPositionTo("relative",{top:o-d.helperProportions.height,left:0}).top-
d.margins.top),r&&(c.position.left=d._convertPositionTo("relative",{top:0,left:l}).left-d.margins.left),s&&(c.position.left=d._convertPositionTo("relative",{top:0,left:m-d.helperProportions.width}).left-d.margins.left)}!d.snapElements[k].snapping&&(p||q||r||s||t)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[k].item})),d.snapElements[k].snapping=p||q||r||s||t}}}),a.ui.plugin.add("draggable","stack",{start:function(b,c){var d=a(this).data("draggable").options,
e=a.makeArray(a(d.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});if(!!e.length){var f=parseInt(e[0].style.zIndex)||0;a(e).each(function(a){this.style.zIndex=f+a}),this[0].style.zIndex=f+e.length}}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex")),d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("draggable").options;
d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})})(jQuery);
(function(a,b){a.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var b=this.options,c=b.accept;this.isover=0,this.isout=1,this.accept=a.isFunction(c)?c:function(a){return a.is(c)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},a.ui.ddmanager.droppables[b.scope]=a.ui.ddmanager.droppables[b.scope]||[],a.ui.ddmanager.droppables[b.scope].push(this),
b.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){var b=a.ui.ddmanager.droppables[this.options.scope];for(var c=0;c<b.length;c++)b[c]==this&&b.splice(c,1);this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(b,c){b=="accept"&&(this.accept=a.isFunction(c)?c:function(a){return a.is(c)}),a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&
this.element.addClass(this.options.activeClass),c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;!!c&&(c.currentItem||c.element)[0]!=this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",
b,this.ui(c)))},_out:function(b){var c=a.ui.ddmanager.current;!!c&&(c.currentItem||c.element)[0]!=this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(c)))},_drop:function(b,c){var d=c||a.ui.ddmanager.current;if(!d||(d.currentItem||d.element)[0]==this.element[0])return!1;var e=!1;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var b=
a.data(this,"droppable");if(b.options.greedy&&!b.options.disabled&&b.options.scope==d.options.scope&&b.accept.call(b.element[0],d.currentItem||d.element)&&a.ui.intersect(d,a.extend(b,{offset:b.element.offset()}),b.options.tolerance)){e=!0;return!1}});if(e)return!1;if(this.accept.call(this.element[0],d.currentItem||d.element)){this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",
b,this.ui(d));return this.element}return!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}}),a.extend(a.ui.droppable,{version:"1.8.17"}),a.ui.intersect=function(b,c,d){if(!c.offset)return!1;var e=(b.positionAbs||b.position.absolute).left,f=e+b.helperProportions.width,g=(b.positionAbs||b.position.absolute).top,h=g+b.helperProportions.height,i=c.offset.left,j=i+c.proportions.width,k=c.offset.top,l=k+c.proportions.height;switch(d){case "fit":return i<=
e&&f<=j&&k<=g&&h<=l;case "intersect":return i<e+b.helperProportions.width/2&&f-b.helperProportions.width/2<j&&k<g+b.helperProportions.height/2&&h-b.helperProportions.height/2<l;case "pointer":var m=(b.positionAbs||b.position.absolute).left+(b.clickOffset||b.offset.click).left,n=(b.positionAbs||b.position.absolute).top+(b.clickOffset||b.offset.click).top,o=a.ui.isOver(n,m,k,i,c.proportions.height,c.proportions.width);return o;case "touch":return(g>=k&&g<=l||h>=k&&h<=l||g<k&&h>l)&&(e>=i&&e<=j||f>=i&&
f<=j||e<i&&f>j);default:return!1}},a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(b,c){var d=a.ui.ddmanager.droppables[b.options.scope]||[],e=c?c.type:null,f=(b.currentItem||b.element).find(":data(droppable)").andSelf();droppablesLoop:for(var g=0;g<d.length;g++){if(d[g].options.disabled||b&&!d[g].accept.call(d[g].element[0],b.currentItem||b.element))continue;for(var h=0;h<f.length;h++)if(f[h]==d[g].element[0]){d[g].proportions.height=0;continue droppablesLoop}d[g].visible=
d[g].element.css("display")!="none";if(!d[g].visible)continue;e=="mousedown"&&d[g]._activate.call(d[g],c),d[g].offset=d[g].element.offset(),d[g].proportions={width:d[g].element[0].offsetWidth,height:d[g].element[0].offsetHeight}}},drop:function(b,c){var d=!1;a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){!this.options||(!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance)&&(d=this._drop.call(this,c)||d),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],
b.currentItem||b.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,c)))});return d},dragStart:function(b,c){b.element.parents(":not(body,html)").bind("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)})},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c),a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!(this.options.disabled||this.greedyChild||!this.visible)){var d=a.ui.intersect(b,this,this.options.tolerance),
e=!d&&this.isover==1?"isout":d&&this.isover==0?"isover":null;if(!e)return;var f;if(this.options.greedy){var g=this.element.parents(":data(droppable):eq(0)");g.length&&(f=a.data(g[0],"droppable"),f.greedyChild=e=="isover"?1:0)}f&&e=="isover"&&(f.isover=0,f.isout=1,f._out.call(f,c)),this[e]=1,this[e=="isout"?"isover":"isout"]=0,this[e=="isover"?"_over":"_out"].call(this,c),f&&e=="isout"&&(f.isout=0,f.isover=1,f._over.call(f,c))}})},dragStop:function(b,c){b.element.parents(":not(body,html)").unbind("scroll.droppable"),
b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)}}})(jQuery);
(function(a,b){a.widget("ui.resizable",a.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1E3},_create:function(){var b=this,c=this.options;this.element.addClass("ui-resizable"),a.extend(this,{_aspectRatio:!!c.aspectRatio,aspectRatio:c.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],
_helper:c.helper||c.ghost||c.animate?c.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(/relative/.test(this.element.css("position"))&&a.browser.opera&&this.element.css({position:"relative",top:"auto",left:"auto"}),this.element.wrap(a('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),
this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize",
"none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=c.handles||(a(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor==String){this.handles==
"all"&&(this.handles="n,e,s,w,se,sw,ne,nw");var d=this.handles.split(",");this.handles={};for(var e=0;e<d.length;e++){var f=a.trim(d[e]),g="ui-resizable-"+f,h=a('<div class="ui-resizable-handle '+g+'"></div>');/sw|se|ne|nw/.test(f)&&h.css({zIndex:++c.zIndex}),"se"==f&&h.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[f]=".ui-resizable-"+f,this.element.append(h)}}this._renderAxis=function(b){b=b||this.element;for(var c in this.handles){this.handles[c].constructor==String&&(this.handles[c]=
a(this.handles[c],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var d=a(this.handles[c],this.element),e=0;e=/sw|ne|nw|se|n|s/.test(c)?d.outerHeight():d.outerWidth();var f=["padding",/ne|nw|n/.test(c)?"Top":/se|sw|s/.test(c)?"Bottom":/^e$/.test(c)?"Right":"Left"].join("");b.css(f,e),this._proportionallyResize()}if(!a(this.handles[c]).length)continue}},this._renderAxis(this.element),this._handles=a(".ui-resizable-handle",this.element).disableSelection(),
this._handles.mouseover(function(){if(!b.resizing){if(this.className)var a=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);b.axis=a&&a[1]?a[1]:"se"}}),c.autoHide&&(this._handles.hide(),a(this.element).addClass("ui-resizable-autohide").hover(function(){c.disabled||(a(this).removeClass("ui-resizable-autohide"),b._handles.show())},function(){c.disabled||b.resizing||(a(this).addClass("ui-resizable-autohide"),b._handles.hide())})),this._mouseInit()},destroy:function(){this._mouseDestroy();
var b=function(b){a(b).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){b(this.element);var c=this.element;c.after(this.originalElement.css({position:c.css("position"),width:c.outerWidth(),height:c.outerHeight(),top:c.css("top"),left:c.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle),b(this.originalElement);return this},_mouseCapture:function(b){var c=
!1;for(var d in this.handles)a(this.handles[d])[0]==b.target&&(c=!0);return!this.options.disabled&&c},_mouseStart:function(b){var d=this.options,e=this.element.position(),f=this.element;this.resizing=!0,this.documentScroll={top:a(document).scrollTop(),left:a(document).scrollLeft()},(f.is(".ui-draggable")||/absolute/.test(f.css("position")))&&f.css({position:"absolute",top:e.top,left:e.left}),a.browser.opera&&/relative/.test(f.css("position"))&&f.css({position:"relative",top:"auto",left:"auto"}),this._renderProxy();
var g=c(this.helper.css("left")),h=c(this.helper.css("top"));d.containment&&(g+=a(d.containment).scrollLeft()||0,h+=a(d.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:g,top:h},this.size=this._helper?{width:f.outerWidth(),height:f.outerHeight()}:{width:f.width(),height:f.height()},this.originalSize=this._helper?{width:f.outerWidth(),height:f.outerHeight()}:{width:f.width(),height:f.height()},this.originalPosition={left:g,top:h},this.sizeDiff={width:f.outerWidth()-
f.width(),height:f.outerHeight()-f.height()},this.originalMousePosition={left:b.pageX,top:b.pageY},this.aspectRatio=typeof d.aspectRatio=="number"?d.aspectRatio:this.originalSize.width/this.originalSize.height||1;var i=a(".ui-resizable-"+this.axis).css("cursor");a("body").css("cursor",i=="auto"?this.axis+"-resize":i),f.addClass("ui-resizable-resizing"),this._propagate("start",b);return!0},_mouseDrag:function(b){var c=this.helper,d=this.options,e={},f=this,g=this.originalMousePosition,h=this.axis,
i=b.pageX-g.left||0,j=b.pageY-g.top||0,k=this._change[h];if(!k)return!1;var l=k.apply(this,[b,i,j]),m=a.browser.msie&&a.browser.version<7,n=this.sizeDiff;this._updateVirtualBoundaries(b.shiftKey);if(this._aspectRatio||b.shiftKey)l=this._updateRatio(l,b);l=this._respectSize(l,b),this._propagate("resize",b),c.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),
this._updateCache(l),this._trigger("resize",b,this.ui());return!1},_mouseStop:function(b){this.resizing=!1;var c=this.options,d=this;if(this._helper){var e=this._proportionallyResizeElements,f=e.length&&/textarea/i.test(e[0].nodeName),g=f&&a.ui.hasScroll(e[0],"left")?0:d.sizeDiff.height,h=f?0:d.sizeDiff.width,i={width:d.helper.width()-h,height:d.helper.height()-g},j=parseInt(d.element.css("left"),10)+(d.position.left-d.originalPosition.left)||null,k=parseInt(d.element.css("top"),10)+(d.position.top-
d.originalPosition.top)||null;c.animate||this.element.css(a.extend(i,{top:k,left:j})),d.helper.height(d.size.height),d.helper.width(d.size.width),this._helper&&!c.animate&&this._proportionallyResize()}a("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",b),this._helper&&this.helper.remove();return!1},_updateVirtualBoundaries:function(a){var b=this.options,c,e,f,g,h;h={minWidth:d(b.minWidth)?b.minWidth:0,maxWidth:d(b.maxWidth)?b.maxWidth:Infinity,
minHeight:d(b.minHeight)?b.minHeight:0,maxHeight:d(b.maxHeight)?b.maxHeight:Infinity};if(this._aspectRatio||a)c=h.minHeight*this.aspectRatio,f=h.minWidth/this.aspectRatio,e=h.maxHeight*this.aspectRatio,g=h.maxWidth/this.aspectRatio,c>h.minWidth&&(h.minWidth=c),f>h.minHeight&&(h.minHeight=f),e<h.maxWidth&&(h.maxWidth=e),g<h.maxHeight&&(h.maxHeight=g);this._vBoundaries=h},_updateCache:function(a){var b=this.options;this.offset=this.helper.offset(),d(a.left)&&(this.position.left=a.left),d(a.top)&&(this.position.top=
a.top),d(a.height)&&(this.size.height=a.height),d(a.width)&&(this.size.width=a.width)},_updateRatio:function(a,b){var c=this.options,e=this.position,f=this.size,g=this.axis;d(a.height)?a.width=a.height*this.aspectRatio:d(a.width)&&(a.height=a.width/this.aspectRatio),g=="sw"&&(a.left=e.left+(f.width-a.width),a.top=null),g=="nw"&&(a.top=e.top+(f.height-a.height),a.left=e.left+(f.width-a.width));return a},_respectSize:function(a,b){var c=this.helper,e=this._vBoundaries,f=this._aspectRatio||b.shiftKey,
g=this.axis,h=d(a.width)&&e.maxWidth&&e.maxWidth<a.width,i=d(a.height)&&e.maxHeight&&e.maxHeight<a.height,j=d(a.width)&&e.minWidth&&e.minWidth>a.width,k=d(a.height)&&e.minHeight&&e.minHeight>a.height;j&&(a.width=e.minWidth),k&&(a.height=e.minHeight),h&&(a.width=e.maxWidth),i&&(a.height=e.maxHeight);var l=this.originalPosition.left+this.originalSize.width,m=this.position.top+this.size.height,n=/sw|nw|w/.test(g),o=/nw|ne|n/.test(g);j&&n&&(a.left=l-e.minWidth),h&&n&&(a.left=l-e.maxWidth),k&&o&&(a.top=
m-e.minHeight),i&&o&&(a.top=m-e.maxHeight);var p=!a.width&&!a.height;p&&!a.left&&a.top?a.top=null:p&&!a.top&&a.left&&(a.left=null);return a},_proportionallyResize:function(){var b=this.options;if(!!this._proportionallyResizeElements.length){var c=this.helper||this.element;for(var d=0;d<this._proportionallyResizeElements.length;d++){var e=this._proportionallyResizeElements[d];if(!this.borderDif){var f=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],
g=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];this.borderDif=a.map(f,function(a,b){var c=parseInt(a,10)||0,d=parseInt(g[b],10)||0;return c+d})}if(a.browser.msie&&(!!a(c).is(":hidden")||!!a(c).parents(":hidden").length))continue;e.css({height:c.height()-this.borderDif[0]-this.borderDif[2]||0,width:c.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var b=this.element,c=this.options;this.elementOffset=b.offset();if(this._helper){this.helper=
this.helper||a('<div style="overflow:hidden;"></div>');var d=a.browser.msie&&a.browser.version<7,e=d?1:0,f=d?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+f,height:this.element.outerHeight()+f,position:"absolute",left:this.elementOffset.left-e+"px",top:this.elementOffset.top-e+"px",zIndex:++c.zIndex}),this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(a,b,c){return{width:this.originalSize.width+b}},w:function(a,b,c){var d=
this.options,e=this.originalSize,f=this.originalPosition;return{left:f.left+b,width:e.width-b}},n:function(a,b,c){var d=this.options,e=this.originalSize,f=this.originalPosition;return{top:f.top+c,height:e.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},sw:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,c,d]))},ne:function(b,
c,d){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},nw:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,c,d]))}},_propagate:function(b,c){a.ui.plugin.call(this,b,[c,this.ui()]),b!="resize"&&this._trigger(b,c,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),
a.extend(a.ui.resizable,{version:"1.8.17"}),a.ui.plugin.add("resizable","alsoResize",{start:function(b,c){var d=a(this).data("resizable"),e=d.options,f=function(b){a(b).each(function(){var b=a(this);b.data("resizable-alsoresize",{width:parseInt(b.width(),10),height:parseInt(b.height(),10),left:parseInt(b.css("left"),10),top:parseInt(b.css("top"),10),position:b.css("position")})})};typeof e.alsoResize=="object"&&!e.alsoResize.parentNode?e.alsoResize.length?(e.alsoResize=e.alsoResize[0],f(e.alsoResize)):
a.each(e.alsoResize,function(a){f(a)}):f(e.alsoResize)},resize:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d.originalSize,g=d.originalPosition,h={height:d.size.height-f.height||0,width:d.size.width-f.width||0,top:d.position.top-g.top||0,left:d.position.left-g.left||0},i=function(b,e){a(b).each(function(){var b=a(this),f=a(this).data("resizable-alsoresize"),g={},i=e&&e.length?e:b.parents(c.originalElement[0]).length?["width","height"]:["width","height","top","left"];a.each(i,function(a,
b){var c=(f[b]||0)+(h[b]||0);c&&c>=0&&(g[b]=c||null)}),a.browser.opera&&/relative/.test(b.css("position"))&&(d._revertToRelativePosition=!0,b.css({position:"absolute",top:"auto",left:"auto"})),b.css(g)})};typeof e.alsoResize=="object"&&!e.alsoResize.nodeType?a.each(e.alsoResize,function(a,b){i(a,b)}):i(e.alsoResize)},stop:function(b,c){var d=a(this).data("resizable"),e=d.options,f=function(b){a(b).each(function(){var b=a(this);b.css({position:b.data("resizable-alsoresize").position})})};d._revertToRelativePosition&&
(d._revertToRelativePosition=!1,typeof e.alsoResize=="object"&&!e.alsoResize.nodeType?a.each(e.alsoResize,function(a){f(a)}):f(e.alsoResize)),a(this).removeData("resizable-alsoresize")}}),a.ui.plugin.add("resizable","animate",{stop:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d._proportionallyResizeElements,g=f.length&&/textarea/i.test(f[0].nodeName),h=g&&a.ui.hasScroll(f[0],"left")?0:d.sizeDiff.height,i=g?0:d.sizeDiff.width,j={width:d.size.width-i,height:d.size.height-h},k=parseInt(d.element.css("left"),
10)+(d.position.left-d.originalPosition.left)||null,l=parseInt(d.element.css("top"),10)+(d.position.top-d.originalPosition.top)||null;d.element.animate(a.extend(j,l&&k?{top:l,left:k}:{}),{duration:e.animateDuration,easing:e.animateEasing,step:function(){var c={width:parseInt(d.element.css("width"),10),height:parseInt(d.element.css("height"),10),top:parseInt(d.element.css("top"),10),left:parseInt(d.element.css("left"),10)};f&&f.length&&a(f[0]).css({width:c.width,height:c.height}),d._updateCache(c),
d._propagate("resize",b)}})}}),a.ui.plugin.add("resizable","containment",{start:function(b,d){var e=a(this).data("resizable"),f=e.options,g=e.element,h=f.containment,i=h instanceof a?h.get(0):/parent/.test(h)?g.parent().get(0):h;if(!!i){e.containerElement=a(i);if(/document/.test(h)||h==document)e.containerOffset={left:0,top:0},e.containerPosition={left:0,top:0},e.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight};
else{var j=a(i),k=[];a(["Top","Right","Left","Bottom"]).each(function(a,b){k[a]=c(j.css("padding"+b))}),e.containerOffset=j.offset(),e.containerPosition=j.position(),e.containerSize={height:j.innerHeight()-k[3],width:j.innerWidth()-k[1]};var l=e.containerOffset,m=e.containerSize.height,n=e.containerSize.width,o=a.ui.hasScroll(i,"left")?i.scrollWidth:n,p=a.ui.hasScroll(i)?i.scrollHeight:m;e.parentData={element:i,left:l.left,top:l.top,width:o,height:p}}}},resize:function(b,c){var d=a(this).data("resizable"),
e=d.options,f=d.containerSize,g=d.containerOffset,h=d.size,i=d.position,j=d._aspectRatio||b.shiftKey,k={top:0,left:0},l=d.containerElement;l[0]!=document&&/static/.test(l.css("position"))&&(k=g),i.left<(d._helper?g.left:0)&&(d.size.width=d.size.width+(d._helper?d.position.left-g.left:d.position.left-k.left),j&&(d.size.height=d.size.width/e.aspectRatio),d.position.left=e.helper?g.left:0),i.top<(d._helper?g.top:0)&&(d.size.height=d.size.height+(d._helper?d.position.top-g.top:d.position.top),j&&(d.size.width=
d.size.height*e.aspectRatio),d.position.top=d._helper?g.top:0),d.offset.left=d.parentData.left+d.position.left,d.offset.top=d.parentData.top+d.position.top;var m=Math.abs((d._helper?d.offset.left-k.left:d.offset.left-k.left)+d.sizeDiff.width),n=Math.abs((d._helper?d.offset.top-k.top:d.offset.top-g.top)+d.sizeDiff.height),o=d.containerElement.get(0)==d.element.parent().get(0),p=/relative|absolute/.test(d.containerElement.css("position"));o&&p&&(m-=d.parentData.left),m+d.size.width>=d.parentData.width&&
(d.size.width=d.parentData.width-m,j&&(d.size.height=d.size.width/d.aspectRatio)),n+d.size.height>=d.parentData.height&&(d.size.height=d.parentData.height-n,j&&(d.size.width=d.size.height*d.aspectRatio))},stop:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d.position,g=d.containerOffset,h=d.containerPosition,i=d.containerElement,j=a(d.helper),k=j.offset(),l=j.outerWidth()-d.sizeDiff.width,m=j.outerHeight()-d.sizeDiff.height;d._helper&&!e.animate&&/relative/.test(i.css("position"))&&a(this).css({left:k.left-
h.left-g.left,width:l,height:m}),d._helper&&!e.animate&&/static/.test(i.css("position"))&&a(this).css({left:k.left-h.left-g.left,width:l,height:m})}}),a.ui.plugin.add("resizable","ghost",{start:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d.size;d.ghost=d.originalElement.clone(),d.ghost.css({opacity:0.25,display:"block",position:"relative",height:f.height,width:f.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof e.ghost=="string"?e.ghost:""),d.ghost.appendTo(d.helper)},
resize:function(b,c){var d=a(this).data("resizable"),e=d.options;d.ghost&&d.ghost.css({position:"relative",height:d.size.height,width:d.size.width})},stop:function(b,c){var d=a(this).data("resizable"),e=d.options;d.ghost&&d.helper&&d.helper.get(0).removeChild(d.ghost.get(0))}}),a.ui.plugin.add("resizable","grid",{resize:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d.size,g=d.originalSize,h=d.originalPosition,i=d.axis,j=e._aspectRatio||b.shiftKey;e.grid=typeof e.grid=="number"?[e.grid,
e.grid]:e.grid;var k=Math.round((f.width-g.width)/(e.grid[0]||1))*(e.grid[0]||1),l=Math.round((f.height-g.height)/(e.grid[1]||1))*(e.grid[1]||1);/^(se|s|e)$/.test(i)?(d.size.width=g.width+k,d.size.height=g.height+l):/^(ne)$/.test(i)?(d.size.width=g.width+k,d.size.height=g.height+l,d.position.top=h.top-l):/^(sw)$/.test(i)?(d.size.width=g.width+k,d.size.height=g.height+l,d.position.left=h.left-k):(d.size.width=g.width+k,d.size.height=g.height+l,d.position.top=h.top-l,d.position.left=h.left-k)}});var c=
function(a){return parseInt(a,10)||0},d=function(a){return!isNaN(parseInt(a,10))}})(jQuery);
(function(a,b){a.widget("ui.selectable",a.ui.mouse,{options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var b=this;this.element.addClass("ui-selectable"),this.dragged=!1;var c;this.refresh=function(){c=a(b.options.filter,b.element[0]),c.addClass("ui-selectee"),c.each(function(){var b=a(this),c=b.offset();a.data(this,"selectable-item",{element:this,$element:b,left:c.left,top:c.top,right:c.left+b.outerWidth(),bottom:c.top+b.outerHeight(),startselected:!1,
selected:b.hasClass("ui-selected"),selecting:b.hasClass("ui-selecting"),unselecting:b.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=c.addClass("ui-selectee"),this._mouseInit(),this.helper=a("<div class='ui-selectable-helper'></div>")},destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable"),this._mouseDestroy();return this},_mouseStart:function(b){var c=
this;this.opos=[b.pageX,b.pageY];if(!this.options.disabled){var d=this.options;this.selectees=a(d.filter,this.element[0]),this._trigger("start",b),a(d.appendTo).append(this.helper),this.helper.css({left:b.clientX,top:b.clientY,width:0,height:0}),d.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var d=a.data(this,"selectable-item");d.startselected=!0,!b.metaKey&&!b.ctrlKey&&(d.$element.removeClass("ui-selected"),d.selected=!1,d.$element.addClass("ui-unselecting"),
d.unselecting=!0,c._trigger("unselecting",b,{unselecting:d.element}))}),a(b.target).parents().andSelf().each(function(){var d=a.data(this,"selectable-item");if(d){var e=!b.metaKey&&!b.ctrlKey||!d.$element.hasClass("ui-selected");d.$element.removeClass(e?"ui-unselecting":"ui-selected").addClass(e?"ui-selecting":"ui-unselecting"),d.unselecting=!e,d.selecting=e,d.selected=e,e?c._trigger("selecting",b,{selecting:d.element}):c._trigger("unselecting",b,{unselecting:d.element});return!1}})}},_mouseDrag:function(b){var c=
this;this.dragged=!0;if(!this.options.disabled){var d=this.options,e=this.opos[0],f=this.opos[1],g=b.pageX,h=b.pageY;if(e>g){var i=g;g=e,e=i}if(f>h){var i=h;h=f,f=i}this.helper.css({left:e,top:f,width:g-e,height:h-f}),this.selectees.each(function(){var i=a.data(this,"selectable-item");if(!!i&&i.element!=c.element[0]){var j=!1;d.tolerance=="touch"?j=!(i.left>g||i.right<e||i.top>h||i.bottom<f):d.tolerance=="fit"&&(j=i.left>e&&i.right<g&&i.top>f&&i.bottom<h),j?(i.selected&&(i.$element.removeClass("ui-selected"),
i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,c._trigger("selecting",b,{selecting:i.element}))):(i.selecting&&((b.metaKey||b.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),c._trigger("unselecting",
b,{unselecting:i.element}))),i.selected&&!b.metaKey&&!b.ctrlKey&&!i.startselected&&(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,c._trigger("unselecting",b,{unselecting:i.element})))}});return!1}},_mouseStop:function(b){var c=this;this.dragged=!1;var d=this.options;a(".ui-unselecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-unselecting"),d.unselecting=!1,d.startselected=!1,c._trigger("unselected",
b,{unselected:d.element})}),a(".ui-selecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-selecting").addClass("ui-selected"),d.selecting=!1,d.selected=!0,d.startselected=!0,c._trigger("selected",b,{selected:d.element})}),this._trigger("stop",b),this.helper.remove();return!1}}),a.extend(a.ui.selectable,{version:"1.8.17"})})(jQuery);
(function(a,b){a.widget("ui.sortable",a.ui.mouse,{widgetEventPrefix:"sort",options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("ui-sortable"),
this.refresh(),this.floating=this.items.length?a.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_setOption:function(b,c){b==="disabled"?(this.options[b]=c,this.widget()[c?
"addClass":"removeClass"]("ui-sortable-disabled")):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){var d=this;if(this.reverting)return!1;if(this.options.disabled||this.options.type=="static")return!1;this._refreshItems(b);var e=null,f=this,g=a(b.target).parents().each(function(){if(a.data(this,d.widgetName+"-item")==f){e=a(this);return!1}});a.data(b.target,d.widgetName+"-item")==f&&(e=a(b.target));if(!e)return!1;if(this.options.handle&&!c){var h=!1;a(this.options.handle,
e).find("*").andSelf().each(function(){this==b.target&&(h=!0)});if(!h)return!1}this.currentItem=e,this._removeCurrentsFromItems();return!0},_mouseStart:function(b,c,d){var e=this.options,f=this;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},
this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&
this.currentItem.hide(),this._createPlaceholder(),e.containment&&this._setContainment(),e.cursor&&(a("body").css("cursor")&&(this._storedCursor=a("body").css("cursor")),a("body").css("cursor",e.cursor)),e.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",e.opacity)),e.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",e.zIndex)),this.scrollParent[0]!=document&&this.scrollParent[0].tagName!=
"HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!d)for(var g=this.containers.length-1;g>=0;g--)this.containers[g]._trigger("activate",b,f._uiHash(this));a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b);return!0},_mouseDrag:function(b){this.position=
this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var c=this.options,d=!1;this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<c.scrollSensitivity?this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop+c.scrollSpeed:b.pageY-this.overflowOffset.top<c.scrollSensitivity&&(this.scrollParent[0].scrollTop=
d=this.scrollParent[0].scrollTop-c.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<c.scrollSensitivity?this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft+c.scrollSpeed:b.pageX-this.overflowOffset.left<c.scrollSensitivity&&(this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft-c.scrollSpeed)):(b.pageY-a(document).scrollTop()<c.scrollSensitivity?d=a(document).scrollTop(a(document).scrollTop()-c.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<
c.scrollSensitivity&&(d=a(document).scrollTop(a(document).scrollTop()+c.scrollSpeed)),b.pageX-a(document).scrollLeft()<c.scrollSensitivity?d=a(document).scrollLeft(a(document).scrollLeft()-c.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<c.scrollSensitivity&&(d=a(document).scrollLeft(a(document).scrollLeft()+c.scrollSpeed))),d!==!1&&a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||
this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";for(var e=this.items.length-1;e>=0;e--){var f=this.items[e],g=f.item[0],h=this._intersectsWithPointer(f);if(!h)continue;if(g!=this.currentItem[0]&&this.placeholder[h==1?"next":"prev"]()[0]!=g&&!a.ui.contains(this.placeholder[0],g)&&(this.options.type=="semi-dynamic"?!a.ui.contains(this.element[0],g):!0)){this.direction=h==1?"down":"up";
if(this.options.tolerance=="pointer"||this._intersectsWithSides(f))this._rearrange(b,f);else break;this._trigger("change",b,this._uiHash());break}}this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs;return!1},_mouseStop:function(b,c){if(!!b){a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b);if(this.options.revert){var d=this,e=d.placeholder.offset();d.reverting=!0,a(this.helper).animate({left:e.left-
this.offset.parent.left-d.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:e.top-this.offset.parent.top-d.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){var b=this;if(this.dragging){this._mouseUp({target:null}),this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):
this.currentItem.show();for(var c=this.containers.length-1;c>=0;c--)this.containers[c]._trigger("deactivate",null,b._uiHash(this)),this.containers[c].containerCache.over&&(this.containers[c]._trigger("out",null,b._uiHash(this)),this.containers[c].containerCache.over=0)}this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,
dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem));return this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"=");return d.join("&")},toArray:function(b){var c=
this._getItemsAsjQuery(b&&b.connected),d=[];b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")});return d},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l=d+j>h&&d+j<i&&b+k>f&&b+k<g;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!=
"pointer"&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?l:f<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<g&&h<d+this.helperProportions.height/2&&e-this.helperProportions.height/2<i},_intersectsWithPointer:function(b){var c=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top,b.height),d=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left,b.width),e=c&&d,f=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();
if(!e)return!1;return this.floating?g&&g=="right"||f=="down"?2:1:f&&(f=="down"?2:1)},_intersectsWithSides:function(b){var c=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top+b.height/2,b.height),d=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left+b.width/2,b.width),e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?f=="right"&&d||f=="left"&&!d:e&&(e=="down"&&c||e=="up"&&!c)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-
this.lastPositionAbs.top;return a!=0&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return a!=0&&(a>0?"right":"left")},refresh:function(a){this._refreshItems(a),this.refreshPositions();return this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){var c=this,d=[],e=[],f=this._connectWith();if(f&&b)for(var g=f.length-1;g>=0;g--){var h=a(f[g]);
for(var i=h.length-1;i>=0;i--){var j=a.data(h[i],this.widgetName);j&&j!=this&&!j.options.disabled&&e.push([a.isFunction(j.options.items)?j.options.items.call(j.element):a(j.options.items,j.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),j])}}e.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var g=
e.length-1;g>=0;g--)e[g][0].each(function(){d.push(this)});return a(d)},_removeCurrentsFromItems:function(){var a=this.currentItem.find(":data("+this.widgetName+"-item)");for(var b=0;b<this.items.length;b++)for(var c=0;c<a.length;c++)a[c]==this.items[b].item[0]&&this.items.splice(b,1)},_refreshItems:function(b){this.items=[],this.containers=[this];var c=this.items,d=this,e=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),
this]],f=this._connectWith();if(f)for(var g=f.length-1;g>=0;g--){var h=a(f[g]);for(var i=h.length-1;i>=0;i--){var j=a.data(h[i],this.widgetName);j&&j!=this&&!j.options.disabled&&(e.push([a.isFunction(j.options.items)?j.options.items.call(j.element[0],b,{item:this.currentItem}):a(j.options.items,j.element),j]),this.containers.push(j))}}for(var g=e.length-1;g>=0;g--){var k=e[g][1],l=e[g][0];for(var i=0,m=l.length;i<m;i++){var n=a(l[i]);n.data(this.widgetName+"-item",k),c.push({item:n,instance:k,width:0,
height:0,left:0,top:0})}}},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var c=this.items.length-1;c>=0;c--){var d=this.items[c];if(d.instance!=this.currentContainer&&this.currentContainer&&d.item[0]!=this.currentItem[0])continue;var e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item;b||(d.width=e.outerWidth(),d.height=e.outerHeight());var f=e.offset();d.left=f.left,d.top=f.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);
else for(var c=this.containers.length-1;c>=0;c--){var f=this.containers[c].element.offset();this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight()}return this},_createPlaceholder:function(b){var c=b||this,d=c.options;if(!d.placeholder||d.placeholder.constructor==String){var e=d.placeholder;d.placeholder=
{element:function(){var b=a(document.createElement(c.currentItem[0].nodeName)).addClass(e||c.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];e||(b.style.visibility="hidden");return b},update:function(a,b){if(!e||!!d.forcePlaceholderSize)b.height()||b.height(c.currentItem.innerHeight()-parseInt(c.currentItem.css("paddingTop")||0,10)-parseInt(c.currentItem.css("paddingBottom")||0,10)),b.width()||b.width(c.currentItem.innerWidth()-parseInt(c.currentItem.css("paddingLeft")||
0,10)-parseInt(c.currentItem.css("paddingRight")||0,10))}}}c.placeholder=a(d.placeholder.element.call(c.element,c.currentItem)),c.currentItem.after(c.placeholder),d.placeholder.update(c,c.placeholder)},_contactContainers:function(b){var c=null,d=null;for(var e=this.containers.length-1;e>=0;e--){if(a.ui.contains(this.currentItem[0],this.containers[e].element[0]))continue;if(this._intersectsWith(this.containers[e].containerCache)){if(c&&a.ui.contains(this.containers[e].element[0],c.element[0]))continue;
c=this.containers[e],d=e}else this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",b,this._uiHash(this)),this.containers[e].containerCache.over=0)}if(!!c)if(this.containers.length===1)this.containers[d]._trigger("over",b,this._uiHash(this)),this.containers[d].containerCache.over=1;else if(this.currentContainer!=this.containers[d]){var f=1E4,g=null,h=this.positionAbs[this.containers[d].floating?"left":"top"];for(var i=this.items.length-1;i>=0;i--){if(!a.ui.contains(this.containers[d].element[0],
this.items[i].item[0]))continue;var j=this.items[i][this.containers[d].floating?"left":"top"];Math.abs(j-h)<f&&(f=Math.abs(j-h),g=this.items[i])}if(!g&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[d],g?this._rearrange(b,g,null,!0):this._rearrange(b,null,this.containers[d].element,!0),this._trigger("change",b,this._uiHash()),this.containers[d]._trigger("change",b,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[d]._trigger("over",
b,this._uiHash(this)),this.containers[d].containerCache.over=1}},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):c.helper=="clone"?this.currentItem.clone():this.currentItem;d.parents("body").length||a(c.appendTo!="parent"?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),
top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(d[0].style.width==""||c.forceHelperSize)&&d.width(this.currentItem.width()),(d[0].style.height==""||c.forceHelperSize)&&d.height(this.currentItem.height());return d},_adjustOffsetFromHelper:function(b){typeof b=="string"&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),
"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&
this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,
left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;b.containment=="parent"&&(b.containment=this.helper[0].parentNode);if(b.containment=="document"||b.containment=="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,
0-this.offset.relative.top-this.offset.parent.top,a(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)){var c=a(b.containment)[0],d=a(b.containment).offset(),e=a(c).css("overflow")!="hidden";this.containment=[d.left+(parseInt(a(c).css("borderLeftWidth"),10)||
0)+(parseInt(a(c).css("paddingLeft"),10)||0)-this.margins.left,d.top+(parseInt(a(c).css("borderTopWidth"),10)||0)+(parseInt(a(c).css("paddingTop"),10)||0)-this.margins.top,d.left+(e?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(a(c).css("borderLeftWidth"),10)||0)-(parseInt(a(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,d.top+(e?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(a(c).css("borderTopWidth"),10)||0)-(parseInt(a(c).css("paddingBottom"),
10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(b,c){c||(c=this.position);var d=b=="absolute"?1:-1,e=this.options,f=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=/(html|body)/i.test(f[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():
g?0:f.scrollTop())*d),left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:f.scrollLeft())*d)}},_generatePosition:function(b){var c=this.options,d=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(d[0].tagName);this.cssPosition=="relative"&&(this.scrollParent[0]==
document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var f=b.pageX,g=b.pageY;if(this.originalPosition){this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&
(g=this.containment[3]+this.offset.click.top));if(c.grid){var h=this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1];g=this.containment?h-this.offset.click.top<this.containment[1]||h-this.offset.click.top>this.containment[3]?h-this.offset.click.top<this.containment[1]?h+c.grid[1]:h-c.grid[1]:h:h;var i=this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0];f=this.containment?i-this.offset.click.left<this.containment[0]||i-this.offset.click.left>this.containment[2]?
i-this.offset.click.left<this.containment[0]?i+c.grid[0]:i-c.grid[0]:i:i}}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_rearrange:function(a,
b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this,f=this.counter;window.setTimeout(function(){f==e.counter&&e.refreshPositions(!d)},0)},_clear:function(b,c){this.reverting=!1;var d=[],e=this;!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var f in this._storedCSS)if(this._storedCSS[f]==
"auto"||this._storedCSS[f]=="static")this._storedCSS[f]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!c&&d.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!c&&d.push(function(a){this._trigger("update",a,this._uiHash())});if(!a.ui.contains(this.element[0],
this.currentItem[0])){c||d.push(function(a){this._trigger("remove",a,this._uiHash())});for(var f=this.containers.length-1;f>=0;f--)a.ui.contains(this.containers[f].element[0],this.currentItem[0])&&!c&&(d.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.containers[f])),d.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.containers[f])))}for(var f=this.containers.length-1;f>=0;f--)c||d.push(function(a){return function(b){a._trigger("deactivate",
b,this._uiHash(this))}}.call(this,this.containers[f])),this.containers[f].containerCache.over&&(d.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[f])),this.containers[f].containerCache.over=0);this._storedCursor&&a("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!c){this._trigger("beforeStop",
b,this._uiHash());for(var f=0;f<d.length;f++)d[f].call(this,b);this._trigger("stop",b,this._uiHash())}return!1}c||this._trigger("beforeStop",b,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!c){for(var f=0;f<d.length;f++)d[f].call(this,b);this._trigger("stop",b,this._uiHash())}this.fromOutside=!1;return!0},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},
_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}}),a.extend(a.ui.sortable,{version:"1.8.17"})})(jQuery);
(function(a,b){a.widget("ui.accordion",{options:{active:0,animated:"slide",autoHeight:!0,clearStyle:!1,collapsible:!1,event:"click",fillSpace:!1,header:"> li > :first-child,> :not(li):even",icons:{header:"ui-icon-triangle-1-e",headerSelected:"ui-icon-triangle-1-s"},navigation:!1,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}},_create:function(){var b=this,c=b.options;b.running=0,b.element.addClass("ui-accordion ui-widget ui-helper-reset").children("li").addClass("ui-accordion-li-fix"),
b.headers=b.element.find(c.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion",function(){c.disabled||a(this).addClass("ui-state-hover")}).bind("mouseleave.accordion",function(){c.disabled||a(this).removeClass("ui-state-hover")}).bind("focus.accordion",function(){c.disabled||a(this).addClass("ui-state-focus")}).bind("blur.accordion",function(){c.disabled||a(this).removeClass("ui-state-focus")}),b.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");
if(c.navigation){var d=b.element.find("a").filter(c.navigationFilter).eq(0);if(d.length){var e=d.closest(".ui-accordion-header");e.length?b.active=e:b.active=d.closest(".ui-accordion-content").prev()}}b.active=b._findActive(b.active||c.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top"),b.active.next().addClass("ui-accordion-content-active"),b._createIcons(),b.resize(),b.element.attr("role","tablist"),b.headers.attr("role","tab").bind("keydown.accordion",
function(a){return b._keydown(a)}).next().attr("role","tabpanel"),b.headers.not(b.active||"").attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).next().hide(),b.active.length?b.active.attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}):b.headers.eq(0).attr("tabIndex",0),a.browser.safari||b.headers.find("a").attr("tabIndex",-1),c.event&&b.headers.bind(c.event.split(" ").join(".accordion ")+".accordion",function(a){b._clickHandler.call(b,a,this),a.preventDefault()})},_createIcons:function(){var b=
this.options;b.icons&&(a("<span></span>").addClass("ui-icon "+b.icons.header).prependTo(this.headers),this.active.children(".ui-icon").toggleClass(b.icons.header).toggleClass(b.icons.headerSelected),this.element.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.children(".ui-icon").remove(),this.element.removeClass("ui-accordion-icons")},destroy:function(){var b=this.options;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex"),
this.headers.find("a").removeAttr("tabIndex"),this._destroyIcons();var c=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");(b.autoHeight||b.fillHeight)&&c.css("height","");return a.Widget.prototype.destroy.call(this)},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments),b=="active"&&this.activate(c),b=="icons"&&(this._destroyIcons(),
c&&this._createIcons()),b=="disabled"&&this.headers.add(this.headers.next())[c?"addClass":"removeClass"]("ui-accordion-disabled ui-state-disabled")},_keydown:function(b){if(!(this.options.disabled||b.altKey||b.ctrlKey)){var c=a.ui.keyCode,d=this.headers.length,e=this.headers.index(b.target),f=!1;switch(b.keyCode){case c.RIGHT:case c.DOWN:f=this.headers[(e+1)%d];break;case c.LEFT:case c.UP:f=this.headers[(e-1+d)%d];break;case c.SPACE:case c.ENTER:this._clickHandler({target:b.target},b.target),b.preventDefault()}if(f){a(b.target).attr("tabIndex",
-1),a(f).attr("tabIndex",0),f.focus();return!1}return!0}},resize:function(){var b=this.options,c;if(b.fillSpace){if(a.browser.msie){var d=this.element.parent().css("overflow");this.element.parent().css("overflow","hidden")}c=this.element.parent().height(),a.browser.msie&&this.element.parent().css("overflow",d),this.headers.each(function(){c-=a(this).outerHeight(!0)}),this.headers.next().each(function(){a(this).height(Math.max(0,c-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")}else b.autoHeight&&
(c=0,this.headers.next().each(function(){c=Math.max(c,a(this).height("").height())}).height(c));return this},activate:function(a){this.options.active=a;var b=this._findActive(a)[0];this._clickHandler({target:b},b);return this},_findActive:function(b){return b?typeof b=="number"?this.headers.filter(":eq("+b+")"):this.headers.not(this.headers.not(b)):b===!1?a([]):this.headers.filter(":eq(0)")},_clickHandler:function(b,c){var d=this.options;if(!d.disabled){if(!b.target){if(!d.collapsible)return;this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(d.icons.headerSelected).addClass(d.icons.header),
this.active.next().addClass("ui-accordion-content-active");var e=this.active.next(),f={options:d,newHeader:a([]),oldHeader:d.active,newContent:a([]),oldContent:e},g=this.active=a([]);this._toggle(g,e,f);return}var h=a(b.currentTarget||c),i=h[0]===this.active[0];d.active=d.collapsible&&i?!1:this.headers.index(h);if(this.running||!d.collapsible&&i)return;var j=this.active,g=h.next(),e=this.active.next(),f={options:d,newHeader:i&&d.collapsible?a([]):h,oldHeader:this.active,newContent:i&&d.collapsible?
a([]):g,oldContent:e},k=this.headers.index(this.active[0])>this.headers.index(h[0]);this.active=i?a([]):h,this._toggle(g,e,f,i,k),j.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(d.icons.headerSelected).addClass(d.icons.header),i||(h.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-icon").removeClass(d.icons.header).addClass(d.icons.headerSelected),h.next().addClass("ui-accordion-content-active"));
return}},_toggle:function(b,c,d,e,f){var g=this,h=g.options;g.toShow=b,g.toHide=c,g.data=d;var i=function(){if(!!g)return g._completed.apply(g,arguments)};g._trigger("changestart",null,g.data),g.running=c.size()===0?b.size():c.size();if(h.animated){var j={};h.collapsible&&e?j={toShow:a([]),toHide:c,complete:i,down:f,autoHeight:h.autoHeight||h.fillSpace}:j={toShow:b,toHide:c,complete:i,down:f,autoHeight:h.autoHeight||h.fillSpace},h.proxied||(h.proxied=h.animated),h.proxiedDuration||(h.proxiedDuration=
h.duration),h.animated=a.isFunction(h.proxied)?h.proxied(j):h.proxied,h.duration=a.isFunction(h.proxiedDuration)?h.proxiedDuration(j):h.proxiedDuration;var k=a.ui.accordion.animations,l=h.duration,m=h.animated;m&&!k[m]&&!a.easing[m]&&(m="slide"),k[m]||(k[m]=function(a){this.slide(a,{easing:m,duration:l||700})}),k[m](j)}else h.collapsible&&e?b.toggle():(c.hide(),b.show()),i(!0);c.prev().attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).blur(),b.prev().attr({"aria-expanded":"true",
"aria-selected":"true",tabIndex:0}).focus()},_completed:function(a){this.running=a?0:--this.running;this.running||(this.options.clearStyle&&this.toShow.add(this.toHide).css({height:"",overflow:""}),this.toHide.removeClass("ui-accordion-content-active"),this.toHide.length&&(this.toHide.parent()[0].className=this.toHide.parent()[0].className),this._trigger("change",null,this.data))}}),a.extend(a.ui.accordion,{version:"1.8.17",animations:{slide:function(b,c){b=a.extend({easing:"swing",duration:300},
b,c);if(!b.toHide.size())b.toShow.animate({height:"show",paddingTop:"show",paddingBottom:"show"},b);else{if(!b.toShow.size()){b.toHide.animate({height:"hide",paddingTop:"hide",paddingBottom:"hide"},b);return}var d=b.toShow.css("overflow"),e=0,f={},g={},h=["height","paddingTop","paddingBottom"],i,j=b.toShow;i=j[0].style.width,j.width(j.parent().width()-parseFloat(j.css("paddingLeft"))-parseFloat(j.css("paddingRight"))-(parseFloat(j.css("borderLeftWidth"))||0)-(parseFloat(j.css("borderRightWidth"))||
0)),a.each(h,function(c,d){g[d]="hide";var e=(""+a.css(b.toShow[0],d)).match(/^([\d+-.]+)(.*)$/);f[d]={value:e[1],unit:e[2]||"px"}}),b.toShow.css({height:0,overflow:"hidden"}).show(),b.toHide.filter(":hidden").each(b.complete).end().filter(":visible").animate(g,{step:function(a,c){c.prop=="height"&&(e=c.end-c.start===0?0:(c.now-c.start)/(c.end-c.start)),b.toShow[0].style[c.prop]=e*f[c.prop].value+f[c.prop].unit},duration:b.duration,easing:b.easing,complete:function(){b.autoHeight||b.toShow.css("height",
""),b.toShow.css({width:i,overflow:d}),b.complete()}})}},bounceslide:function(a){this.slide(a,{easing:a.down?"easeOutBounce":"swing",duration:a.down?1E3:200})}}})})(jQuery);
(function(a,b){var c=0;a.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var b=this,c=this.element[0].ownerDocument,d;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(c){if(!b.options.disabled&&!b.element.propAttr("readOnly")){d=
!1;var e=a.ui.keyCode;switch(c.keyCode){case e.PAGE_UP:b._move("previousPage",c);break;case e.PAGE_DOWN:b._move("nextPage",c);break;case e.UP:b._move("previous",c),c.preventDefault();break;case e.DOWN:b._move("next",c),c.preventDefault();break;case e.ENTER:case e.NUMPAD_ENTER:b.menu.active&&(d=!0,c.preventDefault());case e.TAB:if(!b.menu.active)return;b.menu.select(c);break;case e.ESCAPE:b.element.val(b.term),b.close(c);break;default:clearTimeout(b.searching),b.searching=setTimeout(function(){b.term!=
b.element.val()&&(b.selectedItem=null,b.search(null,c))},b.options.delay)}}}).bind("keypress.autocomplete",function(a){d&&(d=!1,a.preventDefault())}).bind("focus.autocomplete",function(){b.options.disabled||(b.selectedItem=null,b.previous=b.element.val())}).bind("blur.autocomplete",function(a){b.options.disabled||(clearTimeout(b.searching),b.closing=setTimeout(function(){b.close(a),b._change(a)},150))}),this._initSource(),this.response=function(){return b._response.apply(b,arguments)},this.menu=a("<ul></ul>").addClass("ui-autocomplete").appendTo(a(this.options.appendTo||
"body",c)[0]).mousedown(function(c){var d=b.menu.element[0];a(c.target).closest(".ui-menu-item").length||setTimeout(function(){a(document).one("mousedown",function(c){c.target!==b.element[0]&&c.target!==d&&!a.ui.contains(d,c.target)&&b.close()})},1),setTimeout(function(){clearTimeout(b.closing)},13)}).menu({focus:function(a,c){var d=c.item.data("item.autocomplete");!1!==b._trigger("focus",a,{item:d})&&/^key/.test(a.originalEvent.type)&&b.element.val(d.value)},selected:function(a,d){var e=d.item.data("item.autocomplete"),
f=b.previous;b.element[0]!==c.activeElement&&(b.element.focus(),b.previous=f,setTimeout(function(){b.previous=f,b.selectedItem=e},1)),!1!==b._trigger("select",a,{item:e})&&b.element.val(e.value),b.term=b.element.val(),b.close(a),b.selectedItem=e},blur:function(a,c){b.menu.element.is(":visible")&&b.element.val()!==b.term&&b.element.val(b.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu"),a.fn.bgiframe&&this.menu.element.bgiframe(),b.beforeunloadHandler=function(){b.element.removeAttr("autocomplete")},
a(window).bind("beforeunload",b.beforeunloadHandler)},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup"),this.menu.element.remove(),a(window).unbind("beforeunload",this.beforeunloadHandler),a.Widget.prototype.destroy.call(this)},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments),b==="source"&&this._initSource(),b==="appendTo"&&this.menu.element.appendTo(a(c||
"body",this.element[0].ownerDocument)[0]),b==="disabled"&&c&&this.xhr&&this.xhr.abort()},_initSource:function(){var b=this,d,e;a.isArray(this.options.source)?(d=this.options.source,this.source=function(b,c){c(a.ui.autocomplete.filter(d,b.term))}):typeof this.options.source=="string"?(e=this.options.source,this.source=function(d,f){b.xhr&&b.xhr.abort(),b.xhr=a.ajax({url:e,data:d,dataType:"json",autocompleteRequest:++c,success:function(a,b){this.autocompleteRequest===c&&f(a)},error:function(){this.autocompleteRequest===
c&&f([])}})}):this.source=this.options.source},search:function(a,b){a=a!=null?a:this.element.val(),this.term=this.element.val();if(a.length<this.options.minLength)return this.close(b);clearTimeout(this.closing);if(this._trigger("search",b)!==!1)return this._search(a)},_search:function(a){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.source({term:a},this.response)},_response:function(a){!this.options.disabled&&a&&a.length?(a=this._normalize(a),this._suggest(a),this._trigger("open")):
this.close(),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},close:function(a){clearTimeout(this.closing),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.deactivate(),this._trigger("close",a))},_change:function(a){this.previous!==this.element.val()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){if(b.length&&b[0].label&&b[0].value)return b;return a.map(b,function(b){if(typeof b=="string")return{label:b,value:b};return a.extend({label:b.label||
b.value,value:b.value||b.label},b)})},_suggest:function(b){var c=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(c,b),this.menu.deactivate(),this.menu.refresh(),c.show(),this._resizeMenu(),c.position(a.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(new a.Event("mouseover"))},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(b,c){var d=
this;a.each(c,function(a,c){d._renderItem(b,c)})},_renderItem:function(b,c){return a("<li></li>").data("item.autocomplete",c).append(a("<a></a>").text(c.label)).appendTo(b)},_move:function(a,b){if(!this.menu.element.is(":visible"))this.search(null,b);else{if(this.menu.first()&&/^previous/.test(a)||this.menu.last()&&/^next/.test(a)){this.element.val(this.term),this.menu.deactivate();return}this.menu[a](b)}},widget:function(){return this.menu.element}}),a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,
"\\$&")},filter:function(b,c){var d=new RegExp(a.ui.autocomplete.escapeRegex(c),"i");return a.grep(b,function(a){return d.test(a.label||a.value||a)})}})})(jQuery),function(a){a.widget("ui.menu",{_create:function(){var b=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(c){!a(c.target).closest(".ui-menu-item a").length||(c.preventDefault(),b.select(c))}),this.refresh()},refresh:function(){var b=
this,c=this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem");c.children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(c){b.activate(c,a(this).parent())}).mouseleave(function(){b.deactivate()})},activate:function(a,b){this.deactivate();if(this.hasScroll()){var c=b.offset().top-this.element.offset().top,d=this.element.scrollTop(),e=this.element.height();c<0?this.element.scrollTop(d+c):c>=e&&this.element.scrollTop(d+c-e+b.height())}this.active=
b.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end(),this._trigger("focus",a,{item:b})},deactivate:function(){!this.active||(this.active.children("a").removeClass("ui-state-hover").removeAttr("id"),this._trigger("blur"),this.active=null)},next:function(a){this.move("next",".ui-menu-item:first",a)},previous:function(a){this.move("prev",".ui-menu-item:last",a)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&
!this.active.nextAll(".ui-menu-item").length},move:function(a,b,c){if(!this.active)this.activate(c,this.element.children(b));else{var d=this.active[a+"All"](".ui-menu-item").eq(0);d.length?this.activate(c,d):this.activate(c,this.element.children(b))}},nextPage:function(b){if(this.hasScroll()){if(!this.active||this.last()){this.activate(b,this.element.children(".ui-menu-item:first"));return}var c=this.active.offset().top,d=this.element.height(),e=this.element.children(".ui-menu-item").filter(function(){var b=
a(this).offset().top-c-d+a(this).height();return b<10&&b>-10});e.length||(e=this.element.children(".ui-menu-item:last")),this.activate(b,e)}else this.activate(b,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))},previousPage:function(b){if(this.hasScroll()){if(!this.active||this.first()){this.activate(b,this.element.children(".ui-menu-item:last"));return}var c=this.active.offset().top,d=this.element.height();result=this.element.children(".ui-menu-item").filter(function(){var b=
a(this).offset().top-c+d-a(this).height();return b<10&&b>-10}),result.length||(result=this.element.children(".ui-menu-item:first")),this.activate(b,result)}else this.activate(b,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element[a.fn.prop?"prop":"attr"]("scrollHeight")},select:function(a){this._trigger("selected",a,{item:this.active})}})}(jQuery);
(function(a,b){var c,d,e,f,g="ui-button ui-widget ui-state-default ui-corner-all",h="ui-state-hover ui-state-active ",i="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",j=function(){var b=a(this).find(":ui-button");setTimeout(function(){b.button("refresh")},1)},k=function(b){var c=b.name,d=b.form,e=a([]);c&&(d?e=a(d).find("[name='"+c+"']"):e=a("[name='"+c+"']",b.ownerDocument).filter(function(){return!this.form}));
return e};a.widget("ui.button",{options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",j),typeof this.options.disabled!="boolean"&&(this.options.disabled=this.element.propAttr("disabled")),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var b=this,h=this.options,i=this.type==="checkbox"||this.type==="radio",l="ui-state-hover"+(i?"":" ui-state-active"),m="ui-state-focus";
h.label===null&&(h.label=this.buttonElement.html()),this.element.is(":disabled")&&(h.disabled=!0),this.buttonElement.addClass(g).attr("role","button").bind("mouseenter.button",function(){h.disabled||(a(this).addClass("ui-state-hover"),this===c&&a(this).addClass("ui-state-active"))}).bind("mouseleave.button",function(){h.disabled||a(this).removeClass(l)}).bind("click.button",function(a){h.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}),this.element.bind("focus.button",function(){b.buttonElement.addClass(m)}).bind("blur.button",
function(){b.buttonElement.removeClass(m)}),i&&(this.element.bind("change.button",function(){f||b.refresh()}),this.buttonElement.bind("mousedown.button",function(a){h.disabled||(f=!1,d=a.pageX,e=a.pageY)}).bind("mouseup.button",function(a){!h.disabled&&(d!==a.pageX||e!==a.pageY)&&(f=!0)})),this.type==="checkbox"?this.buttonElement.bind("click.button",function(){if(h.disabled||f)return!1;a(this).toggleClass("ui-state-active"),b.buttonElement.attr("aria-pressed",b.element[0].checked)}):this.type===
"radio"?this.buttonElement.bind("click.button",function(){if(h.disabled||f)return!1;a(this).addClass("ui-state-active"),b.buttonElement.attr("aria-pressed","true");var c=b.element[0];k(c).not(c).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown.button",function(){if(h.disabled)return!1;a(this).addClass("ui-state-active"),c=this,a(document).one("mouseup",function(){c=null})}).bind("mouseup.button",function(){if(h.disabled)return!1;
a(this).removeClass("ui-state-active")}).bind("keydown.button",function(b){if(h.disabled)return!1;(b.keyCode==a.ui.keyCode.SPACE||b.keyCode==a.ui.keyCode.ENTER)&&a(this).addClass("ui-state-active")}).bind("keyup.button",function(){a(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()})),this._setOption("disabled",h.disabled),this._resetButton()},_determineButtonType:function(){this.element.is(":checkbox")?
this.type="checkbox":this.element.is(":radio")?this.type="radio":this.element.is("input")?this.type="input":this.type="button";if(this.type==="checkbox"||this.type==="radio"){var a=this.element.parents().filter(":last"),b="label[for='"+this.element.attr("id")+"']";this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible");
var c=this.element.is(":checked");c&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.attr("aria-pressed",c)}else this.buttonElement=this.element},widget:function(){return this.buttonElement},destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(g+" "+h+" "+i).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title"),a.Widget.prototype.destroy.call(this)},
_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments);b==="disabled"?c?this.element.propAttr("disabled",!0):this.element.propAttr("disabled",!1):this._resetButton()},refresh:function(){var b=this.element.is(":disabled");b!==this.options.disabled&&this._setOption("disabled",b),this.type==="radio"?k(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed",
"false")}):this.type==="checkbox"&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if(this.type==="input")this.options.label&&this.element.val(this.options.label);else{var b=this.buttonElement.removeClass(i),c=a("<span></span>",this.element[0].ownerDocument).addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),d=
this.options.icons,e=d.primary&&d.secondary,f=[];d.primary||d.secondary?(this.options.text&&f.push("ui-button-text-icon"+(e?"s":d.primary?"-primary":"-secondary")),d.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>"),d.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>"),this.options.text||(f.push(e?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||b.attr("title",c))):f.push("ui-button-text-only"),b.addClass(f.join(" "))}}}),
a.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(b,c){b==="disabled"&&this.buttons.button("option",b,c),a.Widget.prototype._setOption.apply(this,arguments)},refresh:function(){var b=this.element.css("direction")==="rtl";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(b?
"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(b?"ui-corner-left":"ui-corner-right").end().end()},destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy"),a.Widget.prototype.destroy.call(this)}})})(jQuery);
(function(a,b){var c="ui-dialog ui-widget ui-widget-content ui-corner-all ",d={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},e={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},f=a.attrFn||{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0,click:!0};a.widget("ui.dialog",{options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,
position:{my:"center",at:"center",collision:"fit",using:function(b){var c=a(this).css(b).offset().top;c<0&&a(this).css("top",b.top-c)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1E3},_create:function(){this.originalTitle=this.element.attr("title"),typeof this.originalTitle!="string"&&(this.originalTitle=""),this.options.title=this.options.title||this.originalTitle;var b=this,d=b.options,e=d.title||"&#160;",f=a.ui.dialog.getTitleId(b.element),g=(b.uiDialog=a("<div></div>")).appendTo(document.body).hide().addClass(c+
d.dialogClass).css({zIndex:d.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(c){d.closeOnEscape&&!c.isDefaultPrevented()&&c.keyCode&&c.keyCode===a.ui.keyCode.ESCAPE&&(b.close(c),c.preventDefault())}).attr({role:"dialog","aria-labelledby":f}).mousedown(function(a){b.moveToTop(!1,a)}),h=b.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(g),i=(b.uiDialogTitlebar=a("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(g),
j=a('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role","button").hover(function(){j.addClass("ui-state-hover")},function(){j.removeClass("ui-state-hover")}).focus(function(){j.addClass("ui-state-focus")}).blur(function(){j.removeClass("ui-state-focus")}).click(function(a){b.close(a);return!1}).appendTo(i),k=(b.uiDialogTitlebarCloseText=a("<span></span>")).addClass("ui-icon ui-icon-closethick").text(d.closeText).appendTo(j),l=a("<span></span>").addClass("ui-dialog-title").attr("id",
f).html(e).prependTo(i);a.isFunction(d.beforeclose)&&!a.isFunction(d.beforeClose)&&(d.beforeClose=d.beforeclose),i.find("*").add(i).disableSelection(),d.draggable&&a.fn.draggable&&b._makeDraggable(),d.resizable&&a.fn.resizable&&b._makeResizable(),b._createButtons(d.buttons),b._isOpen=!1,a.fn.bgiframe&&g.bgiframe()},_init:function(){this.options.autoOpen&&this.open()},destroy:function(){var a=this;a.overlay&&a.overlay.destroy(),a.uiDialog.hide(),a.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"),
a.uiDialog.remove(),a.originalTitle&&a.element.attr("title",a.originalTitle);return a},widget:function(){return this.uiDialog},close:function(b){var c=this,d,e;if(!1!==c._trigger("beforeClose",b)){c.overlay&&c.overlay.destroy(),c.uiDialog.unbind("keypress.ui-dialog"),c._isOpen=!1,c.options.hide?c.uiDialog.hide(c.options.hide,function(){c._trigger("close",b)}):(c.uiDialog.hide(),c._trigger("close",b)),a.ui.dialog.overlay.resize(),c.options.modal&&(d=0,a(".ui-dialog").each(function(){this!==c.uiDialog[0]&&
(e=a(this).css("z-index"),isNaN(e)||(d=Math.max(d,e)))}),a.ui.dialog.maxZ=d);return c}},isOpen:function(){return this._isOpen},moveToTop:function(b,c){var d=this,e=d.options,f;if(e.modal&&!b||!e.stack&&!e.modal)return d._trigger("focus",c);e.zIndex>a.ui.dialog.maxZ&&(a.ui.dialog.maxZ=e.zIndex),d.overlay&&(a.ui.dialog.maxZ+=1,d.overlay.$el.css("z-index",a.ui.dialog.overlay.maxZ=a.ui.dialog.maxZ)),f={scrollTop:d.element.scrollTop(),scrollLeft:d.element.scrollLeft()},a.ui.dialog.maxZ+=1,d.uiDialog.css("z-index",
a.ui.dialog.maxZ),d.element.attr(f),d._trigger("focus",c);return d},open:function(){if(!this._isOpen){var b=this,c=b.options,d=b.uiDialog;b.overlay=c.modal?new a.ui.dialog.overlay(b):null,b._size(),b._position(c.position),d.show(c.show),b.moveToTop(!0),c.modal&&d.bind("keydown.ui-dialog",function(b){if(b.keyCode===a.ui.keyCode.TAB){var c=a(":tabbable",this),d=c.filter(":first"),e=c.filter(":last");if(b.target===e[0]&&!b.shiftKey){d.focus(1);return!1}if(b.target===d[0]&&b.shiftKey){e.focus(1);return!1}}}),
a(b.element.find(":tabbable").get().concat(d.find(".ui-dialog-buttonpane :tabbable").get().concat(d.get()))).eq(0).focus(),b._isOpen=!0,b._trigger("open");return b}},_createButtons:function(b){var c=this,d=!1,e=a("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),g=a("<div></div>").addClass("ui-dialog-buttonset").appendTo(e);c.uiDialog.find(".ui-dialog-buttonpane").remove(),typeof b=="object"&&b!==null&&a.each(b,function(){return!(d=!0)}),d&&(a.each(b,function(b,
d){d=a.isFunction(d)?{click:d,text:b}:d;var e=a('<button type="button"></button>').click(function(){d.click.apply(c.element[0],arguments)}).appendTo(g);a.each(d,function(a,b){a!=="click"&&(a in f?e[a](b):e.attr(a,b))}),a.fn.button&&e.button()}),e.appendTo(c.uiDialog))},_makeDraggable:function(){function f(a){return{position:a.position,offset:a.offset}}var b=this,c=b.options,d=a(document),e;b.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",
start:function(d,g){e=c.height==="auto"?"auto":a(this).height(),a(this).height(a(this).height()).addClass("ui-dialog-dragging"),b._trigger("dragStart",d,f(g))},drag:function(a,c){b._trigger("drag",a,f(c))},stop:function(g,h){c.position=[h.position.left-d.scrollLeft(),h.position.top-d.scrollTop()],a(this).removeClass("ui-dialog-dragging").height(e),b._trigger("dragStop",g,f(h)),a.ui.dialog.overlay.resize()}})},_makeResizable:function(c){function h(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,
position:a.position,size:a.size}}c=c===b?this.options.resizable:c;var d=this,e=d.options,f=d.uiDialog.css("position"),g=typeof c=="string"?c:"n,e,s,w,se,sw,ne,nw";d.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:d.element,maxWidth:e.maxWidth,maxHeight:e.maxHeight,minWidth:e.minWidth,minHeight:d._minHeight(),handles:g,start:function(b,c){a(this).addClass("ui-dialog-resizing"),d._trigger("resizeStart",b,h(c))},resize:function(a,b){d._trigger("resize",a,h(b))},stop:function(b,
c){a(this).removeClass("ui-dialog-resizing"),e.height=a(this).height(),e.width=a(this).width(),d._trigger("resizeStop",b,h(c)),a.ui.dialog.overlay.resize()}}).css("position",f).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var a=this.options;return a.height==="auto"?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(b){var c=[],d=[0,0],e;if(b){if(typeof b=="string"||typeof b=="object"&&"0"in b)c=b.split?b.split(" "):[b[0],b[1]],c.length===
1&&(c[1]=c[0]),a.each(["left","top"],function(a,b){+c[a]===c[a]&&(d[a]=c[a],c[a]=b)}),b={my:c.join(" "),at:c.join(" "),offset:d.join(" ")};b=a.extend({},a.ui.dialog.prototype.options.position,b)}else b=a.ui.dialog.prototype.options.position;e=this.uiDialog.is(":visible"),e||this.uiDialog.show(),this.uiDialog.css({top:0,left:0}).position(a.extend({of:window},b)),e||this.uiDialog.hide()},_setOptions:function(b){var c=this,f={},g=!1;a.each(b,function(a,b){c._setOption(a,b),a in d&&(g=!0),a in e&&(f[a]=
b)}),g&&this._size(),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",f)},_setOption:function(b,d){var e=this,f=e.uiDialog;switch(b){case "beforeclose":b="beforeClose";break;case "buttons":e._createButtons(d);break;case "closeText":e.uiDialogTitlebarCloseText.text(""+d);break;case "dialogClass":f.removeClass(e.options.dialogClass).addClass(c+d);break;case "disabled":d?f.addClass("ui-dialog-disabled"):f.removeClass("ui-dialog-disabled");break;case "draggable":var g=f.is(":data(draggable)");
g&&!d&&f.draggable("destroy"),!g&&d&&e._makeDraggable();break;case "position":e._position(d);break;case "resizable":var h=f.is(":data(resizable)");h&&!d&&f.resizable("destroy"),h&&typeof d=="string"&&f.resizable("option","handles",d),!h&&d!==!1&&e._makeResizable(d);break;case "title":a(".ui-dialog-title",e.uiDialogTitlebar).html(""+(d||"&#160;"))}a.Widget.prototype._setOption.apply(e,arguments)},_size:function(){var b=this.options,c,d,e=this.uiDialog.is(":visible");this.element.show().css({width:"auto",
minHeight:0,height:0}),b.minWidth>b.width&&(b.width=b.minWidth),c=this.uiDialog.css({height:"auto",width:b.width}).height(),d=Math.max(0,b.minHeight-c);if(b.height==="auto")if(a.support.minHeight)this.element.css({minHeight:d,height:"auto"});else{this.uiDialog.show();var f=this.element.css("height","auto").height();e||this.uiDialog.hide(),this.element.height(Math.max(f,d))}else this.element.height(Math.max(b.height-c,0));this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",
this._minHeight())}}),a.extend(a.ui.dialog,{version:"1.8.17",uuid:0,maxZ:0,getTitleId:function(a){var b=a.attr("id");b||(this.uuid+=1,b=this.uuid);return"ui-dialog-title-"+b},overlay:function(b){this.$el=a.ui.dialog.overlay.create(b)}}),a.extend(a.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:a.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(a){return a+".dialog-overlay"}).join(" "),create:function(b){this.instances.length===0&&(setTimeout(function(){a.ui.dialog.overlay.instances.length&&
a(document).bind(a.ui.dialog.overlay.events,function(b){if(a(b.target).zIndex()<a.ui.dialog.overlay.maxZ)return!1})},1),a(document).bind("keydown.dialog-overlay",function(c){b.options.closeOnEscape&&!c.isDefaultPrevented()&&c.keyCode&&c.keyCode===a.ui.keyCode.ESCAPE&&(b.close(c),c.preventDefault())}),a(window).bind("resize.dialog-overlay",a.ui.dialog.overlay.resize));var c=(this.oldInstances.pop()||a("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});
a.fn.bgiframe&&c.bgiframe(),this.instances.push(c);return c},destroy:function(b){var c=a.inArray(b,this.instances);c!=-1&&this.oldInstances.push(this.instances.splice(c,1)[0]),this.instances.length===0&&a([document,window]).unbind(".dialog-overlay"),b.remove();var d=0;a.each(this.instances,function(){d=Math.max(d,this.css("z-index"))}),this.maxZ=d},height:function(){var b,c;if(a.browser.msie&&a.browser.version<7){b=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),c=Math.max(document.documentElement.offsetHeight,
document.body.offsetHeight);return b<c?a(window).height()+"px":b+"px"}return a(document).height()+"px"},width:function(){var b,c;if(a.browser.msie){b=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),c=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);return b<c?a(window).width()+"px":b+"px"}return a(document).width()+"px"},resize:function(){var b=a([]);a.each(a.ui.dialog.overlay.instances,function(){b=b.add(this)}),b.css({width:0,height:0}).css({width:a.ui.dialog.overlay.width(),
height:a.ui.dialog.overlay.height()})}}),a.extend(a.ui.dialog.overlay.prototype,{destroy:function(){a.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);
(function(a,b){var c=5;a.widget("ui.slider",a.ui.mouse,{widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var b=this,d=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",g=d.values&&d.values.length||1,h=[];this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=
null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"+(d.disabled?" ui-slider-disabled ui-disabled":"")),this.range=a([]),d.range&&(d.range===!0&&(d.values||(d.values=[this._valueMin(),this._valueMin()]),d.values.length&&d.values.length!==2&&(d.values=[d.values[0],d.values[0]])),this.range=a("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(d.range==="min"||
d.range==="max"?" ui-slider-range-"+d.range:"")));for(var i=e.length;i<g;i+=1)h.push(f);this.handles=e.add(a(h.join("")).appendTo(b.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(a){a.preventDefault()}).hover(function(){d.disabled||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).focus(function(){d.disabled?a(this).blur():(a(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),a(this).addClass("ui-state-focus"))}).blur(function(){a(this).removeClass("ui-state-focus")}),
this.handles.each(function(b){a(this).data("index.ui-slider-handle",b)}),this.handles.keydown(function(d){var e=!0,f=a(this).data("index.ui-slider-handle"),g,h,i,j;if(!b.options.disabled){switch(d.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:e=!1;if(!b._keySliding){b._keySliding=!0,a(this).addClass("ui-state-active"),g=b._start(d,f);if(g===!1)return}}j=
b.options.step,b.options.values&&b.options.values.length?h=i=b.values(f):h=i=b.value();switch(d.keyCode){case a.ui.keyCode.HOME:i=b._valueMin();break;case a.ui.keyCode.END:i=b._valueMax();break;case a.ui.keyCode.PAGE_UP:i=b._trimAlignValue(h+(b._valueMax()-b._valueMin())/c);break;case a.ui.keyCode.PAGE_DOWN:i=b._trimAlignValue(h-(b._valueMax()-b._valueMin())/c);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(h===b._valueMax())return;i=b._trimAlignValue(h+j);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(h===
b._valueMin())return;i=b._trimAlignValue(h-j)}b._slide(d,f,i);return e}}).keyup(function(c){var d=a(this).data("index.ui-slider-handle");b._keySliding&&(b._keySliding=!1,b._stop(c,d),b._change(c,d),a(this).removeClass("ui-state-active"))}),this._refreshValue(),this._animateOff=!1},destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider"),
this._mouseDestroy();return this},_mouseCapture:function(b){var c=this.options,d,e,f,g,h,i,j,k,l;if(c.disabled)return!1;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),d={x:b.pageX,y:b.pageY},e=this._normValueFromMouse(d),f=this._valueMax()-this._valueMin()+1,h=this,this.handles.each(function(b){var c=Math.abs(e-h.values(b));f>c&&(f=c,g=a(this),i=b)}),c.range===!0&&this.values(1)===c.min&&(i+=1,g=a(this.handles[i])),j=this._start(b,
i);if(j===!1)return!1;this._mouseSliding=!0,h._handleIndex=i,g.addClass("ui-state-active").focus(),k=g.offset(),l=!a(b.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:b.pageX-k.left-g.width()/2,top:b.pageY-k.top-g.height()/2-(parseInt(g.css("borderTopWidth"),10)||0)-(parseInt(g.css("borderBottomWidth"),10)||0)+(parseInt(g.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(b,i,e),this._animateOff=!0;return!0},_mouseStart:function(a){return!0},
_mouseDrag:function(a){var b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b);this._slide(a,this._handleIndex,c);return!1},_mouseStop:function(a){this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1;return!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,
c,d,e,f;this.orientation==="horizontal"?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),d=c/b,d>1&&(d=1),d<0&&(d=0),this.orientation==="vertical"&&(d=1-d),e=this._valueMax()-this._valueMin(),f=this._valueMin()+d*e;return this._trimAlignValue(f)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&
(c.value=this.values(b),c.values=this.values());return this._trigger("start",a,c)},_slide:function(a,b,c){var d,e,f;this.options.values&&this.options.values.length?(d=this.values(b?0:1),this.options.values.length===2&&this.options.range===!0&&(b===0&&c>d||b===1&&c<d)&&(c=d),c!==this.values(b)&&(e=this.values(),e[b]=c,f=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),d=this.values(b?0:1),f!==!1&&this.values(b,c,!0))):c!==this.value()&&(f=this._trigger("slide",a,{handle:this.handles[b],
value:c}),f!==!1&&this.value(c))},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("change",a,c)}},value:function(a){if(arguments.length)this.options.value=
this._trimAlignValue(a),this._refreshValue(),this._change(null,0);else return this._value()},values:function(b,c){var d,e,f;if(arguments.length>1)this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),this._change(null,b);else{if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();d=this.options.values,e=arguments[0];for(f=0;f<d.length;f+=1)d[f]=this._trimAlignValue(e[f]),this._change(null,
f);this._refreshValue()}},_setOption:function(b,c){var d,e=0;a.isArray(this.options.values)&&(e=this.options.values.length),a.Widget.prototype._setOption.apply(this,arguments);switch(b){case "disabled":c?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.propAttr("disabled",!1),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+
this.orientation),this._refreshValue();break;case "value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case "values":this._animateOff=!0,this._refreshValue();for(d=0;d<e;d+=1)this._change(null,d);this._animateOff=!1}},_value:function(){var a=this.options.value;a=this._trimAlignValue(a);return a},_values:function(a){var b,c,d;if(arguments.length){b=this.options.values[a],b=this._trimAlignValue(b);return b}c=this.options.values.slice();for(d=0;d<c.length;d+=
1)c[d]=this._trimAlignValue(c[d]);return c},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b,d=a-c;Math.abs(c)*2>=b&&(d+=c>0?b:-b);return parseFloat(d.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b=this.options.range,c=this.options,d=this,e=this._animateOff?!1:c.animate,
f,g={},h,i,j,k;this.options.values&&this.options.values.length?this.handles.each(function(b,i){f=(d.values(b)-d._valueMin())/(d._valueMax()-d._valueMin())*100,g[d.orientation==="horizontal"?"left":"bottom"]=f+"%",a(this).stop(1,1)[e?"animate":"css"](g,c.animate),d.options.range===!0&&(d.orientation==="horizontal"?(b===0&&d.range.stop(1,1)[e?"animate":"css"]({left:f+"%"},c.animate),b===1&&d.range[e?"animate":"css"]({width:f-h+"%"},{queue:!1,duration:c.animate})):(b===0&&d.range.stop(1,1)[e?"animate":
"css"]({bottom:f+"%"},c.animate),b===1&&d.range[e?"animate":"css"]({height:f-h+"%"},{queue:!1,duration:c.animate}))),h=f}):(i=this.value(),j=this._valueMin(),k=this._valueMax(),f=k!==j?(i-j)/(k-j)*100:0,g[d.orientation==="horizontal"?"left":"bottom"]=f+"%",this.handle.stop(1,1)[e?"animate":"css"](g,c.animate),b==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[e?"animate":"css"]({width:f+"%"},c.animate),b==="max"&&this.orientation==="horizontal"&&this.range[e?"animate":"css"]({width:100-
f+"%"},{queue:!1,duration:c.animate}),b==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[e?"animate":"css"]({height:f+"%"},c.animate),b==="max"&&this.orientation==="vertical"&&this.range[e?"animate":"css"]({height:100-f+"%"},{queue:!1,duration:c.animate}))}}),a.extend(a.ui.slider,{version:"1.8.17"})})(jQuery);
(function(a,b){function f(){return++d}function e(){return++c}var c=0,d=0;a.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:!1,cookie:null,collapsible:!1,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},_create:function(){this._tabify(!0)},_setOption:function(a,b){if(a=="selected"){if(this.options.collapsible&&
b==this.options.selected)return;this.select(b)}else this.options[a]=b,this._tabify()},_tabId:function(a){return a.title&&a.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+e()},_sanitizeSelector:function(a){return a.replace(/:/g,"\\:")},_cookie:function(){var b=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+f());return a.cookie.apply(null,[b].concat(a.makeArray(arguments)))},_ui:function(a,b){return{tab:a,panel:b,index:this.anchors.index(a)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var b=
a(this);b.html(b.data("label.tabs")).removeData("label.tabs")})},_tabify:function(c){function m(b,c){b.css("display",""),!a.support.opacity&&c.opacity&&b[0].style.removeAttribute("filter")}var d=this,e=this.options,f=/^#.+/;this.list=this.element.find("ol,ul").eq(0),this.lis=a(" > li:has(a[href])",this.list),this.anchors=this.lis.map(function(){return a("a",this)[0]}),this.panels=a([]),this.anchors.each(function(b,c){var g=a(c).attr("href"),h=g.split("#")[0],i;h&&(h===location.toString().split("#")[0]||
(i=a("base")[0])&&h===i.href)&&(g=c.hash,c.href=g);if(f.test(g))d.panels=d.panels.add(d.element.find(d._sanitizeSelector(g)));else if(g&&g!=="#"){a.data(c,"href.tabs",g),a.data(c,"load.tabs",g.replace(/#.*$/,""));var j=d._tabId(c);c.href="#"+j;var k=d.element.find("#"+j);k.length||(k=a(e.panelTemplate).attr("id",j).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(d.panels[b-1]||d.list),k.data("destroy.tabs",!0)),d.panels=d.panels.add(k)}else e.disabled.push(b)}),c?(this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all"),
this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"),this.lis.addClass("ui-state-default ui-corner-top"),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom"),e.selected===b?(location.hash&&this.anchors.each(function(a,b){if(b.hash==location.hash){e.selected=a;return!1}}),typeof e.selected!="number"&&e.cookie&&(e.selected=parseInt(d._cookie(),10)),typeof e.selected!="number"&&this.lis.filter(".ui-tabs-selected").length&&(e.selected=
this.lis.index(this.lis.filter(".ui-tabs-selected"))),e.selected=e.selected||(this.lis.length?0:-1)):e.selected===null&&(e.selected=-1),e.selected=e.selected>=0&&this.anchors[e.selected]||e.selected<0?e.selected:0,e.disabled=a.unique(e.disabled.concat(a.map(this.lis.filter(".ui-state-disabled"),function(a,b){return d.lis.index(a)}))).sort(),a.inArray(e.selected,e.disabled)!=-1&&e.disabled.splice(a.inArray(e.selected,e.disabled),1),this.panels.addClass("ui-tabs-hide"),this.lis.removeClass("ui-tabs-selected ui-state-active"),
e.selected>=0&&this.anchors.length&&(d.element.find(d._sanitizeSelector(d.anchors[e.selected].hash)).removeClass("ui-tabs-hide"),this.lis.eq(e.selected).addClass("ui-tabs-selected ui-state-active"),d.element.queue("tabs",function(){d._trigger("show",null,d._ui(d.anchors[e.selected],d.element.find(d._sanitizeSelector(d.anchors[e.selected].hash))[0]))}),this.load(e.selected)),a(window).bind("unload",function(){d.lis.add(d.anchors).unbind(".tabs"),d.lis=d.anchors=d.panels=null})):e.selected=this.lis.index(this.lis.filter(".ui-tabs-selected")),
this.element[e.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible"),e.cookie&&this._cookie(e.selected,e.cookie);for(var g=0,h;h=this.lis[g];g++)a(h)[a.inArray(g,e.disabled)!=-1&&!a(h).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled");e.cache===!1&&this.anchors.removeData("cache.tabs"),this.lis.add(this.anchors).unbind(".tabs");if(e.event!=="mouseover"){var i=function(a,b){b.is(":not(.ui-state-disabled)")&&b.addClass("ui-state-"+a)},j=function(a,b){b.removeClass("ui-state-"+
a)};this.lis.bind("mouseover.tabs",function(){i("hover",a(this))}),this.lis.bind("mouseout.tabs",function(){j("hover",a(this))}),this.anchors.bind("focus.tabs",function(){i("focus",a(this).closest("li"))}),this.anchors.bind("blur.tabs",function(){j("focus",a(this).closest("li"))})}var k,l;e.fx&&(a.isArray(e.fx)?(k=e.fx[0],l=e.fx[1]):k=l=e.fx);var n=l?function(b,c){a(b).closest("li").addClass("ui-tabs-selected ui-state-active"),c.hide().removeClass("ui-tabs-hide").animate(l,l.duration||"normal",function(){m(c,
l),d._trigger("show",null,d._ui(b,c[0]))})}:function(b,c){a(b).closest("li").addClass("ui-tabs-selected ui-state-active"),c.removeClass("ui-tabs-hide"),d._trigger("show",null,d._ui(b,c[0]))},o=k?function(a,b){b.animate(k,k.duration||"normal",function(){d.lis.removeClass("ui-tabs-selected ui-state-active"),b.addClass("ui-tabs-hide"),m(b,k),d.element.dequeue("tabs")})}:function(a,b,c){d.lis.removeClass("ui-tabs-selected ui-state-active"),b.addClass("ui-tabs-hide"),d.element.dequeue("tabs")};this.anchors.bind(e.event+
".tabs",function(){var b=this,c=a(b).closest("li"),f=d.panels.filter(":not(.ui-tabs-hide)"),g=d.element.find(d._sanitizeSelector(b.hash));if(c.hasClass("ui-tabs-selected")&&!e.collapsible||c.hasClass("ui-state-disabled")||c.hasClass("ui-state-processing")||d.panels.filter(":animated").length||d._trigger("select",null,d._ui(this,g[0]))===!1){this.blur();return!1}e.selected=d.anchors.index(this),d.abort();if(e.collapsible){if(c.hasClass("ui-tabs-selected")){e.selected=-1,e.cookie&&d._cookie(e.selected,
e.cookie),d.element.queue("tabs",function(){o(b,f)}).dequeue("tabs"),this.blur();return!1}if(!f.length){e.cookie&&d._cookie(e.selected,e.cookie),d.element.queue("tabs",function(){n(b,g)}),d.load(d.anchors.index(this)),this.blur();return!1}}e.cookie&&d._cookie(e.selected,e.cookie);if(g.length)f.length&&d.element.queue("tabs",function(){o(b,f)}),d.element.queue("tabs",function(){n(b,g)}),d.load(d.anchors.index(this));else throw"jQuery UI Tabs: Mismatching fragment identifier.";a.browser.msie&&this.blur()}),
this.anchors.bind("click.tabs",function(){return!1})},_getIndex:function(a){typeof a=="string"&&(a=this.anchors.index(this.anchors.filter("[href$="+a+"]")));return a},destroy:function(){var b=this.options;this.abort(),this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs"),this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"),this.anchors.each(function(){var b=a.data(this,
"href.tabs");b&&(this.href=b);var c=a(this).unbind(".tabs");a.each(["href","load","cache"],function(a,b){c.removeData(b+".tabs")})}),this.lis.unbind(".tabs").add(this.panels).each(function(){a.data(this,"destroy.tabs")?a(this).remove():a(this).removeClass(["ui-state-default","ui-corner-top","ui-tabs-selected","ui-state-active","ui-state-hover","ui-state-focus","ui-state-disabled","ui-tabs-panel","ui-widget-content","ui-corner-bottom","ui-tabs-hide"].join(" "))}),b.cookie&&this._cookie(null,b.cookie);
return this},add:function(c,d,e){e===b&&(e=this.anchors.length);var f=this,g=this.options,h=a(g.tabTemplate.replace(/#\{href\}/g,c).replace(/#\{label\}/g,d)),i=c.indexOf("#")?this._tabId(a("a",h)[0]):c.replace("#","");h.addClass("ui-state-default ui-corner-top").data("destroy.tabs",!0);var j=f.element.find("#"+i);j.length||(j=a(g.panelTemplate).attr("id",i).data("destroy.tabs",!0)),j.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"),e>=this.lis.length?(h.appendTo(this.list),
j.appendTo(this.list[0].parentNode)):(h.insertBefore(this.lis[e]),j.insertBefore(this.panels[e])),g.disabled=a.map(g.disabled,function(a,b){return a>=e?++a:a}),this._tabify(),this.anchors.length==1&&(g.selected=0,h.addClass("ui-tabs-selected ui-state-active"),j.removeClass("ui-tabs-hide"),this.element.queue("tabs",function(){f._trigger("show",null,f._ui(f.anchors[0],f.panels[0]))}),this.load(0)),this._trigger("add",null,this._ui(this.anchors[e],this.panels[e]));return this},remove:function(b){b=this._getIndex(b);
var c=this.options,d=this.lis.eq(b).remove(),e=this.panels.eq(b).remove();d.hasClass("ui-tabs-selected")&&this.anchors.length>1&&this.select(b+(b+1<this.anchors.length?1:-1)),c.disabled=a.map(a.grep(c.disabled,function(a,c){return a!=b}),function(a,c){return a>=b?--a:a}),this._tabify(),this._trigger("remove",null,this._ui(d.find("a")[0],e[0]));return this},enable:function(b){b=this._getIndex(b);var c=this.options;if(a.inArray(b,c.disabled)!=-1){this.lis.eq(b).removeClass("ui-state-disabled"),c.disabled=
a.grep(c.disabled,function(a,c){return a!=b}),this._trigger("enable",null,this._ui(this.anchors[b],this.panels[b]));return this}},disable:function(a){a=this._getIndex(a);var b=this,c=this.options;a!=c.selected&&(this.lis.eq(a).addClass("ui-state-disabled"),c.disabled.push(a),c.disabled.sort(),this._trigger("disable",null,this._ui(this.anchors[a],this.panels[a])));return this},select:function(a){a=this._getIndex(a);if(a==-1)if(this.options.collapsible&&this.options.selected!=-1)a=this.options.selected;
else return this;this.anchors.eq(a).trigger(this.options.event+".tabs");return this},load:function(b){b=this._getIndex(b);var c=this,d=this.options,e=this.anchors.eq(b)[0],f=a.data(e,"load.tabs");this.abort();if(!f||this.element.queue("tabs").length!==0&&a.data(e,"cache.tabs"))this.element.dequeue("tabs");else{this.lis.eq(b).addClass("ui-state-processing");if(d.spinner){var g=a("span",e);g.data("label.tabs",g.html()).html(d.spinner)}this.xhr=a.ajax(a.extend({},d.ajaxOptions,{url:f,success:function(f,
g){c.element.find(c._sanitizeSelector(e.hash)).html(f),c._cleanup(),d.cache&&a.data(e,"cache.tabs",!0),c._trigger("load",null,c._ui(c.anchors[b],c.panels[b]));try{d.ajaxOptions.success(f,g)}catch(h){}},error:function(a,f,g){c._cleanup(),c._trigger("load",null,c._ui(c.anchors[b],c.panels[b]));try{d.ajaxOptions.error(a,f,b,e)}catch(g){}}})),c.element.dequeue("tabs");return this}},abort:function(){this.element.queue([]),this.panels.stop(!1,!0),this.element.queue("tabs",this.element.queue("tabs").splice(-2,
2)),this.xhr&&(this.xhr.abort(),delete this.xhr),this._cleanup();return this},url:function(a,b){this.anchors.eq(a).removeData("cache.tabs").data("load.tabs",b);return this},length:function(){return this.anchors.length}}),a.extend(a.ui.tabs,{version:"1.8.17"}),a.extend(a.ui.tabs.prototype,{rotation:null,rotate:function(a,b){var c=this,d=this.options,e=c._rotate||(c._rotate=function(b){clearTimeout(c.rotation),c.rotation=setTimeout(function(){var a=d.selected;c.select(++a<c.anchors.length?a:0)},a),
b&&b.stopPropagation()}),f=c._unrotate||(c._unrotate=b?function(a){t=d.selected,e()}:function(a){a.clientX&&c.rotate(null)});a?(this.element.bind("tabsshow",e),this.anchors.bind(d.event+".tabs",f),e()):(clearTimeout(c.rotation),this.element.unbind("tabsshow",e),this.anchors.unbind(d.event+".tabs",f),delete this._rotate,delete this._unrotate);return this}})})(jQuery);
(function($,undefined){function isArray(a){return a&&($.browser.safari&&typeof a=="object"&&a.length||a.constructor&&a.constructor.toString().match(/\Array\(\)/))}function extendRemove(a,b){$.extend(a,b);for(var c in b)if(b[c]==null||b[c]==undefined)a[c]=b[c];return a}function bindHover(a){var b="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return a.bind("mouseout",function(a){var c=$(a.target).closest(b);!c.length||c.removeClass("ui-state-hover ui-datepicker-prev-hover ui-datepicker-next-hover")}).bind("mouseover",
function(c){var d=$(c.target).closest(b);!$.datepicker._isDisabledDatepicker(instActive.inline?a.parent()[0]:instActive.input[0])&&!!d.length&&(d.parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),d.addClass("ui-state-hover"),d.hasClass("ui-datepicker-prev")&&d.addClass("ui-datepicker-prev-hover"),d.hasClass("ui-datepicker-next")&&d.addClass("ui-datepicker-next-hover"))})}function Datepicker(){this.debug=!1,this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=
!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",
currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,
yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,
numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},$.extend(this._defaults,this.regional[""]),this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}$.extend($.ui,{datepicker:{version:"1.8.17"}});var PROP_NAME="datepicker",dpuuid=(new Date).getTime(),instActive;$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",
maxRows:4,log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){extendRemove(this._defaults,a||{});return this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase(),
inline=nodeName=="div"||nodeName=="span";target.id||(this.uuid+=1,target.id="dp"+this.uuid);var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{}),nodeName=="input"?this._connectDatepicker(target,inst):inline&&this._inlineDatepicker(target,inst)},_newInst:function(a,b){var c=a[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:c,input:a,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,dpDiv:b?bindHover($('<div class="'+this._inlineClass+
' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(a,b){var c=$(a);b.append=$([]),b.trigger=$([]);c.hasClass(this.markerClassName)||(this._attachments(c,b),c.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(a,c,d){b.settings[c]=d}).bind("getData.datepicker",function(a,c){return this._get(b,c)}),this._autoSize(b),$.data(a,PROP_NAME,
b),b.settings.disabled&&this._disableDatepicker(a))},_attachments:function(a,b){var c=this._get(b,"appendText"),d=this._get(b,"isRTL");b.append&&b.append.remove(),c&&(b.append=$('<span class="'+this._appendClass+'">'+c+"</span>"),a[d?"before":"after"](b.append)),a.unbind("focus",this._showDatepicker),b.trigger&&b.trigger.remove();var e=this._get(b,"showOn");(e=="focus"||e=="both")&&a.focus(this._showDatepicker);if(e=="button"||e=="both"){var f=this._get(b,"buttonText"),g=this._get(b,"buttonImage");
b.trigger=$(this._get(b,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:g,alt:f,title:f}):$('<button type="button"></button>').addClass(this._triggerClass).html(g==""?f:$("<img/>").attr({src:g,alt:f,title:f}))),a[d?"before":"after"](b.trigger),b.trigger.click(function(){$.datepicker._datepickerShowing&&$.datepicker._lastInput==a[0]?$.datepicker._hideDatepicker():$.datepicker._showDatepicker(a[0]);return!1})}},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b=
new Date(2009,11,20),c=this._get(a,"dateFormat");if(c.match(/[DM]/)){var d=function(a){var b=0,c=0;for(var d=0;d<a.length;d++)a[d].length>b&&(b=a[d].length,c=d);return c};b.setMonth(d(this._get(a,c.match(/MM/)?"monthNames":"monthNamesShort"))),b.setDate(d(this._get(a,c.match(/DD/)?"dayNames":"dayNamesShort"))+20-b.getDay())}a.input.attr("size",this._formatDate(a,b).length)}},_inlineDatepicker:function(a,b){var c=$(a);c.hasClass(this.markerClassName)||(c.addClass(this.markerClassName).append(b.dpDiv).bind("setData.datepicker",
function(a,c,d){b.settings[c]=d}).bind("getData.datepicker",function(a,c){return this._get(b,c)}),$.data(a,PROP_NAME,b),this._setDate(b,this._getDefaultDate(b),!0),this._updateDatepicker(b),this._updateAlternate(b),b.settings.disabled&&this._disableDatepicker(a),b.dpDiv.css("display","block"))},_dialogDatepicker:function(a,b,c,d,e){var f=this._dialogInst;if(!f){this.uuid+=1;var g="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+g+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>'),
this._dialogInput.keydown(this._doKeyDown),$("body").append(this._dialogInput),f=this._dialogInst=this._newInst(this._dialogInput,!1),f.settings={},$.data(this._dialogInput[0],PROP_NAME,f)}extendRemove(f.settings,d||{}),b=b&&b.constructor==Date?this._formatDate(f,b):b,this._dialogInput.val(b),this._pos=e?e.length?e:[e.pageX,e.pageY]:null;if(!this._pos){var h=document.documentElement.clientWidth,i=document.documentElement.clientHeight,j=document.documentElement.scrollLeft||document.body.scrollLeft,
k=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[h/2-100+j,i/2-150+k]}this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),f.settings.onSelect=c,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],PROP_NAME,f);return this},_destroyDatepicker:function(a){var b=$(a),c=$.data(a,PROP_NAME);if(!!b.hasClass(this.markerClassName)){var d=a.nodeName.toLowerCase();
$.removeData(a,PROP_NAME),d=="input"?(c.append.remove(),c.trigger.remove(),b.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):(d=="div"||d=="span")&&b.removeClass(this.markerClassName).empty()}},_enableDatepicker:function(a){var b=$(a),c=$.data(a,PROP_NAME);if(!!b.hasClass(this.markerClassName)){var d=a.nodeName.toLowerCase();if(d=="input")a.disabled=!1,c.trigger.filter("button").each(function(){this.disabled=
!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if(d=="div"||d=="span"){var e=b.children("."+this._inlineClass);e.children().removeClass("ui-state-disabled"),e.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled")}this._disabledInputs=$.map(this._disabledInputs,function(b){return b==a?null:b})}},_disableDatepicker:function(a){var b=$(a),c=$.data(a,PROP_NAME);if(!!b.hasClass(this.markerClassName)){var d=a.nodeName.toLowerCase();if(d=="input")a.disabled=!0,
c.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if(d=="div"||d=="span"){var e=b.children("."+this._inlineClass);e.children().addClass("ui-state-disabled"),e.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled","disabled")}this._disabledInputs=$.map(this._disabledInputs,function(b){return b==a?null:b}),this._disabledInputs[this._disabledInputs.length]=a}},_isDisabledDatepicker:function(a){if(!a)return!1;
for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]==a)return!0;return!1},_getInst:function(a){try{return $.data(a,PROP_NAME)}catch(b){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(a,b,c){var d=this._getInst(a);if(arguments.length==2&&typeof b=="string")return b=="defaults"?$.extend({},$.datepicker._defaults):d?b=="all"?$.extend({},d.settings):this._get(d,b):null;var e=b||{};typeof b=="string"&&(e={},e[b]=c);if(d){this._curInst==d&&this._hideDatepicker();
var f=this._getDateDatepicker(a,!0),g=this._getMinMaxDate(d,"min"),h=this._getMinMaxDate(d,"max");extendRemove(d.settings,e),g!==null&&e.dateFormat!==undefined&&e.minDate===undefined&&(d.settings.minDate=this._formatDate(d,g)),h!==null&&e.dateFormat!==undefined&&e.maxDate===undefined&&(d.settings.maxDate=this._formatDate(d,h)),this._attachments($(a),d),this._autoSize(d),this._setDate(d,f),this._updateAlternate(d),this._updateDatepicker(d)}},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,
b,c)},_refreshDatepicker:function(a){var b=this._getInst(a);b&&this._updateDatepicker(b)},_setDateDatepicker:function(a,b){var c=this._getInst(a);c&&(this._setDate(c,b),this._updateDatepicker(c),this._updateAlternate(c))},_getDateDatepicker:function(a,b){var c=this._getInst(a);c&&!c.inline&&this._setDateFromField(c,b);return c?this._getDate(c):null},_doKeyDown:function(a){var b=$.datepicker._getInst(a.target),c=!0,d=b.dpDiv.is(".ui-datepicker-rtl");b._keyEvent=!0;if($.datepicker._datepickerShowing)switch(a.keyCode){case 9:$.datepicker._hideDatepicker(),
c=!1;break;case 13:var e=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",b.dpDiv);e[0]&&$.datepicker._selectDay(a.target,b.selectedMonth,b.selectedYear,e[0]);var f=$.datepicker._get(b,"onSelect");if(f){var g=$.datepicker._formatDate(b);f.apply(b.input?b.input[0]:null,[g,b])}else $.datepicker._hideDatepicker();return!1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(a.target,a.ctrlKey?-$.datepicker._get(b,"stepBigMonths"):-$.datepicker._get(b,
"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(a.target,a.ctrlKey?+$.datepicker._get(b,"stepBigMonths"):+$.datepicker._get(b,"stepMonths"),"M");break;case 35:(a.ctrlKey||a.metaKey)&&$.datepicker._clearDate(a.target),c=a.ctrlKey||a.metaKey;break;case 36:(a.ctrlKey||a.metaKey)&&$.datepicker._gotoToday(a.target),c=a.ctrlKey||a.metaKey;break;case 37:(a.ctrlKey||a.metaKey)&&$.datepicker._adjustDate(a.target,d?1:-1,"D"),c=a.ctrlKey||a.metaKey,a.originalEvent.altKey&&$.datepicker._adjustDate(a.target,
a.ctrlKey?-$.datepicker._get(b,"stepBigMonths"):-$.datepicker._get(b,"stepMonths"),"M");break;case 38:(a.ctrlKey||a.metaKey)&&$.datepicker._adjustDate(a.target,-7,"D"),c=a.ctrlKey||a.metaKey;break;case 39:(a.ctrlKey||a.metaKey)&&$.datepicker._adjustDate(a.target,d?-1:1,"D"),c=a.ctrlKey||a.metaKey,a.originalEvent.altKey&&$.datepicker._adjustDate(a.target,a.ctrlKey?+$.datepicker._get(b,"stepBigMonths"):+$.datepicker._get(b,"stepMonths"),"M");break;case 40:(a.ctrlKey||a.metaKey)&&$.datepicker._adjustDate(a.target,
7,"D"),c=a.ctrlKey||a.metaKey;break;default:c=!1}else a.keyCode==36&&a.ctrlKey?$.datepicker._showDatepicker(this):c=!1;c&&(a.preventDefault(),a.stopPropagation())},_doKeyPress:function(a){var b=$.datepicker._getInst(a.target);if($.datepicker._get(b,"constrainInput")){var c=$.datepicker._possibleChars($.datepicker._get(b,"dateFormat")),d=String.fromCharCode(a.charCode==undefined?a.keyCode:a.charCode);return a.ctrlKey||a.metaKey||d<" "||!c||c.indexOf(d)>-1}},_doKeyUp:function(a){var b=$.datepicker._getInst(a.target);
if(b.input.val()!=b.lastVal)try{var c=$.datepicker.parseDate($.datepicker._get(b,"dateFormat"),b.input?b.input.val():null,$.datepicker._getFormatConfig(b));c&&($.datepicker._setDateFromField(b),$.datepicker._updateAlternate(b),$.datepicker._updateDatepicker(b))}catch(a){$.datepicker.log(a)}return!0},_showDatepicker:function(a){a=a.target||a,a.nodeName.toLowerCase()!="input"&&(a=$("input",a.parentNode)[0]);if(!$.datepicker._isDisabledDatepicker(a)&&$.datepicker._lastInput!=a){var b=$.datepicker._getInst(a);
$.datepicker._curInst&&$.datepicker._curInst!=b&&($.datepicker._curInst.dpDiv.stop(!0,!0),b&&$.datepicker._datepickerShowing&&$.datepicker._hideDatepicker($.datepicker._curInst.input[0]));var c=$.datepicker._get(b,"beforeShow"),d=c?c.apply(a,[a,b]):{};if(d===!1)return;extendRemove(b.settings,d),b.lastVal=null,$.datepicker._lastInput=a,$.datepicker._setDateFromField(b),$.datepicker._inDialog&&(a.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(a),$.datepicker._pos[1]+=a.offsetHeight);
var e=!1;$(a).parents().each(function(){e|=$(this).css("position")=="fixed";return!e}),e&&$.browser.opera&&($.datepicker._pos[0]-=document.documentElement.scrollLeft,$.datepicker._pos[1]-=document.documentElement.scrollTop);var f={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null,b.dpDiv.empty(),b.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(b),f=$.datepicker._checkOffset(b,f,e),b.dpDiv.css({position:$.datepicker._inDialog&&
$.blockUI?"static":e?"fixed":"absolute",display:"none",left:f.left+"px",top:f.top+"px"});if(!b.inline){var g=$.datepicker._get(b,"showAnim"),h=$.datepicker._get(b,"duration"),i=function(){var a=b.dpDiv.find("iframe.ui-datepicker-cover");if(!!a.length){var c=$.datepicker._getBorders(b.dpDiv);a.css({left:-c[0],top:-c[1],width:b.dpDiv.outerWidth(),height:b.dpDiv.outerHeight()})}};b.dpDiv.zIndex($(a).zIndex()+1),$.datepicker._datepickerShowing=!0,$.effects&&$.effects[g]?b.dpDiv.show(g,$.datepicker._get(b,
"showOptions"),h,i):b.dpDiv[g||"show"](g?h:null,i),(!g||!h)&&i(),b.input.is(":visible")&&!b.input.is(":disabled")&&b.input.focus(),$.datepicker._curInst=b}}},_updateDatepicker:function(a){var b=this;b.maxRows=4;var c=$.datepicker._getBorders(a.dpDiv);instActive=a,a.dpDiv.empty().append(this._generateHTML(a));var d=a.dpDiv.find("iframe.ui-datepicker-cover");!d.length||d.css({left:-c[0],top:-c[1],width:a.dpDiv.outerWidth(),height:a.dpDiv.outerHeight()}),a.dpDiv.find("."+this._dayOverClass+" a").mouseover();
var e=this._getNumberOfMonths(a),f=e[1],g=17;a.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),f>1&&a.dpDiv.addClass("ui-datepicker-multi-"+f).css("width",g*f+"em"),a.dpDiv[(e[0]!=1||e[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi"),a.dpDiv[(this._get(a,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),a==$.datepicker._curInst&&$.datepicker._datepickerShowing&&a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&a.input[0]!=document.activeElement&&
a.input.focus();if(a.yearshtml){var h=a.yearshtml;setTimeout(function(){h===a.yearshtml&&a.yearshtml&&a.dpDiv.find("select.ui-datepicker-year:first").replaceWith(a.yearshtml),h=a.yearshtml=null},0)}},_getBorders:function(a){var b=function(a){return{thin:1,medium:2,thick:3}[a]||a};return[parseFloat(b(a.css("border-left-width"))),parseFloat(b(a.css("border-top-width")))]},_checkOffset:function(a,b,c){var d=a.dpDiv.outerWidth(),e=a.dpDiv.outerHeight(),f=a.input?a.input.outerWidth():0,g=a.input?a.input.outerHeight():
0,h=document.documentElement.clientWidth+$(document).scrollLeft(),i=document.documentElement.clientHeight+$(document).scrollTop();b.left-=this._get(a,"isRTL")?d-f:0,b.left-=c&&b.left==a.input.offset().left?$(document).scrollLeft():0,b.top-=c&&b.top==a.input.offset().top+g?$(document).scrollTop():0,b.left-=Math.min(b.left,b.left+d>h&&h>d?Math.abs(b.left+d-h):0),b.top-=Math.min(b.top,b.top+e>i&&i>e?Math.abs(e+g):0);return b},_findPos:function(a){var b=this._getInst(a),c=this._get(b,"isRTL");while(a&&
(a.type=="hidden"||a.nodeType!=1||$.expr.filters.hidden(a)))a=a[c?"previousSibling":"nextSibling"];var d=$(a).offset();return[d.left,d.top]},_hideDatepicker:function(a){var b=this._curInst;if(!(!b||a&&b!=$.data(a,PROP_NAME))&&this._datepickerShowing){var c=this._get(b,"showAnim"),d=this._get(b,"duration"),e=this,f=function(){$.datepicker._tidyDialog(b),e._curInst=null};$.effects&&$.effects[c]?b.dpDiv.hide(c,$.datepicker._get(b,"showOptions"),d,f):b.dpDiv[c=="slideDown"?"slideUp":c=="fadeIn"?"fadeOut":
"hide"](c?d:null,f),c||f(),this._datepickerShowing=!1;var g=this._get(b,"onClose");g&&g.apply(b.input?b.input[0]:null,[b.input?b.input.val():"",b]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(a){if(!!$.datepicker._curInst){var b=$(a.target),
c=$.datepicker._getInst(b[0]);(b[0].id!=$.datepicker._mainDivId&&b.parents("#"+$.datepicker._mainDivId).length==0&&!b.hasClass($.datepicker.markerClassName)&&!b.hasClass($.datepicker._triggerClass)&&$.datepicker._datepickerShowing&&(!$.datepicker._inDialog||!$.blockUI)||b.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!=c)&&$.datepicker._hideDatepicker()}},_adjustDate:function(a,b,c){var d=$(a),e=this._getInst(d[0]);this._isDisabledDatepicker(d[0])||(this._adjustInstDate(e,b+(c=="M"?
this._get(e,"showCurrentAtPos"):0),c),this._updateDatepicker(e))},_gotoToday:function(a){var b=$(a),c=this._getInst(b[0]);if(this._get(c,"gotoCurrent")&&c.currentDay)c.selectedDay=c.currentDay,c.drawMonth=c.selectedMonth=c.currentMonth,c.drawYear=c.selectedYear=c.currentYear;else{var d=new Date;c.selectedDay=d.getDate(),c.drawMonth=c.selectedMonth=d.getMonth(),c.drawYear=c.selectedYear=d.getFullYear()}this._notifyChange(c),this._adjustDate(b)},_selectMonthYear:function(a,b,c){var d=$(a),e=this._getInst(d[0]);
e["selected"+(c=="M"?"Month":"Year")]=e["draw"+(c=="M"?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10),this._notifyChange(e),this._adjustDate(d)},_selectDay:function(a,b,c,d){var e=$(a);if(!$(d).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(e[0])){var f=this._getInst(e[0]);f.selectedDay=f.currentDay=$("a",d).html(),f.selectedMonth=f.currentMonth=b,f.selectedYear=f.currentYear=c,this._selectDate(a,this._formatDate(f,f.currentDay,f.currentMonth,f.currentYear))}},_clearDate:function(a){var b=
$(a),c=this._getInst(b[0]);this._selectDate(b,"")},_selectDate:function(a,b){var c=$(a),d=this._getInst(c[0]);b=b!=null?b:this._formatDate(d),d.input&&d.input.val(b),this._updateAlternate(d);var e=this._get(d,"onSelect");e?e.apply(d.input?d.input[0]:null,[b,d]):d.input&&d.input.trigger("change"),d.inline?this._updateDatepicker(d):(this._hideDatepicker(),this._lastInput=d.input[0],typeof d.input[0]!="object"&&d.input.focus(),this._lastInput=null)},_updateAlternate:function(a){var b=this._get(a,"altField");
if(b){var c=this._get(a,"altFormat")||this._get(a,"dateFormat"),d=this._getDate(a),e=this.formatDate(c,d,this._getFormatConfig(a));$(b).each(function(){$(this).val(e)})}},noWeekends:function(a){var b=a.getDay();return[b>0&&b<6,""]},iso8601Week:function(a){var b=new Date(a.getTime());b.setDate(b.getDate()+4-(b.getDay()||7));var c=b.getTime();b.setMonth(0),b.setDate(1);return Math.floor(Math.round((c-b)/864E5)/7)+1},parseDate:function(a,b,c){if(a==null||b==null)throw"Invalid arguments";b=typeof b==
"object"?b.toString():b+"";if(b=="")return null;var d=(c?c.shortYearCutoff:null)||this._defaults.shortYearCutoff;d=typeof d!="string"?d:(new Date).getFullYear()%100+parseInt(d,10);var e=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,f=(c?c.dayNames:null)||this._defaults.dayNames,g=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,h=(c?c.monthNames:null)||this._defaults.monthNames,i=-1,j=-1,k=-1,l=-1,m=!1,n=function(b){var c=s+1<a.length&&a.charAt(s+1)==b;c&&s++;return c},o=function(a){var c=
n(a),d=a=="@"?14:a=="!"?20:a=="y"&&c?4:a=="o"?3:2,e=new RegExp("^\\d{1,"+d+"}"),f=b.substring(r).match(e);if(!f)throw"Missing number at position "+r;r+=f[0].length;return parseInt(f[0],10)},p=function(a,c,d){var e=$.map(n(a)?d:c,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)}),f=-1;$.each(e,function(a,c){var d=c[1];if(b.substr(r,d.length).toLowerCase()==d.toLowerCase()){f=c[0],r+=d.length;return!1}});if(f!=-1)return f+1;throw"Unknown name at position "+r;},q=function(){if(b.charAt(r)!=
a.charAt(s))throw"Unexpected literal at position "+r;r++},r=0;for(var s=0;s<a.length;s++)if(m)a.charAt(s)=="'"&&!n("'")?m=!1:q();else switch(a.charAt(s)){case "d":k=o("d");break;case "D":p("D",e,f);break;case "o":l=o("o");break;case "m":j=o("m");break;case "M":j=p("M",g,h);break;case "y":i=o("y");break;case "@":var t=new Date(o("@"));i=t.getFullYear(),j=t.getMonth()+1,k=t.getDate();break;case "!":var t=new Date((o("!")-this._ticksTo1970)/1E4);i=t.getFullYear(),j=t.getMonth()+1,k=t.getDate();break;
case "'":n("'")?q():m=!0;break;default:q()}if(r<b.length)throw"Extra/unparsed characters found in date: "+b.substring(r);i==-1?i=(new Date).getFullYear():i<100&&(i+=(new Date).getFullYear()-(new Date).getFullYear()%100+(i<=d?0:-100));if(l>-1){j=1,k=l;for(;;){var u=this._getDaysInMonth(i,j-1);if(k<=u)break;j++,k-=u}}var t=this._daylightSavingAdjust(new Date(i,j-1,k));if(t.getFullYear()!=i||t.getMonth()+1!=j||t.getDate()!=k)throw"Invalid date";return t},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",
RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1E7,formatDate:function(a,b,c){if(!b)return"";var d=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,e=(c?c.dayNames:null)||this._defaults.dayNames,f=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,g=(c?c.monthNames:null)||this._defaults.monthNames,
h=function(b){var c=m+1<a.length&&a.charAt(m+1)==b;c&&m++;return c},i=function(a,b,c){var d=""+b;if(h(a))while(d.length<c)d="0"+d;return d},j=function(a,b,c,d){return h(a)?d[b]:c[b]},k="",l=!1;if(b)for(var m=0;m<a.length;m++)if(l)a.charAt(m)=="'"&&!h("'")?l=!1:k+=a.charAt(m);else switch(a.charAt(m)){case "d":k+=i("d",b.getDate(),2);break;case "D":k+=j("D",b.getDay(),d,e);break;case "o":k+=i("o",Math.round(((new Date(b.getFullYear(),b.getMonth(),b.getDate())).getTime()-(new Date(b.getFullYear(),0,
0)).getTime())/864E5),3);break;case "m":k+=i("m",b.getMonth()+1,2);break;case "M":k+=j("M",b.getMonth(),f,g);break;case "y":k+=h("y")?b.getFullYear():(b.getYear()%100<10?"0":"")+b.getYear()%100;break;case "@":k+=b.getTime();break;case "!":k+=b.getTime()*1E4+this._ticksTo1970;break;case "'":h("'")?k+="'":l=!0;break;default:k+=a.charAt(m)}return k},_possibleChars:function(a){var b="",c=!1,d=function(b){var c=e+1<a.length&&a.charAt(e+1)==b;c&&e++;return c};for(var e=0;e<a.length;e++)if(c)a.charAt(e)==
"'"&&!d("'")?c=!1:b+=a.charAt(e);else switch(a.charAt(e)){case "d":case "m":case "y":case "@":b+="0123456789";break;case "D":case "M":return null;case "'":d("'")?b+="'":c=!0;break;default:b+=a.charAt(e)}return b},_get:function(a,b){return a.settings[b]!==undefined?a.settings[b]:this._defaults[b]},_setDateFromField:function(a,b){if(a.input.val()!=a.lastVal){var c=this._get(a,"dateFormat"),d=a.lastVal=a.input?a.input.val():null,e,f;e=f=this._getDefaultDate(a);var g=this._getFormatConfig(a);try{e=this.parseDate(c,
d,g)||f}catch(h){this.log(h),d=b?"":d}a.selectedDay=e.getDate(),a.drawMonth=a.selectedMonth=e.getMonth(),a.drawYear=a.selectedYear=e.getFullYear(),a.currentDay=d?e.getDate():0,a.currentMonth=d?e.getMonth():0,a.currentYear=d?e.getFullYear():0,this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(a,b,c){var d=function(a){var b=new Date;b.setDate(b.getDate()+a);return b},e=function(b){try{return $.datepicker.parseDate($.datepicker._get(a,
"dateFormat"),b,$.datepicker._getFormatConfig(a))}catch(c){}var d=(b.toLowerCase().match(/^c/)?$.datepicker._getDate(a):null)||new Date,e=d.getFullYear(),f=d.getMonth(),g=d.getDate(),h=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,i=h.exec(b);while(i){switch(i[2]||"d"){case "d":case "D":g+=parseInt(i[1],10);break;case "w":case "W":g+=parseInt(i[1],10)*7;break;case "m":case "M":f+=parseInt(i[1],10),g=Math.min(g,$.datepicker._getDaysInMonth(e,f));break;case "y":case "Y":e+=parseInt(i[1],10),g=Math.min(g,$.datepicker._getDaysInMonth(e,
f))}i=h.exec(b)}return new Date(e,f,g)},f=b==null||b===""?c:typeof b=="string"?e(b):typeof b=="number"?isNaN(b)?c:d(b):new Date(b.getTime());f=f&&f.toString()=="Invalid Date"?c:f,f&&(f.setHours(0),f.setMinutes(0),f.setSeconds(0),f.setMilliseconds(0));return this._daylightSavingAdjust(f)},_daylightSavingAdjust:function(a){if(!a)return null;a.setHours(a.getHours()>12?a.getHours()+2:0);return a},_setDate:function(a,b,c){var d=!b,e=a.selectedMonth,f=a.selectedYear,g=this._restrictMinMax(a,this._determineDate(a,
b,new Date));a.selectedDay=a.currentDay=g.getDate(),a.drawMonth=a.selectedMonth=a.currentMonth=g.getMonth(),a.drawYear=a.selectedYear=a.currentYear=g.getFullYear(),(e!=a.selectedMonth||f!=a.selectedYear)&&!c&&this._notifyChange(a),this._adjustInstDate(a),a.input&&a.input.val(d?"":this._formatDate(a))},_getDate:function(a){var b=!a.currentYear||a.input&&a.input.val()==""?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return b},_generateHTML:function(a){var b=new Date;
b=this._daylightSavingAdjust(new Date(b.getFullYear(),b.getMonth(),b.getDate()));var c=this._get(a,"isRTL"),d=this._get(a,"showButtonPanel"),e=this._get(a,"hideIfNoPrevNext"),f=this._get(a,"navigationAsDateFormat"),g=this._getNumberOfMonths(a),h=this._get(a,"showCurrentAtPos"),i=this._get(a,"stepMonths"),j=g[0]!=1||g[1]!=1,k=this._daylightSavingAdjust(a.currentDay?new Date(a.currentYear,a.currentMonth,a.currentDay):new Date(9999,9,9)),l=this._getMinMaxDate(a,"min"),m=this._getMinMaxDate(a,"max"),
n=a.drawMonth-h,o=a.drawYear;n<0&&(n+=12,o--);if(m){var p=this._daylightSavingAdjust(new Date(m.getFullYear(),m.getMonth()-g[0]*g[1]+1,m.getDate()));p=l&&p<l?l:p;while(this._daylightSavingAdjust(new Date(o,n,1))>p)n--,n<0&&(n=11,o--)}a.drawMonth=n,a.drawYear=o;var q=this._get(a,"prevText");q=f?this.formatDate(q,this._daylightSavingAdjust(new Date(o,n-i,1)),this._getFormatConfig(a)):q;var r=this._canAdjustMonth(a,-1,o,n)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._adjustDate('#"+
a.id+"', -"+i+", 'M');\""+' title="'+q+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+q+"</span></a>":e?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+q+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+q+"</span></a>",s=this._get(a,"nextText");s=f?this.formatDate(s,this._daylightSavingAdjust(new Date(o,n+i,1)),this._getFormatConfig(a)):s;var t=this._canAdjustMonth(a,1,o,n)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+
dpuuid+".datepicker._adjustDate('#"+a.id+"', +"+i+", 'M');\""+' title="'+s+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+s+"</span></a>":e?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+s+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+s+"</span></a>",u=this._get(a,"currentText"),v=this._get(a,"gotoCurrent")&&a.currentDay?k:b;u=f?this.formatDate(u,v,this._getFormatConfig(a)):u;var w=a.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+
dpuuid+'.datepicker._hideDatepicker();">'+this._get(a,"closeText")+"</button>",x=d?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(c?w:"")+(this._isInRange(a,v)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._gotoToday('#"+a.id+"');\""+">"+u+"</button>":"")+(c?"":w)+"</div>":"",y=parseInt(this._get(a,"firstDay"),10);y=isNaN(y)?0:y;var z=this._get(a,"showWeek"),A=this._get(a,"dayNames"),
B=this._get(a,"dayNamesShort"),C=this._get(a,"dayNamesMin"),D=this._get(a,"monthNames"),E=this._get(a,"monthNamesShort"),F=this._get(a,"beforeShowDay"),G=this._get(a,"showOtherMonths"),H=this._get(a,"selectOtherMonths"),I=this._get(a,"calculateWeek")||this.iso8601Week,J=this._getDefaultDate(a),K="";for(var L=0;L<g[0];L++){var M="";this.maxRows=4;for(var N=0;N<g[1];N++){var O=this._daylightSavingAdjust(new Date(o,n,a.selectedDay)),P=" ui-corner-all",Q="";if(j){Q+='<div class="ui-datepicker-group';
if(g[1]>1)switch(N){case 0:Q+=" ui-datepicker-group-first",P=" ui-corner-"+(c?"right":"left");break;case g[1]-1:Q+=" ui-datepicker-group-last",P=" ui-corner-"+(c?"left":"right");break;default:Q+=" ui-datepicker-group-middle",P=""}Q+='">'}Q+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+P+'">'+(/all|left/.test(P)&&L==0?c?t:r:"")+(/all|right/.test(P)&&L==0?c?r:t:"")+this._generateMonthYearHeader(a,n,o,l,m,L>0||N>0,D,E)+'</div><table class="ui-datepicker-calendar"><thead>'+"<tr>";
var R=z?'<th class="ui-datepicker-week-col">'+this._get(a,"weekHeader")+"</th>":"";for(var S=0;S<7;S++){var T=(S+y)%7;R+="<th"+((S+y+6)%7>=5?' class="ui-datepicker-week-end"':"")+">"+'<span title="'+A[T]+'">'+C[T]+"</span></th>"}Q+=R+"</tr></thead><tbody>";var U=this._getDaysInMonth(o,n);o==a.selectedYear&&n==a.selectedMonth&&(a.selectedDay=Math.min(a.selectedDay,U));var V=(this._getFirstDayOfMonth(o,n)-y+7)%7,W=Math.ceil((V+U)/7),X=j?this.maxRows>W?this.maxRows:W:W;this.maxRows=X;var Y=this._daylightSavingAdjust(new Date(o,
n,1-V));for(var Z=0;Z<X;Z++){Q+="<tr>";var _=z?'<td class="ui-datepicker-week-col">'+this._get(a,"calculateWeek")(Y)+"</td>":"";for(var S=0;S<7;S++){var ba=F?F.apply(a.input?a.input[0]:null,[Y]):[!0,""],bb=Y.getMonth()!=n,bc=bb&&!H||!ba[0]||l&&Y<l||m&&Y>m;_+='<td class="'+((S+y+6)%7>=5?" ui-datepicker-week-end":"")+(bb?" ui-datepicker-other-month":"")+(Y.getTime()==O.getTime()&&n==a.selectedMonth&&a._keyEvent||J.getTime()==Y.getTime()&&J.getTime()==O.getTime()?" "+this._dayOverClass:"")+(bc?" "+this._unselectableClass+
" ui-state-disabled":"")+(bb&&!G?"":" "+ba[1]+(Y.getTime()==k.getTime()?" "+this._currentClass:"")+(Y.getTime()==b.getTime()?" ui-datepicker-today":""))+'"'+((!bb||G)&&ba[2]?' title="'+ba[2]+'"':"")+(bc?"":' onclick="DP_jQuery_'+dpuuid+".datepicker._selectDay('#"+a.id+"',"+Y.getMonth()+","+Y.getFullYear()+', this);return false;"')+">"+(bb&&!G?"&#xa0;":bc?'<span class="ui-state-default">'+Y.getDate()+"</span>":'<a class="ui-state-default'+(Y.getTime()==b.getTime()?" ui-state-highlight":"")+(Y.getTime()==
k.getTime()?" ui-state-active":"")+(bb?" ui-priority-secondary":"")+'" href="#">'+Y.getDate()+"</a>")+"</td>",Y.setDate(Y.getDate()+1),Y=this._daylightSavingAdjust(Y)}Q+=_+"</tr>"}n++,n>11&&(n=0,o++),Q+="</tbody></table>"+(j?"</div>"+(g[0]>0&&N==g[1]-1?'<div class="ui-datepicker-row-break"></div>':""):""),M+=Q}K+=M}K+=x+($.browser.msie&&parseInt($.browser.version,10)<7&&!a.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':""),a._keyEvent=!1;return K},_generateMonthYearHeader:function(a,
b,c,d,e,f,g,h){var i=this._get(a,"changeMonth"),j=this._get(a,"changeYear"),k=this._get(a,"showMonthAfterYear"),l='<div class="ui-datepicker-title">',m="";if(f||!i)m+='<span class="ui-datepicker-month">'+g[b]+"</span>";else{var n=d&&d.getFullYear()==c,o=e&&e.getFullYear()==c;m+='<select class="ui-datepicker-month" onchange="DP_jQuery_'+dpuuid+".datepicker._selectMonthYear('#"+a.id+"', this, 'M');\" "+">";for(var p=0;p<12;p++)(!n||p>=d.getMonth())&&(!o||p<=e.getMonth())&&(m+='<option value="'+p+'"'+
(p==b?' selected="selected"':"")+">"+h[p]+"</option>");m+="</select>"}k||(l+=m+(f||!i||!j?"&#xa0;":""));if(!a.yearshtml){a.yearshtml="";if(f||!j)l+='<span class="ui-datepicker-year">'+c+"</span>";else{var q=this._get(a,"yearRange").split(":"),r=(new Date).getFullYear(),s=function(a){var b=a.match(/c[+-].*/)?c+parseInt(a.substring(1),10):a.match(/[+-].*/)?r+parseInt(a,10):parseInt(a,10);return isNaN(b)?r:b},t=s(q[0]),u=Math.max(t,s(q[1]||""));t=d?Math.max(t,d.getFullYear()):t,u=e?Math.min(u,e.getFullYear()):
u,a.yearshtml+='<select class="ui-datepicker-year" onchange="DP_jQuery_'+dpuuid+".datepicker._selectMonthYear('#"+a.id+"', this, 'Y');\" "+">";for(;t<=u;t++)a.yearshtml+='<option value="'+t+'"'+(t==c?' selected="selected"':"")+">"+t+"</option>";a.yearshtml+="</select>",l+=a.yearshtml,a.yearshtml=null}}l+=this._get(a,"yearSuffix"),k&&(l+=(f||!i||!j?"&#xa0;":"")+m),l+="</div>";return l},_adjustInstDate:function(a,b,c){var d=a.drawYear+(c=="Y"?b:0),e=a.drawMonth+(c=="M"?b:0),f=Math.min(a.selectedDay,
this._getDaysInMonth(d,e))+(c=="D"?b:0),g=this._restrictMinMax(a,this._daylightSavingAdjust(new Date(d,e,f)));a.selectedDay=g.getDate(),a.drawMonth=a.selectedMonth=g.getMonth(),a.drawYear=a.selectedYear=g.getFullYear(),(c=="M"||c=="Y")&&this._notifyChange(a)},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max"),e=c&&b<c?c:b;e=d&&e>d?d:e;return e},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,
a.selectedMonth+1,a])},_getNumberOfMonths:function(a){var b=this._get(a,"numberOfMonths");return b==null?[1,1]:typeof b=="number"?[1,b]:b},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},_canAdjustMonth:function(a,b,c,d){var e=this._getNumberOfMonths(a),f=this._daylightSavingAdjust(new Date(c,d+(b<
0?b:e[0]*e[1]),1));b<0&&f.setDate(this._getDaysInMonth(f.getFullYear(),f.getMonth()));return this._isInRange(a,f)},_isInRange:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max");return(!c||b.getTime()>=c.getTime())&&(!d||b.getTime()<=d.getTime())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff");b=typeof b!="string"?b:(new Date).getFullYear()%100+parseInt(b,10);return{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),
monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,"monthNames")}},_formatDate:function(a,b,c,d){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear);var e=b?typeof b=="object"?b:this._daylightSavingAdjust(new Date(d,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),e,this._getFormatConfig(a))}}),$.fn.datepicker=function(a){if(!this.length)return this;$.datepicker.initialized||
($(document).mousedown($.datepicker._checkExternalClick).find("body").append($.datepicker.dpDiv),$.datepicker.initialized=!0);var b=Array.prototype.slice.call(arguments,1);if(typeof a=="string"&&(a=="isDisabled"||a=="getDate"||a=="widget"))return $.datepicker["_"+a+"Datepicker"].apply($.datepicker,[this[0]].concat(b));if(a=="option"&&arguments.length==2&&typeof arguments[1]=="string")return $.datepicker["_"+a+"Datepicker"].apply($.datepicker,[this[0]].concat(b));return this.each(function(){typeof a==
"string"?$.datepicker["_"+a+"Datepicker"].apply($.datepicker,[this].concat(b)):$.datepicker._attachDatepicker(this,a)})},$.datepicker=new Datepicker,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.8.17",window["DP_jQuery_"+dpuuid]=$})(jQuery);
(function(a,b){a.widget("ui.progressbar",{options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()}),this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this.oldValue=this._value(),this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),
this.valueDiv.remove(),a.Widget.prototype.destroy.apply(this,arguments)},value:function(a){if(a===b)return this._value();this._setOption("value",a);return this},_setOption:function(b,c){b==="value"&&(this.options.value=c,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete")),a.Widget.prototype._setOption.apply(this,arguments)},_value:function(){var a=this.options.value;typeof a!="number"&&(a=0);return Math.min(this.options.max,Math.max(this.min,a))},_percentage:function(){return 100*
this._value()/this.options.max},_refreshValue:function(){var a=this.value(),b=this._percentage();this.oldValue!==a&&(this.oldValue=a,this._trigger("change")),this.valueDiv.toggle(a>this.min).toggleClass("ui-corner-right",a===this.options.max).width(b.toFixed(0)+"%"),this.element.attr("aria-valuenow",a)}}),a.extend(a.ui.progressbar,{version:"1.8.17"})})(jQuery);
jQuery.effects||function(a,b){function l(b){if(!b||typeof b=="number"||a.fx.speeds[b])return!0;if(typeof b=="string"&&!a.effects[b])return!0;return!1}function k(b,c,d,e){typeof b=="object"&&(e=c,d=null,c=b,b=c.effect),a.isFunction(c)&&(e=c,d=null,c={});if(typeof c=="number"||a.fx.speeds[c])e=d,d=c,c={};a.isFunction(d)&&(e=d,d=null),c=c||{},d=d||c.duration,d=a.fx.off?0:typeof d=="number"?d:d in a.fx.speeds?a.fx.speeds[d]:a.fx.speeds._default,e=e||c.complete;return[b,c,d,e]}function j(a,b){var c={_:0},
d;for(d in b)a[d]!=b[d]&&(c[d]=b[d]);return c}function i(b){var c,d;for(c in b)d=b[c],(d==null||a.isFunction(d)||c in g||/scrollbar/.test(c)||!/color/i.test(c)&&isNaN(parseFloat(d)))&&delete b[c];return b}function h(){var a=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,b={},c,d;if(a&&a.length&&a[0]&&a[a[0]]){var e=a.length;while(e--)c=a[e],typeof a[c]=="string"&&(d=c.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()}),b[d]=a[c])}else for(c in a)typeof a[c]==
"string"&&(b[c]=a[c]);return b}function d(b,d){var e;do{e=a.curCSS(b,d);if(e!=""&&e!="transparent"||a.nodeName(b,"body"))break;d="backgroundColor"}while(b=b.parentNode);return c(e)}function c(b){var c;if(b&&b.constructor==Array&&b.length==3)return b;if(c=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(b))return[parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3],10)];if(c=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(b))return[parseFloat(c[1])*
2.55,parseFloat(c[2])*2.55,parseFloat(c[3])*2.55];if(c=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(b))return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)];if(c=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(b))return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)];if(c=/rgba\(0, 0, 0, 0\)/.exec(b))return e.transparent;return e[a.trim(b).toLowerCase()]}a.effects={},a.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor",
"borderColor","color","outlineColor"],function(b,e){a.fx.step[e]=function(a){a.colorInit||(a.start=d(a.elem,e),a.end=c(a.end),a.colorInit=!0),a.elem.style[e]="rgb("+Math.max(Math.min(parseInt(a.pos*(a.end[0]-a.start[0])+a.start[0],10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[1]-a.start[1])+a.start[1],10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[2]-a.start[2])+a.start[2],10),255),0)+")"}});var e={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,
255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,
182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},f=["add","remove","toggle"],g={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.effects.animateClass=function(b,c,d,e){a.isFunction(d)&&(e=d,
d=null);return this.queue(function(){var g=a(this),k=g.attr("style")||" ",l=i(h.call(this)),m,n=g.attr("class");a.each(f,function(a,c){b[c]&&g[c+"Class"](b[c])}),m=i(h.call(this)),g.attr("class",n),g.animate(j(l,m),{queue:!1,duration:c,easing:d,complete:function(){a.each(f,function(a,c){b[c]&&g[c+"Class"](b[c])}),typeof g.attr("style")=="object"?(g.attr("style").cssText="",g.attr("style").cssText=k):g.attr("style",k),e&&e.apply(this,arguments),a.dequeue(this)}})})},a.fn.extend({_addClass:a.fn.addClass,
addClass:function(b,c,d,e){return c?a.effects.animateClass.apply(this,[{add:b},c,d,e]):this._addClass(b)},_removeClass:a.fn.removeClass,removeClass:function(b,c,d,e){return c?a.effects.animateClass.apply(this,[{remove:b},c,d,e]):this._removeClass(b)},_toggleClass:a.fn.toggleClass,toggleClass:function(c,d,e,f,g){return typeof d=="boolean"||d===b?e?a.effects.animateClass.apply(this,[d?{add:c}:{remove:c},e,f,g]):this._toggleClass(c,d):a.effects.animateClass.apply(this,[{toggle:c},d,e,f])},switchClass:function(b,
c,d,e,f){return a.effects.animateClass.apply(this,[{add:c,remove:b},d,e,f])}}),a.extend(a.effects,{version:"1.8.17",save:function(a,b){for(var c=0;c<b.length;c++)b[c]!==null&&a.data("ec.storage."+b[c],a[0].style[b[c]])},restore:function(a,b){for(var c=0;c<b.length;c++)b[c]!==null&&a.css(b[c],a.data("ec.storage."+b[c]))},setMode:function(a,b){b=="toggle"&&(b=a.is(":hidden")?"show":"hide");return b},getBaseline:function(a,b){var c,d;switch(a[0]){case "top":c=0;break;case "middle":c=0.5;break;case "bottom":c=
1;break;default:c=a[0]/b.height}switch(a[1]){case "left":d=0;break;case "center":d=0.5;break;case "right":d=1;break;default:d=a[1]/b.width}return{x:d,y:c}},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper"))return b.parent();var c={width:b.outerWidth(!0),height:b.outerHeight(!0),"float":b.css("float")},d=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e=document.activeElement;b.wrap(d),(b[0]===e||a.contains(b[0],
e))&&a(e).focus(),d=b.parent(),b.css("position")=="static"?(d.css({position:"relative"}),b.css({position:"relative"})):(a.extend(c,{position:b.css("position"),zIndex:b.css("z-index")}),a.each(["top","left","bottom","right"],function(a,d){c[d]=b.css(d),isNaN(parseInt(c[d],10))&&(c[d]="auto")}),b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"}));return d.css(c).show()},removeWrapper:function(b){var c,d=document.activeElement;if(b.parent().is(".ui-effects-wrapper")){c=b.parent().replaceWith(b),
(b[0]===d||a.contains(b[0],d))&&a(d).focus();return c}return b},setTransition:function(b,c,d,e){e=e||{},a.each(c,function(a,c){unit=b.cssUnit(c),unit[0]>0&&(e[c]=unit[0]*d+unit[1])});return e}}),a.fn.extend({effect:function(b,c,d,e){var f=k.apply(this,arguments),g={options:f[1],duration:f[2],callback:f[3]},h=g.options.mode,i=a.effects[b];if(a.fx.off||!i)return h?this[h](g.duration,g.callback):this.each(function(){g.callback&&g.callback.call(this)});return i.call(this,g)},_show:a.fn.show,show:function(a){if(l(a))return this._show.apply(this,
arguments);var b=k.apply(this,arguments);b[1].mode="show";return this.effect.apply(this,b)},_hide:a.fn.hide,hide:function(a){if(l(a))return this._hide.apply(this,arguments);var b=k.apply(this,arguments);b[1].mode="hide";return this.effect.apply(this,b)},__toggle:a.fn.toggle,toggle:function(b){if(l(b)||typeof b=="boolean"||a.isFunction(b))return this.__toggle.apply(this,arguments);var c=k.apply(this,arguments);c[1].mode="toggle";return this.effect.apply(this,c)},cssUnit:function(b){var c=this.css(b),
d=[];a.each(["em","px","%","pt"],function(a,b){c.indexOf(b)>0&&(d=[parseFloat(c),b])});return d}}),a.easing.jswing=a.easing.swing,a.extend(a.easing,{def:"easeOutQuad",swing:function(b,c,d,e,f){return a.easing[a.easing.def](b,c,d,e,f)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){if((b/=e/2)<1)return d/2*b*b+c;return-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,
b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){if((b/=e/2)<1)return d/2*b*b*b+c;return d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){if((b/=e/2)<1)return d/2*b*b*b*b+c;return-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,
b,c,d,e){if((b/=e/2)<1)return d/2*b*b*b*b*b+c;return d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return b==0?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){if(b==0)return c;if(b==
e)return c+d;if((b/=e/2)<1)return d/2*Math.pow(2,10*(b-1))+c;return d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){if((b/=e/2)<1)return-d/2*(Math.sqrt(1-b*b)-1)+c;return d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e)==1)return c+d;g||(g=e*0.3);if(h<Math.abs(d)){h=d;var f=g/4}else var f=
g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g))+c},easeOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e)==1)return c+d;g||(g=e*0.3);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*b)*Math.sin((b*e-f)*2*Math.PI/g)+d+c},easeInOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e/2)==2)return c+d;g||(g=e*0.3*1.5);if(h<Math.abs(d)){h=d;var f=g/4}else var f=
g/(2*Math.PI)*Math.asin(d/h);if(b<1)return-0.5*h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)+c;return h*Math.pow(2,-10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)*0.5+d+c},easeInBack:function(a,c,d,e,f,g){g==b&&(g=1.70158);return e*(c/=f)*c*((g+1)*c-g)+d},easeOutBack:function(a,c,d,e,f,g){g==b&&(g=1.70158);return e*((c=c/f-1)*c*((g+1)*c+g)+1)+d},easeInOutBack:function(a,c,d,e,f,g){g==b&&(g=1.70158);if((c/=f/2)<1)return e/2*c*c*(((g*=1.525)+1)*c-g)+d;return e/2*((c-=2)*c*(((g*=1.525)+1)*c+g)+2)+
d},easeInBounce:function(b,c,d,e,f){return e-a.easing.easeOutBounce(b,f-c,0,e,f)+d},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?d*7.5625*b*b+c:b<2/2.75?d*(7.5625*(b-=1.5/2.75)*b+0.75)+c:b<2.5/2.75?d*(7.5625*(b-=2.25/2.75)*b+0.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+0.984375)+c},easeInOutBounce:function(b,c,d,e,f){if(c<f/2)return a.easing.easeInBounce(b,c*2,0,e,f)*0.5+d;return a.easing.easeOutBounce(b,c*2-f,0,e,f)*0.5+e*0.5+d}})}(jQuery);
(function(a,b){a.effects.blind=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right"],e=a.effects.setMode(c,b.options.mode||"hide"),f=b.options.direction||"vertical";a.effects.save(c,d),c.show();var g=a.effects.createWrapper(c).css({overflow:"hidden"}),h=f=="vertical"?"height":"width",i=f=="vertical"?g.height():g.width();e=="show"&&g.css(h,0);var j={};j[h]=e=="show"?i:0,g.animate(j,b.duration,b.options.easing,function(){e=="hide"&&c.hide(),a.effects.restore(c,
d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(c[0],arguments),c.dequeue()})})}})(jQuery);
(function(a,b){a.effects.bounce=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right"],e=a.effects.setMode(c,b.options.mode||"effect"),f=b.options.direction||"up",g=b.options.distance||20,h=b.options.times||5,i=b.duration||250;/show|hide/.test(e)&&d.push("opacity"),a.effects.save(c,d),c.show(),a.effects.createWrapper(c);var j=f=="up"||f=="down"?"top":"left",k=f=="up"||f=="left"?"pos":"neg",g=b.options.distance||(j=="top"?c.outerHeight({margin:!0})/3:c.outerWidth({margin:!0})/
3);e=="show"&&c.css("opacity",0).css(j,k=="pos"?-g:g),e=="hide"&&(g=g/(h*2)),e!="hide"&&h--;if(e=="show"){var l={opacity:1};l[j]=(k=="pos"?"+=":"-=")+g,c.animate(l,i/2,b.options.easing),g=g/2,h--}for(var m=0;m<h;m++){var n={},p={};n[j]=(k=="pos"?"-=":"+=")+g,p[j]=(k=="pos"?"+=":"-=")+g,c.animate(n,i/2,b.options.easing).animate(p,i/2,b.options.easing),g=e=="hide"?g*2:g/2}if(e=="hide"){var l={opacity:0};l[j]=(k=="pos"?"-=":"+=")+g,c.animate(l,i/2,b.options.easing,function(){c.hide(),a.effects.restore(c,
d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments)})}else{var n={},p={};n[j]=(k=="pos"?"-=":"+=")+g,p[j]=(k=="pos"?"+=":"-=")+g,c.animate(n,i/2,b.options.easing).animate(p,i/2,b.options.easing,function(){a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments)})}c.queue("fx",function(){c.dequeue()}),c.dequeue()})}})(jQuery);
(function(a,b){a.effects.clip=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right","height","width"],e=a.effects.setMode(c,b.options.mode||"hide"),f=b.options.direction||"vertical";a.effects.save(c,d),c.show();var g=a.effects.createWrapper(c).css({overflow:"hidden"}),h=c[0].tagName=="IMG"?g:c,i={size:f=="vertical"?"height":"width",position:f=="vertical"?"top":"left"},j=f=="vertical"?h.height():h.width();e=="show"&&(h.css(i.size,0),h.css(i.position,j/2));
var k={};k[i.size]=e=="show"?j:0,k[i.position]=e=="show"?0:j/2,h.animate(k,{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){e=="hide"&&c.hide(),a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(c[0],arguments),c.dequeue()}})})}})(jQuery);
(function(a,b){a.effects.drop=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right","opacity"],e=a.effects.setMode(c,b.options.mode||"hide"),f=b.options.direction||"left";a.effects.save(c,d),c.show(),a.effects.createWrapper(c);var g=f=="up"||f=="down"?"top":"left",h=f=="up"||f=="left"?"pos":"neg",i=b.options.distance||(g=="top"?c.outerHeight({margin:!0})/2:c.outerWidth({margin:!0})/2);e=="show"&&c.css("opacity",0).css(g,h=="pos"?-i:i);var j={opacity:e==
"show"?1:0};j[g]=(e=="show"?h=="pos"?"+=":"-=":h=="pos"?"-=":"+=")+i,c.animate(j,{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){e=="hide"&&c.hide(),a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments),c.dequeue()}})})}})(jQuery);
(function(a,b){a.effects.explode=function(b){return this.queue(function(){var c=b.options.pieces?Math.round(Math.sqrt(b.options.pieces)):3,d=b.options.pieces?Math.round(Math.sqrt(b.options.pieces)):3;b.options.mode=b.options.mode=="toggle"?a(this).is(":visible")?"hide":"show":b.options.mode;var e=a(this).show().css("visibility","hidden"),f=e.offset();f.top-=parseInt(e.css("marginTop"),10)||0,f.left-=parseInt(e.css("marginLeft"),10)||0;var g=e.outerWidth(!0),h=e.outerHeight(!0);for(var i=0;i<c;i++)for(var j=
0;j<d;j++)e.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-j*(g/d),top:-i*(h/c)}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:g/d,height:h/c,left:f.left+j*(g/d)+(b.options.mode=="show"?(j-Math.floor(d/2))*(g/d):0),top:f.top+i*(h/c)+(b.options.mode=="show"?(i-Math.floor(c/2))*(h/c):0),opacity:b.options.mode=="show"?0:1}).animate({left:f.left+j*(g/d)+(b.options.mode=="show"?0:(j-Math.floor(d/2))*(g/d)),top:f.top+
i*(h/c)+(b.options.mode=="show"?0:(i-Math.floor(c/2))*(h/c)),opacity:b.options.mode=="show"?1:0},b.duration||500);setTimeout(function(){b.options.mode=="show"?e.css({visibility:"visible"}):e.css({visibility:"visible"}).hide(),b.callback&&b.callback.apply(e[0]),e.dequeue(),a("div.ui-effects-explode").remove()},b.duration||500)})}})(jQuery);
(function(a,b){a.effects.fade=function(b){return this.queue(function(){var c=a(this),d=a.effects.setMode(c,b.options.mode||"hide");c.animate({opacity:d},{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){b.callback&&b.callback.apply(this,arguments),c.dequeue()}})})}})(jQuery);
(function(a,b){a.effects.fold=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right"],e=a.effects.setMode(c,b.options.mode||"hide"),f=b.options.size||15,g=!!b.options.horizFirst,h=b.duration?b.duration/2:a.fx.speeds._default/2;a.effects.save(c,d),c.show();var i=a.effects.createWrapper(c).css({overflow:"hidden"}),j=e=="show"!=g,k=j?["width","height"]:["height","width"],l=j?[i.width(),i.height()]:[i.height(),i.width()],m=/([0-9]+)%/.exec(f);m&&(f=parseInt(m[1],
10)/100*l[e=="hide"?0:1]),e=="show"&&i.css(g?{height:0,width:f}:{height:f,width:0});var n={},p={};n[k[0]]=e=="show"?l[0]:f,p[k[1]]=e=="show"?l[1]:0,i.animate(n,h,b.options.easing).animate(p,h,b.options.easing,function(){e=="hide"&&c.hide(),a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(c[0],arguments),c.dequeue()})})}})(jQuery);
(function(a,b){a.effects.highlight=function(b){return this.queue(function(){var c=a(this),d=["backgroundImage","backgroundColor","opacity"],e=a.effects.setMode(c,b.options.mode||"show"),f={backgroundColor:c.css("backgroundColor")};e=="hide"&&(f.opacity=0),a.effects.save(c,d),c.show().css({backgroundImage:"none",backgroundColor:b.options.color||"#ffff99"}).animate(f,{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){e=="hide"&&c.hide(),a.effects.restore(c,d),e=="show"&&!a.support.opacity&&
this.style.removeAttribute("filter"),b.callback&&b.callback.apply(this,arguments),c.dequeue()}})})}})(jQuery);
(function(a,b){a.effects.pulsate=function(b){return this.queue(function(){var c=a(this),d=a.effects.setMode(c,b.options.mode||"show");times=(b.options.times||5)*2-1,duration=b.duration?b.duration/2:a.fx.speeds._default/2,isVisible=c.is(":visible"),animateTo=0,isVisible||(c.css("opacity",0).show(),animateTo=1),(d=="hide"&&isVisible||d=="show"&&!isVisible)&&times--;for(var e=0;e<times;e++)c.animate({opacity:animateTo},duration,b.options.easing),animateTo=(animateTo+1)%2;c.animate({opacity:animateTo},
duration,b.options.easing,function(){animateTo==0&&c.hide(),b.callback&&b.callback.apply(this,arguments)}),c.queue("fx",function(){c.dequeue()}).dequeue()})}})(jQuery);
(function(a,b){a.effects.puff=function(b){return this.queue(function(){var c=a(this),d=a.effects.setMode(c,b.options.mode||"hide"),e=parseInt(b.options.percent,10)||150,f=e/100,g={height:c.height(),width:c.width()};a.extend(b.options,{fade:!0,mode:d,percent:d=="hide"?e:100,from:d=="hide"?g:{height:g.height*f,width:g.width*f}}),c.effect("scale",b.options,b.duration,b.callback),c.dequeue()})},a.effects.scale=function(b){return this.queue(function(){var c=a(this),d=a.extend(!0,{},b.options),e=a.effects.setMode(c,
b.options.mode||"effect"),f=parseInt(b.options.percent,10)||(parseInt(b.options.percent,10)==0?0:e=="hide"?0:100),g=b.options.direction||"both",h=b.options.origin;e!="effect"&&(d.origin=h||["middle","center"],d.restore=!0);var i={height:c.height(),width:c.width()};c.from=b.options.from||(e=="show"?{height:0,width:0}:i);var j={y:g!="horizontal"?f/100:1,x:g!="vertical"?f/100:1};c.to={height:i.height*j.y,width:i.width*j.x},b.options.fade&&(e=="show"&&(c.from.opacity=0,c.to.opacity=1),e=="hide"&&(c.from.opacity=
1,c.to.opacity=0)),d.from=c.from,d.to=c.to,d.mode=e,c.effect("size",d,b.duration,b.callback),c.dequeue()})},a.effects.size=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right","width","height","overflow","opacity"],e=["position","top","bottom","left","right","overflow","opacity"],f=["width","height","overflow"],g=["fontSize"],h=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],i=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],
j=a.effects.setMode(c,b.options.mode||"effect"),k=b.options.restore||!1,l=b.options.scale||"both",m=b.options.origin,n={height:c.height(),width:c.width()};c.from=b.options.from||n,c.to=b.options.to||n;if(m){var p=a.effects.getBaseline(m,n);c.from.top=(n.height-c.from.height)*p.y,c.from.left=(n.width-c.from.width)*p.x,c.to.top=(n.height-c.to.height)*p.y,c.to.left=(n.width-c.to.width)*p.x}var q={from:{y:c.from.height/n.height,x:c.from.width/n.width},to:{y:c.to.height/n.height,x:c.to.width/n.width}};
if(l=="box"||l=="both")q.from.y!=q.to.y&&(d=d.concat(h),c.from=a.effects.setTransition(c,h,q.from.y,c.from),c.to=a.effects.setTransition(c,h,q.to.y,c.to)),q.from.x!=q.to.x&&(d=d.concat(i),c.from=a.effects.setTransition(c,i,q.from.x,c.from),c.to=a.effects.setTransition(c,i,q.to.x,c.to));(l=="content"||l=="both")&&q.from.y!=q.to.y&&(d=d.concat(g),c.from=a.effects.setTransition(c,g,q.from.y,c.from),c.to=a.effects.setTransition(c,g,q.to.y,c.to)),a.effects.save(c,k?d:e),c.show(),a.effects.createWrapper(c),
c.css("overflow","hidden").css(c.from);if(l=="content"||l=="both")h=h.concat(["marginTop","marginBottom"]).concat(g),i=i.concat(["marginLeft","marginRight"]),f=d.concat(h).concat(i),c.find("*[width]").each(function(){child=a(this),k&&a.effects.save(child,f);var c={height:child.height(),width:child.width()};child.from={height:c.height*q.from.y,width:c.width*q.from.x},child.to={height:c.height*q.to.y,width:c.width*q.to.x},q.from.y!=q.to.y&&(child.from=a.effects.setTransition(child,h,q.from.y,child.from),
child.to=a.effects.setTransition(child,h,q.to.y,child.to)),q.from.x!=q.to.x&&(child.from=a.effects.setTransition(child,i,q.from.x,child.from),child.to=a.effects.setTransition(child,i,q.to.x,child.to)),child.css(child.from),child.animate(child.to,b.duration,b.options.easing,function(){k&&a.effects.restore(child,f)})});c.animate(c.to,{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){c.to.opacity===0&&c.css("opacity",c.from.opacity),j=="hide"&&c.hide(),a.effects.restore(c,k?d:
e),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments),c.dequeue()}})})}})(jQuery);
(function(a,b){a.effects.shake=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right"],e=a.effects.setMode(c,b.options.mode||"effect"),f=b.options.direction||"left",g=b.options.distance||20,h=b.options.times||3,i=b.duration||b.options.duration||140;a.effects.save(c,d),c.show(),a.effects.createWrapper(c);var j=f=="up"||f=="down"?"top":"left",k=f=="up"||f=="left"?"pos":"neg",l={},m={},n={};l[j]=(k=="pos"?"-=":"+=")+g,m[j]=(k=="pos"?"+=":"-=")+g*2,n[j]=(k==
"pos"?"-=":"+=")+g*2,c.animate(l,i,b.options.easing);for(var p=1;p<h;p++)c.animate(m,i,b.options.easing).animate(n,i,b.options.easing);c.animate(m,i,b.options.easing).animate(l,i/2,b.options.easing,function(){a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments)}),c.queue("fx",function(){c.dequeue()}),c.dequeue()})}})(jQuery);
(function(a,b){a.effects.slide=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right"],e=a.effects.setMode(c,b.options.mode||"show"),f=b.options.direction||"left";a.effects.save(c,d),c.show(),a.effects.createWrapper(c).css({overflow:"hidden"});var g=f=="up"||f=="down"?"top":"left",h=f=="up"||f=="left"?"pos":"neg",i=b.options.distance||(g=="top"?c.outerHeight({margin:!0}):c.outerWidth({margin:!0}));e=="show"&&c.css(g,h=="pos"?isNaN(i)?"-"+i:-i:i);var j={};
j[g]=(e=="show"?h=="pos"?"+=":"-=":h=="pos"?"-=":"+=")+i,c.animate(j,{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){e=="hide"&&c.hide(),a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments),c.dequeue()}})})}})(jQuery);
(function(a,b){a.effects.transfer=function(b){return this.queue(function(){var c=a(this),d=a(b.options.to),e=d.offset(),f={top:e.top,left:e.left,height:d.innerHeight(),width:d.innerWidth()},g=c.offset(),h=a('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(b.options.className).css({top:g.top,left:g.left,height:c.innerHeight(),width:c.innerWidth(),position:"absolute"}).animate(f,b.duration,b.options.easing,function(){h.remove(),b.callback&&b.callback.apply(c[0],arguments),
c.dequeue()})})}})(jQuery);
jQuery(function(a){a.datepicker.regional[""]={closeText:"\u5173\u95ed",prevText:"&#x3c;\u4e0a\u6708",nextText:"\u4e0b\u6708&#x3e;",currentText:"\u4eca\u5929",monthNames:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"],monthNamesShort:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708",
"\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"],dayNames:["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],dayNamesShort:["\u5468\u65e5","\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d"],dayNamesMin:["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],weekHeader:"\u5468",dateFormat:"yy-mm-dd",firstDay:1,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"\u5e74"},
a.datepicker.setDefaults(a.datepicker.regional[""])});
(function($){$.extend($.ui,{timepicker:{version:"0.9.9"}});function Timepicker(){this.regional=[];this.regional[""]={currentText:"Now",closeText:"Done",ampm:false,amNames:["AM","A"],pmNames:["PM","P"],timeFormat:"hh:mm tt",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",timezoneText:"Time Zone"};this._defaults={showButtonPanel:true,timeOnly:false,showHour:true,showMinute:true,showSecond:false,showMillisec:false,
showTimezone:false,showTime:true,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,hour:0,minute:0,second:0,millisec:0,timezone:"+0000",hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,minDateTime:null,maxDateTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,alwaysSetTime:true,separator:" ",altFieldTimeOnly:true,showTimepicker:true,timezoneIso8609:false,timezoneList:null,addSliderAccess:false,sliderAccessArgs:null};$.extend(this._defaults,
this.regional[""])}$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,timezone_select:null,hour:0,minute:0,second:0,millisec:0,timezone:"+0000",hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:null,
setDefaults:function(settings){extendRemove(this._defaults,settings||{});return this},_newInst:function($input,o){var tp_inst=new Timepicker,inlineSettings={};for(var attrName in this._defaults){var attrValue=$input.attr("time:"+attrName);if(attrValue)try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}tp_inst._defaults=$.extend({},this._defaults,inlineSettings,o,{beforeShow:function(input,dp_inst){if($.isFunction(o.beforeShow))return o.beforeShow(input,dp_inst,
tp_inst)},onChangeMonthYear:function(year,month,dp_inst){tp_inst._updateDateTime(dp_inst);if($.isFunction(o.onChangeMonthYear))o.onChangeMonthYear.call($input[0],year,month,dp_inst,tp_inst)},onClose:function(dateText,dp_inst){if(tp_inst.timeDefined===true&&$input.val()!="")tp_inst._updateDateTime(dp_inst);if($.isFunction(o.onClose))o.onClose.call($input[0],dateText,dp_inst,tp_inst)},timepicker:tp_inst});tp_inst.amNames=$.map(tp_inst._defaults.amNames,function(val){return val.toUpperCase()});tp_inst.pmNames=
$.map(tp_inst._defaults.pmNames,function(val){return val.toUpperCase()});if(tp_inst._defaults.timezoneList===null){var timezoneList=[];for(var i=-11;i<=12;i++)timezoneList.push((i>=0?"+":"-")+("0"+Math.abs(i).toString()).slice(-2)+"00");if(tp_inst._defaults.timezoneIso8609)timezoneList=$.map(timezoneList,function(val){return val=="+0000"?"Z":val.substring(0,3)+":"+val.substring(3)});tp_inst._defaults.timezoneList=timezoneList}tp_inst.hour=tp_inst._defaults.hour;tp_inst.minute=tp_inst._defaults.minute;
tp_inst.second=tp_inst._defaults.second;tp_inst.millisec=tp_inst._defaults.millisec;tp_inst.ampm="";tp_inst.$input=$input;if(o.altField)tp_inst.$altInput=$(o.altField).css({cursor:"pointer"}).focus(function(){$input.trigger("focus")});if(tp_inst._defaults.minDate==0||tp_inst._defaults.minDateTime==0)tp_inst._defaults.minDate=new Date;if(tp_inst._defaults.maxDate==0||tp_inst._defaults.maxDateTime==0)tp_inst._defaults.maxDate=new Date;if(tp_inst._defaults.minDate!==undefined&&tp_inst._defaults.minDate instanceof
Date)tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime());if(tp_inst._defaults.minDateTime!==undefined&&tp_inst._defaults.minDateTime instanceof Date)tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime());if(tp_inst._defaults.maxDate!==undefined&&tp_inst._defaults.maxDate instanceof Date)tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime());if(tp_inst._defaults.maxDateTime!==undefined&&tp_inst._defaults.maxDateTime instanceof Date)tp_inst._defaults.maxDate=
new Date(tp_inst._defaults.maxDateTime.getTime());return tp_inst},_addTimePicker:function(dp_inst){var currDT=this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(currDT);this._limitMinMaxDateTime(dp_inst,false);this._injectTimePicker()},_parseTime:function(timeString,withDate){var regstr=this._defaults.timeFormat.toString().replace(/h{1,2}/ig,"(\\d?\\d)").replace(/m{1,2}/ig,"(\\d?\\d)").replace(/s{1,2}/ig,"(\\d?\\d)").replace(/l{1}/ig,
"(\\d?\\d?\\d)").replace(/t{1,2}/ig,this._getPatternAmpm()).replace(/z{1}/ig,"(z|[-+]\\d\\d:?\\d\\d)?").replace(/\s/g,"\\s?")+this._defaults.timeSuffix+"$",order=this._getFormatPositions(),ampm="",treg;if(!this.inst)this.inst=$.datepicker._getInst(this.$input[0]);if(withDate||!this._defaults.timeOnly){var dp_dateFormat=$.datepicker._get(this.inst,"dateFormat");var specials=new RegExp("[.*+?|()\\[\\]{}\\\\]","g");regstr="^.{"+dp_dateFormat.length+",}?"+this._defaults.separator.replace(specials,"\\$&")+
regstr}treg=timeString.match(new RegExp(regstr,"i"));if(treg){if(order.t!==-1)if(treg[order.t]===undefined||treg[order.t].length===0){ampm="";this.ampm=""}else{ampm=$.inArray(treg[order.t].toUpperCase(),this.amNames)!==-1?"AM":"PM";this.ampm=this._defaults[ampm=="AM"?"amNames":"pmNames"][0]}if(order.h!==-1)if(ampm=="AM"&&treg[order.h]=="12")this.hour=0;else if(ampm=="PM"&&treg[order.h]!="12")this.hour=(parseFloat(treg[order.h])+12).toFixed(0);else this.hour=Number(treg[order.h]);if(order.m!==-1)this.minute=
Number(treg[order.m]);if(order.s!==-1)this.second=Number(treg[order.s]);if(order.l!==-1)this.millisec=Number(treg[order.l]);if(order.z!==-1&&treg[order.z]!==undefined){var tz=treg[order.z].toUpperCase();switch(tz.length){case 1:tz=this._defaults.timezoneIso8609?"Z":"+0000";break;case 5:if(this._defaults.timezoneIso8609)tz=tz.substring(1)=="0000"?"Z":tz.substring(0,3)+":"+tz.substring(3);break;case 6:if(!this._defaults.timezoneIso8609)tz=tz=="Z"||tz.substring(1)=="00:00"?"+0000":tz.replace(/:/,"");
else if(tz.substring(1)=="00:00")tz="Z";break}this.timezone=tz}return true}return false},_getPatternAmpm:function(){var markers=[];o=this._defaults;if(o.amNames)$.merge(markers,o.amNames);if(o.pmNames)$.merge(markers,o.pmNames);markers=$.map(markers,function(val){return val.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")});return"("+markers.join("|")+")?"},_getFormatPositions:function(){var finds=this._defaults.timeFormat.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|t{1,2}|z)/g),orders={h:-1,m:-1,s:-1,l:-1,
t:-1,z:-1};if(finds)for(var i=0;i<finds.length;i++)if(orders[finds[i].toString().charAt(0)]==-1)orders[finds[i].toString().charAt(0)]=i+1;return orders},_injectTimePicker:function(){var $dp=this.inst.dpDiv,o=this._defaults,tp_inst=this,hourMax=parseInt(o.hourMax-(o.hourMax-o.hourMin)%o.stepHour,10),minMax=parseInt(o.minuteMax-(o.minuteMax-o.minuteMin)%o.stepMinute,10),secMax=parseInt(o.secondMax-(o.secondMax-o.secondMin)%o.stepSecond,10),millisecMax=parseInt(o.millisecMax-(o.millisecMax-o.millisecMin)%
o.stepMillisec,10),dp_id=this.inst.id.toString().replace(/([^A-Za-z0-9_])/g,"");if($dp.find("div#ui-timepicker-div-"+dp_id).length===0&&o.showTimepicker){var noDisplay=' style="display:none;"',html='<div class="ui-timepicker-div" id="ui-timepicker-div-'+dp_id+'"><dl>'+'<dt class="ui_tpicker_time_label" id="ui_tpicker_time_label_'+dp_id+'"'+(o.showTime?"":noDisplay)+">"+o.timeText+"</dt>"+'<dd class="ui_tpicker_time" id="ui_tpicker_time_'+dp_id+'"'+(o.showTime?"":noDisplay)+"></dd>"+'<dt class="ui_tpicker_hour_label" id="ui_tpicker_hour_label_'+
dp_id+'"'+(o.showHour?"":noDisplay)+">"+o.hourText+"</dt>",hourGridSize=0,minuteGridSize=0,secondGridSize=0,millisecGridSize=0,size;html+='<dd class="ui_tpicker_hour"><div id="ui_tpicker_hour_'+dp_id+'"'+(o.showHour?"":noDisplay)+"></div>";if(o.showHour&&o.hourGrid>0){html+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>';for(var h=o.hourMin;h<=hourMax;h+=parseInt(o.hourGrid,10)){hourGridSize++;var tmph=o.ampm&&h>12?h-12:h;if(tmph<10)tmph="0"+tmph;if(o.ampm)if(h==0)tmph=
12+"a";else if(h<12)tmph+="a";else tmph+="p";html+="<td>"+tmph+"</td>"}html+="</tr></table></div>"}html+="</dd>";html+='<dt class="ui_tpicker_minute_label" id="ui_tpicker_minute_label_'+dp_id+'"'+(o.showMinute?"":noDisplay)+">"+o.minuteText+"</dt>"+'<dd class="ui_tpicker_minute"><div id="ui_tpicker_minute_'+dp_id+'"'+(o.showMinute?"":noDisplay)+"></div>";if(o.showMinute&&o.minuteGrid>0){html+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>';for(var m=o.minuteMin;m<=minMax;m+=
parseInt(o.minuteGrid,10)){minuteGridSize++;html+="<td>"+(m<10?"0":"")+m+"</td>"}html+="</tr></table></div>"}html+="</dd>";html+='<dt class="ui_tpicker_second_label" id="ui_tpicker_second_label_'+dp_id+'"'+(o.showSecond?"":noDisplay)+">"+o.secondText+"</dt>"+'<dd class="ui_tpicker_second"><div id="ui_tpicker_second_'+dp_id+'"'+(o.showSecond?"":noDisplay)+"></div>";if(o.showSecond&&o.secondGrid>0){html+='<div style="padding-left: 1px"><table><tr>';for(var s=o.secondMin;s<=secMax;s+=parseInt(o.secondGrid,
10)){secondGridSize++;html+="<td>"+(s<10?"0":"")+s+"</td>"}html+="</tr></table></div>"}html+="</dd>";html+='<dt class="ui_tpicker_millisec_label" id="ui_tpicker_millisec_label_'+dp_id+'"'+(o.showMillisec?"":noDisplay)+">"+o.millisecText+"</dt>"+'<dd class="ui_tpicker_millisec"><div id="ui_tpicker_millisec_'+dp_id+'"'+(o.showMillisec?"":noDisplay)+"></div>";if(o.showMillisec&&o.millisecGrid>0){html+='<div style="padding-left: 1px"><table><tr>';for(var l=o.millisecMin;l<=millisecMax;l+=parseInt(o.millisecGrid,
10)){millisecGridSize++;html+="<td>"+(l<10?"0":"")+l+"</td>"}html+="</tr></table></div>"}html+="</dd>";html+='<dt class="ui_tpicker_timezone_label" id="ui_tpicker_timezone_label_'+dp_id+'"'+(o.showTimezone?"":noDisplay)+">"+o.timezoneText+"</dt>";html+='<dd class="ui_tpicker_timezone" id="ui_tpicker_timezone_'+dp_id+'"'+(o.showTimezone?"":noDisplay)+"></dd>";html+="</dl></div>";$tp=$(html);if(o.timeOnly===true){$tp.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all">'+'<div class="ui-datepicker-title">'+
o.timeOnlyTitle+"</div>"+"</div>");$dp.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()}this.hour_slider=$tp.find("#ui_tpicker_hour_"+dp_id).slider({orientation:"horizontal",value:this.hour,min:o.hourMin,max:hourMax,step:o.stepHour,slide:function(event,ui){tp_inst.hour_slider.slider("option","value",ui.value);tp_inst._onTimeChange()}});this.minute_slider=$tp.find("#ui_tpicker_minute_"+dp_id).slider({orientation:"horizontal",value:this.minute,min:o.minuteMin,max:minMax,step:o.stepMinute,
slide:function(event,ui){tp_inst.minute_slider.slider("option","value",ui.value);tp_inst._onTimeChange()}});this.second_slider=$tp.find("#ui_tpicker_second_"+dp_id).slider({orientation:"horizontal",value:this.second,min:o.secondMin,max:secMax,step:o.stepSecond,slide:function(event,ui){tp_inst.second_slider.slider("option","value",ui.value);tp_inst._onTimeChange()}});this.millisec_slider=$tp.find("#ui_tpicker_millisec_"+dp_id).slider({orientation:"horizontal",value:this.millisec,min:o.millisecMin,
max:millisecMax,step:o.stepMillisec,slide:function(event,ui){tp_inst.millisec_slider.slider("option","value",ui.value);tp_inst._onTimeChange()}});this.timezone_select=$tp.find("#ui_tpicker_timezone_"+dp_id).append("<select></select>").find("select");$.fn.append.apply(this.timezone_select,$.map(o.timezoneList,function(val,idx){return $("<option />").val(typeof val=="object"?val.value:val).text(typeof val=="object"?val.label:val)}));this.timezone_select.val(typeof this.timezone!="undefined"&&this.timezone!=
null&&this.timezone!=""?this.timezone:o.timezone);this.timezone_select.change(function(){tp_inst._onTimeChange()});if(o.showHour&&o.hourGrid>0){size=100*hourGridSize*o.hourGrid/(hourMax-o.hourMin);$tp.find(".ui_tpicker_hour table").css({width:size+"%",marginLeft:size/(-2*hourGridSize)+"%",borderCollapse:"collapse"}).find("td").each(function(index){$(this).click(function(){var h=$(this).html();if(o.ampm){var ap=h.substring(2).toLowerCase(),aph=parseInt(h.substring(0,2),10);if(ap=="a")if(aph==12)h=
0;else h=aph;else if(aph==12)h=12;else h=aph+12}tp_inst.hour_slider.slider("option","value",h);tp_inst._onTimeChange();tp_inst._onSelectHandler()}).css({cursor:"pointer",width:100/hourGridSize+"%",textAlign:"center",overflow:"hidden"})})}if(o.showMinute&&o.minuteGrid>0){size=100*minuteGridSize*o.minuteGrid/(minMax-o.minuteMin);$tp.find(".ui_tpicker_minute table").css({width:size+"%",marginLeft:size/(-2*minuteGridSize)+"%",borderCollapse:"collapse"}).find("td").each(function(index){$(this).click(function(){tp_inst.minute_slider.slider("option",
"value",$(this).html());tp_inst._onTimeChange();tp_inst._onSelectHandler()}).css({cursor:"pointer",width:100/minuteGridSize+"%",textAlign:"center",overflow:"hidden"})})}if(o.showSecond&&o.secondGrid>0)$tp.find(".ui_tpicker_second table").css({width:size+"%",marginLeft:size/(-2*secondGridSize)+"%",borderCollapse:"collapse"}).find("td").each(function(index){$(this).click(function(){tp_inst.second_slider.slider("option","value",$(this).html());tp_inst._onTimeChange();tp_inst._onSelectHandler()}).css({cursor:"pointer",
width:100/secondGridSize+"%",textAlign:"center",overflow:"hidden"})});if(o.showMillisec&&o.millisecGrid>0)$tp.find(".ui_tpicker_millisec table").css({width:size+"%",marginLeft:size/(-2*millisecGridSize)+"%",borderCollapse:"collapse"}).find("td").each(function(index){$(this).click(function(){tp_inst.millisec_slider.slider("option","value",$(this).html());tp_inst._onTimeChange();tp_inst._onSelectHandler()}).css({cursor:"pointer",width:100/millisecGridSize+"%",textAlign:"center",overflow:"hidden"})});
var $buttonPanel=$dp.find(".ui-datepicker-buttonpane");if($buttonPanel.length)$buttonPanel.before($tp);else $dp.append($tp);this.$timeObj=$tp.find("#ui_tpicker_time_"+dp_id);if(this.inst!==null){var timeDefined=this.timeDefined;this._onTimeChange();this.timeDefined=timeDefined}var onSelectDelegate=function(){tp_inst._onSelectHandler()};this.hour_slider.bind("slidestop",onSelectDelegate);this.minute_slider.bind("slidestop",onSelectDelegate);this.second_slider.bind("slidestop",onSelectDelegate);this.millisec_slider.bind("slidestop",
onSelectDelegate);if(this._defaults.addSliderAccess){var sliderAccessArgs=this._defaults.sliderAccessArgs;setTimeout(function(){if($tp.find(".ui-slider-access").length==0){$tp.find(".ui-slider:visible").sliderAccess(sliderAccessArgs);var sliderAccessWidth=$tp.find(".ui-slider-access:eq(0)").outerWidth(true);if(sliderAccessWidth)$tp.find("table:visible").each(function(){var $g=$(this),oldWidth=$g.outerWidth(),oldMarginLeft=$g.css("marginLeft").toString().replace("%",""),newWidth=oldWidth-sliderAccessWidth,
newMarginLeft=oldMarginLeft*newWidth/oldWidth+"%";$g.css({width:newWidth,marginLeft:newMarginLeft})})}},0)}}},_limitMinMaxDateTime:function(dp_inst,adjustSliders){var o=this._defaults,dp_date=new Date(dp_inst.selectedYear,dp_inst.selectedMonth,dp_inst.selectedDay);if(!this._defaults.showTimepicker)return;if($.datepicker._get(dp_inst,"minDateTime")!==null&&$.datepicker._get(dp_inst,"minDateTime")!==undefined&&dp_date){var minDateTime=$.datepicker._get(dp_inst,"minDateTime"),minDateTimeDate=new Date(minDateTime.getFullYear(),
minDateTime.getMonth(),minDateTime.getDate(),0,0,0,0);if(this.hourMinOriginal===null||this.minuteMinOriginal===null||this.secondMinOriginal===null||this.millisecMinOriginal===null){this.hourMinOriginal=o.hourMin;this.minuteMinOriginal=o.minuteMin;this.secondMinOriginal=o.secondMin;this.millisecMinOriginal=o.millisecMin}if(dp_inst.settings.timeOnly||minDateTimeDate.getTime()==dp_date.getTime()){this._defaults.hourMin=minDateTime.getHours();if(this.hour<=this._defaults.hourMin){this.hour=this._defaults.hourMin;
this._defaults.minuteMin=minDateTime.getMinutes();if(this.minute<=this._defaults.minuteMin){this.minute=this._defaults.minuteMin;this._defaults.secondMin=minDateTime.getSeconds()}else if(this.second<=this._defaults.secondMin){this.second=this._defaults.secondMin;this._defaults.millisecMin=minDateTime.getMilliseconds()}else{if(this.millisec<this._defaults.millisecMin)this.millisec=this._defaults.millisecMin;this._defaults.millisecMin=this.millisecMinOriginal}}else{this._defaults.minuteMin=this.minuteMinOriginal;
this._defaults.secondMin=this.secondMinOriginal;this._defaults.millisecMin=this.millisecMinOriginal}}else{this._defaults.hourMin=this.hourMinOriginal;this._defaults.minuteMin=this.minuteMinOriginal;this._defaults.secondMin=this.secondMinOriginal;this._defaults.millisecMin=this.millisecMinOriginal}}if($.datepicker._get(dp_inst,"maxDateTime")!==null&&$.datepicker._get(dp_inst,"maxDateTime")!==undefined&&dp_date){var maxDateTime=$.datepicker._get(dp_inst,"maxDateTime"),maxDateTimeDate=new Date(maxDateTime.getFullYear(),
maxDateTime.getMonth(),maxDateTime.getDate(),0,0,0,0);if(this.hourMaxOriginal===null||this.minuteMaxOriginal===null||this.secondMaxOriginal===null){this.hourMaxOriginal=o.hourMax;this.minuteMaxOriginal=o.minuteMax;this.secondMaxOriginal=o.secondMax;this.millisecMaxOriginal=o.millisecMax}if(dp_inst.settings.timeOnly||maxDateTimeDate.getTime()==dp_date.getTime()){this._defaults.hourMax=maxDateTime.getHours();if(this.hour>=this._defaults.hourMax){this.hour=this._defaults.hourMax;this._defaults.minuteMax=
maxDateTime.getMinutes();if(this.minute>=this._defaults.minuteMax){this.minute=this._defaults.minuteMax;this._defaults.secondMax=maxDateTime.getSeconds()}else if(this.second>=this._defaults.secondMax){this.second=this._defaults.secondMax;this._defaults.millisecMax=maxDateTime.getMilliseconds()}else{if(this.millisec>this._defaults.millisecMax)this.millisec=this._defaults.millisecMax;this._defaults.millisecMax=this.millisecMaxOriginal}}else{this._defaults.minuteMax=this.minuteMaxOriginal;this._defaults.secondMax=
this.secondMaxOriginal;this._defaults.millisecMax=this.millisecMaxOriginal}}else{this._defaults.hourMax=this.hourMaxOriginal;this._defaults.minuteMax=this.minuteMaxOriginal;this._defaults.secondMax=this.secondMaxOriginal;this._defaults.millisecMax=this.millisecMaxOriginal}}if(adjustSliders!==undefined&&adjustSliders===true){var hourMax=parseInt(this._defaults.hourMax-(this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour,10),minMax=parseInt(this._defaults.minuteMax-(this._defaults.minuteMax-
this._defaults.minuteMin)%this._defaults.stepMinute,10),secMax=parseInt(this._defaults.secondMax-(this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond,10),millisecMax=parseInt(this._defaults.millisecMax-(this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec,10);if(this.hour_slider)this.hour_slider.slider("option",{min:this._defaults.hourMin,max:hourMax}).slider("value",this.hour);if(this.minute_slider)this.minute_slider.slider("option",{min:this._defaults.minuteMin,
max:minMax}).slider("value",this.minute);if(this.second_slider)this.second_slider.slider("option",{min:this._defaults.secondMin,max:secMax}).slider("value",this.second);if(this.millisec_slider)this.millisec_slider.slider("option",{min:this._defaults.millisecMin,max:millisecMax}).slider("value",this.millisec)}},_onTimeChange:function(){var hour=this.hour_slider?this.hour_slider.slider("value"):false,minute=this.minute_slider?this.minute_slider.slider("value"):false,second=this.second_slider?this.second_slider.slider("value"):
false,millisec=this.millisec_slider?this.millisec_slider.slider("value"):false,timezone=this.timezone_select?this.timezone_select.val():false,o=this._defaults;if(typeof hour=="object")hour=false;if(typeof minute=="object")minute=false;if(typeof second=="object")second=false;if(typeof millisec=="object")millisec=false;if(typeof timezone=="object")timezone=false;if(hour!==false)hour=parseInt(hour,10);if(minute!==false)minute=parseInt(minute,10);if(second!==false)second=parseInt(second,10);if(millisec!==
false)millisec=parseInt(millisec,10);var ampm=o[hour<12?"amNames":"pmNames"][0];var hasChanged=hour!=this.hour||minute!=this.minute||second!=this.second||millisec!=this.millisec||this.ampm.length>0&&hour<12!=($.inArray(this.ampm.toUpperCase(),this.amNames)!==-1)||timezone!=this.timezone;if(hasChanged){if(hour!==false)this.hour=hour;if(minute!==false)this.minute=minute;if(second!==false)this.second=second;if(millisec!==false)this.millisec=millisec;if(timezone!==false)this.timezone=timezone;if(!this.inst)this.inst=
$.datepicker._getInst(this.$input[0]);this._limitMinMaxDateTime(this.inst,true)}if(o.ampm)this.ampm=ampm;this.formattedTime=$.datepicker.formatTime(this._defaults.timeFormat,this,this._defaults);if(this.$timeObj)this.$timeObj.text(this.formattedTime+o.timeSuffix);this.timeDefined=true;if(hasChanged)this._updateDateTime()},_onSelectHandler:function(){var onSelect=this._defaults.onSelect;var inputEl=this.$input?this.$input[0]:null;if(onSelect&&inputEl)onSelect.apply(inputEl,[this.formattedDateTime,
this])},_formatTime:function(time,format){time=time||{hour:this.hour,minute:this.minute,second:this.second,millisec:this.millisec,ampm:this.ampm,timezone:this.timezone};var tmptime=(format||this._defaults.timeFormat).toString();tmptime=$.datepicker.formatTime(tmptime,time,this._defaults);if(arguments.length)return tmptime;else this.formattedTime=tmptime},_updateDateTime:function(dp_inst){dp_inst=this.inst||dp_inst;var dt=$.datepicker._daylightSavingAdjust(new Date(dp_inst.selectedYear,dp_inst.selectedMonth,
dp_inst.selectedDay)),dateFmt=$.datepicker._get(dp_inst,"dateFormat"),formatCfg=$.datepicker._getFormatConfig(dp_inst),timeAvailable=dt!==null&&this.timeDefined;this.formattedDate=$.datepicker.formatDate(dateFmt,dt===null?new Date:dt,formatCfg);var formattedDateTime=this.formattedDate;if(dp_inst.lastVal!==undefined&&dp_inst.lastVal.length>0&&this.$input.val().length===0)return;if(this._defaults.timeOnly===true)formattedDateTime=this.formattedTime;else if(this._defaults.timeOnly!==true&&(this._defaults.alwaysSetTime||
timeAvailable))formattedDateTime+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix;this.formattedDateTime=formattedDateTime;if(!this._defaults.showTimepicker)this.$input.val(this.formattedDate);else if(this.$altInput&&this._defaults.altFieldTimeOnly===true){this.$altInput.val(this.formattedTime);this.$input.val(this.formattedDate)}else if(this.$altInput){this.$altInput.val(formattedDateTime);this.$input.val(formattedDateTime)}else this.$input.val(formattedDateTime);this.$input.trigger("change")}});
$.fn.extend({timepicker:function(o){o=o||{};var tmp_args=arguments;if(typeof o=="object")tmp_args[0]=$.extend(o,{timeOnly:true});return $(this).each(function(){$.fn.datetimepicker.apply($(this),tmp_args)})},datetimepicker:function(o){o=o||{};var $input=this,tmp_args=arguments;if(typeof o=="string")if(o=="getDate")return $.fn.datepicker.apply($(this[0]),tmp_args);else return this.each(function(){var $t=$(this);$t.datepicker.apply($t,tmp_args)});else return this.each(function(){var $t=$(this);$t.datepicker($.timepicker._newInst($t,
o)._defaults)})}});$.datepicker.formatTime=function(format,time,options){options=options||{};options=$.extend($.timepicker._defaults,options);time=$.extend({hour:0,minute:0,second:0,millisec:0,timezone:"+0000"},time);var tmptime=format;var ampmName=options["amNames"][0];var hour=parseInt(time.hour,10);if(options.ampm){if(hour>11){ampmName=options["pmNames"][0];if(hour>12)hour=hour%12}if(hour===0)hour=12}tmptime=tmptime.replace(/(?:hh?|mm?|ss?|[tT]{1,2}|[lz])/g,function(match){switch(match.toLowerCase()){case "hh":return("0"+
hour).slice(-2);case "h":return hour;case "mm":return("0"+time.minute).slice(-2);case "m":return time.minute;case "ss":return("0"+time.second).slice(-2);case "s":return time.second;case "l":return("00"+time.millisec).slice(-3);case "z":return time.timezone;case "t":case "tt":if(options.ampm){if(match.length==1)ampmName=ampmName.charAt(0);return match.charAt(0)=="T"?ampmName.toUpperCase():ampmName.toLowerCase()}return""}});tmptime=$.trim(tmptime);return tmptime};$.datepicker._base_selectDate=$.datepicker._selectDate;
$.datepicker._selectDate=function(id,dateStr){var inst=this._getInst($(id)[0]),tp_inst=this._get(inst,"timepicker");if(tp_inst){tp_inst._limitMinMaxDateTime(inst,true);inst.inline=inst.stay_open=true;this._base_selectDate(id,dateStr);inst.inline=inst.stay_open=false;this._notifyChange(inst);this._updateDatepicker(inst)}else this._base_selectDate(id,dateStr)};$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker;$.datepicker._updateDatepicker=function(inst){var input=inst.input[0];if($.datepicker._curInst&&
$.datepicker._curInst!=inst&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!=input)return;if(typeof inst.stay_open!=="boolean"||inst.stay_open===false){this._base_updateDatepicker(inst);var tp_inst=this._get(inst,"timepicker");if(tp_inst)tp_inst._addTimePicker(inst)}};$.datepicker._base_doKeyPress=$.datepicker._doKeyPress;$.datepicker._doKeyPress=function(event){var inst=$.datepicker._getInst(event.target),tp_inst=$.datepicker._get(inst,"timepicker");if(tp_inst)if($.datepicker._get(inst,
"constrainInput")){var ampm=tp_inst._defaults.ampm,dateChars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat")),datetimeChars=tp_inst._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,ampm?"APM":"").replace(/Tt/g,ampm?"AaPpMm":"").replace(/tT/g,ampm?"AaPpMm":"").replace(/T/g,ampm?"AP":"").replace(/tt/g,ampm?"apm":"").replace(/t/g,ampm?"ap":"")+" "+tp_inst._defaults.separator+tp_inst._defaults.timeSuffix+(tp_inst._defaults.showTimezone?tp_inst._defaults.timezoneList.join(""):
"")+tp_inst._defaults.amNames.join("")+tp_inst._defaults.pmNames.join("")+dateChars,chr=String.fromCharCode(event.charCode===undefined?event.keyCode:event.charCode);return event.ctrlKey||chr<" "||!dateChars||datetimeChars.indexOf(chr)>-1}return $.datepicker._base_doKeyPress(event)};$.datepicker._base_doKeyUp=$.datepicker._doKeyUp;$.datepicker._doKeyUp=function(event){var inst=$.datepicker._getInst(event.target),tp_inst=$.datepicker._get(inst,"timepicker");if(tp_inst)if(tp_inst._defaults.timeOnly&&
inst.input.val()!=inst.lastVal)try{$.datepicker._updateDatepicker(inst)}catch(err){$.datepicker.log(err)}return $.datepicker._base_doKeyUp(event)};$.datepicker._base_gotoToday=$.datepicker._gotoToday;$.datepicker._gotoToday=function(id){var inst=this._getInst($(id)[0]),$dp=inst.dpDiv;this._base_gotoToday(id);var now=new Date;var tp_inst=this._get(inst,"timepicker");if(tp_inst&&tp_inst._defaults.showTimezone&&tp_inst.timezone_select){var tzoffset=now.getTimezoneOffset();var tzsign=tzoffset>0?"-":"+";
tzoffset=Math.abs(tzoffset);var tzmin=tzoffset%60;tzoffset=tzsign+("0"+(tzoffset-tzmin)/60).slice(-2)+("0"+tzmin).slice(-2);if(tp_inst._defaults.timezoneIso8609)tzoffset=tzoffset.substring(0,3)+":"+tzoffset.substring(3);tp_inst.timezone_select.val(tzoffset)}this._setTime(inst,now);$(".ui-datepicker-today",$dp).click()};$.datepicker._disableTimepickerDatepicker=function(target,date,withDate){var inst=this._getInst(target),tp_inst=this._get(inst,"timepicker");$(target).datepicker("getDate");if(tp_inst){tp_inst._defaults.showTimepicker=
false;tp_inst._updateDateTime(inst)}};$.datepicker._enableTimepickerDatepicker=function(target,date,withDate){var inst=this._getInst(target),tp_inst=this._get(inst,"timepicker");$(target).datepicker("getDate");if(tp_inst){tp_inst._defaults.showTimepicker=true;tp_inst._addTimePicker(inst);tp_inst._updateDateTime(inst)}};$.datepicker._setTime=function(inst,date){var tp_inst=this._get(inst,"timepicker");if(tp_inst){var defaults=tp_inst._defaults,hour=date?date.getHours():defaults.hour,minute=date?date.getMinutes():
defaults.minute,second=date?date.getSeconds():defaults.second,millisec=date?date.getMilliseconds():defaults.millisec;if(hour<defaults.hourMin||hour>defaults.hourMax||minute<defaults.minuteMin||minute>defaults.minuteMax||second<defaults.secondMin||second>defaults.secondMax||millisec<defaults.millisecMin||millisec>defaults.millisecMax){hour=defaults.hourMin;minute=defaults.minuteMin;second=defaults.secondMin;millisec=defaults.millisecMin}tp_inst.hour=hour;tp_inst.minute=minute;tp_inst.second=second;
tp_inst.millisec=millisec;if(tp_inst.hour_slider)tp_inst.hour_slider.slider("value",hour);if(tp_inst.minute_slider)tp_inst.minute_slider.slider("value",minute);if(tp_inst.second_slider)tp_inst.second_slider.slider("value",second);if(tp_inst.millisec_slider)tp_inst.millisec_slider.slider("value",millisec);tp_inst._onTimeChange();tp_inst._updateDateTime(inst)}};$.datepicker._setTimeDatepicker=function(target,date,withDate){var inst=this._getInst(target),tp_inst=this._get(inst,"timepicker");if(tp_inst){this._setDateFromField(inst);
var tp_date;if(date){if(typeof date=="string"){tp_inst._parseTime(date,withDate);tp_date=new Date;tp_date.setHours(tp_inst.hour,tp_inst.minute,tp_inst.second,tp_inst.millisec)}else tp_date=new Date(date.getTime());if(tp_date.toString()=="Invalid Date")tp_date=undefined;this._setTime(inst,tp_date)}}};$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker;$.datepicker._setDateDatepicker=function(target,date){var inst=this._getInst(target),tp_date=date instanceof Date?new Date(date.getTime()):
date;this._updateDatepicker(inst);this._base_setDateDatepicker.apply(this,arguments);this._setTimeDatepicker(target,tp_date,true)};$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker;$.datepicker._getDateDatepicker=function(target,noDefault){var inst=this._getInst(target),tp_inst=this._get(inst,"timepicker");if(tp_inst){this._setDateFromField(inst,noDefault);var date=this._getDate(inst);if(date&&tp_inst._parseTime($(target).val(),tp_inst.timeOnly))date.setHours(tp_inst.hour,tp_inst.minute,
tp_inst.second,tp_inst.millisec);return date}return this._base_getDateDatepicker(target,noDefault)};$.datepicker._base_parseDate=$.datepicker.parseDate;$.datepicker.parseDate=function(format,value,settings){var date;try{date=this._base_parseDate(format,value,settings)}catch(err){if(err.indexOf(":")>=0)date=this._base_parseDate(format,value.substring(0,value.length-(err.length-err.indexOf(":")-2)),settings);else throw err;}return date};$.datepicker._base_formatDate=$.datepicker._formatDate;$.datepicker._formatDate=
function(inst,day,month,year){var tp_inst=this._get(inst,"timepicker");if(tp_inst){if(day)var b=this._base_formatDate(inst,day,month,year);tp_inst._updateDateTime(inst);return tp_inst.$input.val()}return this._base_formatDate(inst)};$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker;$.datepicker._optionDatepicker=function(target,name,value){var inst=this._getInst(target),tp_inst=this._get(inst,"timepicker");if(tp_inst){var min,max,onselect;if(typeof name=="string")if(name==="minDate"||
name==="minDateTime")min=value;else if(name==="maxDate"||name==="maxDateTime")max=value;else{if(name==="onSelect")onselect=value}else if(typeof name=="object")if(name.minDate)min=name.minDate;else if(name.minDateTime)min=name.minDateTime;else if(name.maxDate)max=name.maxDate;else if(name.maxDateTime)max=name.maxDateTime;if(min){if(min==0)min=new Date;else min=new Date(min);tp_inst._defaults.minDate=min;tp_inst._defaults.minDateTime=min}else if(max){if(max==0)max=new Date;else max=new Date(max);tp_inst._defaults.maxDate=
max;tp_inst._defaults.maxDateTime=max}else if(onselect)tp_inst._defaults.onSelect=onselect}if(value===undefined)return this._base_optionDatepicker(target,name);return this._base_optionDatepicker(target,name,value)};function extendRemove(target,props){$.extend(target,props);for(var name in props)if(props[name]===null||props[name]===undefined)target[name]=props[name];return target}$.timepicker=new Timepicker;$.timepicker.version="0.9.9"})(jQuery);
(function($){$.widget("ech.notify",{options:{speed:500,expires:5E3,stack:"below",custom:false},_create:function(){var self=this;this.templates={};this.keys=[];this.element.addClass("ui-notify").children().addClass("ui-notify-message ui-notify-message-style").each(function(i){var key=this.id||i;self.keys.push(key);self.templates[key]=$(this).removeAttr("id").wrap("<div></div>").parent().html()}).end().empty().show()},create:function(template,msg,opts){if(typeof template==="object"){opts=msg;msg=template;
template=null}var tpl=this.templates[template||this.keys[0]];if(opts&&opts.custom)tpl=$(tpl).removeClass("ui-notify-message-style").wrap("<div></div>").parent().html();return(new $.ech.notify.instance(this))._create(msg,$.extend({},this.options,opts),tpl)}});$.extend($.ech.notify,{instance:function(widget){this.parent=widget;this.isOpen=false}});$.extend($.ech.notify.instance.prototype,{_create:function(params,options,template){this.options=options;var self=this,html=template.replace(/#(?:\{|%7B)(.*?)(?:\}|%7D)/g,
function($1,$2){return $2 in params?params[$2]:""}),m=this.element=$(html),closelink=m.find(".ui-notify-close");if(typeof this.options.click==="function")m.addClass("ui-notify-click").bind("click",function(e){self._trigger("click",e,self)});if(closelink.length)closelink.bind("click",function(){self.close();return false});this.open();if(typeof options.expires==="number")window.setTimeout(function(){self.close()},options.expires);return this},close:function(){var self=this,speed=this.options.speed;
this.element.fadeTo(speed,0).slideUp(speed,function(){self._trigger("close");self.isOpen=false});return this},open:function(){if(this.isOpen||this._trigger("beforeopen")===false)return this;var self=this;this.element[this.options.stack==="above"?"prependTo":"appendTo"](this.parent.element).css({display:"none",opacity:""}).fadeIn(this.options.speed,function(){self._trigger("open");self.isOpen=true});return this},widget:function(){return this.element},_trigger:function(type,e,instance){return this.parent._trigger.call(this,
type,e,instance)}})})(jQuery);
(function($){$.extend($.Deferred,{queue:function(){var queueDeferred=$.Deferred();var promises=0;function resolve(){if(--promises>0)return;setTimeout($.proxy(queueDeferred,"resolve"),0)}var promise=$.extend(queueDeferred.promise(),{push:function(){if(this.isResolved()||this.isRejected())throw new Error("Can not add promises to a resolved "+"or rejected promise queue");promises+=1;$.when.apply(null,arguments).then(resolve,$.proxy(queueDeferred,"reject"));return this}});if(arguments.length)promise.push.apply(promise,
arguments);return promise}})})(jQuery);
(function(d){var k=d.scrollTo=function(a,i,e){d(window).scrollTo(a,i,e)};k.defaults={axis:"xy",duration:parseFloat(d.fn.jquery)>=1.3?0:1};k.window=function(a){return d(window)._scrollable()};d.fn._scrollable=function(){return this.map(function(){var a=this,i=!a.nodeName||d.inArray(a.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1;if(!i)return a;var e=(a.contentWindow||a).document||a.ownerDocument||a;return d.browser.safari||e.compatMode=="BackCompat"?e.body:e.documentElement})};d.fn.scrollTo=
function(n,j,b){if(typeof j=="object"){b=j;j=0}if(typeof b=="function")b={onAfter:b};if(n=="max")n=9E9;b=d.extend({},k.defaults,b);j=j||b.speed||b.duration;b.queue=b.queue&&b.axis.length>1;if(b.queue)j/=2;b.offset=p(b.offset);b.over=p(b.over);return this._scrollable().each(function(){var q=this,r=d(q),f=n,s,g={},u=r.is("html,body");switch(typeof f){case "number":case "string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(f)){f=p(f);break}f=d(f,this);case "object":if(f.is||f.style)s=(f=d(f)).offset()}d.each(b.axis.split(""),
function(a,i){var e=i=="x"?"Left":"Top",h=e.toLowerCase(),c="scroll"+e,l=q[c],m=k.max(q,i);if(s){g[c]=s[h]+(u?0:l-r.offset()[h]);if(b.margin){g[c]-=parseInt(f.css("margin"+e))||0;g[c]-=parseInt(f.css("border"+e+"Width"))||0}g[c]+=b.offset[h]||0;if(b.over[h])g[c]+=f[i=="x"?"width":"height"]()*b.over[h]}else{var o=f[h];g[c]=o.slice&&o.slice(-1)=="%"?parseFloat(o)/100*m:o}if(/^\d+$/.test(g[c]))g[c]=g[c]<=0?0:Math.min(g[c],m);if(!a&&b.queue){if(l!=g[c])t(b.onAfterFirst);delete g[c]}});t(b.onAfter);function t(a){r.animate(g,
j,b.easing,a&&function(){a.call(this,n,b)})}}).end()};k.max=function(a,i){var e=i=="x"?"Width":"Height",h="scroll"+e;if(!d(a).is("html,body"))return a[h]-d(a)[e.toLowerCase()]();var c="client"+e,l=a.ownerDocument.documentElement,m=a.ownerDocument.body;return Math.max(l[h],m[h])-Math.min(l[c],m[c])};function p(a){return typeof a=="object"?a:{top:a,left:a}}})(jQuery);
(function($){function maybeCall(thing,ctx){return typeof thing=="function"?thing.call(ctx):thing}function Tipsy(element,options){this.$element=$(element);this.options=options;this.enabled=true;this.fixTitle()}Tipsy.prototype={show:function(){$.fn.tipsy.clear();if(!this.$element.parent().length)return;var title=this.getTitle();if(title&&this.enabled){var $tip=this.tip();$tip.find(".tipsy-inner")[this.options.html?"html":"text"](title);$tip[0].className="tipsy";$tip.remove().css({top:0,left:0,visibility:"hidden",
display:"block"}).prependTo(document.body);var pos=$.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight,gravity=maybeCall(this.options.gravity,this.$element[0]);var tp;switch(gravity.charAt(0)){case "n":tp={top:pos.top+pos.height+this.options.offset,left:pos.left+pos.width/2-actualWidth/2};break;case "s":tp={top:pos.top-actualHeight-this.options.offset,left:pos.left+pos.width/
2-actualWidth/2};break;case "e":tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth-this.options.offset};break;case "w":tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width+this.options.offset};break}if(gravity.length==2)if(gravity.charAt(1)=="w")tp.left=pos.left+pos.width/2-15;else tp.left=pos.left+pos.width/2-actualWidth+15;$tip.css(tp).addClass("tipsy-"+gravity);$tip.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+gravity.charAt(0);if(this.options.className)$tip.addClass(maybeCall(this.options.className,
this.$element[0]));if(this.options.fade)$tip.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity});else $tip.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){if(this.options.fade)this.tip().stop().fadeOut(function(){$(this).remove()});else this.tip().remove()},fixTitle:function(){var $e=this.$element;if($e.attr("title")||typeof $e.attr("original-title")!="string")$e.attr("original-title",$e.attr("title")||"").removeAttr("title")},
getTitle:function(){var title,$e=this.$element,o=this.options;this.fixTitle();var title,o=this.options;if(typeof o.title=="string")title=$e.attr(o.title=="title"?"original-title":o.title);else if(typeof o.title=="function")title=o.title.call($e[0]);title=(""+title).replace(/(^\s*|\s*$)/,"");return title||o.fallback},tip:function(){if(!this.$tip)this.$tip=$('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>');return this.$tip},validate:function(){if(!this.$element[0].parentNode){this.hide();
this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled}};$.fn.tipsy=function(options){if(options===true)return this.data("tipsy");else if(typeof options=="string"){var tipsy=this.data("tipsy");if(tipsy)tipsy[options]();return this}options=$.extend({},$.fn.tipsy.defaults,options);function get(ele){var tipsy=$.data(ele,"tipsy");if(!tipsy){tipsy=new Tipsy(ele,$.fn.tipsy.elementOptions(ele,
options));$.data(ele,"tipsy",tipsy)}return tipsy}function enter(){var tipsy=get(this);tipsy.hoverState="in";if(options.delayIn==0)tipsy.show();else{tipsy.fixTitle();setTimeout(function(){if(tipsy.hoverState=="in")tipsy.show()},options.delayIn)}}function leave(){var tipsy=get(this);tipsy.hoverState="out";if(options.delayOut==0)tipsy.hide();else setTimeout(function(){if(tipsy.hoverState=="out")tipsy.hide()},options.delayOut)}if(!options.live)this.each(function(){get(this)});if(options.trigger!="manual"){var binder=
options.live?"live":"bind",eventIn=options.trigger=="hover"?"mouseenter":"focus",eventOut=options.trigger=="hover"?"mouseleave":"blur";this[binder](eventIn,enter)[binder](eventOut,leave)}return this};$.fn.tipsy.clear=function(){$("div.tipsy").stop().remove()};$.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:false,fallback:"",gravity:"n",html:false,live:false,offset:0,opacity:0.8,title:"title",trigger:"hover"};$.fn.tipsy.elementOptions=function(ele,options){return $.metadata?$.extend({},
options,$(ele).metadata()):options};$.fn.tipsy.autoNS=function(){return $(this).offset().top>$(document).scrollTop()+$(window).height()/2?"s":"n"};$.fn.tipsy.autoWE=function(){return $(this).offset().left>$(document).scrollLeft()+$(window).width()/2?"e":"w"};$.fn.tipsy.autoBounds=function(margin,prefer){return function(){var dir={ns:prefer[0],ew:prefer.length>1?prefer[1]:false},boundTop=$(document).scrollTop()+margin,boundLeft=$(document).scrollLeft()+margin,$this=$(this);if($this.offset().top<boundTop)dir.ns=
"n";if($this.offset().left<boundLeft)dir.ew="w";if($(window).width()+$(document).scrollLeft()-$this.offset().left<margin)dir.ew="e";if($(window).height()+$(document).scrollTop()-$this.offset().top<margin)dir.ns="s";return dir.ns+(dir.ew?dir.ew:"")}}})(jQuery);var JSON;if(!JSON)JSON={};
(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,
k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function")value=value.toJSON(key);if(typeof rep==="function")value=rep.call(holder,key,value);switch(typeof value){case "string":return quote(value);case "number":return isFinite(value)?String(value):"null";case "boolean":case "null":return String(value);case "object":if(!value)return"null";gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;
for(i=0;i<length;i+=1)partial[i]=str(i,value)||"null";v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1)if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v)partial.push(quote(k)+(gap?": ":":")+v)}}else for(k in value)if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v)partial.push(quote(k)+(gap?": ":":")+v)}v=partial.length===0?"{}":
gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function")JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number")for(i=0;i<space;i+=1)indent+=" ";else if(typeof space==="string")indent=space;rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number"))throw new Error("JSON.stringify");return str("",{"":value})};if(typeof JSON.parse!==
"function")JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object")for(k in value)if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined)value[k]=v;else delete value[k]}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text))text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,
"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse");}})();
var QWeb2={expressions_cache:{},RESERVED_WORDS:"true,false,NaN,null,undefined,debugger,console,in,instanceof,new,function,return,this,typeof,eval,Math,RegExp,Array,Object,Date".split(","),ACTIONS_PRECEDENCE:"foreach,if,call,set,esc,escf,raw,rawf,js,debug,log".split(","),WORD_REPLACEMENT:{"and":"&&","or":"||","gt":">","gte":">=","lt":"<","lte":"<="},tools:{exception:function(message,context){context=context||{};var prefix="QWeb2";if(context.template)prefix+=" - template['"+context.template+"']";throw new Error(prefix+
": "+message);},warning:function(message){if(typeof window!=="undefined"&&window.console)window.console.warn(message)},trim:function(s,mode){switch(mode){case "left":return s.replace(/^\s*/,"");case "right":return s.replace(/\s*$/,"");default:return s.replace(/^\s*|\s*$/g,"")}},js_escape:function(s,noquotes){return(noquotes?"":"'")+s.replace(/\r?\n/g,"\\n").replace(/'/g,"\\'")+(noquotes?"":"'")},html_escape:function(s,attribute){if(s==null)return"";s=String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,
"&gt;");if(attribute)s=s.replace(/"/g,"&quot;");return s},gen_attribute:function(o){if(o!==null&&o!==undefined)if(o.constructor===Array){if(o[1]!==null&&o[1]!==undefined)return this.format_attribute(o[0],o[1])}else if(typeof o==="object"){var r="";for(var k in o)if(o.hasOwnProperty(k))r+=this.gen_attribute([k,o[k]]);return r}return""},format_attribute:function(name,value){return" "+name+'="'+this.html_escape(value,true)+'"'},extend:function(dst,src,exclude){for(var p in src)if(src.hasOwnProperty(p)&&
!(exclude&&this.arrayIndexOf(exclude,p)!==-1))dst[p]=src[p];return dst},arrayIndexOf:function(array,item){for(var i=0,ilen=array.length;i<ilen;i++)if(array[i]===item)return i;return-1},xml_node_to_string:function(node,childs_only){if(childs_only){var childs=node.childNodes,r=[];for(var i=0,ilen=childs.length;i<ilen;i++)r.push(this.xml_node_to_string(childs[i]));return r.join("")}else if(typeof XMLSerializer!=="undefined")return(new XMLSerializer).serializeToString(node);else{switch(node.nodeType){case 1:return node.outerHTML;
case 3:return node.data;case 4:return"<![CDATA["+node.data+"]]\>";case 8:return"<\!-- "+node.data+"--\>"}throw new Error("Unknown node type "+node.nodeType);}},call:function(context,template,old_dict,_import,callback){var new_dict=this.extend({},old_dict);new_dict["__caller__"]=old_dict["__template__"];if(callback)new_dict["__content__"]=callback(context,new_dict);var r=context.engine._render(template,new_dict);if(_import)if(_import==="*")this.extend(old_dict,new_dict,["__caller__","__template__"]);
else{_import=_import.split(",");for(var i=0,ilen=_import.length;i<ilen;i++){var v=_import[i];old_dict[v]=new_dict[v]}}return r},foreach:function(context,enu,as,old_dict,callback){if(enu!=null){var size,new_dict=this.extend({},old_dict);new_dict[as+"_all"]=enu;var as_value=as+"_value",as_index=as+"_index",as_first=as+"_first",as_last=as+"_last",as_parity=as+"_parity";if(size=enu.length){new_dict[as+"_size"]=size;for(var j=0,jlen=enu.length;j<jlen;j++){var cur=enu[j];new_dict[as_value]=cur;new_dict[as_index]=
j;new_dict[as_first]=j===0;new_dict[as_last]=j+1===size;new_dict[as_parity]=j%2==1?"odd":"even";if(cur.constructor===Object)this.extend(new_dict,cur);new_dict[as]=cur;callback(context,new_dict)}}else if(enu.constructor==Number){var _enu=[];for(var i=0;i<enu;i++)_enu.push(i);this.foreach(context,_enu,as,old_dict,callback)}else{var index=0;for(var k in enu)if(enu.hasOwnProperty(k)){var v=enu[k];new_dict[as_value]=v;new_dict[as_index]=index;new_dict[as_first]=index===0;new_dict[as_parity]=j%2==1?"odd":
"even";new_dict[as]=k;callback(context,new_dict);index+=1}}}else this.exception("No enumerator given to foreach",context)}}};
QWeb2.Engine=function(){function Engine(){this.prefix="t";this.debug=false;this.templates_resources=[];this.templates={};this.compiled_templates={};this.extend_templates={};this.default_dict={};this.tools=QWeb2.tools;this.jQuery=window.jQuery;this.reserved_words=QWeb2.RESERVED_WORDS.slice(0);this.actions_precedence=QWeb2.ACTIONS_PRECEDENCE.slice(0);this.word_replacement=QWeb2.tools.extend({},QWeb2.WORD_REPLACEMENT);this.preprocess_node=null;for(var i=0;i<arguments.length;i++)this.add_template(arguments[i])}
QWeb2.tools.extend(Engine.prototype,{add_template:function(template){this.templates_resources.push(template);if(template.constructor===String)template=this.load_xml(template);var ec=template.documentElement&&template.documentElement.childNodes||template.childNodes||[];for(var i=0;i<ec.length;i++){var node=ec[i];if(node.nodeType===1){if(node.nodeName=="parsererror")return this.tools.exception(node.innerText);var name=node.getAttribute(this.prefix+"-name");var extend=node.getAttribute(this.prefix+"-extend");
if(name&&extend){if(!this.templates[extend])return this.tools.exception("Can't clone undefined template "+extend);this.templates[name]=this.templates[extend].cloneNode(true);extend=name;name=undefined}if(name)this.templates[name]=node;else if(extend){delete this.compiled_templates[extend];if(this.extend_templates[extend])this.extend_templates[extend].push(node);else this.extend_templates[extend]=[node]}}}return true},load_xml:function(s){s=this.tools.trim(s);if(s.charAt(0)==="<")return this.load_xml_string(s);
else{var req=this.get_xhr();if(req){if(this.debug)s+="?debug="+(new Date).getTime();req.open("GET",s,false);req.send(null);var xDoc=req.responseXML;if(xDoc){if(!xDoc.documentElement)throw new Error("QWeb2: This xml document has no root document : "+xDoc.responseText);if(xDoc.documentElement.nodeName=="parsererror")return this.tools.exception(xDoc.documentElement.childNodes[0].nodeValue);return xDoc}else return this.load_xml_string(req.responseText)}}},load_xml_string:function(s){if(window.DOMParser){var dp=
new DOMParser;var r=dp.parseFromString(s,"text/xml");if(r.body&&r.body.firstChild&&r.body.firstChild.nodeName=="parsererror")return this.tools.exception(r.body.innerText);return r}var xDoc;try{xDoc=new ActiveXObject("MSXML2.DOMDocument")}catch(e){return this.tools.exception("Could not find a DOM Parser: "+e.message)}xDoc.async=false;xDoc.preserveWhiteSpace=true;xDoc.loadXML(s);return xDoc},has_template:function(template){return!!this.templates[template]},get_xhr:function(){if(window.XMLHttpRequest)return new window.XMLHttpRequest;
try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){return null}},compile:function(node){var e=new QWeb2.Element(this,node);var template=node.getAttribute(this.prefix+"-name");return"   /* 'this' refers to Qweb2.Engine instance */\n"+"   var context = { engine : this, template : "+this.tools.js_escape(template)+" };\n"+"   dict = dict || {};\n"+"   dict['__template__'] = '"+template+"';\n"+"   var r = [];\n"+"   /* START TEMPLATE */"+(this.debug?"":" try {\n")+e.compile()+"\n"+"   /* END OF TEMPLATE */"+
(this.debug?"":" } catch(error) {\n"+"       if (console && console.exception) console.exception(error);\n"+"       context.engine.tools.exception('Runtime Error: ' + error, context);\n")+(this.debug?"":"   }\n")+"   return r.join('');"},render:function(template,dict){dict=dict||{};QWeb2.tools.extend(dict,this.default_dict);var r=this._render(template,dict);return r},_render:function(template,dict){if(this.compiled_templates[template])return this.compiled_templates[template].apply(this,[dict||{}]);
else if(this.templates[template]){var ext;if(ext=this.extend_templates[template]){var extend_node;while(extend_node=ext.shift())this.extend(template,extend_node)}var code=this.compile(this.templates[template]),tcompiled;try{tcompiled=new Function(["dict"],code)}catch(error){if(this.debug&&window.console)console.log(code);this.tools.exception("Error evaluating template: "+error,{template:name})}if(!tcompiled)this.tools.exception("Error evaluating template: (IE?)"+error,{template:name});this.compiled_templates[template]=
tcompiled;return this.render(template,dict)}else return this.tools.exception("Template '"+template+"' not found")},extend:function(template,extend_node){if(!this.jQuery)return this.tools.exception("Can't extend template "+template+" without jQuery");var template_dest=this.templates[template];for(var i=0,ilen=extend_node.childNodes.length;i<ilen;i++){var child=extend_node.childNodes[i];if(child.nodeType===1){var jquery=child.getAttribute(this.prefix+"-jquery"),operation=child.getAttribute(this.prefix+
"-operation"),target,error_msg="Error while extending template '"+template;if(jquery)target=this.jQuery(jquery,template_dest);else this.tools.exception(error_msg+"No expression given");error_msg+="' (expression='"+jquery+"') : ";if(operation){var allowed_operations="append,prepend,before,after,replace,inner".split(",");if(this.tools.arrayIndexOf(allowed_operations,operation)==-1)this.tools.exception(error_msg+"Invalid operation : '"+operation+"'");operation={"replace":"replaceWith","inner":"html"}[operation]||
operation;target[operation](child.cloneNode(true).childNodes)}else{try{var f=new Function(["$","document"],this.tools.xml_node_to_string(child,true))}catch(error){return this.tools.exception("Parse "+error_msg+error)}try{f.apply(target,[this.jQuery,template_dest.ownerDocument])}catch(error){return this.tools.exception("Runtime "+error_msg+error)}}}}}});return Engine}();
QWeb2.Element=function(){function Element(engine,node){this.engine=engine;this.node=node;this.tag=node.tagName;this.actions={};this.actions_done=[];this.attributes={};this.children=[];this._top=[];this._bottom=[];this._indent=1;this.process_children=true;var childs=this.node.childNodes;if(childs)for(var i=0,ilen=childs.length;i<ilen;i++)this.children.push(new QWeb2.Element(this.engine,childs[i]));var attrs=this.node.attributes;if(attrs)for(var j=0,jlen=attrs.length;j<jlen;j++){var attr=attrs[j];var name=
attr.name;var m=name.match(new RegExp("^"+this.engine.prefix+"-(.+)"));if(m){name=m[1];if(name==="name")continue;this.actions[name]=attr.value}else this.attributes[name]=attr.value}if(this.engine.preprocess_node)this.engine.preprocess_node.call(this)}QWeb2.tools.extend(Element.prototype,{compile:function(){var r=[],instring=false,lines=this._compile().split("\n");for(var i=0,ilen=lines.length;i<ilen;i++){var m,line=lines[i];if(m=line.match(/^(\s*)\/\/@string=(.*)/))if(instring)if(this.engine.debug)r.push((m[2].indexOf("\\n")!=
-1?"',\n\t"+m[1]+"'":"")+m[2]);else r.push(m[2]);else{r.push(m[1]+"r.push('"+m[2]);instring=true}else{if(instring)r.push("');\n");instring=false;r.push(line+"\n")}}return r.join("")},_compile:function(){switch(this.node.nodeType){case 3:case 4:this.top_string(this.node.data);break;case 1:this.compile_element()}var r=this._top.join("");if(this.process_children)for(var i=0,ilen=this.children.length;i<ilen;i++){var child=this.children[i];child._indent=this._indent;r+=child._compile()}r+=this._bottom.join("");
return r},format_expression:function(e){if(QWeb2.expressions_cache[e])return QWeb2.expressions_cache[e];var chars=e.split(""),instring="",invar="",invar_pos=0,r="";chars.push(" ");for(var i=0,ilen=chars.length;i<ilen;i++){var c=chars[i];if(instring.length){if(c===instring&&chars[i-1]!=="\\")instring=""}else if(c==='"'||c==="'")instring=c;else if(c.match(/[a-zA-Z_\$]/)&&!invar.length){invar=c;invar_pos=i;continue}else if(c.match(/\W/)&&invar.length){if(chars[invar_pos-1]!=="."&&QWeb2.tools.arrayIndexOf(this.engine.reserved_words,
invar)<0)invar=this.engine.word_replacement[invar]||"dict['"+invar+"']";r+=invar;invar=""}else if(invar.length){invar+=c;continue}r+=c}r=r.slice(0,-1);QWeb2.expressions_cache[e]=r;return r},string_interpolation:function(s){if(!s)return"''";var regex=/^{(.*)}(.*)/,src=s.split(/#/),r=[];for(var i=0,ilen=src.length;i<ilen;i++){var val=src[i],m=val.match(regex);if(m){r.push("("+this.format_expression(m[1])+")");if(m[2])r.push(this.engine.tools.js_escape(m[2]))}else if(!(i===0&&val===""))r.push(this.engine.tools.js_escape((i===
0?"":"#")+val))}return r.join(" + ")},indent:function(){return this._indent++},dedent:function(){if(this._indent!==0)return this._indent--},get_indent:function(){return(new Array(this._indent+1)).join("\t")},top:function(s){return this._top.push(this.get_indent()+s+"\n")},top_string:function(s){return this._top.push(this.get_indent()+"//@string="+this.engine.tools.js_escape(s,true)+"\n")},bottom:function(s){return this._bottom.unshift(this.get_indent()+s+"\n")},bottom_string:function(s){return this._bottom.unshift(this.get_indent()+
"//@string="+this.engine.tools.js_escape(s,true)+"\n")},compile_element:function(){for(var i=0,ilen=this.engine.actions_precedence.length;i<ilen;i++){var a=this.engine.actions_precedence[i];if(a in this.actions){var value=this.actions[a];var key="compile_action_"+a;if(this[key])this[key](value);else if(this.engine[key])this.engine[key].call(this,value);else this.engine.tools.exception("No handler method for action '"+a+"'")}}if(this.tag.toLowerCase()!==this.engine.prefix){var tag="<"+this.tag;for(var a in this.attributes)tag+=
this.engine.tools.gen_attribute([a,this.attributes[a]]);this.top_string(tag);if(this.actions.att)this.top("r.push(context.engine.tools.gen_attribute("+this.format_expression(this.actions.att)+"));");for(var a in this.actions){var v=this.actions[a];var m=a.match(/att-(.+)/);if(m)this.top("r.push(context.engine.tools.gen_attribute(['"+m[1]+"', ("+this.format_expression(v)+")]));");var m=a.match(/attf-(.+)/);if(m)this.top("r.push(context.engine.tools.gen_attribute(['"+m[1]+"', ("+this.string_interpolation(v)+
")]));")}if(this.children.length||this.actions.opentag==="true"){this.top_string(">");this.bottom_string("</"+this.tag+">")}else this.top_string("/>")}},compile_action_if:function(value){this.top("if ("+this.format_expression(value)+") {");this.bottom("}");this.indent()},compile_action_foreach:function(value){var as=this.actions["as"]||value.replace(/[^a-zA-Z0-9]/g,"_");this.top("context.engine.tools.foreach(context, "+this.format_expression(value)+", "+this.engine.tools.js_escape(as)+", dict, function(context, dict) {");
this.bottom("});");this.indent()},compile_action_call:function(value){var _import=this.actions["import"]||"";if(this.children.length===0)return this.top("r.push(context.engine.tools.call(context, "+this.engine.tools.js_escape(value)+", dict, "+this.engine.tools.js_escape(_import)+"));");else{this.top("r.push(context.engine.tools.call(context, "+this.engine.tools.js_escape(value)+", dict, "+this.engine.tools.js_escape(_import)+", function(context, dict) {");this.bottom("}));");this.indent();this.top("var r = [];");
return this.bottom("return r.join('');")}},compile_action_set:function(value){var variable=this.format_expression(value);if(this.actions["value"]){if(this.children.length)this.engine.tools.warning("@set with @value plus node chidren found. Children are ignored.");this.top(variable+" = ("+this.format_expression(this.actions["value"])+");");this.process_children=false}else if(this.children.length===0)this.top(variable+" = '';");else if(this.children.length===1&&this.children[0].node.nodeType===3){this.top(variable+
" = "+this.engine.tools.js_escape(this.children[0].node.data)+";");this.process_children=false}else{this.top(variable+" = (function(dict) {");this.bottom("})(dict);");this.indent();this.top("var r = [];");this.bottom("return r.join('');")}},compile_action_esc:function(value){this.top("r.push(context.engine.tools.html_escape("+this.format_expression(value)+"));")},compile_action_escf:function(value){this.top("r.push(context.engine.tools.html_escape("+this.string_interpolation(value)+"));")},compile_action_raw:function(value){this.top("r.push("+
this.format_expression(value)+");")},compile_action_rawf:function(value){this.top("r.push("+this.string_interpolation(value)+");")},compile_action_js:function(value){this.top("(function("+value+") {");this.bottom("})(dict);");this.indent();var lines=this.engine.tools.xml_node_to_string(this.node,true).split(/\r?\n/);for(var i=0,ilen=lines.length;i<ilen;i++)this.top(lines[i]);this.process_children=false},compile_action_debug:function(value){this.top("debugger;")},compile_action_log:function(value){this.top("console.log("+
this.format_expression(value)+"});")}});return Element}();
(function(){var root=this;var previousUnderscore=root._;var breaker={};var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var slice=ArrayProto.slice,unshift=ArrayProto.unshift,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=
ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){return new wrapper(obj)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=_;exports._=_}else root["_"]=_;_.VERSION="1.3.1";var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null)return;if(nativeForEach&&obj.forEach===nativeForEach)obj.forEach(iterator,context);else if(obj.length===
+obj.length)for(var i=0,l=obj.length;i<l;i++){if(i in obj&&iterator.call(context,obj[i],i,obj)===breaker)return}else for(var key in obj)if(_.has(obj,key))if(iterator.call(context,obj[key],key,obj)===breaker)return};_.map=_.collect=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeMap&&obj.map===nativeMap)return obj.map(iterator,context);each(obj,function(value,index,list){results[results.length]=iterator.call(context,value,index,list)});if(obj.length===+obj.length)results.length=
obj.length;return results};_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduce&&obj.reduce===nativeReduce){if(context)iterator=_.bind(iterator,context);return initial?obj.reduce(iterator,memo):obj.reduce(iterator)}each(obj,function(value,index,list){if(!initial){memo=value;initial=true}else memo=iterator.call(context,memo,value,index,list)});if(!initial)throw new TypeError("Reduce of empty array with no initial value");return memo};
_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduceRight&&obj.reduceRight===nativeReduceRight){if(context)iterator=_.bind(iterator,context);return initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator)}var reversed=_.toArray(obj).reverse();if(context&&!initial)iterator=_.bind(iterator,context);return initial?_.reduce(reversed,iterator,memo,context):_.reduce(reversed,iterator)};_.find=_.detect=function(obj,iterator,
context){var result;any(obj,function(value,index,list){if(iterator.call(context,value,index,list)){result=value;return true}});return result};_.filter=_.select=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeFilter&&obj.filter===nativeFilter)return obj.filter(iterator,context);each(obj,function(value,index,list){if(iterator.call(context,value,index,list))results[results.length]=value});return results};_.reject=function(obj,iterator,context){var results=[];if(obj==
null)return results;each(obj,function(value,index,list){if(!iterator.call(context,value,index,list))results[results.length]=value});return results};_.every=_.all=function(obj,iterator,context){var result=true;if(obj==null)return result;if(nativeEvery&&obj.every===nativeEvery)return obj.every(iterator,context);each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list)))return breaker});return result};var any=_.some=_.any=function(obj,iterator,context){iterator||
(iterator=_.identity);var result=false;if(obj==null)return result;if(nativeSome&&obj.some===nativeSome)return obj.some(iterator,context);each(obj,function(value,index,list){if(result||(result=iterator.call(context,value,index,list)))return breaker});return!!result};_.include=_.contains=function(obj,target){var found=false;if(obj==null)return found;if(nativeIndexOf&&obj.indexOf===nativeIndexOf)return obj.indexOf(target)!=-1;found=any(obj,function(value){return value===target});return found};_.invoke=
function(obj,method){var args=slice.call(arguments,2);return _.map(obj,function(value){return(_.isFunction(method)?method||value:value[method]).apply(value,args)})};_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})};_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj))return Math.max.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return-Infinity;var result={computed:-Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,
index,list):value;computed>=result.computed&&(result={value:value,computed:computed})});return result.value};_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj))return Math.min.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return Infinity;var result={computed:Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})});return result.value};_.shuffle=function(obj){var shuffled=
[],rand;each(obj,function(value,index,list){if(index==0)shuffled[0]=value;else{rand=Math.floor(Math.random()*(index+1));shuffled[index]=shuffled[rand];shuffled[rand]=value}});return shuffled};_.sortBy=function(obj,iterator,context){return _.pluck(_.map(obj,function(value,index,list){return{value:value,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0}),"value")};_.groupBy=function(obj,val){var result={};var iterator=
_.isFunction(val)?val:function(obj){return obj[val]};each(obj,function(value,index){var key=iterator(value,index);(result[key]||(result[key]=[])).push(value)});return result};_.sortedIndex=function(array,obj,iterator){iterator||(iterator=_.identity);var low=0,high=array.length;while(low<high){var mid=low+high>>1;iterator(array[mid])<iterator(obj)?low=mid+1:high=mid}return low};_.toArray=function(iterable){if(!iterable)return[];if(iterable.toArray)return iterable.toArray();if(_.isArray(iterable))return slice.call(iterable);
if(_.isArguments(iterable))return slice.call(iterable);return _.values(iterable)};_.size=function(obj){return _.toArray(obj).length};_.first=_.head=function(array,n,guard){return n!=null&&!guard?slice.call(array,0,n):array[0]};_.initial=function(array,n,guard){return slice.call(array,0,array.length-(n==null||guard?1:n))};_.last=function(array,n,guard){if(n!=null&&!guard)return slice.call(array,Math.max(array.length-n,0));else return array[array.length-1]};_.rest=_.tail=function(array,index,guard){return slice.call(array,
index==null||guard?1:index)};_.compact=function(array){return _.filter(array,function(value){return!!value})};_.flatten=function(array,shallow){return _.reduce(array,function(memo,value){if(_.isArray(value))return memo.concat(shallow?value:_.flatten(value));memo[memo.length]=value;return memo},[])};_.without=function(array){return _.difference(array,slice.call(arguments,1))};_.uniq=_.unique=function(array,isSorted,iterator){var initial=iterator?_.map(array,iterator):array;var result=[];_.reduce(initial,
function(memo,el,i){if(0==i||(isSorted===true?_.last(memo)!=el:!_.include(memo,el))){memo[memo.length]=el;result[result.length]=array[i]}return memo},[]);return result};_.union=function(){return _.uniq(_.flatten(arguments,true))};_.intersection=_.intersect=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})};_.difference=function(array){var rest=_.flatten(slice.call(arguments,1));return _.filter(array,
function(value){return!_.include(rest,value)})};_.zip=function(){var args=slice.call(arguments);var length=_.max(_.pluck(args,"length"));var results=new Array(length);for(var i=0;i<length;i++)results[i]=_.pluck(args,""+i);return results};_.indexOf=function(array,item,isSorted){if(array==null)return-1;var i,l;if(isSorted){i=_.sortedIndex(array,item);return array[i]===item?i:-1}if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item);for(i=0,l=array.length;i<l;i++)if(i in array&&array[i]===
item)return i;return-1};_.lastIndexOf=function(array,item){if(array==null)return-1;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf)return array.lastIndexOf(item);var i=array.length;while(i--)if(i in array&&array[i]===item)return i;return-1};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0}step=arguments[2]||1;var len=Math.max(Math.ceil((stop-start)/step),0);var idx=0;var range=new Array(len);while(idx<len){range[idx++]=start;start+=step}return range};var ctor=
function(){};_.bind=function bind(func,context){var bound,args;if(func.bind===nativeBind&&nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;args=slice.call(arguments,2);return bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor;var result=func.apply(self,args.concat(slice.call(arguments)));if(Object(result)===result)return result;return self}};
_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(funcs.length==0)funcs=_.functions(obj);each(funcs,function(f){obj[f]=_.bind(obj[f],obj)});return obj};_.memoize=function(func,hasher){var memo={};hasher||(hasher=_.identity);return function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(func,args)},wait)};_.defer=function(func){return _.delay.apply(_,
[func,1].concat(slice.call(arguments,1)))};_.throttle=function(func,wait){var context,args,timeout,throttling,more;var whenDone=_.debounce(function(){more=throttling=false},wait);return function(){context=this;args=arguments;var later=function(){timeout=null;if(more)func.apply(context,args);whenDone()};if(!timeout)timeout=setTimeout(later,wait);if(throttling)more=true;else func.apply(context,args);whenDone();throttling=true}};_.debounce=function(func,wait){var timeout;return function(){var context=
this,args=arguments;var later=function(){timeout=null;func.apply(context,args)};clearTimeout(timeout);timeout=setTimeout(later,wait)}};_.once=function(func){var ran=false,memo;return function(){if(ran)return memo;ran=true;return memo=func.apply(this,arguments)}};_.wrap=function(func,wrapper){return function(){var args=[func].concat(slice.call(arguments,0));return wrapper.apply(this,args)}};_.compose=function(){var funcs=arguments;return function(){var args=arguments;for(var i=funcs.length-1;i>=0;i--)args=
[funcs[i].apply(this,args)];return args[0]}};_.after=function(times,func){if(times<=0)return func();return function(){if(--times<1)return func.apply(this,arguments)}};_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError("Invalid object");var keys=[];for(var key in obj)if(_.has(obj,key))keys[keys.length]=key;return keys};_.values=function(obj){return _.map(obj,_.identity)};_.functions=_.methods=function(obj){var names=[];for(var key in obj)if(_.isFunction(obj[key]))names.push(key);
return names.sort()};_.extend=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source)obj[prop]=source[prop]});return obj};_.defaults=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source)if(obj[prop]==null)obj[prop]=source[prop]});return obj};_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};function eq(a,b,stack){if(a===b)return a!==
0||1/a==1/b;if(a==null||b==null)return a===b;if(a._chain)a=a._wrapped;if(b._chain)b=b._wrapped;if(a.isEqual&&_.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&_.isFunction(b.isEqual))return b.isEqual(a);var className=toString.call(a);if(className!=toString.call(b))return false;switch(className){case "[object String]":return a==String(b);case "[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==
b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return false;var length=stack.length;while(length--)if(stack[length]==a)return true;stack.push(a);var size=0,result=true;if(className=="[object Array]"){size=a.length;result=size==b.length;if(result)while(size--)if(!(result=size in a==size in b&&eq(a[size],b[size],stack)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return false;for(var key in a)if(_.has(a,
key)){size++;if(!(result=_.has(b,key)&&eq(a[key],b[key],stack)))break}if(result){for(key in b)if(_.has(b,key)&&!size--)break;result=!size}}stack.pop();return result}_.isEqual=function(a,b){return eq(a,b,[])};_.isEmpty=function(obj){if(_.isArray(obj)||_.isString(obj))return obj.length===0;for(var key in obj)if(_.has(obj,key))return false;return true};_.isElement=function(obj){return!!(obj&&obj.nodeType==1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)=="[object Array]"};_.isObject=
function(obj){return obj===Object(obj)};_.isArguments=function(obj){return toString.call(obj)=="[object Arguments]"};if(!_.isArguments(arguments))_.isArguments=function(obj){return!!(obj&&_.has(obj,"callee"))};_.isFunction=function(obj){return toString.call(obj)=="[object Function]"};_.isString=function(obj){return toString.call(obj)=="[object String]"};_.isNumber=function(obj){return toString.call(obj)=="[object Number]"};_.isNaN=function(obj){return obj!==obj};_.isBoolean=function(obj){return obj===
true||obj===false||toString.call(obj)=="[object Boolean]"};_.isDate=function(obj){return toString.call(obj)=="[object Date]"};_.isRegExp=function(obj){return toString.call(obj)=="[object RegExp]"};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.has=function(obj,key){return hasOwnProperty.call(obj,key)};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.times=function(n,iterator,context){for(var i=0;i<
n;i++)iterator.call(context,i)};_.escape=function(string){return(""+string).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};_.mixin=function(obj){each(_.functions(obj),function(name){addToWrapper(name,_[name]=obj[name])})};var idCounter=0;_.uniqueId=function(prefix){var id=idCounter++;return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};
var noMatch=/.^/;var unescape=function(code){return code.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};_.template=function(str,data){var c=_.templateSettings;var tmpl="var __p=[],print=function(){__p.push.apply(__p,arguments);};"+"with(obj||{}){__p.push('"+str.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape||noMatch,function(match,code){return"',_.escape("+unescape(code)+"),'"}).replace(c.interpolate||noMatch,function(match,code){return"',"+unescape(code)+",'"}).replace(c.evaluate||noMatch,
function(match,code){return"');"+unescape(code).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";var func=new Function("obj","_",tmpl);if(data)return func(data,_);return function(data){return func.call(this,data,_)}};_.chain=function(obj){return _(obj).chain()};var wrapper=function(obj){this._wrapped=obj};_.prototype=wrapper.prototype;var result=function(obj,chain){return chain?_(obj).chain():obj};var addToWrapper=function(name,
func){wrapper.prototype[name]=function(){var args=slice.call(arguments);unshift.call(args,this._wrapped);return result(func.apply(_,args),this._chain)}};_.mixin(_);each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];wrapper.prototype[name]=function(){var wrapped=this._wrapped;method.apply(wrapped,arguments);var length=wrapped.length;if((name=="shift"||name=="splice")&&length===0)delete wrapped[0];return result(wrapped,this._chain)}});each(["concat",
"join","slice"],function(name){var method=ArrayProto[name];wrapper.prototype[name]=function(){return result(method.apply(this._wrapped,arguments),this._chain)}});wrapper.prototype.chain=function(){this._chain=true;return this};wrapper.prototype.value=function(){return this._wrapped}}).call(this);
(function(root){var nativeTrim=String.prototype.trim;var parseNumber=function(source){return source*1||0};var strRepeat=function(i,m){for(var o=[];m>0;o[--m]=i);return o.join("")};var slice=function(a){return Array.prototype.slice.call(a)};var defaultToWhiteSpace=function(characters){if(characters)return _s.escapeRegExp(characters);return"\\s"};var sArgs=function(method){return function(){var args=slice(arguments);for(var i=0;i<args.length;i++)args[i]=args[i]==null?"":""+args[i];return method.apply(null,
args)}};var sprintf=function(){function get_type(variable){return Object.prototype.toString.call(variable).slice(8,-1).toLowerCase()}var str_repeat=strRepeat;var str_format=function(){if(!str_format.cache.hasOwnProperty(arguments[0]))str_format.cache[arguments[0]]=str_format.parse(arguments[0]);return str_format.format.call(null,str_format.cache[arguments[0]],arguments)};str_format.format=function(parse_tree,argv){var cursor=1,tree_length=parse_tree.length,node_type="",arg,output=[],i,k,match,pad,
pad_character,pad_length;for(i=0;i<tree_length;i++){node_type=get_type(parse_tree[i]);if(node_type==="string")output.push(parse_tree[i]);else if(node_type==="array"){match=parse_tree[i];if(match[2]){arg=argv[cursor];for(k=0;k<match[2].length;k++){if(!arg.hasOwnProperty(match[2][k]))throw new Error(sprintf('[_.sprintf] property "%s" does not exist',match[2][k]));arg=arg[match[2][k]]}}else if(match[1])arg=argv[match[1]];else arg=argv[cursor++];if(/[^s]/.test(match[8])&&get_type(arg)!="number")throw new Error(sprintf("[_.sprintf] expecting number but found %s",
get_type(arg)));switch(match[8]){case "b":arg=arg.toString(2);break;case "c":arg=String.fromCharCode(arg);break;case "d":arg=parseInt(arg,10);break;case "e":arg=match[7]?arg.toExponential(match[7]):arg.toExponential();break;case "f":arg=match[7]?parseFloat(arg).toFixed(match[7]):parseFloat(arg);break;case "o":arg=arg.toString(8);break;case "s":arg=(arg=String(arg))&&match[7]?arg.substring(0,match[7]):arg;break;case "u":arg=Math.abs(arg);break;case "x":arg=arg.toString(16);break;case "X":arg=arg.toString(16).toUpperCase();
break}arg=/[def]/.test(match[8])&&match[3]&&arg>=0?"+"+arg:arg;pad_character=match[4]?match[4]=="0"?"0":match[4].charAt(1):" ";pad_length=match[6]-String(arg).length;pad=match[6]?str_repeat(pad_character,pad_length):"";output.push(match[5]?arg+pad:pad+arg)}}return output.join("")};str_format.cache={};str_format.parse=function(fmt){var _fmt=fmt,match=[],parse_tree=[],arg_names=0;while(_fmt){if((match=/^[^\x25]+/.exec(_fmt))!==null)parse_tree.push(match[0]);else if((match=/^\x25{2}/.exec(_fmt))!==null)parse_tree.push("%");
else if((match=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(_fmt))!==null){if(match[2]){arg_names|=1;var field_list=[],replacement_field=match[2],field_match=[];if((field_match=/^([a-z_][a-z_\d]*)/i.exec(replacement_field))!==null){field_list.push(field_match[1]);while((replacement_field=replacement_field.substring(field_match[0].length))!=="")if((field_match=/^\.([a-z_][a-z_\d]*)/i.exec(replacement_field))!==null)field_list.push(field_match[1]);else if((field_match=
/^\[(\d+)\]/.exec(replacement_field))!==null)field_list.push(field_match[1]);else throw new Error("[_.sprintf] huh?");}else throw new Error("[_.sprintf] huh?");match[2]=field_list}else arg_names|=2;if(arg_names===3)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");parse_tree.push(match)}else throw new Error("[_.sprintf] huh?");_fmt=_fmt.substring(match[0].length)}return parse_tree};return str_format}();var _s={VERSION:"1.2.0",isBlank:sArgs(function(str){return/^\s*$/.test(str)}),
stripTags:sArgs(function(str){return str.replace(/<\/?[^>]+>/ig,"")}),capitalize:sArgs(function(str){return str.charAt(0).toUpperCase()+str.substring(1).toLowerCase()}),chop:sArgs(function(str,step){step=parseNumber(step)||str.length;var arr=[];for(var i=0;i<str.length;){arr.push(str.slice(i,i+step));i=i+step}return arr}),clean:sArgs(function(str){return _s.strip(str.replace(/\s+/g," "))}),count:sArgs(function(str,substr){var count=0,index;for(var i=0;i<str.length;){index=str.indexOf(substr,i);index>=
0&&count++;i=i+(index>=0?index:0)+substr.length}return count}),chars:sArgs(function(str){return str.split("")}),escapeHTML:sArgs(function(str){return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}),unescapeHTML:sArgs(function(str){return str.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&amp;/g,"&")}),escapeRegExp:sArgs(function(str){return str.replace(/([-.*+?^${}()|[\]\/\\])/g,
"\\$1")}),insert:sArgs(function(str,i,substr){var arr=str.split("");arr.splice(parseNumber(i),0,substr);return arr.join("")}),include:sArgs(function(str,needle){return str.indexOf(needle)!==-1}),join:sArgs(function(sep){var args=slice(arguments);return args.join(args.shift())}),lines:sArgs(function(str){return str.split("\n")}),reverse:sArgs(function(str){return Array.prototype.reverse.apply(String(str).split("")).join("")}),splice:sArgs(function(str,i,howmany,substr){var arr=str.split("");arr.splice(parseNumber(i),
parseNumber(howmany),substr);return arr.join("")}),startsWith:sArgs(function(str,starts){return str.length>=starts.length&&str.substring(0,starts.length)===starts}),endsWith:sArgs(function(str,ends){return str.length>=ends.length&&str.substring(str.length-ends.length)===ends}),succ:sArgs(function(str){var arr=str.split("");arr.splice(str.length-1,1,String.fromCharCode(str.charCodeAt(str.length-1)+1));return arr.join("")}),titleize:sArgs(function(str){var arr=str.split(" "),word;for(var i=0;i<arr.length;i++){word=
arr[i].split("");if(typeof word[0]!=="undefined")word[0]=word[0].toUpperCase();i+1===arr.length?arr[i]=word.join(""):arr[i]=word.join("")+" "}return arr.join("")}),camelize:sArgs(function(str){return _s.trim(str).replace(/(\-|_|\s)+(.)?/g,function(match,separator,chr){return chr?chr.toUpperCase():""})}),underscored:function(str){return _s.trim(str).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/\-|\s+/g,"_").toLowerCase()},dasherize:function(str){return _s.trim(str).replace(/([a-z\d])([A-Z]+)/g,"$1-$2").replace(/^([A-Z]+)/,
"-$1").replace(/\_|\s+/g,"-").toLowerCase()},humanize:function(str){return _s.capitalize(this.underscored(str).replace(/_id$/,"").replace(/_/g," "))},trim:sArgs(function(str,characters){if(!characters&&nativeTrim)return nativeTrim.call(str);characters=defaultToWhiteSpace(characters);return str.replace(new RegExp("^["+characters+"]+|["+characters+"]+$","g"),"")}),ltrim:sArgs(function(str,characters){characters=defaultToWhiteSpace(characters);return str.replace(new RegExp("^["+characters+"]+","g"),
"")}),rtrim:sArgs(function(str,characters){characters=defaultToWhiteSpace(characters);return str.replace(new RegExp("["+characters+"]+$","g"),"")}),truncate:sArgs(function(str,length,truncateStr){truncateStr=truncateStr||"...";length=parseNumber(length);return str.length>length?str.slice(0,length)+truncateStr:str}),prune:sArgs(function(str,length,pruneStr){pruneStr=pruneStr||"...";length=parseNumber(length);var pruned="";if(str.substring(length-1,length+1).search(/^\w\w$/)===0)pruned=_s.rtrim(str.slice(0,
length).replace(/([\W][\w]*)$/,""));else pruned=_s.rtrim(str.slice(0,length));pruned=pruned.replace(/\W+$/,"");return pruned.length+pruneStr.length>str.length?str:pruned+pruneStr}),words:function(str,delimiter){return String(str).split(delimiter||" ")},pad:sArgs(function(str,length,padStr,type){var padding="",padlen=0;length=parseNumber(length);if(!padStr)padStr=" ";else if(padStr.length>1)padStr=padStr.charAt(0);switch(type){case "right":padlen=length-str.length;padding=strRepeat(padStr,padlen);
str=str+padding;break;case "both":padlen=length-str.length;padding={"left":strRepeat(padStr,Math.ceil(padlen/2)),"right":strRepeat(padStr,Math.floor(padlen/2))};str=padding.left+str+padding.right;break;default:padlen=length-str.length;padding=strRepeat(padStr,padlen);str=padding+str}return str}),lpad:function(str,length,padStr){return _s.pad(str,length,padStr)},rpad:function(str,length,padStr){return _s.pad(str,length,padStr,"right")},lrpad:function(str,length,padStr){return _s.pad(str,length,padStr,
"both")},sprintf:sprintf,vsprintf:function(fmt,argv){argv.unshift(fmt);return sprintf.apply(null,argv)},toNumber:function(str,decimals){var num=parseNumber(parseNumber(str).toFixed(parseNumber(decimals)));return!(num===0&&str!=="0"&&str!==0)?num:Number.NaN},strRight:sArgs(function(sourceStr,sep){var pos=!sep?-1:sourceStr.indexOf(sep);return pos!=-1?sourceStr.slice(pos+sep.length,sourceStr.length):sourceStr}),strRightBack:sArgs(function(sourceStr,sep){var pos=!sep?-1:sourceStr.lastIndexOf(sep);return pos!=
-1?sourceStr.slice(pos+sep.length,sourceStr.length):sourceStr}),strLeft:sArgs(function(sourceStr,sep){var pos=!sep?-1:sourceStr.indexOf(sep);return pos!=-1?sourceStr.slice(0,pos):sourceStr}),strLeftBack:sArgs(function(sourceStr,sep){var pos=sourceStr.lastIndexOf(sep);return pos!=-1?sourceStr.slice(0,pos):sourceStr}),exports:function(){var result={};for(var prop in this){if(!this.hasOwnProperty(prop)||prop=="include"||prop=="contains"||prop=="reverse")continue;result[prop]=this[prop]}return result}};
_s.strip=_s.trim;_s.lstrip=_s.ltrim;_s.rstrip=_s.rtrim;_s.center=_s.lrpad;_s.ljust=_s.lpad;_s.rjust=_s.rpad;_s.contains=_s.include;if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)module.exports=_s;exports._s=_s}else if(typeof root._!=="undefined"){root._.string=_s;root._.str=root._.string}else root._={string:_s,str:_s}})(this||window);
(function(global){var _$LAB=global.$LAB,_UseLocalXHR="UseLocalXHR",_AlwaysPreserveOrder="AlwaysPreserveOrder",_AllowDuplicates="AllowDuplicates",_CacheBust="CacheBust",_Debug="Debug",_BasePath="BasePath",root_page=/^[^?#]*\//.exec(location.href)[0],root_domain=/^\w+\:\/\/\/?[^\/]+/.exec(root_page)[0],append_to=document.head||document.getElementsByTagName("head"),opera_or_gecko=global.opera&&Object.prototype.toString.call(global.opera)=="[object Opera]"||"MozAppearance"in document.documentElement.style,
log_msg=function(){},log_error=log_msg,test_script_elem=document.createElement("script"),explicit_preloading=typeof test_script_elem.preload=="boolean",real_preloading=explicit_preloading||test_script_elem.readyState&&test_script_elem.readyState=="uninitialized",script_ordered_async=!real_preloading&&test_script_elem.async===true,xhr_or_cache_preloading=!real_preloading&&!script_ordered_async&&!opera_or_gecko;if(global.console&&global.console.log){if(!global.console.error)global.console.error=global.console.log;
log_msg=function(msg){global.console.log(msg)};log_error=function(msg,err){global.console.error(msg,err)}}function is_func(func){return Object.prototype.toString.call(func)=="[object Function]"}function is_array(arr){return Object.prototype.toString.call(arr)=="[object Array]"}function canonical_uri(src,base_path){var absolute_regex=/^\w+\:\/\//;if(/^\/\/\/?/.test(src))src=location.protocol+src;else if(!absolute_regex.test(src)&&src.charAt(0)!="/")src=(base_path||"")+src;return absolute_regex.test(src)?
src:(src.charAt(0)=="/"?root_domain:root_page)+src}function merge_objs(source,target){for(var k in source)if(source.hasOwnProperty(k))target[k]=source[k];return target}function check_chain_group_scripts_ready(chain_group){var any_scripts_ready=false;for(var i=0;i<chain_group.scripts.length;i++)if(chain_group.scripts[i].ready&&chain_group.scripts[i].exec_trigger){any_scripts_ready=true;chain_group.scripts[i].exec_trigger();chain_group.scripts[i].exec_trigger=null}return any_scripts_ready}function create_script_load_listener(elem,
registry_item,flag,onload){elem.onload=elem.onreadystatechange=function(){if(elem.readyState&&elem.readyState!="complete"&&elem.readyState!="loaded"||registry_item[flag])return;elem.onload=elem.onreadystatechange=null;onload()}}function script_executed(registry_item){registry_item.ready=registry_item.finished=true;for(var i=0;i<registry_item.finished_listeners.length;i++)registry_item.finished_listeners[i]();registry_item.ready_listeners=[];registry_item.finished_listeners=[]}function request_script(chain_opts,
script_obj,registry_item,onload,preload_this_script){setTimeout(function(){var script,src=script_obj.real_src,xhr;if("item"in append_to){if(!append_to[0]){setTimeout(arguments.callee,25);return}append_to=append_to[0]}script=document.createElement("script");if(script_obj.type)script.type=script_obj.type;if(script_obj.charset)script.charset=script_obj.charset;if(preload_this_script)if(real_preloading){if(chain_opts[_Debug])log_msg("start script preload: "+src);registry_item.elem=script;if(explicit_preloading){script.preload=
true;script.onpreload=onload}else script.onreadystatechange=function(){if(script.readyState=="loaded")onload()};script.src=src}else if(preload_this_script&&src.indexOf(root_domain)==0&&chain_opts[_UseLocalXHR]){xhr=new XMLHttpRequest;if(chain_opts[_Debug])log_msg("start script preload (xhr): "+src);xhr.onreadystatechange=function(){if(xhr.readyState==4){xhr.onreadystatechange=function(){};registry_item.text=xhr.responseText+"\n//@ sourceURL="+src;onload()}};xhr.open("GET",src);xhr.send()}else{if(chain_opts[_Debug])log_msg("start script preload (cache): "+
src);script.type="text/cache-script";create_script_load_listener(script,registry_item,"ready",function(){append_to.removeChild(script);onload()});script.src=src;append_to.insertBefore(script,append_to.firstChild)}else if(script_ordered_async){if(chain_opts[_Debug])log_msg("start script load (ordered async): "+src);script.async=false;create_script_load_listener(script,registry_item,"finished",onload);script.src=src;append_to.insertBefore(script,append_to.firstChild)}else{if(chain_opts[_Debug])log_msg("start script load: "+
src);create_script_load_listener(script,registry_item,"finished",onload);script.src=src;append_to.insertBefore(script,append_to.firstChild)}},0)}function create_sandbox(){var global_defaults={},can_use_preloading=real_preloading||xhr_or_cache_preloading,queue=[],registry={},instanceAPI;global_defaults[_UseLocalXHR]=true;global_defaults[_AlwaysPreserveOrder]=false;global_defaults[_AllowDuplicates]=false;global_defaults[_CacheBust]=false;global_defaults[_Debug]=false;global_defaults[_BasePath]="";function execute_preloaded_script(chain_opts,
script_obj,registry_item){var script;function preload_execute_finished(){if(script!=null){script=null;script_executed(registry_item)}}if(registry[script_obj.src].finished)return;if(!chain_opts[_AllowDuplicates])registry[script_obj.src].finished=true;script=registry_item.elem||document.createElement("script");if(script_obj.type)script.type=script_obj.type;if(script_obj.charset)script.charset=script_obj.charset;create_script_load_listener(script,registry_item,"finished",preload_execute_finished);if(registry_item.elem)registry_item.elem=
null;else if(registry_item.text){script.onload=script.onreadystatechange=null;script.text=registry_item.text}else script.src=script_obj.real_src;append_to.insertBefore(script,append_to.firstChild);if(registry_item.text)preload_execute_finished()}function do_script(chain_opts,script_obj,chain_group,preload_this_script){var registry_item,registry_items,ready_cb=function(){script_obj.ready_cb(script_obj,function(){execute_preloaded_script(chain_opts,script_obj,registry_item)})},finished_cb=function(){script_obj.finished_cb(script_obj,
chain_group)};script_obj.src=canonical_uri(script_obj.src,chain_opts[_BasePath]);script_obj.real_src=script_obj.src+(chain_opts[_CacheBust]?(/\?.*$/.test(script_obj.src)?"&_":"?_")+~~(Math.random()*1E9)+"=":"");if(!registry[script_obj.src])registry[script_obj.src]={items:[],finished:false};registry_items=registry[script_obj.src].items;if(chain_opts[_AllowDuplicates]||registry_items.length==0){registry_item=registry_items[registry_items.length]={ready:false,finished:false,ready_listeners:[ready_cb],
finished_listeners:[finished_cb]};request_script(chain_opts,script_obj,registry_item,preload_this_script?function(){registry_item.ready=true;for(var i=0;i<registry_item.ready_listeners.length;i++)registry_item.ready_listeners[i]();registry_item.ready_listeners=[]}:function(){script_executed(registry_item)},preload_this_script)}else{registry_item=registry_items[0];if(registry_item.finished)finished_cb();else registry_item.finished_listeners.push(finished_cb)}}function create_chain(){var chainedAPI,
chain_opts=merge_objs(global_defaults,{}),chain=[],exec_cursor=0,scripts_currently_loading=false,group;function chain_script_ready(script_obj,exec_trigger){if(chain_opts[_Debug])log_msg("script preload finished: "+script_obj.real_src);script_obj.ready=true;script_obj.exec_trigger=exec_trigger;advance_exec_cursor()}function chain_script_executed(script_obj,chain_group){if(chain_opts[_Debug])log_msg("script execution finished: "+script_obj.real_src);script_obj.ready=script_obj.finished=true;script_obj.exec_trigger=
null;for(var i=0;i<chain_group.scripts.length;i++)if(!chain_group.scripts[i].finished)return;chain_group.finished=true;advance_exec_cursor()}function advance_exec_cursor(){while(exec_cursor<chain.length){if(is_func(chain[exec_cursor])){if(chain_opts[_Debug])log_msg("$LAB.wait() executing: "+chain[exec_cursor]);try{chain[exec_cursor++]()}catch(err){if(chain_opts[_Debug])log_error("$LAB.wait() error caught: ",err)}continue}else if(!chain[exec_cursor].finished){if(check_chain_group_scripts_ready(chain[exec_cursor]))continue;
break}exec_cursor++}if(exec_cursor==chain.length){scripts_currently_loading=false;group=false}}function init_script_chain_group(){if(!group||!group.scripts)chain.push(group={scripts:[],finished:true})}chainedAPI={script:function(){for(var i=0;i<arguments.length;i++)(function(script_obj,script_list){var splice_args;if(!is_array(script_obj))script_list=[script_obj];for(var j=0;j<script_list.length;j++){init_script_chain_group();script_obj=script_list[j];if(is_func(script_obj))script_obj=script_obj();
if(!script_obj)continue;if(is_array(script_obj)){splice_args=[].slice.call(script_obj);splice_args.unshift(j,1);[].splice.apply(script_list,splice_args);j--;continue}if(typeof script_obj=="string")script_obj={src:script_obj};script_obj=merge_objs(script_obj,{ready:false,ready_cb:chain_script_ready,finished:false,finished_cb:chain_script_executed});group.finished=false;group.scripts.push(script_obj);do_script(chain_opts,script_obj,group,can_use_preloading&&scripts_currently_loading);scripts_currently_loading=
true;if(chain_opts[_AlwaysPreserveOrder])chainedAPI.wait()}})(arguments[i],arguments[i]);return chainedAPI},wait:function(){if(arguments.length>0){for(var i=0;i<arguments.length;i++)chain.push(arguments[i]);group=chain[chain.length-1]}else group=false;advance_exec_cursor();return chainedAPI}};return{script:chainedAPI.script,wait:chainedAPI.wait,setOptions:function(opts){merge_objs(opts,chain_opts);return chainedAPI}}}instanceAPI={setGlobalDefaults:function(opts){merge_objs(opts,global_defaults);return instanceAPI},
setOptions:function(){return create_chain().setOptions.apply(null,arguments)},script:function(){return create_chain().script.apply(null,arguments)},wait:function(){return create_chain().wait.apply(null,arguments)},queueScript:function(){queue[queue.length]={type:"script",args:[].slice.call(arguments)};return instanceAPI},queueWait:function(){queue[queue.length]={type:"wait",args:[].slice.call(arguments)};return instanceAPI},runQueue:function(){var $L=instanceAPI,len=queue.length,i=len,val;for(;--i>=
0;){val=queue.shift();$L=$L[val.type].apply(null,val.args)}return $L},noConflict:function(){global.$LAB=_$LAB;return instanceAPI},sandbox:function(){return create_sandbox()}};return instanceAPI}global.$LAB=create_sandbox();(function(addEvent,domLoaded,handler){if(document.readyState==null&&document[addEvent]){document.readyState="loading";document[addEvent](domLoaded,handler=function(){document.removeEventListener(domLoaded,handler,false);document.readyState="complete"},false)}})("addEventListener",
"DOMContentLoaded")})(this);var py={};
(function(exports){var NUMBER=/^\d$/,NAME_FIRST=/^[a-zA-Z_]$/,NAME=/^[a-zA-Z0-9_]$/;var create=function(o,props){function F(){}F.prototype=o;var inst=new F;for(var name in props){if(!props.hasOwnProperty(name))continue;inst[name]=props[name]}return inst};var symbols={};var comparators={};var Base={nud:function(){throw new Error(this.id+" undefined as prefix");},led:function(led){throw new Error(this.id+" undefined as infix");},toString:function(){if(this.id==="(constant)"||this.id==="(number)"||this.id===
"(name)"||this.id==="(string)")return[this.id.slice(0,this.id.length-1)," ",this.value,")"].join("");else if(this.id==="(end)")return"(end)";else if(this.id==="(comparator)"){var repr=["(comparator",this.expressions[0]];for(var i=0;i<this.operators.length;++i)repr.push(this.operators[i],this.expressions[i+1]);return repr.join(" ")+")"}var out=[this.id,this.first,this.second,this.third].filter(function(r){return r}).join(" ");return"("+out+")"}};function symbol(id,bp){bp=bp||0;var s=symbols[id];if(s){if(bp>
s.lbp)s.lbp=bp;return s}return symbols[id]=create(Base,{id:id,lbp:bp})}function constant(id){symbol(id).nud=function(){this.id="(constant)";this.value=id;return this}}function prefix(id,bp,nud){symbol(id).nud=nud||function(){this.first=expression(bp);return this}}function infix(id,bp,led){symbol(id,bp).led=led||function(left){this.first=left;this.second=expression(bp);return this}}function infixr(id,bp){symbol(id,bp).led=function(left){this.first=left;this.second=expression(bp-1);return this}}function comparator(id){comparators[id]=
true;var bp=60;infix(id,bp,function(left){this.id="(comparator)";this.operators=[id];this.expressions=[left,expression(bp)];while(token.id in comparators){this.operators.push(token.id);advance();this.expressions.push(expression(bp))}return this})}constant("None");constant("False");constant("True");symbol("(number)").nud=function(){return this};symbol("(name)").nud=function(){return this};symbol("(string)").nud=function(){return this};symbol("(end)");symbol(":");symbol(")");symbol("]");symbol("}");
symbol(",");symbol("else");symbol("lambda",20).nud=function(){this.first=[];if(token.id!==":")for(;;){if(token.id!=="(name)")throw new Error("Excepted an argument name");this.first.push(token);advance();if(token.id!==",")break;advance(",")}advance(":");this.second=expression();return this};infix("if",20,function(left){this.first=left;this.second=expression();advance("else");this.third=expression();return this});infixr("or",30);infixr("and",40);prefix("not",50);comparator("in");comparator("not in");
comparator("is");comparator("is not");comparator("<");comparator("<=");comparator(">");comparator(">=");comparator("<>");comparator("!=");comparator("==");infix("|",70);infix("^",80),infix("&",90);infix("<<",100);infix(">>",100);infix("+",110);infix("-",110);infix("*",120);infix("/",120);infix("//",120),infix("%",120);prefix("-",130);prefix("+",130);prefix("~",130);infixr("**",140);infix(".",150,function(left){if(token.id!=="(name)")throw new Error("Expected attribute name, got ",token.id);this.first=
left;this.second=token;advance();return this});symbol("(",150).nud=function(){this.first=[];var comma=false;if(token.id!==")")while(true){if(token.id===")")break;this.first.push(expression());if(token.id!==",")break;comma=true;advance(",")}advance(")");if(!this.first.length||comma)return this;else return this.first[0]};symbol("(").led=function(left){this.first=left;this.second=[];if(token.id!==")")for(;;){this.second.push(expression());if(token.id!==",")break;advance(",")}advance(")");return this};
infix("[",150,function(left){this.first=left;this.second=expression();advance("]");return this});symbol("[").nud=function(){this.first=[];if(token.id!=="]")for(;;){if(token.id==="]")break;this.first.push(expression());if(token.id!==",")break;advance(",")}advance("]");return this};symbol("{").nud=function(){this.first=[];if(token.id!=="}")for(;;){if(token.id==="}")break;var key=expression();advance(":");var value=expression();this.first.push([key,value]);if(token.id!==",")break;advance(",")}advance("}");
return this};var longops={"*":["*"],"<":["<","=",">"],">":["=",">"],"!":["="],"=":["="],"/":["/"]};function Tokenizer(){this.states=["initial"];this.tokens=[]}Tokenizer.prototype={builder:function(empty){var key=this.states[0]+"_builder";if(empty){var value=this[key];delete this[key];return value}else return this[key]=this[key]||[]},simple:function(type){this.tokens.push({type:type})},push:function(new_state){this.states.push(new_state)},pop:function(){this.states.pop()},feed:function(str,index){var s=
this.states;return this[s[s.length-1]](str,index)},initial:function(str,index){var character=str[index];if(character in longops){var follow=longops[character];for(var i=0,len=follow.length;i<len;++i)if(str[index+1]===follow[i]){character+=follow[i];index++;break}}if(character===" ")return index+1;else if(character==="\x00"){this.tokens.push(symbols["(end)"]);return index+1}else if(character==='"'||character==="'"){this.push("string");return index+1}else if(NUMBER.test(character)){this.push("number");
return index}else if(NAME_FIRST.test(character)){this.push("name");return index}else if(character in symbols){this.tokens.push(create(symbols[character]));return index+1}throw new Error("Tokenizing failure of <<"+str+">> at index "+index+", character [["+character+"]]"+"; parsed so far: "+this.tokens);},string:function(str,index){var character=str[index];if(character==='"'||character==="'"){this.tokens.push(create(symbols["(string)"],{value:this.builder(true).join("")}));this.pop();return index+1}this.builder().push(character);
return index+1},number:function(str,index){var character=str[index];if(!(character=="."||NUMBER.test(character))){this.tokens.push(create(symbols["(number)"],{value:parseFloat(this.builder(true).join(""))}));this.pop();return index}this.builder().push(character);return index+1},name:function(str,index){var character=str[index];if(!NAME.test(character)){var name=this.builder(true).join("");var symbol=symbols[name];if(symbol){if(name==="in"&&this.tokens[this.tokens.length-1].id==="not"){symbol=symbols["not in"];
this.tokens.pop()}else if(name==="not"&&this.tokens[this.tokens.length-1].id==="is"){symbol=symbols["is not"];this.tokens.pop()}this.tokens.push(create(symbol))}else this.tokens.push(create(symbols["(name)"],{value:name}));this.pop();return index}this.builder().push(character);return index+1}};exports.tokenize=function tokenize(str){var index=0,tokenizer=new Tokenizer(str);str+="\x00";do index=tokenizer.feed(str,index);while(index!==str.length);return tokenizer.tokens};var token,next;function expression(rbp){rbp=
rbp||0;var t=token;token=next();var left=t.nud();while(rbp<token.lbp){t=token;token=next();left=t.led(left)}return left}function advance(id){if(id&&token.id!==id)throw new Error('Expected "'+id+'", got "'+token.id+'"');token=next()}exports.object=create({},{});exports.bool=function(arg){return!!arg};exports.tuple=create(exports.object,{__contains__:function(value){for(var i=0,len=this.values.length;i<len;++i)if(this.values[i]===value)return true;return false},toJSON:function(){return this.values}});
exports.list=exports.tuple;exports.dict=create(exports.object,{toJSON:function(){return this.values}});exports.parse=function(toks){var index=0;token=toks[0];next=function(){return toks[++index]};return expression()};var evaluate_operator=function(operator,a,b){switch(operator){case "==":case "is":return a===b;case "!=":case "is not":return a!==b;case "<":return a<b;case "<=":return a<=b;case ">":return a>b;case ">=":return a>=b;case "in":if(typeof b==="string")return b.indexOf(a)!==-1;return b.__contains__(a);
case "not in":if(typeof b==="string")return b.indexOf(a)===-1;return!b.__contains__(a)}throw new Error("SyntaxError: unknown comparator [["+operator+"]]");};exports.evaluate=function(expr,context){switch(expr.id){case "(name)":var val=context[expr.value];if(val===undefined)throw new Error("NameError: name '"+expr.value+"' is not defined");return val;case "(string)":case "(number)":return expr.value;case "(constant)":if(expr.value==="None")return null;else if(expr.value==="False")return false;else if(expr.value===
"True")return true;throw new Error("SyntaxError: unknown constant '"+expr.value+"'");case "(comparator)":var result,left=exports.evaluate(expr.expressions[0],context);for(var i=0;i<expr.operators.length;++i){result=evaluate_operator(expr.operators[i],left,left=exports.evaluate(expr.expressions[i+1],context));if(!result)return false}return true;case "-":if(expr.second)throw new Error("SyntaxError: binary [-] not implemented yet");return-exports.evaluate(expr.first,context);case "not":return!exports.evaluate(expr.first,
context);case "and":return exports.evaluate(expr.first,context)&&exports.evaluate(expr.second,context);case "or":return exports.evaluate(expr.first,context)||exports.evaluate(expr.second,context);case "(":if(expr.second){var fn=exports.evaluate(expr.first,context),args=[];for(var jj=0;jj<expr.second.length;++jj)args.push(exports.evaluate(expr.second[jj],context));return fn.apply(null,args)}var tuple_exprs=expr.first,tuple_values=[];for(var j=0,len=tuple_exprs.length;j<len;++j)tuple_values.push(exports.evaluate(tuple_exprs[j],
context));return create(exports.tuple,{values:tuple_values});case "[":if(expr.second)throw new Error("SyntaxError: indexing not implemented yet");var list_exprs=expr.first,list_values=[];for(var k=0;k<list_exprs.length;++k)list_values.push(exports.evaluate(list_exprs[k],context));return create(exports.list,{values:list_values});case "{":var dict_exprs=expr.first,dict_values={};for(var l=0;l<dict_exprs.length;++l)dict_values[exports.evaluate(dict_exprs[l][0],context)]=exports.evaluate(dict_exprs[l][1],
context);return create(exports.dict,{values:dict_values});case ".":if(expr.second.id!=="(name)")throw new Error("SyntaxError: "+expr);return exports.evaluate(expr.first,context)[expr.second.value];default:throw new Error("SyntaxError: Unknown node [["+expr.id+"]]");}};exports.eval=function(str,context){return exports.evaluate(exports.parse(exports.tokenize(str)),context)}})(typeof exports==="undefined"?py:exports);
(function(){if(this.openerp)return;var session_counter=0;var openerp=this.openerp={sessions:{},init:function(modules){modules=modules||["web"];var new_instance={_openerp:openerp,_session_id:"session"+session_counter++,_modules:modules,web:{},web_mobile:{}};openerp.sessions[new_instance._session_id]=new_instance;for(var i=0;i<modules.length;i++)openerp[modules[i]](new_instance);return new_instance}}})();
openerp.web=function(instance){openerp.web.core(instance);if(openerp.web.dates)openerp.web.dates(instance);openerp.web.formats(instance);openerp.web.chrome(instance);openerp.web.data(instance);var files=["views","search","list","form","page","list_editable","web_mobile","view_tree","data_export","data_import","view_editor"];for(var i=0;i<files.length;i++)if(openerp.web[files[i]])openerp.web[files[i]](instance);instance.log=function(){if(instance.connection.debug&&window.console)console.log.apply(console,
arguments)}};var console;if(!console)console={log:function(){}};if(!console.debug)console.debug=console.log;localStorage.last_db_login_success="jydev1";
openerp.web.core=function(openerp){(function(){var initializing=false,fnTest=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;openerp.web.Class=function(){};openerp.web.Class.extend=function(prop){var _super=this.prototype;initializing=true;var prototype=new this;initializing=false;for(var name in prop)prototype[name]=typeof prop[name]=="function"&&typeof _super[name]=="function"&&fnTest.test(prop[name])?function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,
arguments);this._super=tmp;return ret}}(name,prop[name]):prop[name];function Class(){if(!initializing&&this.init){var ret=this.init.apply(this,arguments);if(ret)return ret}return this}Class.include=function(properties){for(var name in properties)if(typeof properties[name]!=="function"||!fnTest.test(properties[name]))prototype[name]=properties[name];else if(typeof prototype[name]==="function"&&prototype.hasOwnProperty(name))prototype[name]=function(name,fn,previous){return function(){var tmp=this._super;
this._super=previous;var ret=fn.apply(this,arguments);this._super=tmp;return ret}}(name,properties[name],prototype[name]);else if(typeof _super[name]==="function")prototype[name]=function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);this._super=tmp;return ret}}(name,properties[name])};Class.prototype=prototype;Class.constructor=Class;Class.extend=arguments.callee;return Class}})();openerp.web.callback=function(obj,method){var callback=function(){var args=
Array.prototype.slice.call(arguments);var r;for(var i=0;i<callback.callback_chain.length;i++){var c=callback.callback_chain[i];if(c.unique){callback.callback_chain.splice(i,1);i-=1}var result=c.callback.apply(c.self,c.args.concat(args));if(c.callback===method)r=result}return r};callback.callback_chain=[];callback.add=function(f){if(typeof f=="function")f={callback:f,args:Array.prototype.slice.call(arguments,1)};f.self=f.self||null;f.args=f.args||[];f.unique=!!f.unique;if(f.position=="last")callback.callback_chain.push(f);
else callback.callback_chain.unshift(f);return callback};callback.add_first=function(f){return callback.add.apply(null,arguments)};callback.add_last=function(f){return callback.add({callback:f,args:Array.prototype.slice.call(arguments,1),position:"last"})};callback.remove=function(f){callback.callback_chain=_.difference(callback.callback_chain,_.filter(callback.callback_chain,function(el){return el.callback===f}));return callback};return callback.add({callback:method,self:obj,args:Array.prototype.slice.call(arguments,
2)})};openerp.web.generate_null_object_class=function(claz,add){var newer={};var copy_proto=function(prototype){for(var name in prototype)if(typeof prototype[name]=="function")newer[name]=function(){};if(prototype.prototype)copy_proto(prototype.prototype)};copy_proto(claz.prototype);newer.init=openerp.web.Widget.prototype.init;var tmpclass=claz.extend(newer);return tmpclass.extend(add||{})};openerp.web.NotFound=openerp.web.Class.extend({});openerp.web.KeyNotFound=openerp.web.NotFound.extend({init:function(key){this.key=
key},toString:function(){return"The key "+this.key+" was not found"}});openerp.web.ObjectNotFound=openerp.web.NotFound.extend({init:function(path){this.path=path},toString:function(){return"Could not find any object of path "+this.path}});openerp.web.Registry=openerp.web.Class.extend({init:function(mapping){this.parent=null;this.map=mapping||{}},get_object:function(key,silent_error){var path_string=this.map[key];if(path_string===undefined){if(this.parent)return this.parent.get_object(key,silent_error);
if(silent_error)return void"nooo";throw new openerp.web.KeyNotFound(key);}var object_match=openerp;var path=path_string.split(".");for(var i=1;i<path.length;++i){object_match=object_match[path[i]];if(object_match===undefined){if(silent_error)return void"noooooo";throw new openerp.web.ObjectNotFound(path_string);}}return object_match},contains:function(key){if(key===undefined)return false;if(key in this.map)return true;if(this.parent)return this.parent.contains(key);return false},get_any:function(keys){for(var i=
0;i<keys.length;++i){var key=keys[i];if(!this.contains(key))continue;return this.get_object(key)}throw new openerp.web.KeyNotFound(keys.join(","));},add:function(key,object_path){this.map[key]=object_path;return this},extend:function(mapping){var child=new openerp.web.Registry(mapping);child.parent=this;return child},clone:function(mapping){console.warn("Registry#clone is deprecated, use Registry#extend");return this.extend(mapping)}});openerp.web.CallbackEnabled=openerp.web.Class.extend({init:function(){for(var name in this)if(typeof this[name]==
"function"){this[name].debug_name=name;if(/^on_|^do_/.test(name))this[name]=openerp.web.callback(this,this[name])}},proxy:function(method_name){var self=this;return function(){return self[method_name].apply(self,arguments)}}});openerp.web.Connection=openerp.web.CallbackEnabled.extend({init:function(){this._super();this.server=null;this.debug=$.deparam($.param.querystring()).debug!=undefined;this.name=openerp._session_id;this.qweb_mutex=new $.Mutex},bind:function(origin){var window_origin=location.protocol+
"//"+location.host,self=this;this.origin=origin?_.str.rtrim(origin,"/"):window_origin;this.prefix=this.origin;this.server=this.origin;openerp.web.qweb.default_dict["_s"]=this.origin;this.rpc_function=this.origin==window_origin?this.rpc_json:this.rpc_jsonp;this.session_id=false;this.uid=false;this.username=false;this.user_context={};this.db=false;this.openerp_entreprise=false;this.module_list=openerp._modules.slice();this.module_loaded={};_(this.module_list).each(function(mod){self.module_loaded[mod]=
true});this.context={};this.shortcuts=[];this.active_id=null;return this.session_init()},rpc:function(url,params,success_callback,error_callback){var self=this;if(_.isString(url))url={url:url};params.session_id=this.session_id;if(this.debug)params.debug=1;var payload={jsonrpc:"2.0",method:"call",params:params,id:_.uniqueId("r")};var deferred=$.Deferred();this.on_rpc_request();var aborter=params.aborter;delete params.aborter;var request=this.rpc_function(url,payload).then(function(response,textStatus,
jqXHR){self.on_rpc_response();if(!response.error)deferred.resolve(response["result"],textStatus,jqXHR);else if(response.error.data.type==="session_invalid"){self.uid=false;self.on_session_invalid(function(){self.rpc(url,payload.params,function(){deferred.resolve.apply(deferred,arguments)},function(){deferred.reject.apply(deferred,arguments)})})}else deferred.reject(response.error,$.Event())},function(jqXHR,textStatus,errorThrown){self.on_rpc_response();var error={code:-32098,message:"XmlHttpRequestError "+
errorThrown,data:{type:"xhr"+textStatus,debug:jqXHR.responseText,objects:[jqXHR,errorThrown]}};deferred.reject(error,$.Event())});if(aborter)aborter.abort_last=function(){if(!(request.isResolved()||request.isRejected())){deferred.fail(function(error,event){event.preventDefault()});request.abort()}};deferred.fail(function(){deferred.fail(function(error,event){if(!event.isDefaultPrevented())self.on_rpc_error(error,event)})}).then(success_callback,error_callback).promise();return deferred},rpc_json:function(url,
payload){var self=this;var ajax=_.extend({type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(payload),processData:false},url);if(this.synch)ajax.async=false;return $.ajax(ajax)},rpc_jsonp:function(url,payload){var self=this;var data={session_id:this.session_id,id:payload.id};url.url=this.get_url(url.url);var ajax=_.extend({type:"GET",dataType:"jsonp",jsonp:"jsonp",cache:false,data:data},url);if(this.synch)ajax.async=false;var payload_str=JSON.stringify(payload);var payload_url=
$.param({r:payload_str});if(payload_url.length<2E3){ajax.data.r=payload_str;return $.ajax(ajax)}else{var ifid=_.uniqueId("oe_rpc_iframe");var display=options.openerp.debug?"block":"none";var $iframe=$(_.str.sprintf("<iframe src='javascript:false;' name='%s' id='%s' style='display:%s'></iframe>",ifid,ifid,display));var $form=$("<form>").attr("method","POST").attr("target",ifid).attr("enctype","multipart/form-data").attr("action",ajax.url+"?"+$.param(data)).append($('<input type="hidden" name="r" />').attr("value",
payload_str)).hide().appendTo($("body"));var cleanUp=function(){if($iframe)$iframe.unbind("load").attr("src","javascript:false;").remove();$form.remove()};var deferred=$.Deferred();$iframe.bind("load",function(){$iframe.unbind("load").bind("load",function(){$.ajax(ajax).always(function(){cleanUp()}).then(function(){deferred.resolve.apply(deferred,arguments)},function(){deferred.reject.apply(deferred,arguments)})});$form.submit()});$form.after($iframe);return deferred}},on_rpc_request:function(){},
on_rpc_response:function(){},on_rpc_error:function(error){},session_init:function(){var self=this;this.session_id=this.get_cookie("session_id");return this.session_reload().pipe(function(result){var modules=openerp._modules.join(",");var deferred=self.rpc("/web/webclient/qweblist",{mods:modules}).pipe(self.do_load_qweb);if(self.session_is_valid())return deferred.pipe(function(){return self.load_modules()});return deferred})},session_reload:function(){var self=this;return this.rpc("/web/session/get_session_info",
{}).then(function(result){_.extend(self,{db:result.db,username:result.login,uid:result.uid,user_context:result.context,openerp_entreprise:result.openerp_entreprise})})},session_is_valid:function(){return!!this.uid},session_authenticate:function(db,login,password,_volatile){var self=this;var base_location=document.location.protocol+"//"+document.location.host;var params={db:db,login:login,password:password,base_location:base_location};return this.rpc("/web/session/authenticate",params).pipe(function(result){_.extend(self,
{session_id:result.session_id,db:result.db,username:result.login,uid:result.uid,user_context:result.context,openerp_entreprise:result.openerp_entreprise});if(!_volatile)self.set_cookie("session_id",self.session_id);return self.load_modules()})},session_logout:function(){this.set_cookie("session_id","");return this.rpc("/web/session/destroy",{})},on_session_valid:function(){},on_session_invalid:function(retry_callback){},get_cookie:function(name){if(!this.name)return null;var nameEQ=this.name+"|"+
name+"=";var cookies=document.cookie.split(";");for(var i=0;i<cookies.length;++i){var cookie=cookies[i].replace(/^\s*/,"");if(cookie.indexOf(nameEQ)===0)return JSON.parse(decodeURIComponent(cookie.substring(nameEQ.length)))}return null},set_cookie:function(name,value,ttl){if(!this.name)return;ttl=ttl||24*60*60*365;document.cookie=[this.name+"|"+name+"="+encodeURIComponent(JSON.stringify(value)),"path=/","max-age="+ttl,"expires="+(new Date((new Date).getTime()+ttl*1E3)).toGMTString()].join(";")},load_modules:function(no_session_valid_signal){var self=
this;return this.rpc("/web/session/modules",{}).pipe(function(result){var lang=self.user_context.lang,all_modules=_.uniq(self.module_list.concat(result));var params={mods:all_modules,lang:lang};var to_load=_.difference(result,self.module_list).join(",");self.module_list=all_modules;var loaded=$.Deferred().resolve().promise();if(to_load.length)loaded=$.when(self.rpc("/web/webclient/csslist",{mods:to_load},self.do_load_css),self.rpc("/web/webclient/qweblist",{mods:to_load}).pipe(self.do_load_qweb),
self.rpc("/web/webclient/translations",params).pipe(function(trans){openerp.web._t.database.set_bundle(trans);var file_list=["/web/static/lib/datejs/globalization/"+lang.replace("_","-")+".js"];return self.rpc("/web/webclient/jslist",{mods:to_load}).pipe(function(files){return self.do_load_js(file_list.concat(files))})}));return loaded.then(function(){self.on_modules_loaded();if(!no_session_valid_signal)self.on_session_valid()})})},do_load_css:function(files){var self=this;_.each(files,function(file){$("head").append($("<link>",
{"href":self.get_url(file),"rel":"stylesheet","type":"text/css"}))})},do_load_js:function(files){var self=this;var d=$.Deferred();if(files.length!=0){var file=files.shift();var tag=document.createElement("script");tag.type="text/javascript";tag.src=self.get_url(file);tag.onload=tag.onreadystatechange=function(){if(tag.readyState&&tag.readyState!="loaded"&&tag.readyState!="complete"||tag.onload_done)return;tag.onload_done=true;self.do_load_js(files).then(function(){d.resolve()})};var head=document.head||
document.getElementsByTagName("head")[0];head.appendChild(tag)}else d.resolve();return d},do_load_qweb:function(files){var self=this;_.each(files,function(file){self.qweb_mutex.exec(function(){return self.rpc("/web/proxy/load",{path:file}).pipe(function(xml){if(!xml)return;openerp.web.qweb.add_template(_.str.trim(xml))})})});return self.qweb_mutex.def},on_modules_loaded:function(){for(var j=0;j<this.module_list.length;j++){var mod=this.module_list[j];if(this.module_loaded[mod])continue;openerp[mod]=
{};if(openerp._openerp[mod]!=undefined){openerp._openerp[mod](openerp);this.module_loaded[mod]=true}}},get_url:function(file){return this.prefix+file},get_file:function(options){var timer,token=(new Date).getTime(),cookie_name="fileToken",cookie_length=cookie_name.length,CHECK_INTERVAL=1E3,id=_.uniqueId("get_file_frame"),remove_form=false;var $form,$form_data=$("<div>");var complete=function(){if(options.complete)options.complete();clearTimeout(timer);$form_data.remove();$target.remove();if(remove_form&&
$form)$form.remove()};var $target=$('<iframe style="display: none;">').attr({id:id,name:id}).appendTo(document.body).load(function(){try{if(options.error)options.error(JSON.parse(this.contentDocument.body.childNodes[1].textContent))}finally{complete()}});if(options.form)$form=$(options.form);else{remove_form=true;$form=$("<form>",{action:options.url,method:"POST"}).appendTo(document.body)}_(_.extend({},options.data||{},{session_id:this.session_id,token:token})).each(function(value,key){var $input=
$form.find("[name="+key+"]");if(!$input.length)$input=$('<input type="hidden" name="'+key+'">').appendTo($form_data);$input.val(value)});$form.append($form_data).attr("target",id).get(0).submit();var waitLoop=function(){var cookies=document.cookie.split(";");timer=setTimeout(waitLoop,CHECK_INTERVAL);for(var i=0;i<cookies.length;++i){var cookie=cookies[i].replace(/^\s*/,"");if(!cookie.indexOf(cookie_name===0))continue;var cookie_val=cookie.substring(cookie_length+1);if(parseInt(cookie_val,10)!==token)continue;
document.cookie=_.str.sprintf("%s=;expires=%s;path=/",cookie_name,(new Date).toGMTString());if(options.success)options.success();complete();return}};timer=setTimeout(waitLoop,CHECK_INTERVAL)},synchronized_mode:function(to_execute){var synch=this.synch;this.synch=true;try{return to_execute()}finally{this.synch=synch}}});openerp.web.Widget=openerp.web.CallbackEnabled.extend({template:null,tag_name:"div",init:function(parent){this._super();this.session=openerp.connection;this.$element=$(document.createElement(this.tag_name));
this.widget_parent=parent;this.widget_children=[];if(parent&&parent.widget_children)parent.widget_children.push(this);this.widget_is_stopped=false},appendTo:function(target){var self=this;return this._render_and_insert(function(t){self.$element.appendTo(t)},target)},prependTo:function(target){var self=this;return this._render_and_insert(function(t){self.$element.prependTo(t)},target)},insertAfter:function(target){var self=this;return this._render_and_insert(function(t){self.$element.insertAfter(t)},
target)},insertBefore:function(target){var self=this;return this._render_and_insert(function(t){self.$element.insertBefore(t)},target)},replace:function(target){return this._render_and_insert(_.bind(function(t){this.$element.replaceAll(t)},this),target)},_render_and_insert:function(insertion,target){this.render_element();if(target instanceof openerp.web.Widget)target=target.$element;insertion(target);this.on_inserted(this.$element,this);return this.start()},on_inserted:function(element,widget){},
render_element:function(){var rendered=this.render();if(rendered){var elem=$(rendered);this.$element.replaceWith(elem);this.$element=elem}return this},render:function(additional){if(this.template)return openerp.web.qweb.render(this.template,_.extend({widget:this},additional||{}));return null},start:function(){return $.Deferred().done().promise()},stop:function(){_.each(_.clone(this.widget_children),function(el){el.stop()});if(this.$element!=null)this.$element.remove();if(this.widget_parent&&this.widget_parent.widget_children)this.widget_parent.widget_children=
_.without(this.widget_parent.widget_children,this);this.widget_parent=null;this.widget_is_stopped=true},do_action:function(action,on_finished){if(this.widget_parent)return this.widget_parent.do_action(action,on_finished);return false},do_notify:function(){if(this.widget_parent)return this.widget_parent.do_notify.apply(this,arguments);return false},do_warn:function(){if(this.widget_parent)return this.widget_parent.do_warn.apply(this,arguments);return false},rpc:function(url,data,success,error){var def=
$.Deferred().then(success,error);var self=this;openerp.connection.rpc(url,data).then(function(){if(!self.widget_is_stopped)def.resolve.apply(def,arguments)},function(){if(!self.widget_is_stopped)def.reject.apply(def,arguments)});return def.promise()}});openerp.web.OldWidget=openerp.web.Widget.extend({init:function(parent,element_id){this._super(parent);this.element_id=element_id;this.element_id=this.element_id||_.uniqueId("widget-");var tmp=document.getElementById(this.element_id);this.$element=tmp?
$(tmp):$(document.createElement(this.tag_name))}});openerp.web.TranslationDataBase=openerp.web.Class.extend({init:function(){this.db={};this.parameters={"direction":"ltr","date_format":"%m/%d/%Y","time_format":"%H:%M:%S","grouping":[],"decimal_point":".","thousands_sep":","}},set_bundle:function(translation_bundle){var self=this;this.db={};var modules=_.keys(translation_bundle.modules);modules.sort();if(_.include(modules,"web"))modules=["web"].concat(_.without(modules,"web"));_.each(modules,function(name){self.add_module_translation(translation_bundle.modules[name])});
if(translation_bundle.lang_parameters){this.parameters=translation_bundle.lang_parameters;this.parameters.grouping=py.eval(this.parameters.grouping).toJSON()}},add_module_translation:function(mod){var self=this;_.each(mod.messages,function(message){self.db[message.id]=message.string})},build_translation_function:function(){var self=this;var fcnt=function(str){var tmp=self.get(str);return tmp===undefined?str:tmp};fcnt.database=this;return fcnt},get:function(key){if(this.db[key])return this.db[key];
return undefined}});if($.blockUI){$.blockUI.defaults.baseZ=1100;$.blockUI.defaults.message='<img src="/web/static/src/img/throbber2.gif">'}openerp.web._t=(new openerp.web.TranslationDataBase).build_translation_function();openerp.web._lt=function(s){return{toString:function(){return openerp.web._t(s)}}};openerp.web.qweb=new QWeb2.Engine;openerp.web.qweb.debug=window.location.search.indexOf("?debug")!==-1;openerp.web.qweb.default_dict={"_":_,"_t":openerp.web._t};openerp.web.qweb.preprocess_node=function(){switch(this.node.nodeType){case 3:case 4:var translation=
this.node.parentNode.attributes["t-translation"];if(translation&&translation.value==="off")return;var ts=_.str.trim(this.node.data);if(ts.length===0)return;var tr=openerp.web._t(ts);if(tr!==ts)this.node.data=tr;break;case 1:var attr,attrs=["label","title","alt"];while(attr=attrs.pop())if(this.attributes[attr])this.attributes[attr]=openerp.web._t(this.attributes[attr])}};$.Mutex=function(){function Mutex(){this.def=$.Deferred().resolve()}Mutex.prototype.exec=function(action){var current=this.def;var next=
this.def=$.Deferred();return current.pipe(function(){return $.when(action()).always(function(){next.resolve()})})};return Mutex}();openerp.connection=new openerp.web.Connection;openerp.web.qweb.default_dict["__debug__"]=openerp.connection.debug;$.async_when=function(){var async=false;var def=$.Deferred();$.when.apply($,arguments).then(function(){var args=arguments;var action=function(){def.resolve.apply(def,args)};if(async)action();else setTimeout(action,0)},function(){var args=arguments;var action=
function(){def.reject.apply(def,args)};if(async)action();else setTimeout(action,0)});async=true;return def};var old_async_when=$.async_when;$.async_when=function(){if(openerp.connection.synch)return $.when.apply(this,arguments);else return old_async_when.apply(this,arguments)}};
openerp.web.dates=function(openerp){openerp.web.str_to_datetime=function(str){if(!str)return str;var regex=/^(\d\d\d\d-\d\d-\d\d \d\d:\d\d:\d\d)(?:\.\d+)?$/;var res=regex.exec(str);if(!res)throw new Error("'"+str+"' is not a valid datetime");var obj=Date.parseExact(res[1]+" UTC","yyyy-MM-dd HH:mm:ss zzz");if(!obj)throw new Error("'"+str+"' is not a valid datetime");return obj};openerp.web.str_to_date=function(str){if(!str)return str;var regex=/^\d\d\d\d-\d\d-\d\d$/;var res=regex.exec(str);if(!res)throw new Error("'"+
str+"' is not a valid date");var obj=Date.parseExact(str,"yyyy-MM-dd");if(!obj)throw new Error("'"+str+"' is not a valid date");return obj};openerp.web.str_to_time=function(str){if(!str)return str;var regex=/^(\d\d:\d\d:\d\d)(?:\.\d+)?$/;var res=regex.exec(str);if(!res)throw new Error("'"+str+"' is not a valid time");var obj=Date.parseExact("1970-01-01 "+res[1],"yyyy-MM-dd HH:mm:ss");if(!obj)throw new Error("'"+str+"' is not a valid time");return obj};var zpad=function(str,size){str=""+str;return(new Array(size-
str.length+1)).join("0")+str};openerp.web.datetime_to_str=function(obj){if(!obj)return false;return zpad(obj.getUTCFullYear(),4)+"-"+zpad(obj.getUTCMonth()+1,2)+"-"+zpad(obj.getUTCDate(),2)+" "+zpad(obj.getUTCHours(),2)+":"+zpad(obj.getUTCMinutes(),2)+":"+zpad(obj.getUTCSeconds(),2)};openerp.web.date_to_str=function(obj){if(!obj)return false;return zpad(obj.getFullYear(),4)+"-"+zpad(obj.getMonth()+1,2)+"-"+zpad(obj.getDate(),2)};openerp.web.time_to_str=function(obj){if(!obj)return false;return zpad(obj.getHours(),
2)+":"+zpad(obj.getMinutes(),2)+":"+zpad(obj.getSeconds(),2)}};
openerp.web.formats=function(openerp){var _t=openerp.web._t;openerp.web.intersperse=function(str,indices,separator){separator=separator||"";var result=[],last=str.length;for(var i=0;i<indices.length;++i){var section=indices[i];if(section===-1||last<=0)break;else if(section===0&&i===0)break;else if(section===0)section=indices[--i];result.push(str.substring(last-section,last));last-=section}var s=str.substring(0,last);if(s)result.push(s);return result.reverse().join(separator)};openerp.web.insert_thousand_seps=
function(num){var negative=num[0]==="-";num=negative?num.slice(1):num;return(negative?"-":"")+openerp.web.intersperse(num,_t.database.parameters.grouping,_t.database.parameters.thousands_sep)};openerp.web.strip_raw_chars=function(value){var isletter=/[a-zA-Z]/,output=[];for(var index=0;index<value.length;++index){var character=value[index];if(isletter.test(character)&&(index===0||value[index-1]!=="%"))continue;output.push(character)}return output.join("")};var normalize_format=function(format){return Date.normalizeFormat(openerp.web.strip_raw_chars(format))};
openerp.web.format_value=function(value,descriptor,value_if_empty){if(typeof value==="number"&&isNaN(value))value=false;switch(value){case "":if(descriptor.type==="char")return"";console.warn("Field",descriptor,"had an empty string as value, treating as false...");case false:case Infinity:case -Infinity:return value_if_empty===undefined?"":value_if_empty}var l10n=_t.database.parameters;switch(descriptor.widget||descriptor.type){case "id":return value.toString();case "integer":return openerp.web.insert_thousand_seps(_.str.sprintf("%d",
value));case "float":var precision=descriptor.digits?descriptor.digits[1]:2;var formatted=_.str.sprintf("%."+precision+"f",value).split(".");formatted[0]=openerp.web.insert_thousand_seps(formatted[0]);return formatted.join(l10n.decimal_point);case "float_time":var pattern="%02d:%02d";if(value<0){value=Math.abs(value);pattern="-"+pattern}return _.str.sprintf(pattern,Math.floor(value),Math.round(value%1*60));case "many2one":return value[1];case "datetime":if(typeof value=="string")value=openerp.web.auto_str_to_date(value);
return value.toString(normalize_format(l10n.date_format)+" "+normalize_format(l10n.time_format));case "date":if(typeof value=="string")value=openerp.web.auto_str_to_date(value);return value.toString(normalize_format(l10n.date_format));case "time":if(typeof value=="string")value=openerp.web.auto_str_to_date(value);return value.toString(normalize_format(l10n.time_format));case "selection":if(_.isArray(value))value=value[0];var result=_(descriptor.selection).detect(function(choice){return choice[0]===
value});if(result)return result[1];return;default:return value}};openerp.web.parse_value=function(value,descriptor,value_if_empty){var date_pattern=normalize_format(_t.database.parameters.date_format),time_pattern=normalize_format(_t.database.parameters.time_format);switch(value){case false:case "":return value_if_empty===undefined?false:value_if_empty}switch(descriptor.widget||descriptor.type){case "integer":var tmp;do{tmp=value;value=value.replace(openerp.web._t.database.parameters.thousands_sep,
"")}while(tmp!==value);tmp=Number(value);if(isNaN(tmp))throw new Error(value+" is not a correct integer");return tmp;case "float":var tmp=Number(value);if(!isNaN(tmp))return tmp;var tmp2=value;do{tmp=tmp2;tmp2=tmp.replace(openerp.web._t.database.parameters.thousands_sep,"")}while(tmp!==tmp2);var reformatted_value=tmp.replace(openerp.web._t.database.parameters.decimal_point,".");var parsed=Number(reformatted_value);if(isNaN(parsed))throw new Error(value+" is not a correct float");return parsed;case "float_time":var factor=
1;if(value[0]==="-"){value=value.slice(1);factor=-1}var float_time_pair=value.split(":");if(float_time_pair.length!=2)return factor*openerp.web.parse_value(value,{type:"float"});var hours=openerp.web.parse_value(float_time_pair[0],{type:"integer"});var minutes=openerp.web.parse_value(float_time_pair[1],{type:"integer"});return factor*(hours+minutes/60);case "progressbar":return openerp.web.parse_value(value,{type:"float"});case "datetime":var datetime=Date.parseExact(value,date_pattern+" "+time_pattern);
if(datetime!==null)return openerp.web.datetime_to_str(datetime);datetime=Date.parse(value);if(datetime!==null)return openerp.web.datetime_to_str(datetime);throw new Error(value+" is not a valid datetime");case "date":var date=Date.parseExact(value,date_pattern);if(date!==null)return openerp.web.date_to_str(date);date=Date.parse(value);if(date!==null)return openerp.web.date_to_str(date);throw new Error(value+" is not a valid date");case "time":var time=Date.parseExact(value,time_pattern);if(time!==
null)return openerp.web.time_to_str(time);time=Date.parse(value);if(time!==null)return openerp.web.time_to_str(time);throw new Error(value+" is not a valid time");}return value};openerp.web.auto_str_to_date=function(value,type){try{return openerp.web.str_to_datetime(value)}catch(e){}try{return openerp.web.str_to_date(value)}catch(e){}try{return openerp.web.str_to_time(value)}catch(e){}throw new Error("'"+value+"' is not a valid date, datetime nor time");};openerp.web.auto_date_to_str=function(value,
type){switch(type){case "datetime":return openerp.web.datetime_to_str(value);case "date":return openerp.web.date_to_str(value);case "time":return openerp.web.time_to_str(value);default:throw new Error(type+" is not convertible to date, datetime nor time");}};openerp.web.format_cell=function(row_data,column,options){options=options||{};var attrs={};if(options.process_modifiers!==false)attrs=column.modifiers_for(row_data);if(attrs.invisible)return"";if(column.tag==="button")return _.template('<button type="button" title="<%-title%>" <%=additional_attributes%> >'+
'<img src="<%-prefix%>/web/static/src/img/icons/<%-icon%>.png" alt="<%-alt%>"/>'+"</button>",{title:column.string||"",additional_attributes:isNaN(row_data["id"].value)&&openerp.web.BufferedDataSet.virtual_id_regex.test(row_data["id"].value)?'disabled="disabled" class="oe-listview-button-disabled"':"",prefix:openerp.connection.prefix,icon:column.icon,alt:column.string||""});if(!row_data[column.id])return options.value_if_empty===undefined?"":options.value_if_empty;switch(column.widget||column.type){case "boolean":return _.str.sprintf('<input type="checkbox" %s disabled="disabled"/>',
row_data[column.id].value?'checked="checked"':"");case "binary":var text=_t("Download"),download_url=_.str.sprintf("/web/binary/saveas?session_id=%s&model=%s&field=%s&id=%d",openerp.connection.session_id,options.model,column.id,options.id);if(column.filename){download_url+="&filename_field="+column.filename;if(row_data[column.filename])text=_.str.sprintf(_t('Download "%s"'),openerp.web.format_value(row_data[column.filename].value,{type:"char"}))}return _.template('<a href="<%-href%>"><%-text%></a> (%<-size%>)',
{text:text,href:download_url,size:row_data[column.id].value});case "progressbar":return _.template('<progress value="<%-value%>" max="100"><%-value%>%</progress>',{value:row_data[column.id].value})}return _.escape(openerp.web.format_value(row_data[column.id].value,column,options.value_if_empty))}};
openerp.web.chrome=function(openerp){var QWeb=openerp.web.qweb,_t=openerp.web._t;openerp.web.Notification=openerp.web.OldWidget.extend({template:"Notification",init:function(){this._super.apply(this,arguments);openerp.notification=this},start:function(){this._super.apply(this,arguments);this.$element.notify({speed:500,expires:2500})},notify:function(title,text,sticky){sticky=!!sticky;var opts={};if(sticky)opts.expires=false;this.$element.notify("create",{title:title,text:text},opts)},warn:function(title,
text,sticky){sticky=!!sticky;var opts={};if(sticky)opts.expires=false;this.$element.notify("create","oe_notification_alert",{title:title,text:text},opts)}});openerp.web.Dialog=openerp.web.OldWidget.extend({dialog_title:"",init:function(parent,options,content){var self=this;this._super(parent);if(content)this.$element=content instanceof $?content:$(content);this.dialog_options={modal:true,destroy_on_close:true,width:$(window).width()*($(window).width()>1024?0.5:0.75),min_width:0,max_width:"95%",height:"auto",
min_height:0,max_height:this.get_height("100%")-140,autoOpen:false,position:[false,50],buttons:{},beforeClose:function(){self.on_close()},resizeStop:this.on_resized};for(var f in this)if(f.substr(0,10)=="on_button_")this.dialog_options.buttons[f.substr(10)]=this[f];if(options)_.extend(this.dialog_options,options);if(this.dialog_options.autoOpen)this.open();else this.$element.dialog(this.get_options())},get_options:function(options){var self=this,o=_.extend({},this.dialog_options,options||{});_.each(["width",
"height"],function(unit){o[unit]=self["get_"+unit](o[unit]);o["min_"+unit]=self["get_"+unit](o["min_"+unit]||0);o["max_"+unit]=self["get_"+unit](o["max_"+unit]||0);if(o[unit]!=="auto"&&o["min_"+unit]&&o[unit]<o["min_"+unit])o[unit]=o["min_"+unit];if(o[unit]!=="auto"&&o["max_"+unit]&&o[unit]>o["max_"+unit])o[unit]=o["max_"+unit]});if(!o.title&&this.dialog_title)o.title=this.dialog_title;return o},get_width:function(val){return this.get_size(val.toString(),$(window.top).width())},get_height:function(val){return this.get_size(val.toString(),
$(window.top).height())},get_size:function(val,available_size){if(val==="auto")return val;else if(val.slice(-1)=="%")return Math.round(available_size/100*parseInt(val.slice(0,-1),10));else return parseInt(val,10)},open:function(options){if(this.template)this.$element.html(this.render());var o=this.get_options(options);this.$element.dialog(o).dialog("open");if(o.height==="auto"&&o.max_height)this.$element.css({"max-height":o.max_height,"overflow-y":"auto"});return this},close:function(){this.$element.dialog("close")},
on_close:function(){if(this.dialog_options.destroy_on_close)this.$element.dialog("destroy")},on_resized:function(){},stop:function(){this.close();this.$element.dialog("destroy");this._super()}});openerp.web.CrashManager=openerp.web.CallbackEnabled.extend({on_rpc_error:function(error){if(error.data.fault_code){var split=(""+error.data.fault_code).split("\n")[0].split(" -- ");if(split.length>1){error.type=split.shift();error.data.fault_code=error.data.fault_code.substr(error.type.length+4)}}if(error.code===
200&&error.type)this.on_managed_error(error);else this.on_traceback(error)},on_managed_error:function(error){$("<div>"+QWeb.render("CrashManagerWarning",{error:error})+"</div>").dialog({title:"System "+_.str.capitalize(error.type),buttons:[{text:_t("Ok"),click:function(){$(this).dialog("close")}}]})},on_traceback:function(error){var self=this;var buttons={};if(openerp.connection.openerp_entreprise){buttons[_t("Send OpenERP Enterprise Report")]=function(){var $this=$(this);var issuename=$("#issuename").val();
var explanation=$("#explanation").val();var remark=$("#remark").val();(new openerp.web.DataSet(self,"publisher_warranty.contract")).call_and_eval("send",[error.data,explanation,remark,issuename]).then(function(result){if(result===false)alert("There was a communication error.");else $this.dialog("close")})};buttons[_t("Dont send")]=function(){$(this).dialog("close")}}else buttons[_t("Ok")]=function(){$(this).dialog("close")};var dialog=(new openerp.web.Dialog(this,{title:"System "+_.str.capitalize(error.type),
width:"80%",height:"50%",min_width:"800px",min_height:"600px",buttons:buttons})).open();dialog.$element.html(QWeb.render("CrashManagerError",{session:openerp.connection,error:error}))}});openerp.web.Loading=openerp.web.OldWidget.extend({template:"Loading",init:function(parent){this._super(parent);this.count=0;this.blocked_ui=false;var self=this;this.request_call=function(){self.on_rpc_event(1)};this.response_call=function(){self.on_rpc_event(-1)};this.session.on_rpc_request.add_first(this.request_call);
this.session.on_rpc_response.add_last(this.response_call)},stop:function(){this.session.on_rpc_request.remove(this.request_call);this.session.on_rpc_response.remove(this.response_call);this.on_rpc_event(-this.count);this._super()},on_rpc_event:function(increment){var self=this;if(!this.count&&increment===1)this.long_running_timer=setTimeout(function(){self.blocked_ui=true;$.blockUI()},3E3);this.count+=increment;if(this.count>0){$(".loading",this.$element).text(_.str.sprintf(_t("Loading (%d)"),this.count));
$(".loading",this.$element).show();this.widget_parent.$element.addClass("loading")}else{this.count=0;clearTimeout(this.long_running_timer);if(self.blocked_ui){this.blocked_ui=false;$.unblockUI()}$(".loading",this.$element).fadeOut();this.widget_parent.$element.removeClass("loading")}}});openerp.web.Database=openerp.web.OldWidget.extend({template:"DatabaseManager",init:function(parent,element_id,option_id){this._super(parent,element_id);this.unblockUIFunction=$.unblockUI;$.validator.addMethod("matches",
function(s,_,re){return(new RegExp(re)).test(s)},_t("Invalid database name"))},start:function(){this.$option_id=$("#oe_db_options");var self=this;var fetch_db=this.rpc("/web/database/get_list",{}).pipe(function(result){self.db_list=result.db_list},function(_,ev){ev.preventDefault();self.db_list=null});var fetch_langs=this.rpc("/web/session/get_lang_list",{},function(result){if(result.error){self.display_error(result);return}self.lang_list=result.lang_list});$.when(fetch_db,fetch_langs).then(function(){self.do_create()});
this.$element.find("#db-create").click(this.do_create);this.$element.find("#db-drop").click(this.do_drop);this.$element.find("#db-backup").click(this.do_backup);this.$element.find("#db-restore").click(this.do_restore);this.$element.find("#db-change-password").click(this.do_change_password);this.$element.find("#back-to-login").click(function(){self.hide()})},stop:function(){this.hide();this.$option_id.empty();this.$element.find("#db-create, #db-drop, #db-backup, #db-restore, #db-change-password, #back-to-login").unbind("click").end().empty();
this._super()},show:function(){this.$element.closest(".login").addClass("database_block")},hide:function(){this.$element.closest(".login").removeClass("database_block")},to_object:function(array){var result={};_(array).each(function(record){result[record.name]=record.value});return result},wait_for_newdb:function(db_creation_id,info){var self=this;self.rpc("/web/database/progress",{id:db_creation_id,password:info.password},function(result){var progress=result[0];if(progress<1){setTimeout(function(){self.wait_for_newdb(db_creation_id,
info)},500);return}var admin=result[1][0];setTimeout(function(){self.widget_parent.do_login(info.db,admin.login,admin.password);self.stop();self.unblockUI()})})},blockUI:function(){$.blockUI();$.unblockUI=function(){}},unblockUI:function(){$.unblockUI=this.unblockUIFunction;$.unblockUI()},display_error:function(error){return $("<div>").dialog({modal:true,title:error.title,buttons:[{text:_t("Ok"),click:function(){$(this).dialog("close")}}]}).html(error.error)},do_create:function(){var self=this;self.$option_id.html(QWeb.render("Database.CreateDB",
self));self.$option_id.find("form[name=create_db_form]").validate({submitHandler:function(form){var fields=$(form).serializeArray();self.blockUI();self.rpc("/web/database/create",{"fields":fields},function(result){if(result.error){self.unblockUI();self.display_error(result);return}if(self.db_list){self.db_list.push(self.to_object(fields)["db_name"]);self.db_list.sort();self.widget_parent.set_db_list(self.db_list)}var form_obj=self.to_object(fields);self.wait_for_newdb(result,{password:form_obj["super_admin_pwd"],
db:form_obj["db_name"]})})}})},do_drop:function(){var self=this;self.$option_id.html(QWeb.render("DropDB",self));self.$option_id.find("form[name=drop_db_form]").validate({submitHandler:function(form){var $form=$(form),fields=$form.serializeArray(),$db_list=$form.find("select[name=drop_db]"),db=$db_list.val();if(!confirm("Do you really want to delete the database: "+db+" ?"))return;self.rpc("/web/database/drop",{"fields":fields},function(result){if(result.error){self.display_error(result);return}$db_list.find(":selected").remove();
if(self.db_list){self.db_list.splice(_.indexOf(self.db_list,db,true),1);self.widget_parent.set_db_list(self.db_list)}self.do_notify("Dropping database","The database '"+db+"' has been dropped")})}})},do_backup:function(){var self=this;self.$option_id.html(QWeb.render("BackupDB",self)).find("form[name=backup_db_form]").validate({submitHandler:function(form){self.blockUI();self.session.get_file({form:form,success:function(){self.do_notify(_t("Backed"),_t("Database backed up successfully"))},error:openerp.webclient.crashmanager.on_rpc_error,
complete:function(){self.unblockUI()}})}})},do_restore:function(){var self=this;self.$option_id.html(QWeb.render("RestoreDB",self));self.$option_id.find("form[name=restore_db_form]").validate({submitHandler:function(form){self.blockUI();$(form).ajaxSubmit({url:"/web/database/restore",type:"POST",resetForm:true,success:function(body){if(!body)return;if(body.indexOf("403 Forbidden")!==-1)self.display_error({title:"Access Denied",error:"Incorrect super-administrator password"});else self.display_error({title:"Restore Database",
error:"Could not restore the database"})},complete:function(){self.unblockUI();self.do_notify(_t("Restored"),_t("Database restored successfully"))}})}})},do_change_password:function(){var self=this;self.$option_id.html(QWeb.render("Change_DB_Pwd",self));self.$option_id.find("form[name=change_pwd_form]").validate({messages:{old_pwd:"Please enter your previous password",new_pwd:"Please enter your new password",confirm_pwd:{required:"Please confirm your new password",equalTo:"The confirmation does not match the password"}},
submitHandler:function(form){self.rpc("/web/database/change_password",{"fields":$(form).serializeArray()},function(result){if(result.error){self.display_error(result);return}self.do_notify("Changed Password","Password has been changed successfully")})}})}});openerp.web.Login=openerp.web.OldWidget.extend({remember_credentials:true,template:"Login",init:function(parent){this._super(parent);this.has_local_storage=typeof localStorage!="undefined";this.selected_db=null;this.selected_login=null;if(this.has_local_storage&&
this.remember_credentials){this.selected_db=localStorage.getItem("last_db_login_success");this.selected_login=localStorage.getItem("last_login_login_success");if(jQuery.deparam(jQuery.param.querystring()).debug!=undefined)this.selected_password=localStorage.getItem("last_password_login_success")}},start:function(){var self=this;this.database=new openerp.web.Database(this);this.database.appendTo(this.$element);this.$element.find("#oe-db-config").click(function(){self.database.show()});this.$element.find("form").submit(this.on_submit);
this.rpc("/web/database/get_list",{},function(result){self.set_db_list(result.db_list)},function(error,event){if(error.data.fault_code==="AccessDenied")event.preventDefault()})},set_db_list:function(list){this.$element.find("[name=db]").replaceWith(openerp.web.qweb.render("Login_dblist",{db_list:list,selected_db:this.selected_db}))},on_submit:function(ev){if(ev)ev.preventDefault();var $e=this.$element;var db=$e.find("form [name=db]").val();if(!db){this.do_warn("Login","No database selected !");return false}var login=
$e.find("form input[name=login]").val();var password=$e.find("form input[name=password]").val();this.do_login(db,login,password)},do_login:function(db,login,password){var self=this;this.$element.removeClass("login_invalid");this.session.on_session_invalid.add({callback:function(){self.$element.addClass("login_invalid")},unique:true});this.session.session_authenticate(db,login,password).then(function(){self.$element.removeClass("login_invalid");if(self.has_local_storage)if(self.remember_credentials){localStorage.setItem("last_db_login_success",
db);localStorage.setItem("last_login_login_success",login);if(jQuery.deparam(jQuery.param.querystring()).debug!=undefined)localStorage.setItem("last_password_login_success",password)}else{localStorage.setItem("last_db_login_success","");localStorage.setItem("last_login_login_success","");localStorage.setItem("last_password_login_success","")}})}});openerp.web.Header=openerp.web.OldWidget.extend({template:"Header",init:function(parent){this._super(parent);this.qs="?"+jQuery.param.querystring();this.$content=
$();this.update_promise=$.Deferred().resolve()},start:function(){this._super()},do_update:function(){var self=this;var fct=function(){self.$content.remove();if(!self.session.uid)return;var func=(new openerp.web.Model("res.users")).get_func("read");return func(self.session.uid,["name","company_id"]).pipe(function(res){self.$content=$(QWeb.render("Header-content",{widget:self,user:res}));self.$content.appendTo(self.$element);self.$element.find(".logout").click(self.on_logout);self.$element.find("a.preferences").click(self.on_preferences);
self.$element.find(".about").click(self.on_about);return self.shortcut_load()})};this.update_promise=this.update_promise.pipe(fct,fct)},on_about:function(){var self=this;self.rpc("/web/webclient/version_info",{}).then(function(res){var $help=$(QWeb.render("About-Page",{version_info:res}));$help.find("a.oe_activate_debug_mode").click(function(e){e.preventDefault();window.location=$.param.querystring(window.location.href,"debug")});$help.dialog({autoOpen:true,modal:true,width:960,title:_t("About")})})},
shortcut_load:function(){var self=this,sc=self.session.shortcuts,shortcuts_ds=new openerp.web.DataSet(this,"ir.ui.view_sc");if(!sc.binding){sc.binding={};$(sc.binding).bind({"add":function(e,attrs){shortcuts_ds.create(attrs,function(out){$("<li>",{"data-shortcut-id":out.result,"data-id":attrs.res_id}).text(attrs.name).appendTo(self.$element.find(".oe-shortcuts ul"));attrs.id=out.result;sc.push(attrs)})},"remove-current":function(){var menu_id=self.session.active_id;var $shortcut=self.$element.find(".oe-shortcuts li[data-id="+
menu_id+"]");var shortcut_id=$shortcut.data("shortcut-id");$shortcut.remove();shortcuts_ds.unlink([shortcut_id]);var sc_new=_.reject(sc,function(shortcut){return shortcut_id===shortcut.id});sc.splice(0,sc.length);sc.push.apply(sc,sc_new)}})}return this.rpc("/web/session/sc_list",{},function(shortcuts){sc.splice(0,sc.length);sc.push.apply(sc,shortcuts);self.$element.find(".oe-shortcuts").html(QWeb.render("Shortcuts",{"shortcuts":shortcuts})).undelegate("li","click").delegate("li","click",function(e){e.stopPropagation();
var id=$(this).data("id");self.session.active_id=id;self.rpc("/web/menu/action",{"menu_id":id},function(ir_menu_data){if(ir_menu_data.action.length)self.on_action(ir_menu_data.action[0][2])})})})},on_action:function(action){},on_preferences:function(){var self=this;var action_manager=new openerp.web.ActionManager(this);var dataset=new openerp.web.DataSet(this,"res.users",this.context);dataset.call("action_get","",function(result){self.rpc("/web/action/load",{action_id:result},function(result){action_manager.do_action(_.extend(result["result"],
{res_id:self.session.uid,res_model:"res.users",flags:{action_buttons:false,search_view:false,sidebar:false,views_switcher:false,pager:false}}))})});this.dialog=(new openerp.web.Dialog(this,{title:_t("Preferences"),width:"700px",buttons:[{text:_t("Cancel"),click:function(){$(this).dialog("destroy")}},{text:_t("Change password"),click:function(){self.change_password()}},{text:_t("Save"),click:function(){var inner_viewmanager=action_manager.inner_viewmanager;inner_viewmanager.views[inner_viewmanager.active_view].controller.do_save().then(function(){self.dialog.stop();
window.location.reload()})}}]})).open();action_manager.appendTo(this.dialog);action_manager.render(this.dialog)},change_password:function(){var self=this;this.dialog=(new openerp.web.Dialog(this,{title:_t("Change Password"),width:"auto"})).open();this.dialog.$element.html(QWeb.render("Change_Pwd",self));this.dialog.$element.find("form[name=change_password_form]").validate({submitHandler:function(form){self.rpc("/web/session/change_password",{"fields":$(form).serializeArray()},function(result){if(result.error){self.display_error(result);
return}else openerp.webclient.on_logout()})}})},display_error:function(error){return $("<div>").dialog({modal:true,title:error.title,buttons:[{text:_("Ok"),click:function(){$(this).dialog("close")}}]}).html(error.error)},on_logout:function(){}});openerp.web.Menu=openerp.web.OldWidget.extend({init:function(parent,element_id,secondary_menu_id){this._super(parent,element_id);this.secondary_menu_id=secondary_menu_id;this.$secondary_menu=$("#"+secondary_menu_id);this.menu=false;this.folded=false;if(window.localStorage)this.folded=
localStorage.getItem("oe_menu_folded")==="true";this.float_timeout=700},start:function(){this.$secondary_menu.addClass(this.folded?"oe_folded":"oe_unfolded")},do_reload:function(){var self=this;return this.rpc("/web/menu/load",{},this.on_loaded).then(function(){if(self.current_menu)self.open_menu(self.current_menu)})},on_loaded:function(data){this.data=data;this.$element.html(QWeb.render("Menu",{widget:this}));this.$secondary_menu.html(QWeb.render("Menu.secondary",{widget:this}));this.$element.add(this.$secondary_menu).find("a").click(this.on_menu_click);
this.$secondary_menu.find(".oe_toggle_secondary_menu").click(this.on_toggle_fold)},on_toggle_fold:function(){this.$secondary_menu.toggleClass("oe_folded").toggleClass("oe_unfolded");if(this.folded)this.$secondary_menu.find(".oe_secondary_menu.active").show();else this.$secondary_menu.find(".oe_secondary_menu").hide();this.folded=!this.folded;if(window.localStorage)localStorage.setItem("oe_menu_folded",this.folded.toString())},open_menu:function(menu_id){this.$element.add(this.$secondary_menu).find(".active").removeClass("active");
this.$secondary_menu.find("> .oe_secondary_menu").hide();var $primary_menu;var $secondary_submenu=this.$secondary_menu.find("a[data-menu="+menu_id+"]");if($secondary_submenu.length)for(;;){if($secondary_submenu.hasClass("leaf"))$secondary_submenu.addClass("active");else if($secondary_submenu.hasClass("submenu"))$secondary_submenu.addClass("opened");var $parent=$secondary_submenu.parent().show();if($parent.hasClass("oe_secondary_menu")){var primary_id=$parent.data("menu-parent");$primary_menu=this.$element.find("a[data-menu="+
primary_id+"]");break}$secondary_submenu=$parent.prev()}else $primary_menu=this.$element.find("a[data-menu="+menu_id+"]");if(!$primary_menu.length)return;$primary_menu.addClass("active");this.$secondary_menu.find("div[data-menu-parent="+$primary_menu.data("menu")+"]").addClass("active").toggle(!this.folded)},on_menu_click:function(ev,id){id=id||0;var $clicked_menu,manual=false;if(id){manual=true;$clicked_menu=this.$element.find("a[data-menu="+id+"]");if(!$clicked_menu.length)$clicked_menu=this.$secondary_menu.find("a[data-menu="+
id+"]")}else{$clicked_menu=$(ev.currentTarget);id=$clicked_menu.data("menu")}if(this.do_menu_click($clicked_menu,manual)&&id){this.current_menu=id;this.session.active_id=id;this.rpc("/web/menu/action",{"menu_id":id},this.on_menu_action_loaded)}if(ev)ev.stopPropagation();return false},do_menu_click:function($clicked_menu,manual){var $sub_menu,$main_menu,active=$clicked_menu.is(".active"),sub_menu_visible=false,has_submenu_items=false;if(this.$secondary_menu.has($clicked_menu).length){$sub_menu=$clicked_menu.parents(".oe_secondary_menu");
$main_menu=this.$element.find("a[data-menu="+$sub_menu.data("menu-parent")+"]")}else{$sub_menu=this.$secondary_menu.find(".oe_secondary_menu[data-menu-parent="+$clicked_menu.attr("data-menu")+"]");$main_menu=$clicked_menu}sub_menu_visible=$sub_menu.is(":visible");has_submenu_items=!!$sub_menu.children().length;this.$secondary_menu.find(".oe_secondary_menu").hide();$(".active",this.$element.add(this.$secondary_menu)).removeClass("active");$main_menu.add($clicked_menu).add($sub_menu).addClass("active");
if(has_submenu_items)if(!(this.folded&&manual))this.do_show_secondary($sub_menu,$main_menu);else this.do_show_secondary();if($main_menu!=$clicked_menu)if($clicked_menu.is(".submenu")){$sub_menu.find(".submenu.opened").each(function(){if(!$(this).next().has($clicked_menu).length&&!$(this).is($clicked_menu))$(this).removeClass("opened").next().hide()});$clicked_menu.toggleClass("opened").next().toggle()}else{if($clicked_menu.is(".leaf")){$sub_menu.toggle(!this.folded);return true}}else if(this.folded){if(active&&
sub_menu_visible||!has_submenu_items){$sub_menu.hide();return true}return manual}else return true;return false},do_hide_secondary:function(){this.$secondary_menu.hide()},do_show_secondary:function($sub_menu,$main_menu){var self=this;this.$secondary_menu.show();if(!arguments.length)return;if(this.folded){var css=$main_menu.position(),fold_width=this.$secondary_menu.width()+2,window_width=$(window).width();css.top+=33;css.left-=Math.round(($sub_menu.width()-$main_menu.width())/2);css.left=css.left<
fold_width?fold_width:css.left;if(css.left+$sub_menu.width()>window_width){delete css.left;css.right=1}$sub_menu.css(css);$sub_menu.mouseenter(function(){clearTimeout($sub_menu.data("timeoutId"));$sub_menu.data("timeoutId",null);return false}).mouseleave(function(evt){var timeoutId=setTimeout(function(){if(self.folded&&$sub_menu.data("timeoutId"))$sub_menu.hide().unbind("mouseenter").unbind("mouseleave")},self.float_timeout);$sub_menu.data("timeoutId",timeoutId);return false})}$sub_menu.show()},on_menu_action_loaded:function(data){var self=
this;if(data.action.length){var action=data.action[0][2];action.from_menu=true;self.on_action(action)}else self.on_action({type:"null_action"})},on_action:function(action){}});openerp.web.WebClient=openerp.web.OldWidget.extend({init:function(parent){var self=this;this._super(parent);openerp.webclient=this;this._current_state=null},start:function(){var self=this;this.$element=$(document.body);if(jQuery.param!=undefined&&jQuery.deparam(jQuery.param.querystring()).kitten!=undefined){this.$element.addClass("kitten-mode-activated");
this.$element.delegate("img.oe-record-edit-link-img","hover",function(e){self.$element.toggleClass("clark-gable")})}this.session.bind().then(function(){if(!self.session.session_is_valid())self.show_login()});this.session.on_session_valid.add(function(){self.show_application();self.header.do_update();self.menu.do_reload();if(self.action_manager)self.action_manager.stop();self.action_manager=new openerp.web.ActionManager(self);self.action_manager.appendTo($("#oe_app"));self.bind_hashchange();var version_label=
_t("OpenERP - Unsupported/Community Version");if(!self.session.openerp_entreprise);})},show_login:function(){var self=this;this.destroy_content();this.show_common();self.login=new openerp.web.Login(self);self.login.appendTo(self.$element)},show_application:function(){var self=this;this.destroy_content();this.show_common();self.$table=$(QWeb.render("Interface",{}));self.$element.append(self.$table);self.header=new openerp.web.Header(self);self.header.on_logout.add(this.proxy("on_logout"));self.header.on_action.add(this.proxy("on_menu_action"));
self.header.appendTo($("#oe_header"));self.menu=new openerp.web.Menu(self,"oe_menu","oe_secondary_menu");self.menu.on_action.add(this.proxy("on_menu_action"));self.menu.start()},show_common:function(){var self=this;if(!this.crashmanager){this.crashmanager=new openerp.web.CrashManager;openerp.connection.on_rpc_error.add(this.crashmanager.on_rpc_error);window.onerror=function(message,file,line){self.crashmanager.on_traceback({type:_t("Client Error"),message:message,data:{debug:file+":"+line}})}}this.notification=
new openerp.web.Notification(this);this.notification.appendTo(this.$element);this.loading=new openerp.web.Loading(this);this.loading.appendTo(this.$element)},destroy_content:function(){_.each(_.clone(this.widget_children),function(el){el.stop()});this.$element.children().remove()},do_reload:function(){var self=this;return this.session.session_reload().pipe(function(){openerp.connection.load_modules(true).pipe(self.menu.proxy("do_reload"))})},do_notify:function(){var n=this.notification;n.notify.apply(n,
arguments)},do_warn:function(){var n=this.notification;n.warn.apply(n,arguments)},on_logout:function(){var self=this;this.session.session_logout().then(function(){$(window).unbind("hashchange",self.on_hashchange);self.do_push_state({});window.location.reload()})},bind_hashchange:function(){$(window).bind("hashchange",this.on_hashchange);var state=$.bbq.getState(true);if(!_.isEmpty(state))$(window).trigger("hashchange");else this.action_manager.do_action({type:"ir.actions.client",tag:"default_home"})},
on_hashchange:function(event){var state=event.getState(true);if(!_.isEqual(this._current_state,state))this.action_manager.do_load_state(state,!!this._current_state);this._current_state=state},do_push_state:function(state){var url="#"+$.param(state);this._current_state=_.clone(state);$.bbq.pushState(url)},on_menu_action:function(action){this.action_manager.do_action(action)},do_action:function(action){var self=this;if(action.menu_id)this.do_reload().then(function(){self.menu.on_menu_click(null,action.menu_id)})}});
openerp.web.EmbeddedClient=openerp.web.OldWidget.extend({template:"EmptyComponent",init:function(action_id,options){this._super();this.action_id=action_id;this.options=options||{};this.am=new openerp.web.ActionManager(this)},start:function(){var self=this;this.am.appendTo(this.$element.addClass("openerp"));return this.rpc("/web/action/load",{action_id:this.action_id},function(result){var action=result.result;action.flags=_.extend({search_view:false,action_buttons:false,sidebar:false},self.options,
action.flags||{});self.am.do_action(action)})}});openerp.web.embed=function(origin,dbname,login,key,action,options){$("head").append($("<link>",{"rel":"stylesheet","type":"text/css","href":origin+"/web/webclient/css"}));var currentScript=document.currentScript;if(!currentScript){var sc=document.getElementsByTagName("script");currentScript=sc[sc.length-1]}openerp.connection.bind(origin).then(function(){openerp.connection.session_authenticate(dbname,login,key,true).then(function(){var client=new openerp.web.EmbeddedClient(action,
options);client.insertAfter(currentScript)})})}};
openerp.web.views=function(session){var QWeb=session.web.qweb,_t=session.web._t;session.web.client_actions=new session.web.Registry;session.web.views=new session.web.Registry;session.web.ActionManager=session.web.OldWidget.extend({init:function(parent){this._super(parent);this.inner_action=null;this.inner_viewmanager=null;this.dialog=null;this.dialog_viewmanager=null;this.client_widget=null},render:function(){return'<div id="'+this.element_id+'" style="height: 100%;"></div>'},dialog_stop:function(){if(this.dialog){this.dialog_viewmanager.stop();
this.dialog_viewmanager=null;this.dialog.stop();this.dialog=null}},content_stop:function(){if(this.inner_viewmanager){this.inner_viewmanager.stop();this.inner_viewmanager=null}if(this.client_widget){this.client_widget.stop();this.client_widget=null}},do_push_state:function(state){if(this.widget_parent&&this.widget_parent.do_push_state){if(this.inner_action){state["model"]=this.inner_action.res_model;if(this.inner_action.id)state["action_id"]=this.inner_action.id}this.widget_parent.do_push_state(state)}},
do_load_state:function(state,warm){var self=this,action_loaded;if(state.action_id){var run_action=!this.inner_viewmanager||this.inner_viewmanager.action.id!==state.action_id;if(run_action){this.null_action();action_loaded=this.do_action(state.action_id)}}else if(state.model&&state.id){this.null_action();var action={res_model:state.model,res_id:state.id,type:"ir.actions.act_window",views:[[false,"page"],[false,"form"]]};action_loaded=this.do_action(action)}else if(state.sa){var self=this;this.null_action();
action_loaded=this.rpc("/web/session/get_session_action",{key:state.sa}).pipe(function(action){if(action)return self.do_action(action)})}else if(state.client_action){this.null_action();this.ir_actions_client(state.client_action)}$.when(action_loaded||null).then(function(){if(self.inner_viewmanager)self.inner_viewmanager.do_load_state(state,warm)})},do_action:function(action,on_close){if(_.isNumber(action)){var self=this;return self.rpc("/web/action/load",{action_id:action},function(result){self.do_action(result.result,
on_close)})}if(!action.type){console.error("No type for action",action);return}var type=action.type.replace(/\./g,"_");var popup=action.target==="new";action.flags=_.extend({views_switcher:!popup,search_view:!popup,action_buttons:!popup,sidebar:!popup,pager:!popup,display_title:!popup},action.flags||{});if(!(type in this)){console.error("Action manager can't handle action of type "+action.type,action);return}return this[type](action,on_close)},null_action:function(){this.dialog_stop();this.content_stop()},
ir_actions_act_window:function(action,on_close){var self=this;if(_(["base.module.upgrade","base.setup.installer"]).contains(action.res_model)){var old_close=on_close;on_close=function(){session.webclient.do_reload().then(old_close)}}if(action.target==="new"){if(this.dialog==null){this.dialog=new session.web.Dialog(this,{width:"80%"});if(on_close)this.dialog.on_close.add(on_close)}else this.dialog_viewmanager.stop();this.dialog.dialog_title=action.name;this.dialog_viewmanager=new session.web.ViewManagerAction(this,
action);this.dialog_viewmanager.appendTo(this.dialog.$element);this.dialog.open()}else{if(action.menu_id)return this.widget_parent.do_action(action,function(){session.webclient.menu.open_menu(action.menu_id)});this.dialog_stop();this.content_stop();this.inner_action=action;this.inner_viewmanager=new session.web.ViewManagerAction(this,action);this.inner_viewmanager.appendTo(this.$element)}},ir_actions_act_window_close:function(action,on_closed){if(!this.dialog&&on_closed)on_closed();this.dialog_stop()},
ir_actions_server:function(action,on_closed){var self=this;this.rpc("/web/action/run",{action_id:action.id,context:action.context||{}}).then(function(action){self.do_action(action,on_closed)})},ir_actions_client:function(action){this.content_stop();this.dialog_stop();var ClientWidget=session.web.client_actions.get_object(action.tag);(this.client_widget=new ClientWidget(this,action.params)).appendTo(this)},ir_actions_report_xml:function(action,on_closed){var self=this;$.blockUI();self.rpc("/web/session/eval_domain_and_context",
{contexts:[action.context],domains:[]}).then(function(res){action=_.clone(action);action.context=res.context;self.session.get_file({url:"/web/report",data:{action:JSON.stringify(action)},complete:$.unblockUI,success:function(){if(!self.dialog&&on_closed)on_closed();self.dialog_stop()},error:session.webclient.crashmanager.on_rpc_error})})},ir_actions_act_url:function(action){window.open(action.url,action.target==="self"?"_self":"_blank")},ir_ui_menu:function(action){this.widget_parent.do_action(action)}});
session.web.ViewManager=session.web.OldWidget.extend({template:"ViewManager",init:function(parent,dataset,views,flags){this._super(parent);this.model=dataset?dataset.model:undefined;this.dataset=dataset;this.searchview=null;this.active_view=null;this.views_src=_.map(views,function(x){if(x instanceof Array){var View=session.web.views.get_object(x[1],true);return{view_id:x[0],view_type:x[1],label:View?View.prototype.display_name:void"nope"}}else return x});this.views={};this.flags=flags||{};this.registry=
session.web.views;this.views_history=[]},render:function(){return session.web.qweb.render(this.template,{self:this,prefix:this.element_id,views:this.views_src})},start:function(){this._super();var self=this;this.$element.find(".oe_vm_switch button").click(function(){self.on_mode_switch($(this).data("view-type"))});var views_ids={};_.each(this.views_src,function(view){self.views[view.view_type]=$.extend({},view,{deferred:$.Deferred(),controller:null,options:_.extend({sidebar_id:self.element_id+"_sidebar_"+
view.view_type,action:self.action,action_views_ids:views_ids},self.flags,self.flags[view.view_type]||{},view.options||{})});views_ids[view.view_type]=view.view_id});if(this.flags.views_switcher===false)this.$element.find(".oe_vm_switch").hide();var default_view=this.flags.default_view||this.views_src[0].view_type;return this.on_mode_switch(default_view)},on_mode_switch:function(view_type,no_store){var self=this,view=this.views[view_type],view_promise;if(!view)return $.Deferred().reject();if(!no_store)this.views_history.push(view_type);
this.active_view=view_type;if(!view.controller){var controllerclass=this.registry.get_object(view_type);var controller=new controllerclass(this,this.dataset,view.view_id,view.options);if(view.embedded_view)controller.set_embedded_view(view.embedded_view);controller.do_switch_view.add_last(this.on_mode_switch);controller.do_prev_view.add_last(this.on_prev_view);var container=$("#"+this.element_id+"_view_"+view_type);view_promise=controller.appendTo(container);this.views[view_type].controller=controller;
this.views[view_type].deferred.resolve(view_type);$.when(view_promise).then(function(){self.on_controller_inited(view_type,controller);if(self.searchview&&self.flags.auto_search&&view.controller.searchable!==false)self.searchview.ready.then(self.searchview.do_search)})}else if(this.searchview&&self.flags.auto_search&&view.controller.searchable!==false)this.searchview.ready.then(this.searchview.do_search);if(this.searchview)this.searchview[view.controller.searchable===false||this.searchview.hidden?
"hide":"show"]();this.$element.find(".oe_vm_switch button").removeAttr("disabled").filter('[data-view-type="'+view_type+'"]').attr("disabled",true);$.when(view_promise).then(function(){_.each(_.keys(self.views),function(view_name){var controller=self.views[view_name].controller;if(controller)if(view_name===view_type)controller.do_show();else controller.do_hide()});self.$element.find(".oe_view_title_text:first").text(self.display_title())});return view_promise},on_prev_view:function(options){var current_view=
this.views_history.pop();var previous_view=this.views_history[this.views_history.length-1]||options["default"];if(options.created&&current_view==="form"&&previous_view==="list")return this.on_mode_switch("page");else if(options.created&&!previous_view&&this.action&&this.action.flags.default_view==="form")return this.on_mode_switch("page");return this.on_mode_switch(previous_view,true)},setup_search_view:function(view_id,search_defaults){var self=this;if(this.searchview)this.searchview.stop();this.searchview=
new session.web.SearchView(this,this.dataset,view_id,search_defaults,this.flags.search_view===false);this.searchview.on_search.add(this.do_searchview_search);return this.searchview.appendTo($("#"+this.element_id+"_search"))},do_searchview_search:function(domains,contexts,groupbys){var self=this,controller=this.views[this.active_view].controller,action_context=this.action.context||{};this.rpc("/web/session/eval_domain_and_context",{domains:[this.action.domain||[]].concat(domains||[]),contexts:[action_context].concat(contexts||
[]),group_by_seq:groupbys||[]},function(results){self.dataset.context=results.context;self.dataset.domain=results.domain;var groupby=results.group_by.length?results.group_by:action_context.group_by;controller.do_search(results.domain,results.context,groupby||[])})},on_controller_inited:function(view_type,view){},on_action:function(action){},on_create:function(){},on_remove:function(){},on_edit:function(){},on_action_executed:function(){},display_title:function(){var view=this.views[this.active_view];
if(view)return view.controller.fields_view.arch.attrs.string;return""}});session.web.ViewManagerAction=session.web.ViewManager.extend({template:"ViewManagerAction",init:function(parent,action){var flags=action.flags||{};if(!("auto_search"in flags))flags.auto_search=action.auto_search!==false;if(action.res_model=="board.board"&&action.view_mode==="form")_.extend(flags,{views_switcher:false,display_title:false,search_view:false,pager:false,sidebar:false,action_buttons:false});this._super(parent,null,
action.views,flags);this.session=parent.session;this.action=action;var dataset=new session.web.DataSetSearch(this,action.res_model,action.context,action.domain);if(action.res_id){dataset.ids.push(action.res_id);dataset.index=0}this.dataset=dataset;if(this.session.hidden_menutips)return;this.session.hidden_menutips={}},start:function(){var self=this,searchview_loaded,search_defaults={};_.each(this.action.context,function(value,key){var match=/^search_default_(.*)$/.exec(key);if(match)search_defaults[match[1]]=
value});var searchview_id=this.action["search_view_id"]&&this.action["search_view_id"][0];searchview_loaded=this.setup_search_view(searchview_id||false,search_defaults);var main_view_loaded=this._super();var manager_ready=$.when(searchview_loaded,main_view_loaded);this.$element.find(".oe_debug_view").change(this.on_debug_changed);if(this.action.help&&!this.flags.low_profile){var Users=new session.web.DataSet(self,"res.users"),$tips=this.$element.find(".oe_view_manager_menu_tips");$tips.delegate("blockquote button",
"click",function(){var $this=$(this);switch($this.attr("name")){case "disable":Users.write(self.session.uid,{menu_tips:false});case "hide":$this.closest("blockquote").hide();self.session.hidden_menutips[self.action.id]=true}});if(!(self.action.id in self.session.hidden_menutips))Users.read_ids([this.session.uid],["menu_tips"]).then(function(users){var user=users[0];if(!(user&&user.id===self.session.uid))return;$tips.find("blockquote").toggle(user.menu_tips)})}var $res_logs=this.$element.find(".oe-view-manager-logs:first");
$res_logs.delegate("a.oe-more-logs","click",function(){$res_logs.removeClass("oe-folded");return false}).delegate("a.oe-remove-everything","click",function(){$res_logs.removeClass("oe-has-more").find("ul").empty();$res_logs.css("display","none");return false});$res_logs.css("display","none");return manager_ready},on_debug_changed:function(evt){var self=this,$sel=$(evt.currentTarget),$option=$sel.find("option:selected"),val=$sel.val(),current_view=this.views[this.active_view].controller;switch(val){case "fvg":var dialog=
(new session.web.Dialog(this,{title:_t("Fields View Get"),width:"95%"})).open();$("<pre>").text(session.web.json_node_to_xml(current_view.fields_view.arch,true)).appendTo(dialog.$element);break;case "perm_read":var ids=current_view.get_selected_ids();if(ids.length===1)this.dataset.call("perm_read",[ids]).then(function(result){var dialog=(new session.web.Dialog(this,{title:_.str.sprintf(_t("View Log (%s)"),self.dataset.model),width:400},QWeb.render("ViewManagerDebugViewLog",{perm:result[0],format:session.web.format_value}))).open()});
break;case "fields":this.dataset.call_and_eval("fields_get",[false,{}],null,1).then(function(fields){var $root=$("<dl>");_(fields).each(function(attributes,name){$root.append($("<dt>").append($("<h4>").text(name)));var $attrs=$("<dl>").appendTo($("<dd>").appendTo($root));_(attributes).each(function(def,name){if(def instanceof Object)def=JSON.stringify(def);$attrs.append($("<dt>").text(name)).append($('<dd style="white-space: pre-wrap;">').text(def))})});(new session.web.Dialog(self,{title:_.str.sprintf(_t("Model %s fields"),
self.dataset.model),width:"95%"},$root)).open()});break;case "manage_views":if(current_view.fields_view&&current_view.fields_view.arch){var view_editor=new session.web.ViewEditor(current_view,current_view.$element,this.dataset,current_view.fields_view.arch);view_editor.start()}else this.do_warn(_t("Manage Views"),_t("Could not find current view declaration"));break;case "edit_workflow":return this.do_action({res_model:"workflow",domain:[["osv","=",this.dataset.model]],views:[[false,"list"],[false,
"form"],[false,"diagram"]],type:"ir.actions.act_window",view_type:"list",view_mode:"list"});break;case "edit":this.do_edit_resource($option.data("model"),$option.data("id"),{name:$option.text()});break;default:if(val)console.log("No debug handler for ",val)}evt.currentTarget.selectedIndex=0},do_edit_resource:function(model,id,action){var action=_.extend({res_model:model,res_id:id,type:"ir.actions.act_window",view_type:"form",view_mode:"form",views:[[false,"form"]],target:"new",flags:{action_buttons:true,
form:{resize_textareas:true}}},action||{});this.do_action(action)},on_mode_switch:function(view_type,no_store){var self=this;return $.when(this._super(view_type,no_store)).then(function(){self.shortcut_check(self.views[view_type]);self.$element.find(".oe-view-manager-logs:first").addClass("oe-folded").removeClass("oe-has-more").css("display","none").find("ul").empty();var controller=self.views[self.active_view].controller,fvg=controller.fields_view,view_id=fvg&&fvg.view_id||"--";self.$element.find(".oe_debug_view").html(QWeb.render("ViewManagerDebug",
{view:controller,view_manager:self}));if(!self.action.name&&fvg)self.$element.find(".oe_view_title_text").text(fvg.arch.attrs.string||fvg.name);var $title=self.$element.find(".oe_view_title_text"),$search_prefix=$title.find("span.oe_searchable_view");if(controller.searchable!==false&&self.flags.search_view!==false){if(!$search_prefix.length)$title.prepend('<span class="oe_searchable_view">'+_t("Search: ")+"</span>")}else $search_prefix.remove()})},do_push_state:function(state){if(this.widget_parent&&
this.widget_parent.do_push_state){state["view_type"]=this.active_view;this.widget_parent.do_push_state(state)}},do_load_state:function(state,warm){var self=this,defs=[];if(state.view_type&&state.view_type!==this.active_view)defs.push(this.views[this.active_view].deferred.pipe(function(){return self.on_mode_switch(state.view_type,true)}));$.when(defs).then(function(){self.views[self.active_view].controller.do_load_state(state,warm)})},shortcut_check:function(view){var self=this;var grandparent=this.widget_parent&&
this.widget_parent.widget_parent;var $shortcut_toggle=this.$element.find(".oe-shortcut-toggle");if(!this.action.name||!(view.view_type===this.views_src[0].view_type&&view.view_id===this.views_src[0].view_id)){$shortcut_toggle.hide();return}$shortcut_toggle.removeClass("oe-shortcut-remove").show();if(_(this.session.shortcuts).detect(function(shortcut){return shortcut.res_id===self.session.active_id}))$shortcut_toggle.addClass("oe-shortcut-remove");this.shortcut_add_remove()},shortcut_add_remove:function(){var self=
this;var $shortcut_toggle=this.$element.find(".oe-shortcut-toggle");$shortcut_toggle.unbind("click").click(function(){if($shortcut_toggle.hasClass("oe-shortcut-remove")){$(self.session.shortcuts.binding).trigger("remove-current");$shortcut_toggle.removeClass("oe-shortcut-remove")}else{$(self.session.shortcuts.binding).trigger("add",{"user_id":self.session.uid,"res_id":self.session.active_id,"resource":"ir.ui.menu","name":self.action.name});$shortcut_toggle.addClass("oe-shortcut-remove")}})},on_action_executed:function(){return(new session.web.DataSet(this,
"res.log")).call("get",[],this.do_display_log)},do_display_log:function(log_records){var self=this;var cutoff=3;var $logs=this.$element.find(".oe-view-manager-logs:first").addClass("oe-folded").css("display","block");var $logs_list=$logs.find("ul").empty();$logs.toggleClass("oe-has-more",log_records.length>cutoff);_(log_records.reverse()).each(function(record){var context={};if(record.context)try{context=py.eval(record.context).toJSON()}catch(e){}$(_.str.sprintf('<li><a href="#">%s</a></li>',record.name)).appendTo($logs_list).delegate("a",
"click",function(){self.do_action({type:"ir.actions.act_window",res_model:record.res_model,res_id:record.res_id,context:context,views:[[context.view_id||false,"form"]]});return false})})},display_title:function(){return this.action.name}});session.web.Sidebar=session.web.OldWidget.extend({init:function(parent,element_id){this._super(parent,element_id);this.items={};this.sections={}},start:function(){this._super(this);var self=this;this.$element.html(session.web.qweb.render("Sidebar"));this.$element.find(".toggle-sidebar").click(function(e){self.do_toggle()})},
add_default_sections:function(){var self=this,view=this.widget_parent,view_manager=view.widget_parent,action=view_manager.action;if(this.session.uid===1){this.add_section(_t("Customize"),"customize");this.add_items("customize",[{label:_t("Translate"),callback:view.on_sidebar_translate,title:_t("Technical translation")}])}this.add_section(_t("Other Options"),"other");this.add_items("other",[{label:_t("Import"),callback:view.on_sidebar_import},{label:_t("Export"),callback:view.on_sidebar_export}])},
add_toolbar:function(toolbar){var self=this;_.each([["print",_t("Reports")],["action",_t("Actions")],["relate",_t("Links")]],function(type){var items=toolbar[type[0]];if(items.length){for(var i=0;i<items.length;i++)items[i]={label:items[i]["name"],action:items[i],classname:"oe_sidebar_"+type[0]};self.add_section(type[1],type[0]);self.add_items(type[0],items)}})},add_section:function(name,code){if(!code)code=_.str.underscored(name);var $section=this.sections[code];if(!$section){var section_id=_.uniqueId(this.element_id+
"_section_"+code+"_");$section=$(session.web.qweb.render("Sidebar.section",{section_id:section_id,name:name,classname:"oe_sidebar_"+code}));$section.appendTo(this.$element.find("div.sidebar-actions"));this.sections[code]=$section}return $section},add_items:function(section_code,items){var self=this,$section=this.add_section(_.str.titleize(section_code.replace("_"," ")),section_code),section_id=$section.attr("id");if(items){for(var i=0;i<items.length;i++){items[i].element_id=_.uniqueId(section_id+
"_item_");this.items[items[i].element_id]=items[i]}var $items=$(session.web.qweb.render("Sidebar.section.items",{items:items}));$items.find("a.oe_sidebar_action_a").click(function(){var item=self.items[$(this).attr("id")];if(item.callback)item.callback.apply(self,[item]);if(item.action)self.on_item_action_clicked(item);return false});var $ul=$section.find("ul");if(!$ul.length)$ul=$("<ul/>").appendTo($section);$items.appendTo($ul)}},on_item_action_clicked:function(item){var self=this;self.widget_parent.sidebar_context().then(function(context){var ids=
self.widget_parent.get_selected_ids();if(ids.length==0){$("<div />").text(_t("You must choose at least one record.")).dialog({title:_t("Warning"),modal:true});return false}var additional_context=_.extend({active_id:ids[0],active_ids:ids,active_model:self.widget_parent.dataset.model},context);self.rpc("/web/action/load",{action_id:item.action.id,context:additional_context},function(result){result.result.context=_.extend(result.result.context||{},additional_context);result.result.flags=result.result.flags||
{};result.result.flags.new_window=true;self.do_action(result.result,function(){self.widget_parent.reload()})})})},do_fold:function(){this.$element.addClass("closed-sidebar").removeClass("open-sidebar")},do_unfold:function(){this.$element.addClass("open-sidebar").removeClass("closed-sidebar")},do_toggle:function(){this.$element.toggleClass("open-sidebar closed-sidebar")}});session.web.TranslateDialog=session.web.Dialog.extend({dialog_title:{toString:function(){return _t("Translations")}},init:function(view){this.view_language=
view.session.user_context.lang;this["on_button"+_t("Save")]=this.on_button_Save;this["on_button"+_t("Close")]=this.on_button_Close;this._super(view,{width:"80%",height:"80%"});this.view=view;this.view_type=view.fields_view.type||"";this.$fields_form=null;this.$view_form=null;this.$sidebar_form=null;this.translatable_fields_keys=_.map(this.view.translatable_fields||[],function(i){return i.name});this.languages=null;this.languages_loaded=$.Deferred();(new session.web.DataSetSearch(this,"res.lang",this.view.dataset.get_context(),
[["translatable","=","1"]])).read_slice(["code","name"],{sort:"id"}).then(this.on_languages_loaded)},start:function(){var self=this;this._super();$.when(this.languages_loaded).then(function(){self.$element.html(session.web.qweb.render("TranslateDialog",{widget:self}));self.$fields_form=self.$element.find(".oe_translation_form");self.$fields_form.find(".oe_trad_field").change(function(){$(this).toggleClass("touched",$(this).val()!=$(this).attr("data-value"))})});return this},on_languages_loaded:function(langs){this.languages=
langs;this.languages_loaded.resolve()},do_load_fields_values:function(callback){var self=this,deffered=[];this.$fields_form.find(".oe_trad_field").val("").removeClass("touched");_.each(self.languages,function(lg){var deff=$.Deferred();deffered.push(deff);var callback=function(values){_.each(self.translatable_fields_keys,function(f){self.$fields_form.find('.oe_trad_field[name="'+lg.code+"-"+f+'"]').val(values[0][f]||"").attr("data-value",values[0][f]||"")});deff.resolve()};if(lg.code===self.view_language){var values=
{};_.each(self.translatable_fields_keys,function(field){values[field]=self.view.fields[field].get_value()});callback([values])}else self.rpc("/web/dataset/get",{model:self.view.dataset.model,ids:[self.view.datarecord.id],fields:self.translatable_fields_keys,context:self.view.dataset.get_context({"lang":lg.code})},callback)});$.when.apply(null,deffered).then(callback)},open:function(field){var self=this,sup=this._super;$.when(this.languages_loaded).then(function(){if(self.view.translatable_fields&&
self.view.translatable_fields.length)self.do_load_fields_values(function(){sup.call(self);if(field){var $field_input=self.$element.find('tr[data-field="'+field.name+'"] td:nth-child(2) *:first-child');self.$element.scrollTo($field_input);$field_input.focus()}});else sup.call(self)})},on_button_Save:function(){var trads={},self=this,trads_mutex=new $.Mutex;self.$fields_form.find(".oe_trad_field.touched").each(function(){var field=$(this).attr("name").split("-");if(!trads[field[0]])trads[field[0]]=
{};trads[field[0]][field[1]]=$(this).val()});_.each(trads,function(data,code){if(code===self.view_language)_.each(data,function(value,field){self.view.fields[field].set_value(value)});trads_mutex.exec(function(){return self.view.dataset.write(self.view.datarecord.id,data,{context:{"lang":code}})})});this.close()},on_button_Close:function(){this.close()}});session.web.View=session.web.Widget.extend({template:"EmptyComponent",display_name:"",init:function(parent,dataset,view_id,options){this._super(parent);
this.dataset=dataset;this.view_id=view_id;this.set_default_options(options)},set_default_options:function(options){this.options=options||{};_.defaults(this.options,{sidebar_id:null,sidebar:true,action:null,action_views_ids:{}})},open_translate_dialog:function(field){if(!this.translate_dialog)this.translate_dialog=(new session.web.TranslateDialog(this)).start();this.translate_dialog.open(field)},do_execute_action:function(action_data,dataset,record_id,on_closed){var self=this;var result_handler=function(){if(on_closed)on_closed.apply(null,
arguments);if(self.widget_parent&&self.widget_parent.on_action_executed)return self.widget_parent.on_action_executed.apply(null,arguments)};var context=new session.web.CompoundContext(dataset.get_context(),action_data.context||{});var handler=function(r){var action=r.result;if(action&&action.constructor==Object){var ncontext=new session.web.CompoundContext(context);if(record_id)ncontext.add({active_id:record_id,active_ids:[record_id],active_model:dataset.model});ncontext.add(action.context||{});return self.rpc("/web/session/eval_domain_and_context",
{contexts:[ncontext],domains:[]}).pipe(function(results){action.context=results.context;return self.do_action(action,result_handler)},null)}else return result_handler()};if(action_data.special)return handler({result:{"type":"ir.actions.act_window_close"}});else if(action_data.type=="object"){var args=[[record_id]],additional_args=[];if(action_data.args)try{additional_args=JSON.parse(action_data.args.replace(/'/g,'"'));args=args.concat(additional_args)}catch(e){console.error("Could not JSON.parse arguments",
action_data.args)}args.push(context);return dataset.call_button(action_data.name,args,handler)}else if(action_data.type=="action")return this.rpc("/web/action/load",{action_id:parseInt(action_data.name,10),context:context,do_not_eval:true},handler);else return dataset.exec_workflow(record_id,action_data.name,handler)},set_embedded_view:function(embedded_view){this.embedded_view=embedded_view;this.options.sidebar=false},do_show:function(){this.$element.show()},do_hide:function(){this.$element.hide()},
do_push_state:function(state){if(this.widget_parent&&this.widget_parent.do_push_state)this.widget_parent.do_push_state(state)},do_load_state:function(state,warm){},do_switch_view:function(view){},do_prev_view:function(options){},do_search:function(view){},set_common_sidebar_sections:function(sidebar){sidebar.add_default_sections()},on_sidebar_import:function(){var import_view=new session.web.DataImport(this,this.dataset);import_view.start()},on_sidebar_export:function(){var export_view=new session.web.DataExport(this,
this.dataset);export_view.start()},on_sidebar_translate:function(){return this.do_action({res_model:"ir.translation",domain:[["type","!=","object"],"|",["name","=",this.dataset.model],["name","ilike",this.dataset.model+","]],views:[[false,"list"],[false,"form"]],type:"ir.actions.act_window",view_type:"list",view_mode:"list"})},sidebar_context:function(){return $.when()},reload:function(){return $.when()}});session.web.json_node_to_xml=function(node,human_readable,indent){indent=indent||0;var sindent=
human_readable?(new Array(indent+1)).join("\t"):"",r=sindent+"<"+node.tag,cr=human_readable?"\n":"";if(typeof node==="string")return sindent+node;else if(typeof node.tag!=="string"||!node.children instanceof Array||!node.attrs instanceof Object)throw"Node a json node";for(var attr in node.attrs){var vattr=node.attrs[attr];if(typeof vattr!=="string")vattr=JSON.stringify(vattr);vattr=vattr.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");if(human_readable)vattr=
vattr.replace(/&quot;/g,"'");r+=" "+attr+'="'+vattr+'"'}if(node.children&&node.children.length){r+=">"+cr;var childs=[];for(var i=0,ii=node.children.length;i<ii;i++)childs.push(session.web.json_node_to_xml(node.children[i],human_readable,indent+1));r+=childs.join(cr);r+=cr+sindent+"</"+node.tag+">";return r}else return r+"/>"}};
openerp.web.data=function(openerp){openerp.web.serialize_sort=function(criterion){return _.map(criterion,function(criteria){if(criteria[0]==="-")return criteria.slice(1)+" DESC";return criteria+" ASC"}).join(", ")};openerp.web.DataGroup=openerp.web.OldWidget.extend({init:function(parent,model,domain,context,group_by,level){this._super(parent,null);if(group_by)if(group_by.length||context["group_by_no_leaf"])return new openerp.web.ContainerDataGroup(this,model,domain,context,group_by,level);else return new openerp.web.GrouplessDataGroup(this,
model,domain,context,level);this.model=model;this.context=context;this.domain=domain;this.level=level||0},cls:"DataGroup"});openerp.web.ContainerDataGroup=openerp.web.DataGroup.extend({init:function(parent,model,domain,context,group_by,level){this._super(parent,model,domain,context,null,level);this.group_by=group_by},transform_group:function(group){var field_name=this.group_by[0];var fixed_group=_.extend({__context:{group_by:[]},__domain:[]},group);var aggregates={};_(fixed_group).each(function(value,
key){if(key.indexOf("__")===0||key===field_name||key===field_name+"_count")return;aggregates[key]=value||0});var group_size=fixed_group[field_name+"_count"]||fixed_group.__count||0;var leaf_group=fixed_group.__context.group_by.length===0;return{__context:fixed_group.__context,__domain:fixed_group.__domain,grouped_on:field_name,length:group_size,value:fixed_group[field_name],openable:!(leaf_group&&this.context["group_by_no_leaf"]),aggregates:aggregates}},fetch:function(fields){var d=new $.Deferred;
var self=this;this.rpc("/web/group/read",{model:this.model,context:this.context,domain:this.domain,fields:_.uniq(this.group_by.concat(fields)),group_by_fields:this.group_by,sort:openerp.web.serialize_sort(this.sort)},function(){}).then(function(response){var data_groups=_(response).map(_.bind(self.transform_group,self));self.groups=data_groups;d.resolveWith(self,[data_groups])},function(){d.rejectWith.apply(d,[self,arguments])});return d.promise()},list:function(fields,ifGroups,ifRecords){var self=
this;this.fetch(fields).then(function(group_records){ifGroups(_(group_records).map(function(group){var child_context=_.extend({},self.context,group.__context);return _.extend(new openerp.web.DataGroup(self,self.model,group.__domain,child_context,child_context.group_by,self.level+1),group,{sort:self.sort})}))})}});openerp.web.GrouplessDataGroup=openerp.web.DataGroup.extend({init:function(parent,model,domain,context,level){this._super(parent,model,domain,context,null,level)},list:function(fields,ifGroups,
ifRecords){ifRecords(_.extend(new openerp.web.DataSetSearch(this,this.model),{domain:this.domain,context:this.context,_sort:this.sort}))}});openerp.web.StaticDataGroup=openerp.web.GrouplessDataGroup.extend({init:function(dataset){this.dataset=dataset},list:function(fields,ifGroups,ifRecords){ifRecords(this.dataset)}});openerp.web.DataSet=openerp.web.OldWidget.extend({init:function(parent,model,context){this._super(parent);this.model=model;this.context=context||{};this.index=null;this._sort=[]},previous:function(){this.index-=
1;if(!this.ids.length)this.index=null;else if(this.index<0)this.index=this.ids.length-1;return this},next:function(){this.index+=1;if(!this.ids.length)this.index=null;else if(this.index>=this.ids.length)this.index=0;return this},select_id:function(id){var idx=this.get_id_index(id);if(idx===null)return false;else{this.index=idx;return true}},get_id_index:function(id){for(var i=0,ii=this.ids.length;i<ii;i++)if(id==this.ids[i])return i;return null},read_ids:function(ids,fields,options){var options=options||
{};return this.rpc("/web/dataset/get",{model:this.model,ids:ids,fields:fields,context:this.get_context(options.context)})},read_slice:function(fields,options){return null},read_index:function(fields,options){var def=$.Deferred();if(_.isEmpty(this.ids))def.reject();else{fields=fields||false;this.read_ids([this.ids[this.index]],fields,options).then(function(records){def.resolve(records[0])},function(){def.reject.apply(def,arguments)})}return def.promise()},default_get:function(fields,options){var options=
options||{};return this.rpc("/web/dataset/default_get",{model:this.model,fields:fields,context:this.get_context(options.context)})},create:function(data,callback,error_callback){return this.rpc("/web/dataset/create",{model:this.model,data:data,context:this.get_context()},callback,error_callback)},write:function(id,data,options,callback,error_callback){options=options||{};return this.rpc("/web/dataset/save",{model:this.model,id:id,data:data,context:this.get_context(options.context)},callback,error_callback)},
unlink:function(ids,callback,error_callback){var self=this;return this.call_and_eval("unlink",[ids,this.get_context()],null,1,callback,error_callback)},call:function(method,args,callback,error_callback){return this.rpc("/web/dataset/call",{model:this.model,method:method,args:args||[]},callback,error_callback)},call_and_eval:function(method,args,domain_index,context_index,callback,error_callback){return this.rpc("/web/dataset/call",{model:this.model,method:method,domain_id:domain_index==undefined?
null:domain_index,context_id:context_index==undefined?null:context_index,args:args||[],aborter:this},callback,error_callback)},call_button:function(method,args,callback,error_callback){return this.rpc("/web/dataset/call_button",{model:this.model,method:method,domain_id:null,context_id:args.length-1,args:args||[]},callback,error_callback)},name_get:function(ids,callback){return this.call_and_eval("name_get",[ids,this.get_context()],null,1,callback)},name_search:function(name,domain,operator,limit,
callback){return this.call_and_eval("name_search",[name||"",domain||false,operator||"ilike",this.get_context(),limit||0],1,3,callback)},name_create:function(name,callback){return this.call_and_eval("name_create",[name,this.get_context()],null,1,callback)},exec_workflow:function(id,signal,callback){return this.rpc("/web/dataset/exec_workflow",{model:this.model,id:id,signal:signal},callback)},get_context:function(request_context){if(request_context)return new openerp.web.CompoundContext(this.context,
request_context);return this.context},sort:function(field,force_reverse){if(!field)return openerp.web.serialize_sort(this._sort);var reverse=force_reverse||this._sort[0]===field;this._sort.splice.apply(this._sort,[0,this._sort.length].concat(_.without(this._sort,field,"-"+field)));this._sort.unshift((reverse?"-":"")+field);return undefined},size:function(){return this.ids.length},alter_ids:function(n_ids){this.ids=n_ids}});openerp.web.DataSetStatic=openerp.web.DataSet.extend({init:function(parent,
model,context,ids){this._super(parent,model,context);this.ids=ids||[]},read_slice:function(fields,options){options=options||{};fields=fields||{};var offset=options.offset||0,limit=options.limit||false;var end_pos=limit&&limit!==-1?offset+limit:this.ids.length;return this.read_ids(this.ids.slice(offset,end_pos),fields)},set_ids:function(ids){this.ids=ids;if(ids.length===0)this.index=null;else if(this.index>=ids.length-1)this.index=ids.length-1},unlink:function(ids){this.on_unlink(ids);return $.Deferred().resolve({result:true})},
on_unlink:function(ids){this.set_ids(_.without.apply(null,[this.ids].concat(ids)))}});openerp.web.DataSetSearch=openerp.web.DataSet.extend({init:function(parent,model,context,domain){this._super(parent,model,context);this.domain=domain||[];this.offset=0;this._length;this.ids=[]},read_slice:function(fields,options){options=options||{};var self=this;var offset=options.offset||0;return this.rpc("/web/dataset/search_read",{model:this.model,fields:fields||false,domain:this.get_domain(options.domain),context:this.get_context(options.context),
sort:this.sort(),offset:offset,limit:options.limit||false}).pipe(function(result){self.ids=result.ids;self.offset=offset;self._length=result.length;return result.records})},get_domain:function(other_domain){if(other_domain)return new openerp.web.CompoundDomain(this.domain,other_domain);return this.domain},unlink:function(ids,callback,error_callback){var self=this;return this._super(ids,function(result){self.ids=_.without.apply(_,[self.ids].concat(ids));if(this.index!==null)self.index=self.index<=
self.ids.length-1?self.index:self.ids.length>0?self.ids.length-1:0;if(callback)callback(result)},error_callback)},size:function(){if(this._length!==undefined)return this._length;return this._super()}});openerp.web.BufferedDataSet=openerp.web.DataSetStatic.extend({virtual_id_prefix:"one2many_v_id_",debug_mode:true,init:function(){this._super.apply(this,arguments);this.reset_ids([]);this.last_default_get={}},default_get:function(fields,options){return this._super(fields,options).then(this.on_default_get)},
on_default_get:function(res){this.last_default_get=res},create:function(data,callback,error_callback){var cached={id:_.uniqueId(this.virtual_id_prefix),values:data,defaults:this.last_default_get};this.to_create.push(_.extend(_.clone(cached),{values:_.clone(cached.values)}));this.cache.push(cached);var prom=$.Deferred().then(callback);prom.resolve({result:cached.id});return prom.promise()},write:function(id,data,options,callback){var self=this;var record=_.detect(this.to_create,function(x){return x.id===
id});record=record||_.detect(this.to_write,function(x){return x.id===id});var dirty=false;if(record){for(var k in data)if(record.values[k]===undefined||record.values[k]!==data[k]){dirty=true;break}$.extend(record.values,data)}else{dirty=true;record={id:id,values:data};self.to_write.push(record)}var cached=_.detect(this.cache,function(x){return x.id===id});if(!cached){cached={id:id,values:{}};this.cache.push(cached)}$.extend(cached.values,record.values);if(dirty)this.on_change();var to_return=$.Deferred().then(callback);
to_return.resolve({result:true});return to_return.promise()},unlink:function(ids,callback,error_callback){var self=this;_.each(ids,function(id){if(!_.detect(self.to_create,function(x){return x.id===id}))self.to_delete.push({id:id})});this.to_create=_.reject(this.to_create,function(x){return _.include(ids,x.id)});this.to_write=_.reject(this.to_write,function(x){return _.include(ids,x.id)});this.cache=_.reject(this.cache,function(x){return _.include(ids,x.id)});this.set_ids(_.without.apply(_,[this.ids].concat(ids)));
this.on_change();return $.async_when({result:true}).then(callback)},reset_ids:function(ids){this.set_ids(ids);this.to_delete=[];this.to_create=[];this.to_write=[];this.cache=[];this.delete_all=false},on_change:function(){},read_ids:function(ids,fields,options){var self=this;var to_get=[];_.each(ids,function(id){var cached=_.detect(self.cache,function(x){return x.id===id});var created=_.detect(self.to_create,function(x){return x.id===id});if(created)_.each(fields,function(x){if(cached.values[x]===
undefined)cached.values[x]=created.defaults[x]||false});else if(!cached||!_.all(fields,function(x){return cached.values[x]!==undefined}))to_get.push(id)});var completion=$.Deferred();var return_records=function(){var records=_.map(ids,function(id){return _.extend({},_.detect(self.cache,function(c){return c.id===id}).values,{"id":id})});if(self.debug_mode)if(_.include(records,undefined))throw"Record not correctly loaded";var sort_fields=self._sort,compare=function(v1,v2){return v1<v2?-1:v1>v2?1:0};
records.sort(function(a,b){return _.reduce(sort_fields,function(acc,field){if(acc)return acc;var sign=1;if(field[0]==="-"){sign=-1;field=field.slice(1)}return sign*compare(a[field],b[field])},0)});completion.resolve(records)};if(to_get.length>0){var rpc_promise=this._super(to_get,fields,options).then(function(records){_.each(records,function(record,index){var id=to_get[index];var cached=_.detect(self.cache,function(x){return x.id===id});if(!cached)self.cache.push({id:id,values:record});else cached.values=
_.defaults(_.clone(cached.values),record)});return_records()});$.when(rpc_promise).fail(function(){completion.reject()})}else return_records();return completion.promise()},call_button:function(method,args,callback,error_callback){var id=args[0][0],index;for(var i=0,len=this.cache.length;i<len;++i){var record=this.cache[i];if(record.id===id){this.cache.splice(i,1);break}}return this._super(method,args,callback,error_callback)},alter_ids:function(n_ids){this._super(n_ids);this.on_change()}});openerp.web.BufferedDataSet.virtual_id_regex=
/^one2many_v_id_.*$/;openerp.web.ProxyDataSet=openerp.web.DataSetSearch.extend({init:function(){this._super.apply(this,arguments);this.create_function=null;this.write_function=null;this.read_function=null},read_ids:function(){if(this.read_function)return this.read_function.apply(null,arguments);else return this._super.apply(this,arguments)},default_get:function(fields,options){return this._super(fields,options).then(this.on_default_get)},on_default_get:function(result){},create:function(data,callback,
error_callback){this.on_create(data);if(this.create_function)return this.create_function(data,callback,error_callback);else{console.warn("trying to create a record using default proxy dataset behavior");return $.async_when({"result":undefined}).then(callback)}},on_create:function(data){},write:function(id,data,options,callback){this.on_write(id,data);if(this.write_function)return this.write_function(id,data,options,callback);else{console.warn("trying to write a record using default proxy dataset behavior");
return $.async_when({"result":true}).then(callback)}},on_write:function(id,data){},unlink:function(ids,callback,error_callback){this.on_unlink(ids);console.warn("trying to unlink a record using default proxy dataset behavior");return $.async_when({"result":true}).then(callback)},on_unlink:function(ids){}});openerp.web.Model=openerp.web.CallbackEnabled.extend({init:function(model_name){this._super();this.model_name=model_name},rpc:function(){var c=openerp.connection;return c.rpc.apply(c,arguments)},
get_func:function(method_name){var self=this;return function(){return self.call(method_name,_.toArray(arguments),{})}},call:function(method,args,kwargs){return this.rpc("/web/dataset/call_kw",{model:this.model_name,method:method,args:args,kwargs:kwargs})}});openerp.web.CompoundContext=openerp.web.Class.extend({init:function(){this.__ref="compound_context";this.__contexts=[];this.__eval_context=null;var self=this;_.each(arguments,function(x){self.add(x)})},add:function(context){this.__contexts.push(context);
return this},set_eval_context:function(eval_context){this.__eval_context=eval_context;return this},get_eval_context:function(){return this.__eval_context}});openerp.web.CompoundDomain=openerp.web.Class.extend({init:function(){this.__ref="compound_domain";this.__domains=[];this.__eval_context=null;var self=this;_.each(arguments,function(x){self.add(x)})},add:function(domain){this.__domains.push(domain);return this},set_eval_context:function(eval_context){this.__eval_context=eval_context;return this},
get_eval_context:function(){return this.__eval_context}})};
openerp.web.data_export=function(openerp){var QWeb=openerp.web.qweb,_t=openerp.web._t;openerp.web.DataExport=openerp.web.Dialog.extend({template:"ExportTreeView",dialog_title:{toString:function(){return _t("Export Data")}},init:function(parent,dataset){this._super(parent);this.records={};this.dataset=dataset;this.exports=new openerp.web.DataSetSearch(this,"ir.exports",this.dataset.get_context())},start:function(){var self=this;this._super.apply(this,arguments);this.open({buttons:[{text:_t("Close"),
click:function(){self.close()}},{text:_t("Export To File"),click:function(){self.on_click_export_data()}}],close:function(event,ui){self.close()}});self.$element.removeClass("ui-dialog-content ui-widget-content");self.$element.find("#add_field").click(function(){if($("#field-tree-structure tr.ui-selected")){var fld=self.$element.find("#field-tree-structure tr.ui-selected").find("a");for(var i=0;i<fld.length;i++){var id=$(fld[i]).attr("id").split("-")[1];var string=$(fld[i]).attr("string");self.add_field(id,
string)}self.$element.find("#field-tree-structure tr").removeClass("ui-selected")}});self.$element.find("#remove_field").click(function(){self.$element.find("#fields_list option:selected").remove()});self.$element.find("#remove_all_field").click(function(){self.$element.find("#fields_list").empty()});this.$element.find("#export_new_list").click(this.on_show_save_list);var got_fields=new $.Deferred;this.$element.find("#import_compat").change(function(){self.$element.find("#fields_list").empty();self.$element.find("#field-tree-structure").remove();
var import_comp=self.$element.find("#import_compat").val();self.rpc("/web/export/get_fields",{model:self.dataset.model,import_compat:Boolean(import_comp)},function(records){got_fields.resolve();self.on_show_data(records)})}).change();return $.when(got_fields,this.rpc("/web/export/formats",{},this.do_setup_export_formats),this.show_exports_list())},do_setup_export_formats:function(formats){var $fmts=this.$element.find("#export_format");_(formats).each(function(format){var opt=new Option(format.label,
format.tag);if(format.error){opt.disabled=true;opt.replaceChild(document.createTextNode(_.str.sprintf("%s \u2014 %s",format.label,format.error)),opt.childNodes[0])}$fmts.append(opt)})},show_exports_list:function(){var self=this;if(self.$element.find("#saved_export_list").is(":hidden")){self.$element.find("#ExistsExportList").show();return}return this.exports.read_slice(["name"],{domain:[["resource","=",this.dataset.model]]}).then(function(export_list){if(!export_list.length)return;self.$element.find("#ExistsExportList").append(QWeb.render("Exists.ExportList",
{"existing_exports":export_list}));self.$element.find("#saved_export_list").change(function(){self.$element.find("#fields_list option").remove();var export_id=self.$element.find("#saved_export_list option:selected").val();if(export_id)self.rpc("/web/export/namelist",{"model":self.dataset.model,export_id:parseInt(export_id)},self.do_load_export_field)});self.$element.find("#delete_export_list").click(function(){var select_exp=self.$element.find("#saved_export_list option:selected");if(select_exp.val()){self.exports.unlink([parseInt(select_exp.val(),
10)]);select_exp.remove();if(self.$element.find("#saved_export_list option").length<=1)self.$element.find("#ExistsExportList").hide()}})})},do_load_export_field:function(field_list){var export_node=this.$element.find("#fields_list");_(field_list).each(function(field){export_node.append(new Option(field.label,field.name))})},on_show_save_list:function(){var self=this;var current_node=self.$element.find("#savenewlist");if(!current_node.find("label").length){current_node.append(QWeb.render("ExportNewList"));
current_node.find("#add_export_list").click(function(){var value=current_node.find("#savelist_name").val();if(value)self.do_save_export_list(value);else alert(_t("Please enter save field list name"))})}else if(current_node.is(":hidden")){current_node.show();current_node.find("#savelist_name").val("")}else current_node.hide()},do_save_export_list:function(value){var self=this;var fields=self.get_fields();if(!fields.length)return;this.exports.create({name:value,resource:this.dataset.model,export_fields:_(fields).map(function(field){return[0,
0,{name:field}]})},function(export_list_id){if(!export_list_id.result)return;self.$element.find("#saved_export_list").append(new Option(value,export_list_id.result));if(self.$element.find("#saved_export_list").is(":hidden"))self.show_exports_list()});this.on_show_save_list();this.$element.find("#fields_list option").remove()},on_click:function(id,record){var self=this;if(!record["children"])return;var model=record["params"]["model"],prefix=record["params"]["prefix"],name=record["params"]["name"],
exclude_fields=[];if(record["relation_field"])exclude_fields.push(record["relation_field"]);if(!record.loaded){var import_comp=self.$element.find("#import_compat").val();self.rpc("/web/export/get_fields",{model:model,prefix:prefix,parent_name:name,import_compat:Boolean(import_comp),parent_field_type:record["field_type"],exclude:exclude_fields},function(results){record.loaded=true;self.on_show_data(results,record.id)})}else self.showcontent(record.id)},on_show_data:function(result,after){var self=
this;var imp_cmpt=Boolean(self.$element.find("#import_compat").val());if(after){var current_tr=self.$element.find("tr[id='treerow-"+after+"']");current_tr.addClass("open");current_tr.find("img").attr("src","/web/static/src/img/collapse.gif");current_tr.after(QWeb.render("ExportTreeView-Secondary.children",{"fields":result}))}else self.$element.find("#left_field_panel").append(QWeb.render("ExportTreeView-Secondary",{"fields":result}));_.each(result,function(record){self.records[record.id]=record.value;
if(record.required){var required_fld=self.$element.find("tr[id='treerow-"+record.id+"']").find("#tree-column");required_fld.addClass("oe_export_requiredfield")}self.$element.find("img[id='parentimg-"+record.id+"']").click(function(){self.on_click(this.id,record)});self.$element.find("tr[id='treerow-"+record.id+"']").click(function(e){if(e.shiftKey){var frst_click,scnd_click="";if(self.row_index==0){self.row_index=this.rowIndex;frst_click=self.$element.find("tr[id^='treerow-']")[self.row_index-1];
$(frst_click).addClass("ui-selected")}else if(this.rowIndex>=self.row_index)for(var i=self.row_index-1;i<this.rowIndex;i++){scnd_click=self.$element.find("tr[id^='treerow-']")[i];if(!$(scnd_click).find("#tree-column").hasClass("oe_export_readonlyfield"))$(scnd_click).addClass("ui-selected")}else for(var i=self.row_index-1;i>=this.rowIndex-1;i--){scnd_click=self.$element.find("tr[id^='treerow-']")[i];if(!$(scnd_click).find("#tree-column").hasClass("oe_export_readonlyfield"))$(scnd_click).addClass("ui-selected")}}self.row_index=
this.rowIndex;self.$element.find("tr[id='treerow-"+record.id+"']").keyup(function(){self.row_index=0});var o2m_selection=self.$element.find("tr[id='treerow-"+record.id+"']").find("#tree-column");if($(o2m_selection).hasClass("oe_export_readonlyfield"))return false;if(e.ctrlKey)if($(this).hasClass("ui-selected"))$(this).removeClass("ui-selected").find("a").blur();else $(this).addClass("ui-selected").find("a").focus();else if(!e.shiftKey){self.$element.find("tr.ui-selected").removeClass("ui-selected").find("a").blur();
$(this).addClass("ui-selected").find("a").focus()}return false});self.$element.find("tr[id='treerow-"+record.id+"']").keydown(function(e){var keyCode=e.keyCode||e.which;var arrow={left:37,up:38,right:39,down:40};switch(keyCode){case arrow.left:if($(this).hasClass("open"))self.on_click(this.id,record);break;case arrow.right:if(!$(this).hasClass("open"))self.on_click(this.id,record);break;case arrow.up:var elem=this;$(elem).removeClass("ui-selected");while(!$(elem).prev().is(":visible"))elem=$(elem).prev();
if(!$(elem).prev().find("#tree-column").hasClass("oe_export_readonlyfield"))$(elem).prev().addClass("ui-selected");$(elem).prev().find("a").focus();break;case arrow.down:var elem=this;$(elem).removeClass("ui-selected");while(!$(elem).next().is(":visible"))elem=$(elem).next();if(!$(elem).next().find("#tree-column").hasClass("oe_export_readonlyfield"))$(elem).next().addClass("ui-selected");$(elem).next().find("a").focus();break}});self.$element.find("tr[id='treerow-"+record.id+"']").dblclick(function(){var $o2m_selection=
self.$element.find("tr[id^='treerow-"+record.id+"']").find("#tree-column");if(!$o2m_selection.hasClass("oe_export_readonlyfield"))self.add_field(record.id,$(this).find("a").attr("string"))})});self.$element.find("#fields_list").mouseover(function(event){if(event.relatedTarget)if(event.relatedTarget.attributes["id"]&&event.relatedTarget.attributes["string"]){var field_id=event.relatedTarget.attributes["id"]["value"];if(field_id&&field_id.split("-")[0]==="export")if(!self.$element.find("tr[id='treerow-"+
field_id.split("-")[1]+"']").find("#tree-column").hasClass("oe_export_readonlyfield"))self.add_field(field_id.split("-")[1],event.relatedTarget.attributes["string"]["value"])}})},showcontent:function(id){var $this=this.$element.find("tr[id='treerow-"+id+"']");var is_open=$this.hasClass("open");$this.toggleClass("open");var first_child=$this.find("img");if(is_open)first_child.attr("src","/web/static/src/img/expand.gif");else first_child.attr("src","/web/static/src/img/collapse.gif");var child_field=
this.$element.find("tr[id^='treerow-"+id+"/']");var child_len=id.split("/").length+1;for(var i=0;i<child_field.length;i++){var $child=$(child_field[i]);if(is_open)$child.hide();else if(child_len==child_field[i].id.split("/").length){if($child.hasClass("open")){$child.removeClass("open");$child.find("img").attr("src","/web/static/src/img/expand.gif")}$child.show()}}},add_field:function(field_id,string){var field_list=this.$element.find("#fields_list");if(this.$element.find("#fields_list option[value='"+
field_id+"']")&&!this.$element.find("#fields_list option[value='"+field_id+"']").length)field_list.append(new Option(string,field_id))},get_fields:function(){var export_field=[];this.$element.find("#fields_list option").each(function(){export_field.push($(this).val())});if(!export_field.length)alert(_t("Please select fields to save export list..."));return export_field},on_click_export_data:function(){var self=this;var exported_fields=this.$element.find("#fields_list option").map(function(){return{name:self.records[this.value]||
this.value,label:this.textContent||this.innerText}}).get();if(_.isEmpty(exported_fields)){alert(_t("Please select fields to export..."));return}exported_fields.unshift({name:"id",label:"External ID"});var export_format=this.$element.find("#export_format").val();$.blockUI();this.session.get_file({url:"/web/export/"+export_format,data:{data:JSON.stringify({model:this.dataset.model,fields:exported_fields,ids:this.dataset.ids,domain:this.dataset.domain,import_compat:Boolean(this.$element.find("#import_compat").val())})},
complete:$.unblockUI})},close:function(){this.$element.remove();this._super()}})};
openerp.web.data_import=function(openerp){var QWeb=openerp.web.qweb,_t=openerp.web._t;function jsonp(form,attributes,callback){attributes=attributes||{};var options={jsonp:_.uniqueId("import_callback_")};window[options.jsonp]=function(){delete window[options.jsonp];callback.apply(null,arguments)};if("data"in attributes)_.extend(attributes.data,options);else _.extend(attributes,{data:options});$(form).ajaxSubmit(attributes)}openerp.web.DataImport=openerp.web.Dialog.extend({template:"ImportDataView",
dialog_title:{toString:function(){return _t("Import Data")}},init:function(parent,dataset){var self=this;this._super(parent,{});this.model=parent.model;this.fields=[];this.all_fields=[];this.fields_with_defaults=[];this.required_fields=null;var convert_fields=function(root,prefix){prefix=prefix||"";_(root.fields).each(function(f){self.all_fields.push(prefix+f.name);if(f.fields)convert_fields(f,prefix+f.id+"/")})};this.ready=$.Deferred.queue().then(function(){self.required_fields=_(self.fields).chain().filter(function(field){return field.required&&
!_.include(self.fields_with_defaults,field.id)}).pluck("name").value();convert_fields(self);self.all_fields.sort()})},start:function(){var self=this;this._super();this.open({buttons:[{text:_t("Close"),click:function(){self.stop()}},{text:_t("Import File"),click:function(){self.do_import()},"class":"oe-dialog-import-button"}],close:function(event,ui){self.stop()}});this.toggle_import_button(false);this.$element.find("#csvfile").change(this.on_autodetect_data);this.$element.find("fieldset").change(this.on_autodetect_data);
this.$element.delegate("fieldset legend","click",function(){$(this).parent().toggleClass("oe-closed")});this.ready.push((new openerp.web.DataSet(this,this.model)).call("fields_get",[],function(fields){self.graft_fields(fields);self.ready.push((new openerp.web.DataSet(self,self.model)).default_get(_.pluck(self.fields,"id")).then(function(fields){_.each(fields,function(val,key){if(val)self.fields_with_defaults.push(key)})}))}))},graft_fields:function(fields,parent,level){parent=parent||this;level=level||
0;var self=this;if(level===0)parent.fields.push({id:"id",name:"id",string:_t("External ID"),required:false});_(fields).each(function(field,field_name){if(field_name==="id")return;if(field.readonly){if(_.isEmpty(field.states))return;if(!_.any(field.states,function(modifiers){return _(modifiers).chain().pluck(0).contains("readonly").value()}))return}var f={id:field_name,name:field_name,string:field.string,required:field.required};switch(field.type){case "many2many":case "many2one":f.name+="/id";break;
case "one2many":f.name+="/id";f.fields=[];if(level<2)self.ready.push((new openerp.web.DataSet(self,field.relation)).call("fields_get",[],function(fields){self.graft_fields(fields,f,level+1)}));break}parent.fields.push(f)})},toggle_import_button:function(newstate){this.$element.dialog("widget").find(".oe-dialog-import-button").button("option","disabled",!newstate)},do_import:function(){if(!this.$element.find("#csvfile").val())return;var lines_to_skip=parseInt(this.$element.find("#csv_skip").val(),
10);var with_headers=this.$element.find("#file_has_headers").prop("checked");if(!lines_to_skip&&with_headers)lines_to_skip=1;var indices=[],fields=[];this.$element.find(".sel_fields").each(function(index,element){var val=element.value;if(!val)return;indices.push(index);fields.push(val)});jsonp(this.$element.find("#import_data"),{url:"/web/import/import_data",data:{model:this.model,meta:JSON.stringify({skip:lines_to_skip,indices:indices,fields:fields})}},this.on_import_results)},on_autodetect_data:function(){if(!this.$element.find("#csvfile").val())return;
jsonp(this.$element.find("#import_data"),{url:"/web/import/detect_data"},this.on_import_results)},on_import_results:function(results){this.$element.find("#result").empty();var headers,result_node=this.$element.find("#result");if(results["error"]){result_node.append(QWeb.render("ImportView.error",{"error":results["error"]}));this.$element.find("fieldset").removeClass("oe-closed");return}if(results["success"]){if(this.widget_parent.widget_parent.active_view=="list")this.widget_parent.reload_content();
this.stop();return}if(results["records"]){var lines_to_skip=parseInt(this.$element.find("#csv_skip").val(),10),with_headers=this.$element.find("#file_has_headers").prop("checked");headers=with_headers?results.records[0]:null;result_node.append(QWeb.render("ImportView.result",{"headers":headers,"records":lines_to_skip?results.records.slice(lines_to_skip):with_headers?results.records.slice(1):results.records}));this.$element.find("fieldset").addClass("oe-closed")}this.$element.find("form").removeClass("oe-import-no-result");
this.$element.delegate(".oe-m2o-drop-down-button","click",function(){$(this).prev("input").focus()});var self=this;this.ready.then(function(){var $fields=self.$element.find(".sel_fields").bind("blur",function(){if(this.value&&!_(self.all_fields).contains(this.value))this.value=""}).autocomplete({minLength:0,source:self.all_fields,change:self.on_check_field_values}).focus(function(){$(this).autocomplete("search")});_(headers).each(function(header,index){var field_name=self.match_column_to_field(header);
if(field_name)$fields.eq(index).val(field_name)});self.on_check_field_values()})},match_column_to_field:function(name,fields){fields=fields||this.fields;var f;f=_(fields).detect(function(field){return field.name===name||field.string.toLowerCase()===name.toLowerCase()});if(f)return f.name;var index=name.indexOf("/");if(index===-1)return undefined;var column_name=name.substring(0,index);f=_(fields).detect(function(field){return field.id===column_name||field.string.toLowerCase()===column_name.toLowerCase()});
if(!f)return undefined;var rest=this.match_column_to_field(name.substring(index+1),f.fields);if(!rest)return undefined;return f.id+"/"+rest},find_duplicate_fields:function(){var values={},duplicates={};this.$element.find(".sel_fields").each(function(index,element){var value=element.value;var $element=$(element).removeClass("duplicate_fld");if(!value)return;if(!(value in values))values[value]=element;else{var same_valued_field=values[value];if(value in duplicates)duplicates[value].push(element);else duplicates[value]=
[same_valued_field,element];$element.add(same_valued_field).addClass("duplicate_fld")}});return duplicates},on_check_field_values:function(){this.$element.find("#message, #msg").remove();var required_valid=this.check_required();var duplicates=this.find_duplicate_fields();if(_.isEmpty(duplicates))this.toggle_import_button(required_valid);else{var $err=$('<div id="msg" style="color: red;">Destination fields should only be selected once, some fields are selected more than once:</div>').insertBefore(this.$element.find("#result"));
var $dupes=$("<dl>").appendTo($err);_(duplicates).each(function(elements,value){$("<dt>").text(value).appendTo($dupes);_(elements).each(function(element){var cell=$(element).closest("td");$("<dd>").text(cell.parent().children().index(cell)).appendTo($dupes)})});this.toggle_import_button(false)}},check_required:function(){if(!this.required_fields.length)return true;var selected_fields=_(this.$element.find(".sel_fields").get()).chain().pluck("value").compact().value();var missing_fields=_.difference(this.required_fields,
selected_fields);if(missing_fields.length){this.$element.find("#result").before('<div id="message" style="color:red">*Required Fields are not selected : '+missing_fields+".</div>");return false}return true},stop:function(){this.$element.remove();this._super()}})};
openerp.web.search=function(openerp){var QWeb=openerp.web.qweb,_t=openerp.web._t,_lt=openerp.web._lt;openerp.web.SearchView=openerp.web.OldWidget.extend({template:"EmptyComponent",init:function(parent,dataset,view_id,defaults,hidden){this._super(parent);this.dataset=dataset;this.model=dataset.model;this.view_id=view_id;this.defaults=defaults||{};this.has_defaults=!_.isEmpty(this.defaults);this.inputs=[];this.enabled_filters=[];this.has_focus=false;this.hidden=!!hidden;this.headless=this.hidden&&!this.has_defaults;
this.ready=$.Deferred()},start:function(){this._super();if(this.hidden)this.$element.hide();if(this.headless)this.ready.resolve();else this.rpc("/web/searchview/load",{model:this.model,view_id:this.view_id,context:this.dataset.get_context()},this.on_loaded);return this.ready.promise()},show:function(){this.$element.show()},hide:function(){this.$element.hide()},make_widgets:function(items,fields){var rows=[],row=[];rows.push(row);var filters=[];_.each(items,function(item){if(filters.length&&item.tag!==
"filter"){row.push(new openerp.web.search.FilterGroup(filters,this));filters=[]}if(item.tag==="newline"){row=[];rows.push(row)}else if(item.tag==="filter"){if(!this.has_focus){item.attrs.default_focus="1";this.has_focus=true}filters.push(new openerp.web.search.Filter(item,this))}else if(item.tag==="separator");else if(item.tag==="group")row.push(new openerp.web.search.Group(item,this,fields));else if(item.tag==="field"){if(!this.has_focus){item.attrs.default_focus="1";this.has_focus=true}row.push(this.make_field(item,
fields[item["attrs"].name]))}},this);if(filters.length)row.push(new openerp.web.search.FilterGroup(filters,this));return rows},make_field:function(item,field){try{return new (openerp.web.search.fields.get_any([item.attrs.widget,field.type]))(item,field,this)}catch(e){if(!e instanceof openerp.web.KeyNotFound)throw e;console.group("Unknown field type "+field.type);console.error("View node",item);console.info("View field",field);console.info("In view",this);console.groupEnd();return null}},on_loaded:function(data){this.fields_view=
data.fields_view;if(data.fields_view.type!=="search"||data.fields_view.arch.tag!=="search")throw new Error(_.str.sprintf("Got non-search view after asking for a search view: type %s, arch root %s",data.fields_view.type,data.fields_view.arch.tag));var self=this,lines=this.make_widgets(data.fields_view["arch"].children,data.fields_view.fields);var ext=new openerp.web.search.ExtendedSearch(this,this.model);lines.push([ext]);this.extended_search=ext;var render=QWeb.render("SearchView",{"view":data.fields_view["arch"],
"lines":lines,"defaults":this.defaults});this.$element.html(render);var f=this.$element.find("form");this.$element.find("form").submit(this.do_search).bind("reset",this.do_clear);var widget_starts=_(lines).chain().flatten().map(function(widget){return widget.start()}).value();$.when.apply(null,widget_starts).then(function(){self.ready.resolve()});this.reload_managed_filters()},reload_managed_filters:function(){var self=this;return this.rpc("/web/searchview/get_filters",{model:this.dataset.model}).then(function(result){self.managed_filters=
result;var filters=self.$element.find(".oe_search-view-filters-management");filters.html(QWeb.render("SearchView.managed-filters",{filters:result,disabled_filter_message:_t("Filter disabled due to invalid syntax")}));filters.change(self.on_filters_management)})},on_filters_management:function(e){var self=this;var select=this.$element.find(".oe_search-view-filters-management");var val=select.val();switch(val){case "advanced_filter":this.extended_search.on_activate();break;case "add_to_dashboard":this.on_add_to_dashboard();
break;case "manage_filters":this.do_action({res_model:"ir.filters",views:[[false,"list"],[false,"form"]],type:"ir.actions.act_window",context:{"search_default_user_id":this.session.uid,"search_default_model_id":this.dataset.model},target:"current",limit:80});break;case "save_filter":var data=this.build_search_data();var context=new openerp.web.CompoundContext;_.each(data.contexts,function(x){context.add(x)});var domain=new openerp.web.CompoundDomain;_.each(data.domains,function(x){domain.add(x)});
var groupbys=_.pluck(data.groupbys,"group_by").join();context.add({"group_by":groupbys});var dial_html=QWeb.render("SearchView.managed-filters.add");var $dial=$(dial_html);$dial.dialog({modal:true,title:_t("Filter Entry"),buttons:[{text:_t("Cancel"),click:function(){$(this).dialog("close")}},{text:_t("OK"),click:function(){$(this).dialog("close");var name=$(this).find("input").val();self.rpc("/web/searchview/save_filter",{model:self.dataset.model,context_to_save:context,domain:domain,name:name}).then(function(){self.reload_managed_filters()})}}]});
break;case "":this.do_clear()}if(val.slice(0,4)=="get:"){val=val.slice(4);val=parseInt(val,10);var filter=this.managed_filters[val];this.do_clear(false).then(_.bind(function(){select.val("get:"+val);var groupbys=[];var group_by=filter.context.group_by;if(group_by)groupbys=_.map(group_by instanceof Array?group_by:group_by.split(","),function(el){return{group_by:el}});this.on_search([filter.domain],[filter.context],groupbys)},this))}else select.val("")},on_add_to_dashboard:function(){this.$element.find(".oe_search-view-filters-management")[0].selectedIndex=
0;var self=this,menu=openerp.webclient.menu,$dialog=$(QWeb.render("SearchView.add_to_dashboard",{dashboards:menu.data.data.children,selected_menu_id:menu.$element.find("a.active").data("menu")}));$dialog.find("input").val(this.fields_view.name);$dialog.dialog({modal:true,title:_t("Add to Dashboard"),buttons:[{text:_t("Cancel"),click:function(){$(this).dialog("close")}},{text:_t("OK"),click:function(){$(this).dialog("close");var menu_id=$(this).find("select").val(),title=$(this).find("input").val(),
data=self.build_search_data(),context=new openerp.web.CompoundContext,domain=new openerp.web.CompoundDomain;_.each(data.contexts,function(x){context.add(x)});_.each(data.domains,function(x){domain.add(x)});self.rpc("/web/searchview/add_to_dashboard",{menu_id:menu_id,action_id:self.widget_parent.action.id,context_to_save:context,domain:domain,view_mode:self.widget_parent.active_view,name:title},function(r){if(r===false)self.do_warn("Could not add filter to dashboard");else self.do_notify("Filter added to dashboard",
"")})}}]})},do_search:function(e){if(this.headless&&!this.has_defaults)return this.on_search([],[],[]);var select=this.$element.find(".oe_search-view-filters-management");select.val("_filters");if(e&&e.preventDefault)e.preventDefault();var data=this.build_search_data();if(data.errors.length){this.on_invalid(data.errors);return}this.on_search(data.domains,data.contexts,data.groupbys)},build_search_data:function(){var domains=[],contexts=[],errors=[];_.each(this.inputs,function(input){try{var domain=
input.get_domain();if(domain)domains.push(domain);var context=input.get_context();if(context)contexts.push(context)}catch(e){if(e instanceof openerp.web.search.Invalid)errors.push(e);else throw e;}});var groupbys=_(this.enabled_filters).chain().map(function(filter){return filter.get_context()}).compact().value();return{domains:domains,contexts:contexts,errors:errors,groupbys:groupbys}},on_search:function(domains,contexts,groupbys){},on_invalid:function(errors){this.do_notify(_t("Invalid Search"),
_t("triggered from search view"))},do_clear:function(reload_view){this.$element.find(".filter_label, .filter_icon").removeClass("enabled");this.enabled_filters.splice(0);var string=$("a.searchview_group_string");_.each(string,function(str){$(str).closest("div.searchview_group").removeClass("expanded").addClass("folded")});this.$element.find("table:last").hide();$(".searchview_extended_groups_list").empty();return $.async_when.apply(null,_(this.inputs).invoke("clear")).pipe(reload_view!==false?this.on_clear:
null)},on_clear:function(){this.do_search()},do_toggle_filter:function(filter,default_enabled){if(default_enabled||filter.is_enabled())this.enabled_filters.push(filter);else this.enabled_filters=_.without(this.enabled_filters,filter);if(!default_enabled)this.$element.find("form").submit()}});openerp.web.search={};openerp.web.search.fields=new openerp.web.Registry({"char":"openerp.web.search.CharField","text":"openerp.web.search.CharField","boolean":"openerp.web.search.BooleanField","integer":"openerp.web.search.IntegerField",
"id":"openerp.web.search.IntegerField","float":"openerp.web.search.FloatField","selection":"openerp.web.search.SelectionField","datetime":"openerp.web.search.DateTimeField","date":"openerp.web.search.DateField","many2one":"openerp.web.search.ManyToOneField","many2many":"openerp.web.search.CharField","one2many":"openerp.web.search.CharField"});openerp.web.search.Invalid=openerp.web.Class.extend({init:function(field,value,message){this.field=field;this.value=value;this.message=message},toString:function(){return _.str.sprintf(_t("Incorrect value for field %(fieldname)s: [%(value)s] is %(message)s"),
{fieldname:this.field,value:this.value,message:this.message})}});openerp.web.search.Widget=openerp.web.OldWidget.extend({template:null,init:function(view){this._super(view);this.view=view},make_id:function(){this.element_id=_.uniqueId(["search"].concat(_.compact(_.toArray(arguments)),[""]).join("_"));return this.element_id},start:function(){this._super();if(this.view&&this.element_id)this.$element=$(document.getElementById(this.element_id))},stop:function(){delete this.view;this._super()},render:function(defaults){return this._super(_.extend(this,
{defaults:defaults}))}});openerp.web.search.add_expand_listener=function($root){$root.find("a.searchview_group_string").click(function(e){$root.toggleClass("folded expanded");e.stopPropagation();e.preventDefault()})};openerp.web.search.Group=openerp.web.search.Widget.extend({template:"SearchView.group",init:function(view_section,view,fields){this._super(view);this.attrs=view_section.attrs;this.lines=view.make_widgets(view_section.children,fields);this.make_id("group")},start:function(){this._super();
openerp.web.search.add_expand_listener(this.$element);var widget_starts=_(this.lines).chain().flatten().map(function(widget){return widget.start()}).value();return $.when.apply(null,widget_starts)}});openerp.web.search.Input=openerp.web.search.Widget.extend({init:function(view){this._super(view);this.view.inputs.push(this);this.style=undefined},get_context:function(){throw new Error("get_context not implemented for widget "+this.attrs.type);},get_domain:function(){throw new Error("get_domain not implemented for widget "+
this.attrs.type);},load_attrs:function(attrs){if(attrs.modifiers){attrs.modifiers=JSON.parse(attrs.modifiers);attrs.invisible=attrs.modifiers.invisible||false;if(attrs.invisible)this.style="display: none;"}this.attrs=attrs},clear:function(){}});openerp.web.search.FilterGroup=openerp.web.search.Input.extend({template:"SearchView.filters",init:function(filters,view){this._super(view);this.filters=filters;this.length=filters.length},start:function(){this._super();_.each(this.filters,function(filter){filter.start()})},
get_context:function(){},get_domain:function(){var domains=_(this.filters).chain().filter(function(filter){return filter.is_enabled()}).map(function(filter){return filter.attrs.domain}).reject(_.isEmpty).value();if(!domains.length)return;if(domains.length===1)return domains[0];for(var i=domains.length;--i;)domains.unshift(["|"]);return _.extend(new openerp.web.CompoundDomain,{__domains:domains})}});openerp.web.search.Filter=openerp.web.search.Input.extend({template:"SearchView.filter",init:function(node,
view){this._super(view);this.load_attrs(node.attrs);this.classes=[this.attrs.string?"filter_label":"filter_icon"];this.make_id("filter",this.attrs.name)},start:function(){this._super();var self=this;this.$element.click(function(e){$(this).toggleClass("enabled");self.view.do_toggle_filter(self)})},is_enabled:function(){return this.$element.hasClass("enabled")},render:function(defaults){if(this.attrs.name&&defaults[this.attrs.name]){this.classes.push("enabled");this.view.do_toggle_filter(this,true)}return this._super(defaults)},
get_context:function(){if(!this.is_enabled())return;return this.attrs.context},get_domain:function(){}});openerp.web.search.Field=openerp.web.search.Input.extend({template:"SearchView.field",default_operator:"=",init:function(view_section,field,view){this._super(view);this.load_attrs(_.extend({},field,view_section.attrs));this.filters=new openerp.web.search.FilterGroup(_.compact(_.map(view_section.children,function(filter_node){if(filter_node.attrs.string&&typeof console!=="undefined"&&console.debug)console.debug("Filter-in-field with a 'string' attribute "+
"in view",view);delete filter_node.attrs.string;return new openerp.web.search.Filter(filter_node,view)})),view);this.make_id("input",field.type,this.attrs.name)},start:function(){this._super();this.filters.start()},get_context:function(){var val=this.get_value();var has_value=val!==null&&val!=="";var context=this.attrs.context;if(!(has_value&&context))return;return _.extend({},context,{own_values:{self:val}})},make_domain:function(name,operator,value){return[[name,operator,value]]},get_domain:function(){var val=
this.get_value();if(val===null||val==="")return;var domain=this.attrs["filter_domain"];if(!domain)return this.make_domain(this.attrs.name,this.attrs.operator||this.default_operator,val);return _.extend({},domain,{own_values:{self:val}})}});openerp.web.search.CharField=openerp.web.search.Field.extend({default_operator:"ilike",get_value:function(){return this.$element.val()}});openerp.web.search.NumberField=openerp.web.search.Field.extend({get_value:function(){if(!this.$element.val())return null;var val=
this.parse(this.$element.val()),check=Number(this.$element.val());if(isNaN(val)||val!==check){this.$element.addClass("error");throw new openerp.web.search.Invalid(this.attrs.name,this.$element.val(),this.error_message);}this.$element.removeClass("error");return val}});openerp.web.search.IntegerField=openerp.web.search.NumberField.extend({error_message:_t("not a valid integer"),parse:function(value){try{return openerp.web.parse_value(value,{"widget":"integer"})}catch(e){return NaN}}});openerp.web.search.FloatField=
openerp.web.search.NumberField.extend({error_message:_t("not a valid number"),parse:function(value){try{return openerp.web.parse_value(value,{"widget":"float"})}catch(e){return NaN}}});openerp.web.search.SelectionField=openerp.web.search.Field.extend({template:"SearchView.field.selection",init:function(){this._super.apply(this,arguments);this.prepend_empty=!_(this.attrs.selection).detect(function(item){return!item[1]})},get_value:function(){var index=parseInt(this.$element.val(),10);if(isNaN(index))return null;
var value=this.attrs.selection[index][0];if(value===false)return null;return value},render:function(defaults){if(!defaults[this.attrs.name])defaults[this.attrs.name]=false;return this._super(defaults)},clear:function(){var self=this,d=$.Deferred(),selection=this.attrs.selection;for(var index=0;index<selection.length;++index){var item=selection[index];if(!item[1]){setTimeout(function(){self.$element.val(index);d.resolve()},0);return d.promise()}}return d.resolve().promise()}});openerp.web.search.BooleanField=
openerp.web.search.SelectionField.extend({init:function(){this._super.apply(this,arguments);this.attrs.selection=[["true",_t("Yes")],["false",_t("No")]]},render:function(defaults){var name=this.attrs.name;if(name in defaults)defaults[name]=defaults[name]?"true":"false";return this._super(defaults)},get_value:function(){switch(this.$element.val()){case "false":return false;case "true":return true;default:return null}}});openerp.web.search.DateField=openerp.web.search.Field.extend({template:"SearchView.date",
start:function(){this._super();this.datewidget=new openerp.web.DateWidget(this);this.datewidget.prependTo(this.$element);this.datewidget.$element.find("input").attr("size",15).attr("autofocus",this.attrs.default_focus==="1"?"autofocus":null).removeAttr("style");this.datewidget.set_value(this.defaults[this.attrs.name]||false)},get_value:function(){return this.datewidget.get_value()||null},clear:function(){this.datewidget.set_value(false)}});openerp.web.search.DateTimeField=openerp.web.search.DateField.extend({make_domain:function(name,
operator,value){return["&",[name,">=",value+" 00:00:00"],[name,"<=",value+" 23:59:59"]]}});openerp.web.search.ManyToOneField=openerp.web.search.CharField.extend({init:function(view_section,field,view){this._super(view_section,field,view);var self=this;this.got_name=$.Deferred().then(function(){self.$element.val(self.name)});this.dataset=new openerp.web.DataSet(this.view,this.attrs["relation"])},start:function(){this._super();this.setup_autocomplete();var started=$.Deferred();this.got_name.then(function(){started.resolve()},
function(){started.resolve()});return started.promise()},setup_autocomplete:function(){var self=this;this.$element.autocomplete({source:function(req,resp){if(self.abort_last){self.abort_last();delete self.abort_last}self.dataset.name_search(req.term,self.attrs.domain,"ilike",8,function(data){resp(_.map(data,function(result){return{id:result[0],label:result[1]}}))});self.abort_last=self.dataset.abort_last},select:function(event,ui){self.id=ui.item.id;self.name=ui.item.label},delay:0})},on_name_get:function(name_get){if(!name_get.length){delete this.id;
this.got_name.reject();return}this.name=name_get[0][1];this.got_name.resolve()},render:function(defaults){if(defaults[this.attrs.name]){this.id=defaults[this.attrs.name];if(this.id instanceof Array)this.id=this.id[0];delete defaults[this.attrs.name];this.dataset.name_get([this.id],$.proxy(this,"on_name_get"))}else this.got_name.reject();return this._super(defaults)},make_domain:function(name,operator,value){if(this.id&&this.name)if(value===this.name)return[[name,"=",this.id]];else{delete this.id;
delete this.name}return this._super(name,operator,value)}});openerp.web.search.ExtendedSearch=openerp.web.search.Input.extend({template:"SearchView.extended_search",init:function(parent,model){this._super(parent);this.model=model},add_group:function(){var group=new openerp.web.search.ExtendedSearchGroup(this,this.fields);group.appendTo(this.$element.find(".searchview_extended_groups_list"));this.check_last_element()},start:function(){this._super();this.$element.closest("table.oe-searchview-render-line").css("display",
"none");var self=this;this.rpc("/web/searchview/fields_get",{"model":this.model},function(data){self.fields=data.fields;if(!("id"in self.fields))self.fields.id={string:"ID",type:"id"};openerp.web.search.add_expand_listener(self.$element);self.$element.find(".searchview_extended_add_group").click(function(e){self.add_group()})})},get_context:function(){return null},get_domain:function(){if(!this.$element)return null;if(this.$element.closest("table.oe-searchview-render-line").css("display")=="none")return null;
return _.reduce(this.widget_children,function(mem,x){return mem.concat(x.get_domain())},[])},on_activate:function(){this.add_group();var table=this.$element.closest("table.oe-searchview-render-line");table.css("display","");if(this.$element.hasClass("folded"))this.$element.toggleClass("folded expanded")},hide:function(){var table=this.$element.closest("table.oe-searchview-render-line");table.css("display","none");if(this.$element.hasClass("expanded"))this.$element.toggleClass("folded expanded")},
check_last_element:function(){_.each(this.widget_children,function(x){x.set_last_group(false)});if(this.widget_children.length>=1)this.widget_children[this.widget_children.length-1].set_last_group(true)}});openerp.web.search.ExtendedSearchGroup=openerp.web.OldWidget.extend({template:"SearchView.extended_search.group",init:function(parent,fields){this._super(parent);this.fields=fields},add_prop:function(){var prop=new openerp.web.search.ExtendedSearchProposition(this,this.fields);var render=prop.render({"index":this.widget_children.length-
1});this.$element.find(".searchview_extended_propositions_list").append(render);prop.start()},start:function(){var _this=this;this.add_prop();this.$element.find(".searchview_extended_add_proposition").click(function(){_this.add_prop()});this.$element.find(".searchview_extended_delete_group").click(function(){_this.stop()})},get_domain:function(){var props=_(this.widget_children).chain().map(function(x){return x.get_proposition()}).compact().value();var choice=this.$element.find(".searchview_extended_group_choice").val();
var op=choice=="all"?"&":"|";return choice=="none"?["!"]:[].concat(_.map(_.range(_.max([0,props.length-1])),function(){return op}),props)},stop:function(){var parent=this.widget_parent;if(this.widget_parent.widget_children.length==1)this.widget_parent.hide();this._super();parent.check_last_element()},set_last_group:function(is_last){this.$element.toggleClass("last_group",is_last)}});openerp.web.search.ExtendedSearchProposition=openerp.web.OldWidget.extend({template:"SearchView.extended_search.proposition",
init:function(parent,fields){this._super(parent);this.fields=_(fields).chain().map(function(val,key){return _.extend({},val,{"name":key})}).sortBy(function(field){return field.string}).value();this.attrs={_:_,fields:this.fields,selected:null};this.value=null},start:function(){this.$element=$("#"+this.element_id);this.select_field(this.fields.length>0?this.fields[0]:null);var _this=this;this.$element.find(".searchview_extended_prop_field").change(function(){_this.changed()});this.$element.find(".searchview_extended_delete_prop").click(function(){_this.stop()})},
stop:function(){var parent;if(this.widget_parent.widget_children.length==1)parent=this.widget_parent;this._super();if(parent)parent.stop()},changed:function(){var nval=this.$element.find(".searchview_extended_prop_field").val();if(this.attrs.selected==null||nval!=this.attrs.selected.name)this.select_field(_.detect(this.fields,function(x){return x.name==nval}))},select_field:function(field){var self=this;if(this.attrs.selected!=null){this.value.stop();this.value=null;this.$element.find(".searchview_extended_prop_op").html("")}this.attrs.selected=
field;if(field==null)return;var type=field.type;try{openerp.web.search.custom_filters.get_object(type)}catch(e){if(!e instanceof openerp.web.KeyNotFound)throw e;type="char";console.log("Unknow field type "+e.key)}this.value=new (openerp.web.search.custom_filters.get_object(type))(this);if(this.value.set_field)this.value.set_field(field);_.each(this.value.operators,function(operator){$("<option>",{value:operator.value}).text(String(operator.text)).appendTo(self.$element.find(".searchview_extended_prop_op"))});
this.$element.find(".searchview_extended_prop_value").html(this.value.render({}));this.value.start()},get_proposition:function(){if(this.attrs.selected==null)return null;var field=this.attrs.selected.name;var op=this.$element.find(".searchview_extended_prop_op").val();var value=this.value.get_value();return[field,op,value]}});openerp.web.search.ExtendedSearchProposition.Field=openerp.web.OldWidget.extend({start:function(){this.$element=$("#"+this.element_id)}});openerp.web.search.ExtendedSearchProposition.Char=
openerp.web.search.ExtendedSearchProposition.Field.extend({template:"SearchView.extended_search.proposition.char",operators:[{value:"ilike",text:_lt("contains")},{value:"not ilike",text:_lt("doesn't contain")},{value:"=",text:_lt("is equal to")},{value:"!=",text:_lt("is not equal to")},{value:">",text:_lt("greater than")},{value:"<",text:_lt("less than")},{value:">=",text:_lt("greater or equal than")},{value:"<=",text:_lt("less or equal than")}],get_value:function(){return this.$element.val()}});
openerp.web.search.ExtendedSearchProposition.DateTime=openerp.web.search.ExtendedSearchProposition.Field.extend({template:"SearchView.extended_search.proposition.empty",operators:[{value:"=",text:_lt("is equal to")},{value:"!=",text:_lt("is not equal to")},{value:">",text:_lt("greater than")},{value:"<",text:_lt("less than")},{value:">=",text:_lt("greater or equal than")},{value:"<=",text:_lt("less or equal than")}],get_value:function(){return this.datewidget.get_value()},start:function(){this._super();
this.datewidget=new openerp.web.DateTimeWidget(this);this.datewidget.prependTo(this.$element)}});openerp.web.search.ExtendedSearchProposition.Date=openerp.web.search.ExtendedSearchProposition.Field.extend({template:"SearchView.extended_search.proposition.empty",operators:[{value:"=",text:_lt("is equal to")},{value:"!=",text:_lt("is not equal to")},{value:">",text:_lt("greater than")},{value:"<",text:_lt("less than")},{value:">=",text:_lt("greater or equal than")},{value:"<=",text:_lt("less or equal than")}],
get_value:function(){return this.datewidget.get_value()},start:function(){this._super();this.datewidget=new openerp.web.DateWidget(this);this.datewidget.prependTo(this.$element)}});openerp.web.search.ExtendedSearchProposition.Integer=openerp.web.search.ExtendedSearchProposition.Field.extend({template:"SearchView.extended_search.proposition.integer",operators:[{value:"=",text:_lt("is equal to")},{value:"!=",text:_lt("is not equal to")},{value:">",text:_lt("greater than")},{value:"<",text:_lt("less than")},
{value:">=",text:_lt("greater or equal than")},{value:"<=",text:_lt("less or equal than")}],get_value:function(){try{return openerp.web.parse_value(this.$element.val(),{"widget":"integer"})}catch(e){return""}}});openerp.web.search.ExtendedSearchProposition.Id=openerp.web.search.ExtendedSearchProposition.Integer.extend({operators:[{value:"=",text:_lt("is")}]});openerp.web.search.ExtendedSearchProposition.Float=openerp.web.search.ExtendedSearchProposition.Field.extend({template:"SearchView.extended_search.proposition.float",
operators:[{value:"=",text:_lt("is equal to")},{value:"!=",text:_lt("is not equal to")},{value:">",text:_lt("greater than")},{value:"<",text:_lt("less than")},{value:">=",text:_lt("greater or equal than")},{value:"<=",text:_lt("less or equal than")}],get_value:function(){try{return openerp.web.parse_value(this.$element.val(),{"widget":"float"})}catch(e){return""}}});openerp.web.search.ExtendedSearchProposition.Selection=openerp.web.search.ExtendedSearchProposition.Field.extend({template:"SearchView.extended_search.proposition.selection",
operators:[{value:"=",text:_lt("is")},{value:"!=",text:_lt("is not")}],set_field:function(field){this.field=field},get_value:function(){return this.$element.val()}});openerp.web.search.ExtendedSearchProposition.Boolean=openerp.web.search.ExtendedSearchProposition.Field.extend({template:"SearchView.extended_search.proposition.boolean",operators:[{value:"=",text:_lt("is true")},{value:"!=",text:_lt("is false")}],get_value:function(){return true}});openerp.web.search.custom_filters=new openerp.web.Registry({"char":"openerp.web.search.ExtendedSearchProposition.Char",
"text":"openerp.web.search.ExtendedSearchProposition.Char","one2many":"openerp.web.search.ExtendedSearchProposition.Char","many2one":"openerp.web.search.ExtendedSearchProposition.Char","many2many":"openerp.web.search.ExtendedSearchProposition.Char","datetime":"openerp.web.search.ExtendedSearchProposition.DateTime","date":"openerp.web.search.ExtendedSearchProposition.Date","integer":"openerp.web.search.ExtendedSearchProposition.Integer","float":"openerp.web.search.ExtendedSearchProposition.Float",
"boolean":"openerp.web.search.ExtendedSearchProposition.Boolean","selection":"openerp.web.search.ExtendedSearchProposition.Selection","id":"openerp.web.search.ExtendedSearchProposition.Id"})};
openerp.web.form=function(openerp){var _t=openerp.web._t,_lt=openerp.web._lt;var QWeb=openerp.web.qweb;openerp.web.views.add("form","openerp.web.FormView");openerp.web.FormView=openerp.web.View.extend({searchable:false,readonly:false,form_template:"FormView",display_name:_lt("Form"),init:function(parent,dataset,view_id,options){this._super(parent);this.set_default_options(options);this.dataset=dataset;this.model=dataset.model;this.view_id=view_id||false;this.fields_view={};this.widgets={};this.widgets_counter=
0;this.fields={};this.fields_order=[];this.datarecord={};this.default_focus_field=null;this.default_focus_button=null;this.registry=openerp.web.form.widgets;this.has_been_loaded=$.Deferred();this.$form_header=null;this.translatable_fields=[];_.defaults(this.options,{"not_interactible_on_create":false});this.is_initialized=$.Deferred();this.mutating_mutex=new $.Mutex;this.on_change_mutex=new $.Mutex;this.reload_mutex=new $.Mutex},start:function(){this._super();return this.init_view()},init_view:function(){if(this.embedded_view){var def=
$.Deferred().then(this.on_loaded);var self=this;$.async_when().then(function(){def.resolve(self.embedded_view)});return def.promise()}else{var context=new openerp.web.CompoundContext(this.dataset.get_context());return this.rpc("/web/view/load",{"model":this.model,"view_id":this.view_id,"view_type":"form",toolbar:this.options.sidebar,context:context},this.on_loaded)}},stop:function(){if(this.sidebar){this.sidebar.attachments.stop();this.sidebar.stop()}_.each(this.widgets,function(w){w.stop()});this._super()},
reposition:function($e){this.$element=$e;this.on_loaded()},on_loaded:function(data){var self=this;if(data){this.fields_order=[];this.fields_view=data;var frame=new (this.registry.get_object("frame"))(this,this.fields_view.arch);this.rendered=QWeb.render(this.form_template,{"frame":frame,"widget":this})}this.$element.html(this.rendered);_.each(this.widgets,function(w){w.start()});this.$form_header=this.$element.find(".oe_form_header:first");this.$form_header.find("div.oe_form_pager button[data-pager-action]").click(function(){var action=
$(this).data("pager-action");self.on_pager_action(action)});this.$form_header.find("button.oe_form_button_save").click(this.on_button_save);this.$form_header.find("button.oe_form_button_cancel").click(this.on_button_cancel);if(!this.sidebar&&this.options.sidebar&&this.options.sidebar_id){this.sidebar=new openerp.web.Sidebar(this,this.options.sidebar_id);this.sidebar.start();this.sidebar.do_unfold();this.sidebar.attachments=new openerp.web.form.SidebarAttachments(this.sidebar,this);this.sidebar.add_toolbar(this.fields_view.toolbar);
this.set_common_sidebar_sections(this.sidebar);this.sidebar.add_section(_t("Customize"),"customize");this.sidebar.add_items("customize",[{label:_t("Set Default"),form:this,callback:function(item){item.form.open_defaults_dialog()}}])}this.has_been_loaded.resolve()},do_load_state:function(state,warm){if(state.id&&this.datarecord.id!=state.id){if(!this.dataset.get_id_index(state.id))this.dataset.ids.push(state.id);this.dataset.select_id(state.id);if(warm)this.do_show()}},do_show:function(){var self=
this;this.$element.show().css("visibility","hidden");this.$element.removeClass("oe_form_dirty");return this.has_been_loaded.pipe(function(){var result;if(self.dataset.index===null)result=self.on_button_new();else result=self.dataset.read_index(_.keys(self.fields_view.fields),{context:{"bin_size":true}}).pipe(self.on_record_loaded);result.pipe(function(){self.$element.css("visibility","visible")});if(self.sidebar)self.sidebar.$element.show();return result})},do_hide:function(){this._super();if(this.sidebar)this.sidebar.$element.hide()},
on_record_loaded:function(record){var self=this,set_values=[];if(!record){this.do_warn("Form","The record could not be found in the database.",true);return $.Deferred().reject()}this.datarecord=record;_(this.fields).each(function(field,f){field.reset();var result=field.set_value(self.datarecord[f]||false);set_values.push(result);$.when(result).then(function(){field.validate()})});return $.when.apply(null,set_values).pipe(function(){if(!record.id)_.each(self.fields_order,function(field_name){if(record[field_name]!==
undefined){var field=self.fields[field_name];field.dirty=true;self.do_onchange(field)}});self.on_form_changed();self.is_initialized.resolve();self.do_update_pager(record.id==null);if(self.sidebar)self.sidebar.attachments.do_update();if(self.default_focus_field&&!self.embedded_view)self.default_focus_field.focus();if(record.id)self.do_push_state({id:record.id});self.$element.removeClass("oe_form_dirty")})},on_form_changed:function(){for(var w in this.widgets){w=this.widgets[w];w.process_modifiers();
if(w.field)w.validate();w.update_dom()}},do_notify_change:function(){this.$element.addClass("oe_form_dirty")},on_pager_action:function(action){if(this.can_be_discarded()){switch(action){case "first":this.dataset.index=0;break;case "previous":this.dataset.previous();break;case "next":this.dataset.next();break;case "last":this.dataset.index=this.dataset.ids.length-1;break}this.reload()}},do_update_pager:function(hide_index){var $pager=this.$form_header.find("div.oe_form_pager");var index=hide_index?
"-":this.dataset.index+1;$pager.find("button").prop("disabled",this.dataset.ids.length<2);$pager.find("span.oe_pager_index").html(index);$pager.find("span.oe_pager_count").html(this.dataset.ids.length)},parse_on_change:function(on_change,widget){var self=this;var onchange=_.str.trim(on_change);var call=onchange.match(/^\s?(.*?)\((.*?)\)\s?$/);if(!call)return null;var method=call[1];if(!_.str.trim(call[2]))return{method:method,args:[],context_index:null};var argument_replacement={"False":function(){return false},
"True":function(){return true},"None":function(){return null},"context":function(i){context_index=i;var ctx=new openerp.web.CompoundContext(self.dataset.get_context(),widget.build_context()?widget.build_context():{});return ctx}};var parent_fields=null,context_index=null;var args=_.map(call[2].split(","),function(a,i){var field=_.str.trim(a);if(field in argument_replacement)return argument_replacement[field](i);if(/^-?\d+(\.\d+)?$/.test(field))return Number(field);if(self.fields[field]){var value=
self.fields[field].get_on_change_value();return value==null?false:value}var splitted=field.split(".");if(splitted.length>1&&_.str.trim(splitted[0])==="parent"&&self.dataset.parent_view){if(parent_fields===null)parent_fields=self.dataset.parent_view.get_fields_values([self.dataset.child_name]);var p_val=parent_fields[_.str.trim(splitted[1])];if(p_val!==undefined)return p_val==null?false:p_val}var first_char=field[0],last_char=field[field.length-1];if(first_char==='"'&&last_char==='"'||first_char===
"'"&&last_char==="'")return field.slice(1,-1);throw new Error("Could not get field with name '"+field+"' for onchange '"+onchange+"'");});return{method:method,args:args,context_index:context_index}},do_onchange:function(widget,processed){var self=this;return this.on_change_mutex.exec(function(){try{var response={},can_process_onchange=$.Deferred();processed=processed||[];processed.push(widget.name);var on_change=widget.node.attrs.on_change;if(on_change){var change_spec=self.parse_on_change(on_change,
widget);if(change_spec){var ajax={url:"/web/dataset/onchange",async:false};can_process_onchange=self.rpc(ajax,{model:self.dataset.model,method:change_spec.method,args:[self.datarecord.id==null?[]:[self.datarecord.id]].concat(change_spec.args),context_id:change_spec.context_index==undefined?null:change_spec.context_index+1}).then(function(r){_.extend(response,r)})}else console.warn("Wrong on_change format",on_change)}if(can_process_onchange.isRejected())return can_process_onchange;if(widget.field["change_default"]){var fieldname=
widget.name,value;if(response.value&&fieldname in response.value)value=response.value[fieldname];else value=self.fields[fieldname].get_on_change_value();var condition=fieldname+"="+value;if(value)can_process_onchange=self.rpc({url:"/web/dataset/call",async:false},{model:"ir.values",method:"get_defaults",args:[self.model,condition]}).then(function(results){if(!results.length)return;if(!response.value)response.value={};for(var i=0;i<results.length;++i){var triplet=results[i];response.value[triplet[1]]=
triplet[2]}})}if(can_process_onchange.isRejected())return can_process_onchange;return self.on_processed_onchange(response,processed)}catch(e){console.error(e);return $.Deferred().reject()}})},on_processed_onchange:function(response,processed){try{var result=response;if(result.value){for(var f in result.value){if(!result.value.hasOwnProperty(f))continue;var field=this.fields[f];if(field){var value=result.value[f];if(field.get_value()!=value){field.set_value(value);field.dirty=true;if(!_.contains(processed,
field.name))this.do_onchange(field,processed)}}}this.on_form_changed()}if(!_.isEmpty(result.warning))$(QWeb.render("CrashManagerWarning",result.warning)).dialog({modal:true,buttons:[{text:_t("Ok"),click:function(){$(this).dialog("close")}}]});if(result.domain){function edit_domain(node){var new_domain=result.domain[node.attrs.name];if(new_domain)node.attrs.domain=new_domain;_(node.children).each(edit_domain)}edit_domain(this.fields_view.arch)}return $.Deferred().resolve()}catch(e){console.error(e);
return $.Deferred().reject()}},on_button_save:function(){var self=this;return this.do_save().then(function(result){self.do_prev_view({"created":result.created,"default":"page"})})},on_button_cancel:function(){if(this.can_be_discarded())return this.do_prev_view({"default":"page"})},on_button_new:function(){var self=this;var def=$.Deferred();$.when(this.has_been_loaded).then(function(){if(self.can_be_discarded()){var keys=_.keys(self.fields_view.fields);if(keys.length)self.dataset.default_get(keys).pipe(self.on_record_loaded).then(function(){def.resolve()});
else self.on_record_loaded({}).then(function(){def.resolve()})}});return def.promise()},can_be_discarded:function(){return!this.$element.is(".oe_form_dirty")||confirm(_t("Warning, the record has been modified, your changes will be discarded."))},do_save:function(success,prepend_on_create){var self=this;return this.mutating_mutex.exec(function(){return self.is_initialized.pipe(function(){try{var form_invalid=false,values={},first_invalid_field=null;for(var f in self.fields){f=self.fields[f];if(!f.is_valid()){form_invalid=
true;f.update_dom(true);if(!first_invalid_field)first_invalid_field=f}else if(f.name!=="id"&&!f.readonly&&(!self.datarecord.id||f.is_dirty()))values[f.name]=f.get_value()}if(form_invalid){first_invalid_field.focus();self.on_invalid();return $.Deferred().reject()}else{var save_deferral;if(!self.datarecord.id)save_deferral=self.dataset.create(values).pipe(function(r){return self.on_created(r,undefined,prepend_on_create)},null);else if(_.isEmpty(values))save_deferral=$.Deferred().resolve({}).promise();
else save_deferral=self.dataset.write(self.datarecord.id,values,{}).pipe(function(r){return self.on_saved(r)},null);return save_deferral.then(success)}}catch(e){console.error(e);return $.Deferred().reject()}})})},on_invalid:function(){var msg="<ul>";_.each(this.fields,function(f){if(!f.is_valid())msg+="<li>"+f.string+"</li>"});msg+="</ul>";this.do_warn(" :",msg)},on_saved:function(r,success){if(!r.result)return $.Deferred().reject();else return $.when(this.reload()).pipe(function(){return $.when(r).then(success)},
null)},on_created:function(r,success,prepend_on_create){if(!r.result)return $.Deferred().reject();else{this.datarecord.id=r.result;if(!prepend_on_create){this.dataset.alter_ids(this.dataset.ids.concat([this.datarecord.id]));this.dataset.index=this.dataset.ids.length-1}else{this.dataset.alter_ids([this.datarecord.id].concat(this.dataset.ids));this.dataset.index=0}this.do_update_pager();if(this.sidebar)this.sidebar.attachments.do_update();this.reload();return $.when(_.extend(r,{created:true})).then(success)}},
on_action:function(action){console.debug("Executing action",action)},reload:function(){var self=this;return this.reload_mutex.exec(function(){if(self.dataset.index==null||self.dataset.index<0)return $.when(self.on_button_new());else return self.dataset.read_index(_.keys(self.fields_view.fields),{context:{"bin_size":true}}).pipe(self.on_record_loaded)})},get_fields_values:function(blacklist){blacklist=blacklist||[];var values={};var ids=this.get_selected_ids();values["id"]=ids.length>0?ids[0]:false;
_.each(this.fields,function(value,key){if(_.include(blacklist,key))return;var val=value.get_value();values[key]=val});return values},get_selected_ids:function(){var id=this.dataset.ids[this.dataset.index];return id?[id]:[]},recursive_save:function(){var self=this;return $.when(this.do_save()).pipe(function(res){if(self.dataset.parent_view)return self.dataset.parent_view.recursive_save()})},is_dirty:function(){return _.any(this.fields,function(value){return value.is_dirty()})},is_interactible_record:function(){var id=
this.datarecord.id;if(!id){if(this.options.not_interactible_on_create)return false}else if(typeof id==="string")if(openerp.web.BufferedDataSet.virtual_id_regex.test(id))return false;return true},sidebar_context:function(){return this.do_save().pipe(_.bind(function(){return this.get_fields_values()},this))},open_defaults_dialog:function(){var self=this;var fields=_.chain(this.fields).map(function(field,name){var value=field.get_value();if(!value||field.invisible||field.readonly||field.field.type===
"one2many"||field.field.type==="many2many")return false;var displayed;switch(field.field.type){case "selection":displayed=_(field.values).find(function(option){return option[0]===value})[1];break;case "many2one":displayed=field.value[1]||value;break;default:displayed=value}return{name:name,string:field.string,value:value,displayed:displayed,change_default:!!field.field.change_default}}).compact().sortBy(function(field){return field.string}).value();var conditions=_.chain(fields).filter(function(field){return field.change_default}).value();
var d=new openerp.web.Dialog(this,{title:_t("Set Default"),args:{fields:fields,conditions:conditions},buttons:[{text:_t("Close"),click:function(){d.close()}},{text:_t("Save default"),click:function(){var $defaults=d.$element.find("#formview_default_fields");var field_to_set=$defaults.val();if(!field_to_set){$defaults.parent().addClass("invalid");return}var condition=d.$element.find("#formview_default_conditions").val(),all_users=d.$element.find("#formview_default_all").is(":checked");(new openerp.web.DataSet(self,
"ir.values")).call("set_default",[self.dataset.model,field_to_set,self.fields[field_to_set].get_value(),all_users,false,condition||false]).then(function(){d.close()})}}]});d.template="FormView.set_default";d.open()}});openerp.web.FormDialog=openerp.web.Dialog.extend({init:function(parent,options,view_id,dataset){this._super(parent,options);this.dataset=dataset;this.view_id=view_id;return this},start:function(){this._super();this.form=new openerp.web.FormView(this,this.dataset,this.view_id,{sidebar:false,
pager:false});this.form.appendTo(this.$element);this.form.on_created.add_last(this.on_form_dialog_saved);this.form.on_saved.add_last(this.on_form_dialog_saved);return this},select_id:function(id){if(this.form.dataset.select_id(id))return this.form.do_show();else{this.do_warn("Could not find id in dataset");return $.Deferred().reject()}},on_form_dialog_saved:function(r){this.close()}});openerp.web.form={};openerp.web.form.SidebarAttachments=openerp.web.OldWidget.extend({init:function(parent,form_view){var $section=
parent.add_section(_t("Attachments"),"attachments");this.$div=$('<div class="oe-sidebar-attachments"></div>');$section.append(this.$div);this._super(parent,$section.attr("id"));this.view=form_view},do_update:function(){if(!this.view.datarecord.id)this.on_attachments_loaded([]);else(new openerp.web.DataSetSearch(this,"ir.attachment",this.view.dataset.get_context(),[["res_model","=",this.view.dataset.model],["res_id","=",this.view.datarecord.id],["type","in",["binary","url"]]])).read_slice(["name",
"url","type"],{}).then(this.on_attachments_loaded)},on_attachments_loaded:function(attachments){this.attachments=attachments;this.$div.html(QWeb.render("FormView.sidebar.attachments",this));this.$element.find(".oe-binary-file").change(this.on_attachment_changed);this.$element.find(".oe-sidebar-attachment-delete").click(this.on_attachment_delete)},on_attachment_changed:function(e){window[this.element_id+"_iframe"]=this.do_update;var $e=$(e.target);if($e.val()!=""){this.$element.find("form.oe-binary-form").submit();
$e.parent().find("input[type=file]").prop("disabled",true);$e.parent().find("button").prop("disabled",true).find("img, span").toggle()}},on_attachment_delete:function(e){var self=this,$e=$(e.currentTarget);var name=_.str.trim($e.parent().find("a.oe-sidebar-attachments-link").text());if(confirm(_.str.sprintf(_t("Do you really want to delete the attachment %s?"),name)))this.rpc("/web/dataset/unlink",{model:"ir.attachment",ids:[parseInt($e.attr("data-id"))]},function(r){$e.parent().remove();self.do_notify("\u5220\u9664\u4e00\u4e2a\u9644\u4ef6",
"\u9644\u4ef6 '"+name+"' \u5df2\u7ecf\u88ab\u5220\u9664")})}});openerp.web.form.compute_domain=function(expr,fields){var stack=[];for(var i=expr.length-1;i>=0;i--){var ex=expr[i];if(ex.length==1){var top=stack.pop();switch(ex){case "|":stack.push(stack.pop()||top);continue;case "&":stack.push(stack.pop()&&top);continue;case "!":stack.push(!top);continue;default:throw new Error(_.str.sprintf(_t("Unknown operator %s in domain %s"),ex,JSON.stringify(expr)));}}var field=fields[ex[0]];if(!field)throw new Error(_.str.sprintf(_t("Unknown field %s in domain %s"),
ex[0],JSON.stringify(expr)));var field_value=field.get_value?fields[ex[0]].get_value():fields[ex[0]].value;var op=ex[1];var val=ex[2];switch(op.toLowerCase()){case "=":case "==":stack.push(field_value==val);break;case "!=":case "<>":stack.push(field_value!=val);break;case "<":stack.push(field_value<val);break;case ">":stack.push(field_value>val);break;case "<=":stack.push(field_value<=val);break;case ">=":stack.push(field_value>=val);break;case "in":if(!_.isArray(val))val=[val];stack.push(_(val).contains(field_value));
break;case "not in":if(!_.isArray(val))val=[val];stack.push(!_(val).contains(field_value));break;default:console.warn(_t("Unsupported operator %s in domain %s"),op,JSON.stringify(expr))}}return _.all(stack,_.identity)};openerp.web.form.Widget=openerp.web.OldWidget.extend({template:"Widget",init:function(view,node){this.view=view;this.node=node;this.modifiers=JSON.parse(this.node.attrs.modifiers||"{}");this.always_invisible=this.modifiers.invisible&&this.modifiers.invisible===true;this.type=this.type||
node.tag;this.element_name=this.element_name||this.type;this.element_class=["formview",this.view.view_id,this.element_name,this.view.widgets_counter++].join("_");this._super(view);this.view.widgets[this.element_class]=this;this.children=node.children;this.colspan=parseInt(node.attrs.colspan||1,10);this.decrease_max_width=0;this.string=this.string||node.attrs.string;this.help=this.help||node.attrs.help;this.invisible=this.modifiers["invisible"]===true;this.classname="oe_form_"+this.type;this.align=
parseFloat(this.node.attrs.align);if(isNaN(this.align)||this.align===1)this.align="right";else if(this.align===0)this.align="left";else this.align="center";this.width=this.node.attrs.width},start:function(){this.$element=this.view.$element.find("."+this.element_class.replace(/[^\r\n\f0-9A-Za-z_-]/g,"\\$&"))},stop:function(){this._super.apply(this,arguments);$.fn.tipsy.clear()},process_modifiers:function(){var compute_domain=openerp.web.form.compute_domain;for(var a in this.modifiers)this[a]=compute_domain(this.modifiers[a],
this.view.fields)},update_dom:function(){this.$element.toggle(!this.invisible)},render:function(){var template=this.template;return QWeb.render(template,{"widget":this})},do_attach_tooltip:function(widget,trigger,options){widget=widget||this;trigger=trigger||this.$element;options=_.extend({delayIn:500,delayOut:0,fade:true,title:function(){var template=widget.template+".tooltip";if(!QWeb.has_template(template))template="WidgetLabel.tooltip";return QWeb.render(template,{debug:openerp.connection.debug,
widget:widget})},gravity:$.fn.tipsy.autoBounds(50,"nw"),html:true,opacity:0.85,trigger:"hover"},options||{});trigger.tipsy(options)},_build_view_fields_values:function(blacklist){var a_dataset=this.view.dataset;var fields_values=this.view.get_fields_values(blacklist);var active_id=a_dataset.ids[a_dataset.index];_.extend(fields_values,{active_id:active_id||false,active_ids:active_id?[active_id]:[],active_model:a_dataset.model,parent:{}});if(a_dataset.parent_view)fields_values.parent=a_dataset.parent_view.get_fields_values([a_dataset.child_name]);
return fields_values},_build_eval_context:function(blacklist){var a_dataset=this.view.dataset;return new openerp.web.CompoundContext(a_dataset.get_context(),this._build_view_fields_values(blacklist))},build_context:function(blacklist){var v_context=this.node.attrs.context;if(!v_context)v_context=(this.field||{}).context||{};if(v_context.__ref||true){var fields_values=this._build_eval_context(blacklist);v_context=(new openerp.web.CompoundContext(v_context)).set_eval_context(fields_values)}return v_context},
build_domain:function(){var f_domain=this.field.domain||[];var n_domain=this.node.attrs.domain||null;var final_domain=n_domain!==null?n_domain:f_domain;if(!(final_domain instanceof Array)||true){var fields_values=this._build_eval_context();final_domain=(new openerp.web.CompoundDomain(final_domain)).set_eval_context(fields_values)}return final_domain}});openerp.web.form.WidgetFrame=openerp.web.form.Widget.extend({template:"WidgetFrame",init:function(view,node){this._super(view,node);this.columns=parseInt(node.attrs.col||
4,10);this.x=0;this.y=0;this.table=[];this.add_row();for(var i=0;i<node.children.length;i++){var n=node.children[i];if(n.tag=="newline")this.add_row();else this.handle_node(n)}this.set_row_cells_with(this.table[this.table.length-1])},add_row:function(){if(this.table.length)this.set_row_cells_with(this.table[this.table.length-1]);var row=[];this.table.push(row);this.x=0;this.y+=1;return row},set_row_cells_with:function(row){var bypass=0,max_width=100,row_length=row.length;for(var i=0;i<row.length;i++)if(row[i].always_invisible)row_length--;
else{bypass+=row[i].width===undefined?0:1;max_width-=row[i].decrease_max_width}var size_unit=Math.round(max_width/(this.columns-bypass)),colspan_sum=0;for(var i=0;i<row.length;i++){var w=row[i];if(w.always_invisible)continue;colspan_sum+=w.colspan;if(w.width===undefined){var width=i===row_length-1&&colspan_sum===this.columns?max_width:Math.round(size_unit*w.colspan);max_width-=width;w.width=width+"%"}}},handle_node:function(node){var type={};if(node.tag=="field"){type=this.view.fields_view.fields[node.attrs.name]||
{};if(node.attrs.widget=="statusbar"&&node.attrs.nolabel!=="1"){node.attrs.colspan=(parseInt(node.attrs.colspan,10)||1)+1;node.attrs.nolabel="1"}}var widget=new (this.view.registry.get_any([node.attrs.widget,type.type,node.tag]))(this.view,node);if(node.tag=="field"){if(!this.view.default_focus_field||node.attrs.default_focus=="1")this.view.default_focus_field=widget;if(node.attrs.nolabel!="1"){var label=new (this.view.registry.get_object("label"))(this.view,node);label["for"]=widget;this.add_widget(label,
widget.colspan+1)}}this.add_widget(widget)},add_widget:function(widget,colspan){var current_row=this.table[this.table.length-1];if(!widget.always_invisible){colspan=colspan||widget.colspan;if(current_row.length&&this.x+colspan>this.columns)current_row=this.add_row();this.x+=widget.colspan}current_row.push(widget);return widget}});openerp.web.form.WidgetGroup=openerp.web.form.WidgetFrame.extend({template:"WidgetGroup"}),openerp.web.form.WidgetNotebook=openerp.web.form.Widget.extend({template:"WidgetNotebook",
init:function(view,node){this._super(view,node);this.pages=[];for(var i=0;i<node.children.length;i++){var n=node.children[i];if(n.tag=="page"){var page=new (this.view.registry.get_object("notebookpage"))(this.view,n,this,this.pages.length);this.pages.push(page)}}},start:function(){var self=this;this._super.apply(this,arguments);this.$element.find("> ul > li").each(function(index,tab_li){var page=self.pages[index],id=_.uniqueId(self.element_name+"-");page.element_id=id;$(tab_li).find("a").attr("href",
"#"+id)});this.$element.find("> div").each(function(index,page){page.id=self.pages[index].element_id});this.$element.tabs();this.view.on_button_new.add_first(this.do_select_first_visible_tab);if(openerp.connection.debug)this.do_attach_tooltip(this,this.$element.find("ul:first"),{gravity:"s"})},do_select_first_visible_tab:function(){for(var i=0;i<this.pages.length;i++){var page=this.pages[i];if(page.invisible===false){this.$element.tabs("select",page.index);break}}}});openerp.web.form.WidgetNotebookPage=
openerp.web.form.WidgetFrame.extend({template:"WidgetNotebookPage",init:function(view,node,notebook,index){this.notebook=notebook;this.index=index;this.element_name="page_"+index;this._super(view,node)},start:function(){this._super.apply(this,arguments);this.$element_tab=this.notebook.$element.find("> ul > li:eq("+this.index+")")},update_dom:function(){if(this.invisible&&this.index===this.notebook.$element.tabs("option","selected"))this.notebook.do_select_first_visible_tab();this.$element_tab.toggle(!this.invisible);
this.$element.toggle(!this.invisible)}});openerp.web.form.WidgetSeparator=openerp.web.form.Widget.extend({template:"WidgetSeparator",init:function(view,node){this._super(view,node);this.orientation=node.attrs.orientation||"horizontal";if(this.orientation==="vertical")this.width="1";this.classname+="_"+this.orientation}});openerp.web.form.WidgetButton=openerp.web.form.Widget.extend({template:"WidgetButton",init:function(view,node){this._super(view,node);this.force_disabled=false;if(this.string)this.string=
this.string.replace(/_/g,"");if(node.attrs.default_focus=="1")this.view.default_focus_button=this},start:function(){this._super.apply(this,arguments);this.$element.find("button").click(this.on_click);if(this.help||openerp.connection.debug)this.do_attach_tooltip()},on_click:function(){var self=this;this.force_disabled=true;this.check_disable();this.execute_action().always(function(){self.force_disabled=false;self.check_disable()})},execute_action:function(){var self=this;var exec_action=function(){if(self.node.attrs.confirm){var def=
$.Deferred();var dialog=$("<div>"+self.node.attrs.confirm+"</div>").dialog({title:_t("Confirm"),modal:true,buttons:[{text:_t("Cancel"),click:function(){def.resolve();$(this).dialog("close")}},{text:_t("Ok"),click:function(){self.on_confirmed().then(function(){def.resolve()});$(this).dialog("close")}}]});return def.promise()}else return self.on_confirmed()};if(!this.node.attrs.special)return this.view.recursive_save().pipe(exec_action);else return exec_action()},on_confirmed:function(){var self=this;
var context=this.node.attrs.context;if(context&&context.__ref){context=new openerp.web.CompoundContext(context);context.set_eval_context(this._build_eval_context())}return this.view.do_execute_action(_.extend({},this.node.attrs,{context:context}),this.view.dataset,this.view.datarecord.id,function(){self.view.reload()})},update_dom:function(){this._super.apply(this,arguments);this.check_disable()},check_disable:function(){var disabled=this.readonly||this.force_disabled||!this.view.is_interactible_record();
this.$element.find("button").prop("disabled",disabled);this.$element.find("button").css("color",disabled?"grey":"")}});openerp.web.form.WidgetLabel=openerp.web.form.Widget.extend({template:"WidgetLabel",init:function(view,node){this.element_name="label_"+node.attrs.name;this._super(view,node);if(this.node.tag=="label"&&!this.string&&this.node.children.length){this.string=this.node.children[0];this.align="left"}if(this.node.tag=="label"&&(this.align==="left"||this.node.attrs.colspan||this.string&&
this.string.length>32)){this.template="WidgetParagraph";this.colspan=parseInt(this.node.attrs.colspan||1,10);if(isNaN(parseFloat(this.node.attrs.align)))this.align="left";this.multilines=this.string&&_.str.lines(this.string).length>1}else{this.colspan=1;this.width="1%";this.decrease_max_width=1;this.nowrap=true}},render:function(){if(this["for"]&&this.type!=="label")return QWeb.render(this.template,{widget:this["for"]});return QWeb.render(this.template,{widget:this})},start:function(){this._super();
var self=this;if(this["for"]&&(this["for"].help||openerp.connection.debug))this.do_attach_tooltip(self["for"]);this.$element.find("label").dblclick(function(){var widget=self["for"]||self;openerp.log(widget.element_class,widget);window.w=widget})}});openerp.web.form.Field=openerp.web.form.Widget.extend({init:function(view,node){this.name=node.attrs.name;this.value=undefined;view.fields[this.name]=this;view.fields_order.push(this.name);this.type=node.attrs.widget||view.fields_view.fields[node.attrs.name].type;
this.element_name="field_"+this.name+"_"+this.type;this._super(view,node);if(node.attrs.nolabel!="1"&&this.colspan>1)this.colspan--;this.field=view.fields_view.fields[node.attrs.name]||{};this.string=node.attrs.string||this.field.string;this.help=node.attrs.help||this.field.help;this.nolabel=(this.field.nolabel||node.attrs.nolabel)==="1";this.readonly=this.modifiers["readonly"]===true;this.required=this.modifiers["required"]===true;this.invalid=this.dirty=false;this.classname="oe_form_field_"+this.type},
start:function(){this._super.apply(this,arguments);if(this.field.translate){this.view.translatable_fields.push(this);this.$element.addClass("oe_form_field_translatable");this.$element.find(".oe_field_translate").click(this.on_translate)}if(this.nolabel&&openerp.connection.debug)this.do_attach_tooltip(this,this.$element)},set_value:function(value){this.value=value;this.invalid=false;this.update_dom();this.on_value_changed()},set_value_from_ui:function(){this.on_value_changed()},on_value_changed:function(){},
on_translate:function(){this.view.open_translate_dialog(this)},get_value:function(){return this.value},is_valid:function(){return!this.invalid},is_dirty:function(){return this.dirty&&!this.readonly},get_on_change_value:function(){return this.get_value()},update_dom:function(show_invalid){this._super.apply(this,arguments);if(this.field.translate)this.$element.find(".oe_field_translate").toggle(!!this.view.datarecord.id);if(!this.disable_utility_classes){this.$element.toggleClass("disabled",this.readonly);
this.$element.toggleClass("required",this.required);if(show_invalid)this.$element.toggleClass("invalid",!this.is_valid())}},on_ui_change:function(){this.dirty=true;this.validate();if(this.is_valid()){this.set_value_from_ui();this.view.do_onchange(this);this.view.on_form_changed(true);this.view.do_notify_change()}else this.update_dom(true)},validate:function(){this.invalid=false},focus:function($element){if($element)setTimeout(function(){$element.focus()},50)},reset:function(){this.dirty=false},get_definition_options:function(){if(!this.definition_options){var str=
this.node.attrs.options||"{}";this.definition_options=JSON.parse(str)}return this.definition_options}});openerp.web.form.FieldChar=openerp.web.form.Field.extend({template:"FieldChar",init:function(view,node){this._super(view,node);this.password=this.node.attrs.password==="True"||this.node.attrs.password==="1"},start:function(){this._super.apply(this,arguments);this.$element.find("input").change(this.on_ui_change)},set_value:function(value){this._super.apply(this,arguments);var show_value=openerp.web.format_value(value,
this,"");this.$element.find("input").val(show_value);return show_value},update_dom:function(){this._super.apply(this,arguments);this.$element.find("input").prop("readonly",this.readonly)},set_value_from_ui:function(){this.value=openerp.web.parse_value(this.$element.find("input").val(),this);this._super()},validate:function(){this.invalid=false;try{var value=openerp.web.parse_value(this.$element.find("input").val(),this,"");this.invalid=this.required&&value===""}catch(e){this.invalid=true}},focus:function($element){this._super($element||
this.$element.find("input:first"))}});openerp.web.form.FieldID=openerp.web.form.FieldChar.extend({update_dom:function(){this._super.apply(this,arguments);this.$element.find("input").prop("readonly",true)}});openerp.web.form.FieldEmail=openerp.web.form.FieldChar.extend({template:"FieldEmail",start:function(){this._super.apply(this,arguments);this.$element.find("button").click(this.on_button_clicked)},on_button_clicked:function(){if(!this.value||!this.is_valid())this.do_warn("\u90ae\u4ef6\u9519\u8bef",
"\u4e0d\u80fd\u7ed9\u6709\u8bef\u7684\u90ae\u4ef6\u5730\u5740\u53d1\u9001\u90ae\u4ef6");else location.href="mailto:"+this.value}});openerp.web.form.FieldUrl=openerp.web.form.FieldChar.extend({template:"FieldUrl",start:function(){this._super.apply(this,arguments);this.$element.find("button").click(this.on_button_clicked)},on_button_clicked:function(){if(!this.value)this.do_warn("Resource error","This resource is empty");else window.open(this.value)}});openerp.web.form.FieldFloat=openerp.web.form.FieldChar.extend({init:function(view,
node){this._super(view,node);if(node.attrs.digits)this.parse_digits(node.attrs.digits);else this.digits=view.fields_view.fields[node.attrs.name].digits},parse_digits:function(digits_attr){var match=/^\s*[\(\[](\d+),\s*(\d+)/.exec(digits_attr);return[parseInt(match[1],10),parseInt(match[2],10)]},set_value:function(value){if(value===false||value===undefined)value=0;this._super.apply(this,[value])}});openerp.web.DateTimeWidget=openerp.web.OldWidget.extend({template:"web.datetimepicker",jqueryui_object:"datetimepicker",
type_of_date:"datetime",init:function(parent){this._super(parent);this.name=parent.name},start:function(){var self=this;this.$input=this.$element.find("input.oe_datepicker_master");this.$input_picker=this.$element.find("input.oe_datepicker_container");this.$input.change(this.on_change);this.picker({onSelect:this.on_picker_select,changeMonth:true,changeYear:true,showWeek:true,showButtonPanel:true});this.$element.find("img.oe_datepicker_trigger").click(function(){if(!self.readonly&&!self.picker("widget").is(":visible")){self.picker("setDate",
self.value?openerp.web.auto_str_to_date(self.value):new Date);self.$input_picker.show();self.picker("show");self.$input_picker.hide()}});this.set_readonly(false);this.value=false},picker:function(){return $.fn[this.jqueryui_object].apply(this.$input_picker,arguments)},on_picker_select:function(text,instance){var date=this.picker("getDate");this.$input.val(date?this.format_client(date):"").change()},set_value:function(value){this.value=value;this.$input.val(value?this.format_client(value):"")},get_value:function(){return this.value},
set_value_from_ui:function(){var value=this.$input.val()||false;this.value=this.parse_client(value)},set_readonly:function(readonly){this.readonly=readonly;this.$input.prop("readonly",this.readonly);this.$element.find("img.oe_datepicker_trigger").toggleClass("oe_input_icon_disabled",readonly)},is_valid:function(required){var value=this.$input.val();if(value==="")return!required;else try{this.parse_client(value);return true}catch(e){return false}},parse_client:function(v){return openerp.web.parse_value(v,
{"widget":this.type_of_date})},format_client:function(v){return openerp.web.format_value(v,{"widget":this.type_of_date})},on_change:function(){if(this.is_valid())this.set_value_from_ui()}});openerp.web.DateWidget=openerp.web.DateTimeWidget.extend({jqueryui_object:"datepicker",type_of_date:"date"});openerp.web.form.FieldDatetime=openerp.web.form.Field.extend({template:"EmptyComponent",build_widget:function(){return new openerp.web.DateTimeWidget(this)},start:function(){var self=this;this._super.apply(this,
arguments);this.datewidget=this.build_widget();this.datewidget.on_change.add_last(this.on_ui_change);this.datewidget.appendTo(this.$element)},set_value:function(value){this._super(value);this.datewidget.set_value(value)},get_value:function(){return this.datewidget.get_value()},update_dom:function(){this._super.apply(this,arguments);this.datewidget.set_readonly(this.readonly)},validate:function(){this.invalid=!this.datewidget.is_valid(this.required)},focus:function($element){this._super($element||
this.datewidget.$input)}});openerp.web.form.FieldDate=openerp.web.form.FieldDatetime.extend({build_widget:function(){return new openerp.web.DateWidget(this)}});openerp.web.form.FieldText=openerp.web.form.Field.extend({template:"FieldText",start:function(){this._super.apply(this,arguments);this.$element.find("textarea").change(this.on_ui_change);this.resized=false},set_value:function(value){this._super.apply(this,arguments);var show_value=openerp.web.format_value(value,this,"");this.$element.find("textarea").val(show_value);
if(!this.resized&&this.view.options.resize_textareas){this.do_resize(this.view.options.resize_textareas);this.resized=true}},update_dom:function(){this._super.apply(this,arguments);this.$element.find("textarea").prop("readonly",this.readonly)},set_value_from_ui:function(){this.value=openerp.web.parse_value(this.$element.find("textarea").val(),this);this._super()},validate:function(){this.invalid=false;try{var value=openerp.web.parse_value(this.$element.find("textarea").val(),this,"");this.invalid=
this.required&&value===""}catch(e){this.invalid=true}},focus:function($element){this._super($element||this.$element.find("textarea:first"))},do_resize:function(max_height){max_height=parseInt(max_height,10);var $input=this.$element.find("textarea"),$div=$('<div style="position: absolute; z-index: 1000; top: 0"/>').width($input.width()),new_height;$div.text($input.val());_.each("font-family,font-size,white-space".split(","),function(style){$div.css(style,$input.css(style))});$div.appendTo($("body"));
new_height=$div.height();if(new_height<90)new_height=90;if(!isNaN(max_height)&&new_height>max_height)new_height=max_height;$div.remove();$input.height(new_height)},reset:function(){this.resized=false}});openerp.web.form.FieldBoolean=openerp.web.form.Field.extend({template:"FieldBoolean",start:function(){var self=this;this._super.apply(this,arguments);this.$element.find("input").click(self.on_ui_change)},set_value:function(value){this._super.apply(this,arguments);this.$element.find("input")[0].checked=
value},set_value_from_ui:function(){this.value=this.$element.find("input").is(":checked");this._super()},update_dom:function(){this._super.apply(this,arguments);this.$element.find("input").prop("disabled",this.readonly)},focus:function($element){this._super($element||this.$element.find("input:first"))}});openerp.web.form.FieldProgressBar=openerp.web.form.Field.extend({template:"FieldProgressBar",start:function(){this._super.apply(this,arguments);this.$element.find("div").progressbar({value:this.value,
disabled:this.readonly})},set_value:function(value){this._super.apply(this,arguments);var show_value=Number(value);if(isNaN(show_value))show_value=0;var formatted_value=openerp.web.format_value(show_value,{type:"float"},"0");this.$element.find("div").progressbar("option","value",show_value).find("span").html(formatted_value+"%")}});openerp.web.form.FieldTextXml=openerp.web.form.Field.extend({});openerp.web.form.FieldSelection=openerp.web.form.Field.extend({template:"FieldSelection",init:function(view,
node){var self=this;this._super(view,node);this.values=_.clone(this.field.selection);_.each(this.values,function(v,i){if(v[0]===false&&v[1]==="")self.values.splice(i,1)});this.values.unshift([false,""])},start:function(){var ischanging=false;this._super.apply(this,arguments);this.$element.find("select").change(this.on_ui_change).change(function(){ischanging=true}).click(function(){ischanging=false}).keyup(function(e){if(e.which!==13||!ischanging)return;e.stopPropagation();ischanging=false})},set_value:function(value){value=
value===null?false:value;value=value instanceof Array?value[0]:value;this._super(value);var index=0;for(var i=0,ii=this.values.length;i<ii;i++)if(this.values[i][0]===value)index=i;this.$element.find("select")[0].selectedIndex=index},set_value_from_ui:function(){this.value=this.values[this.$element.find("select")[0].selectedIndex][0];this._super()},update_dom:function(){this._super.apply(this,arguments);this.$element.find("select").prop("disabled",this.readonly)},validate:function(){var value=this.values[this.$element.find("select")[0].selectedIndex];
this.invalid=!(value&&!(this.required&&value[0]===false))},focus:function($element){this._super($element||this.$element.find("select:first"))}});(function(){var proto=$.ui.autocomplete.prototype,initSource=proto._initSource;function filter(array,term){var matcher=new RegExp($.ui.autocomplete.escapeRegex(term),"i");return $.grep(array,function(value){return matcher.test($("<div>").html(value.label||value.value||value).text())})}$.extend(proto,{_initSource:function(){if(this.options.html&&$.isArray(this.options.source))this.source=
function(request,response){response(filter(this.options.source,request.term))};else initSource.call(this)},_renderItem:function(ul,item){return $("<li></li>").data("item.autocomplete",item).append($("<a></a>")[this.options.html?"html":"text"](item.label)).appendTo(ul)}})})();openerp.web.form.dialog=function(content,options){options=_.extend({width:"90%",height:"auto",min_width:"800px"},options||{});var dialog=(new openerp.web.Dialog(null,options,content)).open();return dialog.$element};openerp.web.form.FieldMany2One=
openerp.web.form.Field.extend({template:"FieldMany2One",init:function(view,node){this._super(view,node);this.limit=7;this.value=null;this.cm_id=_.uniqueId("m2o_cm_");this.last_search=[];this.tmp_value=undefined},start:function(){this._super();var self=this;this.$input=this.$element.find("input");this.$drop_down=this.$element.find(".oe-m2o-drop-down-button");this.$menu_btn=this.$element.find(".oe-m2o-cm-button");var init_context_menu_def=$.Deferred().then(function(e){var rdataset=new openerp.web.DataSetStatic(self,
"ir.values",self.build_context());rdataset.call("get",["action","client_action_relate",[[self.field.relation,false]],false,rdataset.get_context()],false,0).then(function(result){self.related_entries=result;var $cmenu=$("#"+self.cm_id);$cmenu.append(QWeb.render("FieldMany2One.context_menu",{widget:self}));var bindings={};bindings[self.cm_id+"_search"]=function(){self._search_create_popup("search")};bindings[self.cm_id+"_create"]=function(){self._search_create_popup("form")};bindings[self.cm_id+"_open"]=
function(){if(!self.value)return;var pop=new openerp.web.form.FormOpenPopup(self.view);pop.show_element(self.field.relation,self.value[0],self.build_context(),{title:_t("Open: ")+(self.string||self.name)});pop.on_write_completed.add_last(function(){self.set_value(self.value[0])})};_.each(_.range(self.related_entries.length),function(i){bindings[self.cm_id+"_related_"+i]=function(){self.open_related(self.related_entries[i])}});var cmenu=self.$menu_btn.contextMenu(self.cm_id,{"noRightClick":true,bindings:bindings,
itemStyle:{"color":""},onContextMenu:function(){if(self.value)$("#"+self.cm_id+" .oe_m2o_menu_item_mandatory").removeClass("oe-m2o-disabled-cm");else $("#"+self.cm_id+" .oe_m2o_menu_item_mandatory").addClass("oe-m2o-disabled-cm");if(!self.readonly)$("#"+self.cm_id+" .oe_m2o_menu_item_noreadonly").removeClass("oe-m2o-disabled-cm");else $("#"+self.cm_id+" .oe_m2o_menu_item_noreadonly").addClass("oe-m2o-disabled-cm");return true},menuStyle:{width:"200px"}});$.async_when().then(function(){self.$menu_btn.trigger(e)})})});
var ctx_callback=function(e){init_context_menu_def.resolve(e);e.preventDefault()};this.$menu_btn.click(ctx_callback);this.$input.keyup(function(){if(self.$input.val()==="")self._change_int_value(null);else if(self.value===null||self.value&&self.$input.val()!==self.value[1])self._change_int_value(undefined)});this.$drop_down.click(function(){if(self.readonly)return;if(self.$input.autocomplete("widget").is(":visible"))self.$input.autocomplete("close");else{if(self.value)self.$input.autocomplete("search",
"");else self.$input.autocomplete("search");self.$input.focus()}});var anyoneLoosesFocus=function(){if(!self.$input.is(":focus")&&!self.$input.autocomplete("widget").is(":visible")&&!self.value)if(self.value===undefined&&self.last_search.length>0)self._change_int_ext_value(self.last_search[0]);else self._change_int_ext_value(null)};this.$input.focusout(anyoneLoosesFocus);var isSelecting=false;this.$input.autocomplete({source:function(req,resp){self.get_search_result(req,resp)},select:function(event,
ui){isSelecting=true;var item=ui.item;if(item.id)self._change_int_value([item.id,item.name]);else if(item.action){self._change_int_value(undefined);item.action();return false}},focus:function(e,ui){e.preventDefault()},html:true,close:anyoneLoosesFocus,minLength:0,delay:0});this.$input.keyup(function(e){if(e.which===13)if(isSelecting)e.stopPropagation();isSelecting=false})},get_search_result:function(request,response){var search_val=request.term;var self=this;if(this.abort_last){this.abort_last();
delete this.abort_last}var dataset=new openerp.web.DataSetStatic(this,this.field.relation,self.build_context());dataset.name_search(search_val,self.build_domain(),"ilike",this.limit+1,function(data){self.last_search=data;var values=_.map(data,function(x){return{label:_.str.escapeHTML(x[1]),value:x[1],name:x[1],id:x[0]}});if(values.length>self.limit){values=values.slice(0,self.limit);values.push({label:_t("<em>\u00a0\u00a0\u00a0Search More...</em>"),action:function(){dataset.name_search(search_val,
self.build_domain(),"ilike",false,function(data){self._change_int_value(null);self._search_create_popup("search",data)})}})}var raw_result=_(data.result).map(function(x){return x[1]});if(search_val.length>0&&!_.include(raw_result,search_val)&&(!self.value||search_val!==self.value[1]))values.push({label:_.str.sprintf(_t('<em>\u00a0\u00a0\u00a0Create "<strong>%s</strong>"</em>'),$("<span />").text(search_val).html()),action:function(){self._quick_create(search_val)}});values.push({label:_t("<em>\u00a0\u00a0\u00a0Create and Edit...</em>"),
action:function(){self._change_int_value(null);self._search_create_popup("form",undefined,{"default_name":search_val})}});response(values)});this.abort_last=dataset.abort_last},_quick_create:function(name){var self=this;var slow_create=function(){self._change_int_value(null);self._search_create_popup("form",undefined,{"default_name":name})};if(self.get_definition_options().quick_create===undefined||self.get_definition_options().quick_create){var dataset=new openerp.web.DataSetStatic(this,this.field.relation,
self.build_context());dataset.name_create(name,function(data){self._change_int_ext_value(data)}).fail(function(error,event){event.preventDefault();slow_create()})}else slow_create()},_search_create_popup:function(view,ids,context){var self=this;var pop=new openerp.web.form.SelectCreatePopup(this);pop.select_element(self.field.relation,{title:(view==="search"?_t("Search: "):_t("Create: "))+(this.string||this.name),initial_ids:ids?_.map(ids,function(x){return x[0]}):undefined,initial_view:view,disable_multiple_selection:true},
self.build_domain(),new openerp.web.CompoundContext(self.build_context(),context||{}));pop.on_select_elements.add(function(element_ids){var dataset=new openerp.web.DataSetStatic(self,self.field.relation,self.build_context());dataset.name_get([element_ids[0]],function(data){self._change_int_ext_value(data[0])})})},_change_int_ext_value:function(value){this._change_int_value(value);this.$input.val(this.value?this.value[1]:"")},_change_int_value:function(value){this.value=value;var back_orig_value=this.original_value;
if(this.value===null||this.value)this.original_value=this.value;if(back_orig_value===undefined)return;if(this.value!==undefined&&(back_orig_value?back_orig_value[0]:null)!==(this.value?this.value[0]:null))this.on_ui_change()},set_value:function(value){value=value||null;this.invalid=false;var self=this;this.tmp_value=value;self.update_dom();self.on_value_changed();var real_set_value=function(rval){self.tmp_value=undefined;self.value=rval;self.original_value=undefined;self._change_int_ext_value(rval)};
if(value&&!(value instanceof Array)){var dataset=new openerp.web.DataSetStatic(this,this.field.relation,self.view.dataset.get_context());dataset.name_get([value],function(data){real_set_value(data[0])}).fail(function(){self.tmp_value=undefined})}else $.async_when().then(function(){real_set_value(value)})},get_value:function(){if(this.tmp_value!==undefined){if(this.tmp_value instanceof Array)return this.tmp_value[0];return this.tmp_value?this.tmp_value:false}if(this.value===undefined)return this.original_value?
this.original_value[0]:false;return this.value?this.value[0]:false},validate:function(){this.invalid=false;var val=this.tmp_value!==undefined?this.tmp_value:this.value;if(val===null)this.invalid=this.required},open_related:function(related){var self=this;if(!self.value)return;var additional_context={active_id:self.value[0],active_ids:[self.value[0]],active_model:self.field.relation};self.rpc("/web/action/load",{action_id:related[2].id,context:additional_context},function(result){result.result.context=
_.extend(result.result.context||{},additional_context);self.do_action(result.result)})},focus:function($element){this._super($element||this.$input)},update_dom:function(){this._super.apply(this,arguments);this.$input.prop("readonly",this.readonly)}});var commands={CREATE:0,"create":function(values){return[commands.CREATE,false,values]},UPDATE:1,"update":function(id,values){return[commands.UPDATE,id,values]},DELETE:2,"delete":function(id){return[commands.DELETE,id,false]},FORGET:3,"forget":function(id){return[commands.FORGET,
id,false]},LINK_TO:4,"link_to":function(id){return[commands.LINK_TO,id,false]},DELETE_ALL:5,"delete_all":function(){return[5,false,false]},REPLACE_WITH:6,"replace_with":function(ids){return[6,false,ids]}};openerp.web.form.FieldOne2Many=openerp.web.form.Field.extend({template:"FieldOne2Many",multi_selection:false,init:function(view,node){this._super(view,node);this.is_loaded=$.Deferred();this.initial_is_loaded=this.is_loaded;this.is_setted=$.Deferred();this.form_last_update=$.Deferred();this.init_form_last_update=
this.form_last_update;this.disable_utility_classes=true},start:function(){this._super.apply(this,arguments);var self=this;this.dataset=new openerp.web.form.One2ManyDataSet(this,this.field.relation);this.dataset.o2m=this;this.dataset.parent_view=this.view;this.dataset.child_name=this.name;this.dataset.on_change.add_last(function(){self.trigger_on_change()});this.is_setted.then(function(){self.load_views()})},trigger_on_change:function(){var tmp=this.doing_on_change;this.doing_on_change=true;this.on_ui_change();
this.doing_on_change=tmp},is_readonly:function(){return this.readonly||this.force_readonly},load_views:function(){var self=this;var modes=this.node.attrs.mode;modes=!!modes?modes.split(","):["tree"];var views=[];_.each(modes,function(mode){var view={view_id:false,view_type:mode=="tree"?"list":mode,options:{sidebar:false}};if(self.field.views&&self.field.views[mode])view.embedded_view=self.field.views[mode];if(view.view_type==="list"){view.options.selectable=self.multi_selection;if(self.is_readonly()){view.options.addable=
null;view.options.deletable=null;view.options.isClarkGable=false}}else if(view.view_type==="form"){if(self.is_readonly())view.view_type="page";view.options.not_interactible_on_create=true}views.push(view)});this.views=views;this.viewmanager=new openerp.web.ViewManager(this,this.dataset,views,{});this.viewmanager.template="One2Many.viewmanager";this.viewmanager.registry=openerp.web.views.extend({list:"openerp.web.form.One2ManyListView",form:"openerp.web.form.One2ManyFormView",page:"openerp.web.PageView"});
var once=$.Deferred().then(function(){self.init_form_last_update.resolve()});var def=$.Deferred().then(function(){self.initial_is_loaded.resolve()});this.viewmanager.on_controller_inited.add_last(function(view_type,controller){if(view_type=="list"){controller.o2m=self;if(self.is_readonly())controller.set_editable(false)}else if(view_type=="form"||view_type=="page"){if(view_type=="page"||self.is_readonly())$(".oe_form_buttons",controller.$element).children().remove();controller.on_record_loaded.add_last(function(){once.resolve()});
controller.on_pager_action.add_first(function(){self.save_any_view()})}else if(view_type=="graph")self.reload_current_view();def.resolve()});this.viewmanager.on_mode_switch.add_first(function(n_mode,b,c,d,e){$.when(self.save_any_view()).then(function(){if(n_mode==="list")$.async_when().then(function(){self.reload_current_view()})})});this.is_setted.then(function(){$.async_when().then(function(){self.viewmanager.appendTo(self.$element)})});return def},reload_current_view:function(){var self=this;return self.is_loaded=
self.is_loaded.pipe(function(){var active_view=self.viewmanager.active_view;var view=self.viewmanager.views[active_view].controller;if(active_view==="list")return view.reload_content();else if(active_view==="form"||active_view==="page"){if(self.dataset.index===null&&self.dataset.ids.length>=1)self.dataset.index=0;var act=function(){return view.do_show()};self.form_last_update=self.form_last_update.pipe(act,act);return self.form_last_update}else if(active_view==="graph")return view.do_search(self.build_domain(),
self.dataset.get_context(),[])},undefined)},set_value:function(value){value=value||[];var self=this;this.dataset.reset_ids([]);if(value.length>=1&&value[0]instanceof Array){var ids=[];_.each(value,function(command){var obj={values:command[2]};switch(command[0]){case commands.CREATE:obj["id"]=_.uniqueId(self.dataset.virtual_id_prefix);obj.defaults={};self.dataset.to_create.push(obj);self.dataset.cache.push(_.extend(_.clone(obj),{values:_.clone(command[2])}));ids.push(obj.id);return;case commands.UPDATE:obj["id"]=
command[1];self.dataset.to_write.push(obj);self.dataset.cache.push(_.extend(_.clone(obj),{values:_.clone(command[2])}));ids.push(obj.id);return;case commands.DELETE:self.dataset.to_delete.push({id:command[1]});return;case commands.LINK_TO:ids.push(command[1]);return;case commands.DELETE_ALL:self.dataset.delete_all=true;return}});this._super(ids);this.dataset.set_ids(ids)}else if(value.length>=1&&typeof value[0]==="object"){var ids=[];this.dataset.delete_all=true;_.each(value,function(command){var obj=
{values:command};obj["id"]=_.uniqueId(self.dataset.virtual_id_prefix);obj.defaults={};self.dataset.to_create.push(obj);self.dataset.cache.push(_.clone(obj));ids.push(obj.id)});this._super(ids);this.dataset.set_ids(ids)}else{this._super(value);this.dataset.reset_ids(value)}if(this.dataset.index===null&&this.dataset.ids.length>0)this.dataset.index=0;self.is_setted.resolve();return self.reload_current_view()},get_value:function(){var self=this;if(!this.dataset)return[];this.save_any_view();var val=this.dataset.delete_all?
[commands.delete_all()]:[];val=val.concat(_.map(this.dataset.ids,function(id){var alter_order=_.detect(self.dataset.to_create,function(x){return x.id===id});if(alter_order)return commands.create(alter_order.values);alter_order=_.detect(self.dataset.to_write,function(x){return x.id===id});if(alter_order)return commands.update(alter_order.id,alter_order.values);return commands.link_to(id)}));return val.concat(_.map(this.dataset.to_delete,function(x){return commands["delete"](x.id)}))},save_any_view:function(){if(this.doing_on_change)return false;
return this.session.synchronized_mode(_.bind(function(){if(this.viewmanager&&this.viewmanager.views&&this.viewmanager.active_view&&this.viewmanager.views[this.viewmanager.active_view]&&this.viewmanager.views[this.viewmanager.active_view].controller){var view=this.viewmanager.views[this.viewmanager.active_view].controller;if(this.viewmanager.active_view==="form"){if(!view.is_initialized.isResolved())return false;var res=$.when(view.do_save());if(!res.isResolved()&&!res.isRejected())console.warn("Asynchronous get_value() is not supported in form view.");
return res}else if(this.viewmanager.active_view==="list"){var res=$.when(view.ensure_saved());if(!res.isResolved()&&!res.isRejected())console.warn("Asynchronous get_value() is not supported in list view.");return res}}return false},this))},is_valid:function(){this.validate();return this._super()},validate:function(){this.invalid=false;if(!this.viewmanager.views[this.viewmanager.active_view])return;var view=this.viewmanager.views[this.viewmanager.active_view].controller;if(this.viewmanager.active_view===
"form")for(var f in view.fields){f=view.fields[f];if(!f.is_valid()){this.invalid=true;return}}},is_dirty:function(){this.save_any_view();return this._super()},update_dom:function(){this._super.apply(this,arguments);var self=this;if(this.previous_readonly!==this.readonly){this.previous_readonly=this.readonly;if(this.viewmanager)this.is_loaded=this.is_loaded.pipe(function(){self.viewmanager.stop();return $.when(self.load_views()).then(function(){self.reload_current_view()})})}}});openerp.web.form.One2ManyDataSet=
openerp.web.BufferedDataSet.extend({get_context:function(){this.context=this.o2m.build_context([this.o2m.name]);return this.context}});openerp.web.form.One2ManyListView=openerp.web.ListView.extend({_template:"One2Many.listview",do_add_record:function(){if(this.options.editable)this._super.apply(this,arguments);else{var self=this;var pop=new openerp.web.form.SelectCreatePopup(this);pop.on_default_get.add(self.dataset.on_default_get);pop.select_element(self.o2m.field.relation,{title:_t("Create: ")+
self.name,initial_view:"form",alternative_form_view:self.o2m.field.views?self.o2m.field.views["form"]:undefined,create_function:function(data,callback,error_callback){return self.o2m.dataset.create(data).then(function(r){self.o2m.dataset.set_ids(self.o2m.dataset.ids.concat([r.result]));self.o2m.dataset.on_change()}).then(callback,error_callback)},read_function:function(){return self.o2m.dataset.read_ids.apply(self.o2m.dataset,arguments)},parent_view:self.o2m.view,child_name:self.o2m.name,form_view_options:{"not_interactible_on_create":true}},
self.o2m.build_domain(),self.o2m.build_context());pop.on_select_elements.add_last(function(){self.o2m.reload_current_view()})}},do_activate_record:function(index,id){var self=this;var pop=new openerp.web.form.FormOpenPopup(self.o2m.view);pop.show_element(self.o2m.field.relation,id,self.o2m.build_context(),{title:_t("Open: ")+self.name,auto_write:false,alternative_form_view:self.o2m.field.views?self.o2m.field.views["form"]:undefined,parent_view:self.o2m.view,child_name:self.o2m.name,read_function:function(){return self.o2m.dataset.read_ids.apply(self.o2m.dataset,
arguments)},form_view_options:{"not_interactible_on_create":true},readonly:self.o2m.is_readonly()});pop.on_write.add(function(id,data){self.o2m.dataset.write(id,data,{},function(r){self.o2m.reload_current_view()})})},do_button_action:function(name,id,callback){var self=this;var def=$.Deferred().then(callback).then(function(){self.o2m.view.reload()});return this._super(name,id,_.bind(def.resolve,def))}});openerp.web.form.One2ManyFormView=openerp.web.FormView.extend({form_template:"One2Many.formview",
on_loaded:function(data){this._super(data);var self=this;this.$form_header.find("button.oe_form_button_create").click(function(){self.do_save().then(self.on_button_new)})},do_notify_change:function(){if(this.dataset.parent_view)this.dataset.parent_view.do_notify_change();else this._super.apply(this,arguments)}});openerp.web.form.FieldMany2Many=openerp.web.form.Field.extend({template:"FieldMany2Many",multi_selection:false,init:function(view,node){this._super(view,node);this.list_id=_.uniqueId("many2many");
this.is_loaded=$.Deferred();this.initial_is_loaded=this.is_loaded;this.is_setted=$.Deferred()},start:function(){this._super.apply(this,arguments);var self=this;this.dataset=new openerp.web.form.Many2ManyDataSet(this,this.field.relation);this.dataset.m2m=this;this.dataset.on_unlink.add_last(function(ids){self.on_ui_change()});this.is_setted.then(function(){self.load_view()})},set_value:function(value){value=value||[];if(value.length>=1&&value[0]instanceof Array)value=value[0][2];this._super(value);
this.dataset.set_ids(value);var self=this;self.reload_content();this.is_setted.resolve()},get_value:function(){return[commands.replace_with(this.dataset.ids)]},validate:function(){this.invalid=false},is_readonly:function(){return this.readonly||this.force_readonly},load_view:function(){var self=this;this.list_view=new openerp.web.form.Many2ManyListView(this,this.dataset,false,{"addable":self.is_readonly()?null:_t("Add"),"deletable":self.is_readonly()?false:true,"selectable":self.multi_selection,"isClarkGable":self.is_readonly()?
false:true});var embedded=(this.field.views||{}).tree;if(embedded)this.list_view.set_embedded_view(embedded);this.list_view.m2m_field=this;var loaded=$.Deferred();this.list_view.on_loaded.add_last(function(){self.initial_is_loaded.resolve();loaded.resolve()});$.async_when().then(function(){self.list_view.appendTo($("#"+self.list_id))});return loaded},reload_content:function(){var self=this;this.is_loaded=this.is_loaded.pipe(function(){return self.list_view.reload_content()})},update_dom:function(){this._super.apply(this,
arguments);var self=this;if(this.previous_readonly!==this.readonly){this.previous_readonly=this.readonly;if(this.list_view)this.is_loaded=this.is_loaded.pipe(function(){self.list_view.stop();return $.when(self.load_view()).then(function(){self.reload_content()})})}}});openerp.web.form.Many2ManyDataSet=openerp.web.DataSetStatic.extend({get_context:function(){this.context=this.m2m.build_context();return this.context}});openerp.web.form.Many2ManyListView=openerp.web.ListView.extend({do_add_record:function(){var pop=
new openerp.web.form.SelectCreatePopup(this);pop.select_element(this.model,{title:_t("Add: ")+this.name},new openerp.web.CompoundDomain(this.m2m_field.build_domain(),["!",["id","in",this.m2m_field.dataset.ids]]),this.m2m_field.build_context());var self=this;pop.on_select_elements.add(function(element_ids){_.each(element_ids,function(element_id){if(!_.detect(self.dataset.ids,function(x){return x==element_id})){self.dataset.set_ids([].concat(self.dataset.ids,[element_id]));self.m2m_field.on_ui_change();
self.reload_content()}})})},do_activate_record:function(index,id){var self=this;var pop=new openerp.web.form.FormOpenPopup(this);pop.show_element(this.dataset.model,id,this.m2m_field.build_context(),{title:_t("Open: ")+this.name,readonly:this.widget_parent.is_readonly()});pop.on_write_completed.add_last(function(){self.reload_content()})}});openerp.web.form.SelectCreatePopup=openerp.web.OldWidget.extend({template:"SelectCreatePopup",select_element:function(model,options,domain,context){var self=this;
this.model=model;this.domain=domain||[];this.context=context||{};this.options=_.defaults(options||{},{"initial_view":"search","create_function":function(){return self.create_row.apply(self,arguments)},read_function:null});this.initial_ids=this.options.initial_ids;this.created_elements=[];this.render_element();openerp.web.form.dialog(this.$element,{close:function(){self.check_exit()},title:options.title||""});this.start()},start:function(){this._super();var self=this;this.dataset=new openerp.web.ProxyDataSet(this,
this.model,this.context);this.dataset.create_function=function(){return self.options.create_function.apply(null,arguments).then(function(r){self.created_elements.push(r.result)})};this.dataset.write_function=function(){return self.write_row.apply(self,arguments)};this.dataset.read_function=this.options.read_function;this.dataset.parent_view=this.options.parent_view;this.dataset.child_name=this.options.child_name;this.dataset.on_default_get.add(this.on_default_get);if(this.options.initial_view=="search")self.rpc("/web/session/eval_domain_and_context",
{domains:[],contexts:[this.context]},function(results){var search_defaults={};_.each(results.context,function(value,key){var match=/^search_default_(.*)$/.exec(key);if(match)search_defaults[match[1]]=value});self.setup_search_view(search_defaults)});else this.new_object()},setup_search_view:function(search_defaults){var self=this;if(this.searchview)this.searchview.stop();this.searchview=new openerp.web.SearchView(this,this.dataset,false,search_defaults);this.searchview.on_search.add(function(domains,
contexts,groupbys){if(self.initial_ids){self.do_search(domains.concat([[["id","in",self.initial_ids]],self.domain]),contexts,groupbys);self.initial_ids=undefined}else self.do_search(domains.concat([self.domain]),contexts.concat(self.context),groupbys)});this.searchview.on_loaded.add_last(function(){self.view_list=new openerp.web.form.SelectCreateListView(self,self.dataset,false,_.extend({"deletable":false,"selectable":!self.options.disable_multiple_selection},self.options.list_view_options||{}));
self.view_list.popup=self;self.view_list.appendTo($("#"+self.element_id+"_view_list")).pipe(function(){self.view_list.do_show()}).pipe(function(){self.searchview.do_search()});self.view_list.on_loaded.add_last(function(){var $buttons=self.view_list.$element.find(".oe-actions");$buttons.prepend(QWeb.render("SelectCreatePopup.search.buttons"));var $cbutton=$buttons.find(".oe_selectcreatepopup-search-close");$cbutton.click(function(){self.stop()});var $sbutton=$buttons.find(".oe_selectcreatepopup-search-select");
if(self.options.disable_multiple_selection)$sbutton.hide();$sbutton.click(function(){self.on_select_elements(self.selected_ids);self.stop()})})});this.searchview.appendTo($("#"+this.element_id+"_search"))},do_search:function(domains,contexts,groupbys){var self=this;this.rpc("/web/session/eval_domain_and_context",{domains:domains||[],contexts:contexts||[],group_by_seq:groupbys||[]},function(results){self.view_list.do_search(results.domain,results.context,results.group_by)})},create_row:function(){var self=
this;var wdataset=new openerp.web.DataSetSearch(this,this.model,this.context,this.domain);wdataset.parent_view=this.options.parent_view;wdataset.child_name=this.options.child_name;return wdataset.create.apply(wdataset,arguments)},write_row:function(){var self=this;var wdataset=new openerp.web.DataSetSearch(this,this.model,this.context,this.domain);wdataset.parent_view=this.options.parent_view;wdataset.child_name=this.options.child_name;return wdataset.write.apply(wdataset,arguments)},on_select_elements:function(element_ids){},
on_click_element:function(ids){this.selected_ids=ids||[];if(this.selected_ids.length>0)this.$element.find(".oe_selectcreatepopup-search-select").removeAttr("disabled");else this.$element.find(".oe_selectcreatepopup-search-select").attr("disabled","disabled")},new_object:function(){var self=this;if(this.searchview)this.searchview.hide();if(this.view_list)this.view_list.$element.hide();this.dataset.index=null;this.view_form=new openerp.web.FormView(this,this.dataset,false,self.options.form_view_options);
if(this.options.alternative_form_view)this.view_form.set_embedded_view(this.options.alternative_form_view);this.view_form.appendTo(this.$element.find("#"+this.element_id+"_view_form"));this.view_form.on_loaded.add_last(function(){var $buttons=self.view_form.$element.find(".oe_form_buttons");$buttons.html(QWeb.render("SelectCreatePopup.form.buttons",{widget:self}));var $nbutton=$buttons.find(".oe_selectcreatepopup-form-save-new");$nbutton.click(function(){$.when(self.view_form.do_save()).then(function(){self.view_form.reload_mutex.exec(function(){self.view_form.on_button_new()})})});
var $nbutton=$buttons.find(".oe_selectcreatepopup-form-save");$nbutton.click(function(){$.when(self.view_form.do_save()).then(function(){self.view_form.reload_mutex.exec(function(){self.check_exit()})})});var $cbutton=$buttons.find(".oe_selectcreatepopup-form-close");$cbutton.click(function(){self.check_exit()})});this.view_form.do_show()},check_exit:function(){if(this.created_elements.length>0)this.on_select_elements(this.created_elements);this.stop()},on_default_get:function(res){}});openerp.web.form.SelectCreateListView=
openerp.web.ListView.extend({do_add_record:function(){this.popup.new_object()},select_record:function(index){this.popup.on_select_elements([this.dataset.ids[index]]);this.popup.stop()},do_select:function(ids,records){this._super(ids,records);this.popup.on_click_element(ids)}});openerp.web.form.FormOpenPopup=openerp.web.OldWidget.extend({template:"FormOpenPopup",show_element:function(model,row_id,context,options){this.model=model;this.row_id=row_id;this.context=context||{};this.options=_.defaults(options||
{},{"auto_write":true});this.render_element();this.$element.dialog({title:options.title||"",modal:true,width:960,height:600});this.start()},start:function(){this._super();this.dataset=new openerp.web.form.FormOpenDataset(this,this.model,this.context);this.dataset.fop=this;this.dataset.ids=[this.row_id];this.dataset.index=0;this.dataset.parent_view=this.options.parent_view;this.dataset.child_name=this.options.child_name;this.setup_form_view()},on_write:function(id,data){if(!this.options.auto_write)return;
var self=this;var wdataset=new openerp.web.DataSetSearch(this,this.model,this.context,this.domain);wdataset.parent_view=this.options.parent_view;wdataset.child_name=this.options.child_name;wdataset.write(id,data,{},function(r){self.on_write_completed()})},on_write_completed:function(){},setup_form_view:function(){var self=this;var FormClass=this.options.readonly?openerp.web.views.get_object("page"):openerp.web.views.get_object("form");this.view_form=new FormClass(this,this.dataset,false,self.options.form_view_options);
if(this.options.alternative_form_view)this.view_form.set_embedded_view(this.options.alternative_form_view);this.view_form.appendTo(this.$element.find("#"+this.element_id+"_view_form"));this.view_form.on_loaded.add_last(function(){var $buttons=self.view_form.$element.find(".oe_form_buttons");$buttons.html(QWeb.render("FormOpenPopup.form.buttons"));var $nbutton=$buttons.find(".oe_formopenpopup-form-save");$nbutton.click(function(){self.view_form.do_save().then(function(){self.stop()})});var $cbutton=
$buttons.find(".oe_formopenpopup-form-close");$cbutton.click(function(){self.stop()});if(self.options.readonly){$nbutton.hide();$cbutton.text(_t("Close"))}self.view_form.do_show()});this.dataset.on_write.add(this.on_write)}});openerp.web.form.FormOpenDataset=openerp.web.ProxyDataSet.extend({read_ids:function(){if(this.fop.options.read_function)return this.fop.options.read_function.apply(null,arguments);else return this._super.apply(this,arguments)}});openerp.web.form.FieldReference=openerp.web.form.Field.extend({template:"FieldReference",
init:function(view,node){this._super(view,node);this.fields_view={fields:{selection:{selection:view.fields_view.fields[this.name].selection},m2o:{relation:null}}};this.get_fields_values=view.get_fields_values;this.get_selected_ids=view.get_selected_ids;this.do_onchange=this.on_form_changed=this.do_notify_change=this.on_nop;this.dataset=this.view.dataset;this.widgets_counter=0;this.view_id="reference_"+_.uniqueId();this.widgets={};this.fields={};this.fields_order=[];this.selection=new openerp.web.form.FieldSelection(this,
{attrs:{name:"selection",widget:"selection"}});this.reference_ready=true;this.selection.on_value_changed.add_last(this.on_selection_changed);this.m2o=new openerp.web.form.FieldMany2One(this,{attrs:{name:"m2o",widget:"many2one"}});this.m2o.on_ui_change.add_last(this.on_ui_change)},on_nop:function(){},on_selection_changed:function(){if(this.reference_ready){var sel=this.selection.get_value();this.m2o.field.relation=sel;this.m2o.set_value(null);this.m2o.$element.toggle(sel!==false)}},start:function(){this._super();
this.selection.start();this.m2o.start()},is_valid:function(){return this.required===false||typeof this.get_value()==="string"},is_dirty:function(){return this.selection.is_dirty()||this.m2o.is_dirty()},set_value:function(value){this._super(value);this.reference_ready=false;var vals=[],sel_val,m2o_val;if(typeof value==="string")vals=value.split(",");sel_val=vals[0]||false;m2o_val=vals[1]?parseInt(vals[1],10):false;this.selection.set_value(sel_val);this.m2o.field.relation=sel_val;this.m2o.set_value(m2o_val);
this.m2o.$element.toggle(sel_val!==false);this.reference_ready=true},get_value:function(){var model=this.selection.get_value(),id=this.m2o.get_value();if(typeof model==="string"&&typeof id==="number")return model+","+id;else return false}});openerp.web.form.FieldBinary=openerp.web.form.Field.extend({init:function(view,node){this._super(view,node);this.iframe=this.element_id+"_iframe";this.binary_value=false},start:function(){this._super.apply(this,arguments);this.$element.find("input.oe-binary-file").change(this.on_file_change);
this.$element.find("button.oe-binary-file-save").click(this.on_save_as);this.$element.find(".oe-binary-file-clear").click(this.on_clear)},human_filesize:function(size){var units=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];var i=0;while(size>=1024){size/=1024;++i}return size.toFixed(2)+" "+units[i]},on_file_change:function(e){window[this.iframe]=this.on_file_uploaded;if($(e.target).val()!=""){this.$element.find("form.oe-binary-form input[name=session_id]").val(this.session.session_id);this.$element.find("form.oe-binary-form").submit();
this.$element.find(".oe-binary-progress").show();this.$element.find(".oe-binary").hide()}},on_file_uploaded:function(size,name,content_type,file_base64){delete window[this.iframe];if(size===false){this.do_warn("File Upload","There was a problem while uploading your file");console.warn("Error while uploading file : ",name)}else{this.on_file_uploaded_and_valid.apply(this,arguments);this.on_ui_change()}this.$element.find(".oe-binary-progress").hide();this.$element.find(".oe-binary").show()},on_file_uploaded_and_valid:function(size,
name,content_type,file_base64){},on_save_as:function(){$.blockUI();this.session.get_file({url:"/web/binary/saveas_ajax",data:{data:JSON.stringify({model:this.view.dataset.model,id:this.view.datarecord.id||"",field:this.name,filename_field:this.node.attrs.filename||"",context:this.view.dataset.get_context()})},complete:$.unblockUI,error:openerp.webclient.crashmanager.on_rpc_error})},on_clear:function(){if(this.value!==false){this.value=false;this.binary_value=false;this.on_ui_change()}return false}});
openerp.web.form.FieldBinaryFile=openerp.web.form.FieldBinary.extend({template:"FieldBinaryFile",update_dom:function(){this._super.apply(this,arguments);this.$element.find(".oe-binary-file-set, .oe-binary-file-clear").toggle(!this.readonly);this.$element.find("input[type=text]").prop("readonly",this.readonly)},set_value:function(value){this._super.apply(this,arguments);var show_value;if(this.node.attrs.filename)show_value=this.view.datarecord[this.node.attrs.filename]||"";else show_value=value!=null&&
value!==false?value:"";this.$element.find("input").eq(0).val(show_value)},on_file_uploaded_and_valid:function(size,name,content_type,file_base64){this.value=file_base64;this.binary_value=true;var show_value=name+" ("+this.human_filesize(size)+")";this.$element.find("input").eq(0).val(show_value);this.set_filename(name)},set_filename:function(value){var filename=this.node.attrs.filename;if(this.view.fields[filename]){this.view.fields[filename].set_value(value);this.view.fields[filename].on_ui_change()}},
on_clear:function(){this._super.apply(this,arguments);this.$element.find("input").eq(0).val("");this.set_filename("")}});openerp.web.form.FieldBinaryImage=openerp.web.form.FieldBinary.extend({template:"FieldBinaryImage",start:function(){this._super.apply(this,arguments);this.$image=this.$element.find("img.oe-binary-image")},update_dom:function(){this._super.apply(this,arguments);this.$element.find(".oe-binary").toggle(!this.readonly)},set_value:function(value){this._super.apply(this,arguments);this.set_image_maxwidth();
var url="/web/binary/image?session_id="+this.session.session_id+"&model="+this.view.dataset.model+"&id="+(this.view.datarecord.id||"")+"&field="+this.name+"&t="+(new Date).getTime();this.$image.attr("src",url)},set_image_maxwidth:function(){this.$image.css("max-width",this.$element.width())},on_file_change:function(){this.set_image_maxwidth();this._super.apply(this,arguments)},on_file_uploaded_and_valid:function(size,name,content_type,file_base64){this.value=file_base64;this.binary_value=true;this.$image.attr("src",
"data:"+(content_type||"image/png")+";base64,"+file_base64)},on_clear:function(){this._super.apply(this,arguments);this.$image.attr("src","/web/static/src/img/placeholder.png")}});openerp.web.form.FieldStatus=openerp.web.form.Field.extend({template:"EmptyComponent",start:function(){this._super();this.selected_value=null;this.render_list()},set_value:function(value){this._super(value);this.selected_value=value;this.render_list()},render_list:function(){var self=this;var shown=_.map(((this.node.attrs||
{}).statusbar_visible||"").split(","),function(x){return _.str.trim(x)});shown=_.select(shown,function(x){return x.length>0});if(shown.length==0)this.to_show=this.field.selection;else this.to_show=_.select(this.field.selection,function(x){return _.indexOf(shown,x[0])!==-1||x[0]===self.selected_value});var content=openerp.web.qweb.render("FieldStatus.content",{widget:this,_:_});this.$element.html(content);var colors=JSON.parse((this.node.attrs||{}).statusbar_colors||"{}");var color=colors[this.selected_value];
if(color){var elem=this.$element.find("li.oe-arrow-list-selected span");elem.css("border-color",color);if(this.check_white(color))elem.css("color","white");elem=this.$element.find("li.oe-arrow-list-selected .oe-arrow-list-before");elem.css("border-left-color","rgba(0,0,0,0)");elem=this.$element.find("li.oe-arrow-list-selected .oe-arrow-list-after");elem.css("border-color","rgba(0,0,0,0)");elem.css("border-left-color",color)}},check_white:function(color){var div=$("<div></div>");div.css("display",
"none");div.css("color",color);div.appendTo($("body"));var ncolor=div.css("color");div.remove();var res=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/.exec(ncolor);if(!res)return false;var comps=[parseInt(res[1]),parseInt(res[2]),parseInt(res[3])];var lum=comps[0]*0.3+comps[1]*0.59+comps[1]*0.11;if(lum<128)return true;return false}});openerp.web.form.WidgetHtml=openerp.web.form.Widget.extend({render:function(){var $root=$('<div class="oe_form_html_view">');this.render_children(this,$root);
return $root.html()},render_children:function(object,$into){var self=this,fields=this.view.fields_view.fields;_(object.children).each(function(child){if(typeof child==="string")$into.text(child);else if(child.tag==="field")$into.append((new (self.view.registry.get_object("frame"))(self.view,{tag:"ueule",attrs:{},children:[child]})).render());else{var $child=$(document.createElement(child.tag)).attr(child.attrs).appendTo($into);self.render_children(child,$child)}})}});openerp.web.form.widgets=new openerp.web.Registry({"frame":"openerp.web.form.WidgetFrame",
"group":"openerp.web.form.WidgetGroup","notebook":"openerp.web.form.WidgetNotebook","notebookpage":"openerp.web.form.WidgetNotebookPage","separator":"openerp.web.form.WidgetSeparator","label":"openerp.web.form.WidgetLabel","button":"openerp.web.form.WidgetButton","char":"openerp.web.form.FieldChar","id":"openerp.web.form.FieldID","email":"openerp.web.form.FieldEmail","url":"openerp.web.form.FieldUrl","text":"openerp.web.form.FieldText","date":"openerp.web.form.FieldDate","datetime":"openerp.web.form.FieldDatetime",
"selection":"openerp.web.form.FieldSelection","many2one":"openerp.web.form.FieldMany2One","many2many":"openerp.web.form.FieldMany2Many","one2many":"openerp.web.form.FieldOne2Many","one2many_list":"openerp.web.form.FieldOne2Many","reference":"openerp.web.form.FieldReference","boolean":"openerp.web.form.FieldBoolean","float":"openerp.web.form.FieldFloat","integer":"openerp.web.form.FieldFloat","float_time":"openerp.web.form.FieldFloat","progressbar":"openerp.web.form.FieldProgressBar","image":"openerp.web.form.FieldBinaryImage",
"binary":"openerp.web.form.FieldBinaryFile","statusbar":"openerp.web.form.FieldStatus","html":"openerp.web.form.WidgetHtml"})};
openerp.web.page=function(openerp){var _t=openerp.web._t,_lt=openerp.web._lt;openerp.web.views.add("page","openerp.web.PageView");openerp.web.PageView=openerp.web.FormView.extend({form_template:"PageView",display_name:_lt("Page"),init:function(){this._super.apply(this,arguments);this.registry=openerp.web.page.readonly},reload:function(){if(this.dataset.index==null){this.do_prev_view();return $.Deferred().reject().promise()}return this._super()},on_loaded:function(data){this._super(data);this.$form_header.find("button.oe_form_button_edit").click(this.on_button_edit);
this.$form_header.find("button.oe_form_button_create").click(this.on_button_create);this.$form_header.find("button.oe_form_button_duplicate").click(this.on_button_duplicate);this.$form_header.find("button.oe_form_button_delete").click(this.on_button_delete)},on_button_edit:function(){return this.do_switch_view("form")},on_button_create:function(){this.dataset.index=null;return this.do_switch_view("form")},on_button_duplicate:function(){var self=this;var def=$.Deferred();$.when(this.has_been_loaded).then(function(){self.dataset.call("copy",
[self.datarecord.id,{},self.dataset.context]).then(function(new_id){return self.on_created({result:new_id})}).then(function(){return self.do_switch_view("form")}).then(function(){def.resolve()})});return def.promise()},on_button_delete:function(){var self=this;var def=$.Deferred();$.when(this.has_been_loaded).then(function(){if(self.datarecord.id&&confirm(_t("Do you really want to delete this record?")))self.dataset.unlink([self.datarecord.id]).then(function(){self.on_pager_action("next");def.resolve()});
else $.async_when().then(function(){def.reject()})});return def.promise()}});openerp.web.page={};openerp.web.page.WidgetFrameReadonly=openerp.web.form.WidgetFrame.extend({template:"WidgetFrame.readonly"});openerp.web.page.FieldReadonly=openerp.web.form.Field.extend({});openerp.web.page.FieldCharReadonly=openerp.web.page.FieldReadonly.extend({template:"FieldChar.readonly",init:function(view,node){this._super(view,node);this.password=this.node.attrs.password==="True"||this.node.attrs.password==="1"},
set_value:function(value){this._super.apply(this,arguments);var show_value=openerp.web.format_value(value,this,"");if(this.password)show_value=(new Array(show_value.length+1)).join("*");this.$element.find("div").text(show_value);return show_value}});openerp.web.page.FieldURIReadonly=openerp.web.page.FieldCharReadonly.extend({template:"FieldURI.readonly",scheme:null,format_value:function(value){return value},set_value:function(value){this.$element.find("a").attr("href",this.scheme+":"+value).text(this.format_value(value))}});
openerp.web.page.FieldEmailReadonly=openerp.web.page.FieldURIReadonly.extend({scheme:"mailto"});openerp.web.page.FieldUrlReadonly=openerp.web.page.FieldURIReadonly.extend({set_value:function(value){var s=/(\w+):(.+)/.exec(value);if(!s)value="http://"+value;this.$element.find("a").attr("href",value).text(value)}});openerp.web.page.FieldBooleanReadonly=openerp.web.form.FieldBoolean.extend({update_dom:function(){this._super.apply(this,arguments);this.$element.find("input").prop("disabled",true)}});openerp.web.page.FieldSelectionReadonly=
openerp.web.page.FieldReadonly.extend({template:"FieldChar.readonly",init:function(view,node){var self=this;this._super(view,node);this.values=_.clone(this.field.selection);_.each(this.values,function(v,i){if(v[0]===false&&v[1]==="")self.values.splice(i,1)});this.values.unshift([false,""])},set_value:function(value){value=value===null?false:value;value=value instanceof Array?value[0]:value;var option=_(this.values).detect(function(record){return record[0]===value});this._super(value);this.$element.find("div").text(option?
option[1]:this.values[0][1])}});openerp.web.page.FieldMany2OneReadonly=openerp.web.page.FieldURIReadonly.extend({set_value:function(value){value=value||null;this.invalid=false;var self=this;this.value=value;self.update_dom();self.on_value_changed();var real_set_value=function(rval){self.value=rval;self.$element.find("a").unbind("click").text(rval?rval[1]:"").click(function(){self.do_action({type:"ir.actions.act_window",res_model:self.field.relation,res_id:self.value[0],context:self.build_context(),
views:[[false,"page"],[false,"form"]],target:"current"});return false})};if(value&&!(value instanceof Array))(new openerp.web.DataSetStatic(this,this.field.relation,self.build_context())).name_get([value],function(data){real_set_value(data[0])});else $.async_when().then(function(){real_set_value(value)})},get_value:function(){if(!this.value)return false;else if(this.value instanceof Array)return this.value[0];else return this.value}});openerp.web.page.FieldReferenceReadonly=openerp.web.page.FieldMany2OneReadonly.extend({set_value:function(value){if(!value)return this._super(null);
var reference=value.split(",");this.field.relation=reference[0];var id=parseInt(reference[1],10);return this._super(id)},get_value:function(){if(!this.value)return null;var id;if(typeof this.value==="number")id=this.value;else id=this.value[0];return _.str.sprintf("%s,%d",this.field.relation,id)}});openerp.web.page.FieldMany2ManyReadonly=openerp.web.form.FieldMany2Many.extend({force_readonly:true});openerp.web.page.FieldOne2ManyReadonly=openerp.web.form.FieldOne2Many.extend({force_readonly:true});
openerp.web.page.FieldBinaryImageReaonly=openerp.web.form.FieldBinaryImage.extend({update_dom:function(){this._super.apply(this,arguments);this.$element.find(".oe-binary").hide()}});openerp.web.page.FieldBinaryFileReadonly=openerp.web.form.FieldBinary.extend({template:"FieldURI.readonly",start:function(){this._super.apply(this,arguments);var self=this;this.$element.find("a").click(function(){if(self.value)self.on_save_as();return false})},set_value:function(value){this._super.apply(this,arguments);
this.$element.find("a").show(!!value);if(value){var show_value=_t("Download")+" "+(this.view.datarecord[this.node.attrs.filename]||"");this.$element.find("a").text(show_value)}}});openerp.web.page.readonly=openerp.web.form.widgets.extend({"frame":"openerp.web.page.WidgetFrameReadonly","char":"openerp.web.page.FieldCharReadonly","id":"openerp.web.page.FieldCharReadonly","email":"openerp.web.page.FieldEmailReadonly","url":"openerp.web.page.FieldUrlReadonly","text":"openerp.web.page.FieldCharReadonly",
"date":"openerp.web.page.FieldCharReadonly","datetime":"openerp.web.page.FieldCharReadonly","selection":"openerp.web.page.FieldSelectionReadonly","many2one":"openerp.web.page.FieldMany2OneReadonly","many2many":"openerp.web.page.FieldMany2ManyReadonly","one2many":"openerp.web.page.FieldOne2ManyReadonly","one2many_list":"openerp.web.page.FieldOne2ManyReadonly","reference":"openerp.web.page.FieldReferenceReadonly","boolean":"openerp.web.page.FieldBooleanReadonly","float":"openerp.web.page.FieldCharReadonly",
"integer":"openerp.web.page.FieldCharReadonly","float_time":"openerp.web.page.FieldCharReadonly","binary":"openerp.web.page.FieldBinaryFileReadonly","image":"openerp.web.page.FieldBinaryImageReaonly"})};
openerp.web.list=function(openerp){var _t=openerp.web._t,_lt=openerp.web._lt;var QWeb=openerp.web.qweb;openerp.web.views.add("list","openerp.web.ListView");openerp.web.ListView=openerp.web.View.extend({_template:"ListView",display_name:_lt("List"),defaults:{"selectable":true,"deletable":true,"header":true,"addable":_lt("Create"),"sortable":true,"reorderable":true,"isClarkGable":true},init:function(parent,dataset,view_id,options){var self=this;this._super(parent);this.set_default_options(_.extend({},
this.defaults,options||{}));this.dataset=dataset;this.model=dataset.model;this.view_id=view_id;this.previous_colspan=null;this.colors=null;this.columns=[];this.records=new Collection;this.set_groups(new openerp.web.ListView.Groups(this));if(this.dataset instanceof openerp.web.DataSetStatic)this.groups.datagroup=new openerp.web.StaticDataGroup(this.dataset);else{this.groups.datagroup=new openerp.web.DataGroup(this,this.model,dataset.get_domain(),dataset.get_context(),{});this.groups.datagroup.sort=
this.dataset._sort}this.page=0;this.records.bind("change",function(event,record,key){if(!_(self.aggregate_columns).chain().pluck("name").contains(key).value())return;self.compute_aggregates()});this.no_leaf=false},limit:function(){if(this._limit===undefined)this._limit=this.options.limit||this.defaults.limit||(this.widget_parent.action||{}).limit||80;return this._limit},set_groups:function(groups){var self=this;if(this.groups){$(this.groups).unbind("selected deleted action row_link");delete this.groups}this.groups=
groups;$(this.groups).bind({"selected":function(e,ids,records){self.do_select(ids,records)},"deleted":function(e,ids){self.do_delete(ids)},"action":function(e,action_name,id,callback){self.do_button_action(action_name,id,callback)},"row_link":function(e,id,dataset,view){self.do_activate_record(dataset.index,id,dataset,view)}})},start:function(){this._super();this.$element.addClass("oe-listview");return this.reload_view(null,null,true)},color_for:function(record){if(!this.colors)return"";var context=
_.extend({},record.attributes,{uid:this.session.uid,current_date:(new Date).toString("yyyy-MM-dd")});for(var i=0,len=this.colors.length;i<len;++i){var pair=this.colors[i],color=pair[0],expression=pair[1];if(py.evaluate(expression,_.extend({bool:py.bool},context)))return"color: "+color+";"}return""},on_loaded:function(data,grouped){var self=this;this.fields_view=data;this.name=""+this.fields_view.arch.attrs.string;if(this.fields_view.arch.attrs.colors)this.colors=_(this.fields_view.arch.attrs.colors.split(";")).chain().compact().map(function(color_pair){var pair=
color_pair.split(":"),color=pair[0],expr=pair[1];return[color,py.parse(py.tokenize(expr)),expr]}).value();this.setup_columns(this.fields_view.fields,grouped);this.$element.html(QWeb.render(this._template,this));this.$element.find(".all-record-selector").click(function(){self.$element.find(".oe-record-selector input").prop("checked",self.$element.find(".all-record-selector").prop("checked")||false);var selection=self.groups.get_selection();$(self.groups).trigger("selected",[selection.ids,selection.records])});
this.$element.find(".oe-list-add").click(this.proxy("do_add_record")).attr("disabled",grouped&&this.options.editable);this.$element.find(".oe-list-delete").attr("disabled",true).click(this.proxy("do_delete_selected"));this.$element.find("thead").delegate("th.oe-sortable[data-id]","click",function(e){e.stopPropagation();var $this=$(this);self.dataset.sort($this.data("id"));if($this.find("span").length)$this.find("span").toggleClass("ui-icon-triangle-1-s ui-icon-triangle-1-n");else $this.append('<span class="ui-icon ui-icon-triangle-1-n">').siblings(".oe-sortable").find("span").remove();
self.reload_content()});this.$element.find(".oe-list-pager").delegate("button","click",function(){var $this=$(this);switch($this.data("pager-action")){case "first":self.page=0;break;case "last":self.page=Math.floor(self.dataset.size()/self.limit());break;case "next":self.page+=1;break;case "previous":self.page-=1;break}self.reload_content()}).find(".oe-pager-state").click(function(e){e.stopPropagation();var $this=$(this);var $select=$("<select>").appendTo($this.empty()).click(function(e){e.stopPropagation()}).append('<option value="80">80</option>'+
'<option value="100">100</option>'+'<option value="200">200</option>'+'<option value="500">500</option>'+'<option value="NaN">'+_t("Unlimited")+"</option>").change(function(){var val=parseInt($select.val(),10);self._limit=isNaN(val)?null:val;self.page=0;self.reload_content()}).val(self._limit||"NaN")});if(!this.sidebar&&this.options.sidebar&&this.options.sidebar_id){this.sidebar=new openerp.web.Sidebar(this,this.options.sidebar_id);this.sidebar.start();this.sidebar.add_toolbar(this.fields_view.toolbar);
this.set_common_sidebar_sections(this.sidebar)}},configure_pager:function(dataset){this.dataset.ids=dataset.ids;var limit=this.limit(),total=dataset.size(),first=this.page*limit,last;if(!limit||total-first<limit)last=total;else last=first+limit;this.$element.find("span.oe-pager-state").empty().text(_.str.sprintf(_t("[%(first_record)d to %(last_record)d] of %(records_count)d"),{first_record:first+1,last_record:last,records_count:total}));this.$element.find("button[data-pager-action=first], button[data-pager-action=previous]").attr("disabled",
this.page===0).end().find("button[data-pager-action=last], button[data-pager-action=next]").attr("disabled",last===total)},setup_columns:function(fields,grouped){var domain_computer=openerp.web.form.compute_domain;var noop=function(){return{}};var field_to_column=function(field){var name=field.attrs.name;var column=_.extend({id:name,tag:field.tag},fields[name],field.attrs);if(column.modifiers){var modifiers=JSON.parse(column.modifiers);column.modifiers_for=function(fields){if(!modifiers.invisible)return{};
return{"invisible":domain_computer(modifiers.invisible,fields)}};if(modifiers["tree_invisible"])column.invisible="1";else delete column.invisible}else column.modifiers_for=noop;return column};this.columns.splice(0,this.columns.length);this.columns.push.apply(this.columns,_(this.fields_view.arch.children).map(field_to_column));if(grouped)this.columns.unshift({id:"_group",tag:"",string:"Group",meta:true,modifiers_for:function(){return{}}},{id:"_count",tag:"",string:"#",meta:true,modifiers_for:function(){return{}}});
this.visible_columns=_.filter(this.columns,function(column){return column.invisible!=="1"});this.aggregate_columns=_(this.visible_columns).map(function(column){if(column.type!=="integer"&&column.type!=="float")return{};var aggregation_func=column["group_operator"]||"sum";if(!(aggregation_func in column))return{};return _.extend({},column,{"function":aggregation_func,label:column[aggregation_func]})})},select_record:function(index,view){view=view||index==null?"form":"page";this.dataset.index=index;
_.delay(_.bind(function(){this.do_switch_view(view)},this))},do_show:function(){this._super();if(this.sidebar)this.sidebar.$element.show()},do_hide:function(){this._super();if(this.sidebar)this.sidebar.$element.hide()},reload_view:function(grouped,context,initial){var self=this;var callback=function(field_view_get){self.on_loaded(field_view_get,grouped)};if(this.embedded_view)return $.Deferred().then(callback).resolve(this.embedded_view);else return this.rpc("/web/listview/load",{model:this.model,
view_id:this.view_id,view_type:"tree",context:this.dataset.get_context(context),toolbar:this.options.sidebar},callback)},reload_content:function(){var self=this;self.$element.find(".all-record-selector").prop("checked",false);this.records.reset();var reloaded=$.Deferred();this.$element.find(".oe-listview-content").append(this.groups.render(function(){if(self.dataset.index==null){var has_one=false;self.records.each(function(){has_one=true});if(has_one)self.dataset.index=0}self.compute_aggregates();
reloaded.resolve()}));this.do_push_state({page:this.page,limit:this._limit});return reloaded.promise()},reload:function(){return this.reload_content()},do_load_state:function(state,warm){var reload=false;if(state.page&&this.page!==state.page){this.page=state.page;reload=true}if(state.limit){if(_.isString(state.limit))state.limit=null;if(state.limit!==this._limit){this._limit=state.limit;reload=true}}if(reload)this.reload_content()},do_search:function(domain,context,group_by){this.page=0;this.groups.datagroup=
new openerp.web.DataGroup(this,this.model,domain,context,group_by);this.groups.datagroup.sort=this.dataset._sort;if(_.isEmpty(group_by)&&!context["group_by_no_leaf"])group_by=null;this.no_leaf=!!context["group_by_no_leaf"];this.reload_view(!!group_by,context).then(this.proxy("reload_content"))},do_delete:function(ids){if(!(ids.length&&confirm(_t("Do you really want to remove these records?"))))return;var self=this;return $.when(this.dataset.unlink(ids)).then(function(){_(ids).each(function(id){self.records.remove(self.records.get(id))});
self.configure_pager(self.dataset);self.compute_aggregates()})},do_select:function(ids,records){this.$element.find(".oe-list-delete").attr("disabled",!ids.length);if(this.sidebar)if(ids.length)this.sidebar.do_unfold();else this.sidebar.do_fold();if(!records.length){this.compute_aggregates();return}this.compute_aggregates(_(records).map(function(record){return{count:1,values:record}}))},do_button_action:function(name,id,callback){var action=_.detect(this.columns,function(field){return field.name===
name});if(!action)return;if("confirm"in action&&!window.confirm(action.confirm))return;var c=new openerp.web.CompoundContext;c.set_eval_context(_.extend({active_id:id,active_ids:[id],active_model:this.dataset.model},this.records.get(id).toContext()));if(action.context)c.add(action.context);action.context=c;this.do_execute_action(action,this.dataset,id,callback)},do_activate_record:function(index,id,dataset,view){this.dataset.ids=dataset.ids;this.select_record(index,view)},do_add_record:function(){this.select_record(null)},
do_delete_selected:function(){this.do_delete(this.groups.get_selection().ids)},compute_aggregates:function(records){var columns=_(this.aggregate_columns).filter(function(column){return column["function"]});if(_.isEmpty(columns))return;if(_.isEmpty(records))records=this.groups.get_records();records=_(records).compact();var count=0,sums={};_(columns).each(function(column){switch(column["function"]){case "max":sums[column.id]=-Infinity;break;case "min":sums[column.id]=Infinity;break;default:sums[column.id]=
0}});_(records).each(function(record){count+=record.count||1;_(columns).each(function(column){var field=column.id,value=record.values[field];switch(column["function"]){case "sum":sums[field]+=value;break;case "avg":sums[field]+=record.count*value;break;case "min":if(sums[field]>value)sums[field]=value;break;case "max":if(sums[field]<value)sums[field]=value;break}})});var aggregates={};_(columns).each(function(column){var field=column.id;switch(column["function"]){case "avg":aggregates[field]={value:sums[field]/
count};break;default:aggregates[field]={value:sums[field]}}});this.display_aggregates(aggregates)},display_aggregates:function(aggregation){var self=this;var $footer_cells=this.$element.find(".oe-list-footer");_(this.aggregate_columns).each(function(column){if(!column["function"])return;$footer_cells.filter(_.str.sprintf("[data-field=%s]",column.id)).html(openerp.web.format_cell(aggregation,column,{process_modifiers:false}))})},get_selected_ids:function(){var ids=this.groups.get_selection().ids;return ids},
pad_columns:function(count,options){options=options||{};var $first_header=this.$element.find("thead tr:first th");var colspan=$first_header.attr("colspan");if(colspan){if(!this.previous_colspan)this.previous_colspan=colspan;$first_header.attr("colspan",parseInt(colspan,10)+count)}var $rows=this.$element.find(".oe-listview-header-columns, tr:not(thead tr)").not(options["except"]);var newcols=(new Array(count+1)).join('<td class="oe-listview-padding"></td>');if(options.position==="before")$rows.prepend(newcols);
else $rows.append(newcols)},unpad_columns:function(){this.$element.find(".oe-listview-padding").remove();if(this.previous_colspan){this.$element.find("thead tr:first th").attr("colspan",this.previous_colspan);this.previous_colspan=null}}});openerp.web.ListView.List=openerp.web.Class.extend({init:function(group,opts){var self=this;this.group=group;this.view=group.view;this.session=this.view.session;this.options=opts.options;this.columns=opts.columns;this.dataset=opts.dataset;this.records=opts.records;
this.record_callbacks={"remove":function(event,record){var $row=self.$current.find("[data-id="+record.get("id")+"]");var index=$row.data("index");$row.remove();self.refresh_zebra(index)},"reset":function(){return self.on_records_reset()},"change":function(event,record){var $row=self.$current.find("[data-id="+record.get("id")+"]");$row.replaceWith(self.render_record(record))},"add":function(ev,records,record,index){var $new_row=$("<tr>").attr({"data-id":record.get("id")});if(index===0)$new_row.prependTo(self.$current);
else{var previous_record=records.at(index-1),$previous_sibling=self.$current.find("[data-id="+previous_record.get("id")+"]");$new_row.insertAfter($previous_sibling)}self.refresh_zebra(index,1)}};_(this.record_callbacks).each(function(callback,event){this.records.bind(event,callback)},this);this.$_element=$('<tbody class="ui-widget-content">').appendTo(document.body).delegate("th.oe-record-selector","click",function(e){e.stopPropagation();var selection=self.get_selection();$(self).trigger("selected",
[selection.ids,selection.records])}).delegate("td.oe-record-delete button","click",function(e){e.stopPropagation();var $row=$(e.target).closest("tr");$(self).trigger("deleted",[[self.row_id($row)]])}).delegate("td.oe-field-cell button","click",function(e){e.stopPropagation();var $target=$(e.currentTarget),field=$target.closest("td").data("field"),$row=$target.closest("tr"),record_id=self.row_id($row);$(self).trigger("action",[field.toString(),record_id,function(){return self.reload_record(self.records.get(record_id))}])}).delegate("a",
"click",function(e){e.stopPropagation()}).delegate("tr","click",function(e){e.stopPropagation();var row_id=self.row_id(e.currentTarget);if(row_id!==undefined){if(!self.dataset.select_id(row_id))throw"Could not find id in dataset";var view;if($(e.target).is(".oe-record-edit-link-img"))view="form";self.row_clicked(e,view)}})},row_clicked:function(e,view){$(this).trigger("row_link",[this.dataset.ids[this.dataset.index],this.dataset,view])},render_cell:function(record,column){var value;if(column.type===
"reference"){value=record.get(column.id);var ref_match;if(value&&(ref_match=/([\w\.]+),(\d+)/.exec(value))){var model=ref_match[1],id=parseInt(ref_match[2],10);(new openerp.web.DataSet(this.view,model)).name_get([id],function(names){if(!names.length)return;record.set(column.id,names[0][1])})}}else if(column.type==="many2one"){value=record.get(column.id);if(typeof value==="number"||value instanceof Number)(new openerp.web.DataSet(this.view,column.relation)).name_get([value],function(names){if(!names.length)return;
record.set(column.id,names[0])})}return openerp.web.format_cell(record.toForm().data,column,{model:this.dataset.model,id:record.get("id")})},render:function(){var self=this;if(this.$current)this.$current.remove();this.$current=this.$_element.clone(true);this.$current.empty().append(QWeb.render("ListView.rows",_.extend({render_cell:function(){return self.render_cell.apply(self,arguments)}},this)));this.pad_table_to(5)},pad_table_to:function(count){if(this.records.length>=count||_(this.columns).any(function(column){return column.meta}))return;
var cells=[];if(this.options.selectable)cells.push('<th class="oe-record-selector"></td>');if(this.options.isClarkGable)cells.push('<th class="oe-record-edit-link"></td>');_(this.columns).each(function(column){if(column.invisible==="1")return;if(column.tag==="button")cells.push('<td class="oe-button" title="'+column.string+'">&nbsp;</td>');else cells.push('<td title="'+column.string+'">&nbsp;</td>')});if(this.options.deletable)cells.push('<td class="oe-record-delete"><button type="button" style="visibility: hidden"> </button></td>');
cells.unshift("<tr>");cells.push("</tr>");var row=cells.join("");this.$current.children("tr:not([data-id])").remove().end().append((new Array(count-this.records.length+1)).join(row));this.refresh_zebra(this.records.length)},get_selection:function(){if(!this.options.selectable)return[];var records=this.records;var result={ids:[],records:[]};this.$current.find("th.oe-record-selector input:checked").closest("tr").each(function(){var record=records.get($(this).data("id"));result.ids.push(record.get("id"));
result.records.push(record.attributes)});return result},row_id:function(row){return $(row).data("id")},on_records_reset:function(){_(this.record_callbacks).each(function(callback,event){this.records.unbind(event,callback)},this);if(!this.$current)return;this.$current.remove();this.$current=null;this.$_element.remove()},get_records:function(){return this.records.map(function(record){return{count:1,values:record.attributes}})},reload_record:function(record){return this.dataset.read_ids([record.get("id")],
_.pluck(_(this.columns).filter(function(r){return r.tag==="field"}),"name")).then(function(records){_(records[0]).each(function(value,key){record.set(key,value,{silent:true})});record.trigger("change",record)})},render_record:function(record){var index=this.records.indexOf(record);return QWeb.render("ListView.row",{columns:this.columns,options:this.options,record:record,row_parity:index%2===0?"even":"odd",view:this.view,render_cell:function(){return this.render_cell.apply(this,arguments)}})},refresh_zebra:function(from_index,
offset){offset=offset||0;from_index=from_index||0;var dom_offset=offset+from_index;var sel=dom_offset?":gt("+(dom_offset-1)+")":null;this.$current.children(sel).each(function(i,e){var index=from_index+i;var even=index%2===0;$(e).toggleClass("even",even).toggleClass("odd",!even)})}});openerp.web.ListView.Groups=openerp.web.Class.extend({passtrough_events:"action deleted row_link",init:function(view,options){options=options||{};this.view=view;this.records=options.records||view.records;this.options=
options.options||view.options;this.columns=options.columns||view.columns;this.datagroup=null;this.$row=null;this.children={};this.page=0;var self=this;this.records.bind("reset",function(){return self.on_records_reset()})},make_fragment:function(){return document.createDocumentFragment()},point_insertion:function(row){var $row=$(row);var red_letter_tboday=$row.closest("tbody")[0];var $next_siblings=$row.nextAll();if($next_siblings.length){var $root_kanal=$("<tbody>").insertAfter(red_letter_tboday);
$root_kanal.append($next_siblings);this.elements.splice(_.indexOf(this.elements,red_letter_tboday),0,$root_kanal[0])}return red_letter_tboday},make_paginator:function(){var self=this;var $prev=$('<button type="button" data-pager-action="previous">&lt;</button>').click(function(e){e.stopPropagation();self.page-=1;self.$row.closest("tbody").next().replaceWith(self.render())});var $next=$('<button type="button" data-pager-action="next">&gt;</button>').click(function(e){e.stopPropagation();self.page+=
1;self.$row.closest("tbody").next().replaceWith(self.render())});this.$row.children().last().append($prev).append('<span class="oe-pager-state"></span>').append($next)},open:function(point_insertion){this.render().insertAfter(point_insertion);var no_subgroups=_(this.datagroup.group_by).isEmpty(),records_terminated=!this.datagroup.context["group_by_no_leaf"];if(no_subgroups&&records_terminated)this.make_paginator()},close:function(){this.$row.children().last().empty();this.records.reset()},indent:function($node,
level){return $("<span>").css({"float":"left","white-space":"pre"}).text((new Array(level)).join("   ")).prependTo($node)},render_groups:function(datagroups){var self=this;var placeholder=this.make_fragment();_(datagroups).each(function(group){if(self.children[group.value]){self.records.proxy(group.value).reset();delete self.children[group.value]}var child=self.children[group.value]=new openerp.web.ListView.Groups(self.view,{records:self.records.proxy(group.value),options:self.options,columns:self.columns});
self.bind_child_events(child);child.datagroup=group;var $row=child.$row=$("<tr>");if(group.openable&&group.length)$row.click(function(e){if(!$row.data("open")){$row.data("open",true).find("span.ui-icon").removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-s");child.open(self.point_insertion(e.currentTarget))}else{$row.removeData("open").find("span.ui-icon").removeClass("ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e");child.close()}});placeholder.appendChild($row[0]);var $group_column=
$('<th class="oe-group-name">').appendTo($row);if(group.grouped_on){var row_data={};row_data[group.grouped_on]=group;var group_column=_(self.columns).detect(function(column){return column.id===group.grouped_on});try{$group_column.html(openerp.web.format_cell(row_data,group_column,{value_if_empty:_t("Undefined"),process_modifiers:false}))}catch(e){$group_column.html(row_data[group_column.id].value)}if(group.length&&group.openable)$group_column.prepend('<span class="ui-icon ui-icon-triangle-1-e" style="float: left;">');
else $group_column.prepend('<span class="ui-icon" style="float: left; background-position: 150px 150px">')}self.indent($group_column,group.level);$("<td>").text(group.length).appendTo($row);if(self.options.selectable)$row.append("<td>");if(self.options.isClarkGable)$row.append("<td>");_(self.columns).chain().filter(function(column){return!column.invisible}).each(function(column){if(column.meta);else if(column.id in group.aggregates){var value=group.aggregates[column.id];$('<td class="oe-number">').html(openerp.web.format_value(value,
column)).appendTo($row)}else $row.append("<td>")});if(self.options.deletable)$row.append('<td class="oe-group-pagination">')});return placeholder},bind_child_events:function(child){var $this=$(this),self=this;$(child).bind("selected",function(e){var selection=self.get_selection();$this.trigger(e,[selection.ids,selection.records])}).bind(this.passtrough_events,function(e){var args=Array.prototype.slice.call(arguments,1);$this.trigger.call($this,e,args)})},render_dataset:function(dataset){var self=
this,list=new openerp.web.ListView.List(this,{options:this.options,columns:this.columns,dataset:dataset,records:this.records});this.bind_child_events(list);var view=this.view,limit=view.limit(),d=new $.Deferred,page=this.datagroup.openable?this.page:view.page;var fields=_.pluck(_.select(this.columns,function(x){return x.tag=="field"}),"name");var options={offset:page*limit,limit:limit,context:{bin_size:true}};$.async_when().then(function(){dataset.read_slice(fields,options).then(function(records){if(self.records.length)self.records.reset(null,
{silent:true});if(!self.datagroup.openable)view.configure_pager(dataset);else if(dataset.size()==records.length)self.$row.find("td.oe-group-pagination").empty();else{var pages=Math.ceil(dataset.size()/limit);self.$row.find(".oe-pager-state").text(_.str.sprintf(_t("%(page)d/%(page_count)d"),{page:page+1,page_count:pages})).end().find("button[data-pager-action=previous]").attr("disabled",page===0).end().find("button[data-pager-action=next]").attr("disabled",page===pages-1)}self.records.add(records,
{silent:true});list.render();d.resolve(list)})});return d.promise()},setup_resequence_rows:function(list,dataset){if(dataset.sort&&dataset.sort()||!_(this.columns).any(function(column){return column.name==="sequence"}))return;list.$current.sortable({axis:"y",items:"> tr[data-id]",containment:"parent",helper:"clone",stop:function(event,ui){var to_move=list.records.get(ui.item.data("id")),target_id=ui.item.prev().data("id"),from_index=list.records.indexOf(to_move),target=list.records.get(target_id);
if(list.records.at(from_index-1)==target)return;list.records.remove(to_move);var to=target_id?list.records.indexOf(target)+1:0;list.records.add(to_move,{at:to});var record,index=to,seq=to?list.records.at(to-1).get("sequence"):0;while(++seq,record=list.records.at(index++)){(function(dataset,id,seq){$.async_when().then(function(){dataset.write(id,{sequence:seq})})})(dataset,record.get("id"),seq);record.set("sequence",seq)}list.refresh_zebra()}})},render:function(post_render){var self=this;var $element=
$("<tbody>");this.elements=[$element[0]];this.datagroup.list(_(this.view.visible_columns).chain().filter(function(column){return column.tag==="field"}).pluck("name").value(),function(groups){$element[0].appendChild(self.render_groups(groups));if(post_render)post_render()},function(dataset){self.render_dataset(dataset).then(function(list){self.children[null]=list;self.elements=[list.$current.replaceAll($element)[0]];self.setup_resequence_rows(list,dataset);if(post_render)post_render()})});return $element},
get_selection:function(){var ids=[],records=[];_(this.children).each(function(child){var selection=child.get_selection();ids.push.apply(ids,selection.ids);records.push.apply(records,selection.records)});return{ids:ids,records:records}},on_records_reset:function(){this.children={};$(this.elements).remove()},get_records:function(){if(_(this.children).isEmpty()){if(!this.datagroup.length)return;return{count:this.datagroup.length,values:this.datagroup.aggregates}}return _(this.children).chain().map(function(child){return child.get_records()}).flatten().value()}});
var Events={bind:function(event,handler){var calls=this["_callbacks"]||(this._callbacks={});if(event in calls)calls[event].push(handler);else calls[event]=[handler];return this},unbind:function(event,handler){var calls=this._callbacks||{};if(!(event in calls))return this;if(!handler)delete calls[event];else{var handlers=calls[event];handlers.splice(_(handlers).indexOf(handler),1)}return this},trigger:function(event){var calls;if(!(calls=this._callbacks))return this;var callbacks=(calls[event]||[]).concat(calls[null]||
[]);for(var i=0,length=callbacks.length;i<length;++i)callbacks[i].apply(this,arguments);return this}};var Record=openerp.web.Class.extend({init:function(data){this.attributes=data||{}},get:function(key){return this.attributes[key]},set:function(key,value,options){options=options||{};var old_value=this.attributes[key];if(old_value===value)return this;this.attributes[key]=value;if(!options.silent){this.trigger("change:"+key,this,value,old_value);this.trigger("change",this,key,value,old_value)}return this},
toForm:function(){var form_data={},attrs=this.attributes;for(var k in attrs)form_data[k]={value:attrs[k]};return{data:form_data}},toContext:function(){var output={},attrs=this.attributes;for(var k in attrs){var val=attrs[k];if(typeof val!=="object")output[k]=val;else if(val instanceof Array)output[k]=val[0];else throw new Error("Can't convert value "+val+" to context");}return output}});Record.include(Events);var Collection=openerp.web.Class.extend({init:function(records,options){options=options||
{};_.bindAll(this,"_onRecordEvent");this.length=0;this.records=[];this._byId={};this._proxies={};this._key=options.key;this._parent=options.parent;if(records)this.add(records)},add:function(record,options){options=options||{};var records=record instanceof Array?record:[record];for(var i=0,length=records.length;i<length;++i){var instance=records[i]instanceof Record?records[i]:new Record(records[i]);instance.bind(null,this._onRecordEvent);this._byId[instance.get("id")]=instance;if(options.at==undefined){this.records.push(instance);
if(!options.silent)this.trigger("add",this,instance,this.records.length-1)}else{var insertion_index=options.at+i;this.records.splice(insertion_index,0,instance);if(!options.silent)this.trigger("add",this,instance,insertion_index)}this.length++}return this},at:function(index,group){if(group){var groups=group.split(".");return this._proxies[groups[0]].at(index,groups.join("."))}return this.records[index]},get:function(id){if(!_(this._proxies).isEmpty()){var record=null;_(this._proxies).detect(function(proxy){return record=
proxy.get(id)});return record}return this._byId[id]},proxy:function(section){return this._proxies[section]=(new Collection(null,{parent:this,key:section})).bind(null,this._onRecordEvent)},reset:function(records,options){options=options||{};_(this._proxies).each(function(proxy){proxy.reset()});this._proxies={};_(this.records).invoke("unbind",null,this._onRecordEvent);this.length=0;this.records=[];this._byId={};if(records)this.add(records);if(!options.silent)this.trigger("reset",this);return this},
remove:function(record){var index=_(this.records).indexOf(record);if(index===-1){_(this._proxies).each(function(proxy){proxy.remove(record)});return this}record.unbind(null,this._onRecordEvent);this.records.splice(index,1);delete this._byId[record.get("id")];this.length--;this.trigger("remove",record,this);return this},_onRecordEvent:function(event,record,options){if(event==="reset")return;this.trigger.apply(this,arguments)},each:function(callback){for(var section in this._proxies)if(this._proxies.hasOwnProperty(section))this._proxies[section].each(callback);
for(var i=0;i<this.length;++i)callback(this.records[i])},map:function(callback){var results=[];this.each(function(record){results.push(callback(record))});return results},pluck:function(fieldname){return this.map(function(record){return record.get(fieldname)})},indexOf:function(record){return _(this.records).indexOf(record)}});Collection.include(Events);openerp.web.list={Events:Events,Record:Record,Collection:Collection}};
openerp.web.list_editable=function(openerp){var KEY_RETURN=13,KEY_ESCAPE=27;var QWeb=openerp.web.qweb;openerp.web.ListView.prototype.defaults.editable=null;openerp.web.ListView.include({init:function(){var self=this;this._super.apply(this,arguments);$(this.groups).bind({"edit":function(e,id,dataset){self.do_edit(dataset.index,id,dataset)},"saved":function(){if(self.groups.get_selection().length)return;self.configure_pager(self.dataset);self.compute_aggregates()}})},do_edit:function(index,id,dataset){_.extend(this.dataset,
dataset)},set_editable:function(force){this.options.editable=force&&"bottom"||this.defaults.editable},do_search:function(domain,context,group_by){this.set_editable(context["set_editable"]);this._super.apply(this,arguments)},do_add_record:function(){if(this.options.editable)this.groups.new_record();else this._super()},on_loaded:function(data,grouped){this.options.editable=data.arch.attrs.editable||this.options.editable;return this._super(data,grouped)},ensure_saved:function(){return this.groups.ensure_saved()}});
openerp.web.ListView.Groups.include({passtrough_events:openerp.web.ListView.Groups.prototype.passtrough_events+" edit saved",new_record:function(){this.children[null].new_record()},ensure_saved:function(){return $.when.apply(null,_.invoke(_.values(this.children),"ensure_saved"))}});openerp.web.ListView.List.include({row_clicked:function(event){if(!this.options.editable)return this._super.apply(this,arguments);this.edit_record($(event.currentTarget).data("id"))},cancel_pending_edition:function(){var self=
this,cancelled=$.Deferred();if(!this.edition){cancelled.resolve();return cancelled.promise()}if(this.edition_id!=null)this.reload_record(self.records.get(this.edition_id)).then(function(){cancelled.resolve()});else cancelled.resolve();cancelled.then(function(){self.view.unpad_columns();self.edition_form.stop();self.edition_form.$element.remove();delete self.edition_form;delete self.edition_id;delete self.edition});this.pad_table_to(5);return cancelled.promise()},get_form_fields_view:function(){var view=
$.extend(true,{},this.group.view.fields_view);_(view.arch.children).each(function(widget){widget.attrs.nolabel=true;if(widget.tag==="button")delete widget.attrs.string});view.arch.attrs.col=2*view.arch.children.length;return view},on_row_keyup:function(e){var self=this;switch(e.which){case KEY_RETURN:this.save_row().then(function(result){if(result.created){self.new_record();return}var next_record_id,next_record=self.records.at(self.records.indexOf(result.edited_record)+1);if(next_record){next_record_id=
next_record.get("id");self.dataset.index=_(self.dataset.ids).indexOf(next_record_id)}else{self.dataset.index=0;next_record_id=self.records.at(0).get("id")}self.edit_record(next_record_id)});break;case KEY_ESCAPE:this.cancel_edition();break}},render_row_as_form:function(row){var self=this;this.cancel_pending_edition().then(function(){var record_id=$(row).data("id");var $new_row=$("<tr>",{id:_.uniqueId("oe-editable-row-"),"data-id":record_id,"class":row?$(row).attr("class"):""+" oe_forms",click:function(e){e.stopPropagation()}}).delegate("button.oe-edit-row-save",
"click",function(){self.save_row()}).delegate("button","keyup",function(e){e.stopImmediatePropagation()}).keyup(function(){return self.on_row_keyup.apply(self,arguments)}).keydown(function(e){e.stopPropagation()});if(row)$new_row.replaceAll(row);else if(self.options.editable){var $last_child=self.$current.children("tr:last");if(self.records.length)if(self.options.editable==="top")$new_row.insertBefore(self.$current.children("[data-id]:first"));else $new_row.insertAfter(self.$current.children("[data-id]:last"));
else $new_row.prependTo(self.$current);if($last_child.is(":not([data-id])"))$last_child.remove()}self.edition=true;self.edition_id=record_id;self.edition_form=_.extend(new openerp.web.ListEditableFormView(self.view,self.dataset,false),{form_template:"ListView.row.form",registry:openerp.web.list.form.widgets,$element:$new_row});self.edition_form.appendTo();$.when(self.edition_form.on_loaded(self.get_form_fields_view())).then(function(){$new_row.find("> td").addClass("oe-field-cell").removeAttr("width").end().find("td:last").removeClass("oe-field-cell").end();
if(self.options.selectable)$new_row.prepend("<th>");if(self.options.isClarkGable)$new_row.prepend("<th>");_(self.columns).each(function(column){if(column.meta)$new_row.prepend("<td>")});if(!self.options.deletable)self.view.pad_columns(1,{except:$new_row});self.edition_form.do_show()})})},handle_onwrite:function(source_record_id){var self=this;var on_write_callback=self.view.fields_view.arch.attrs.on_write;if(!on_write_callback)return;this.dataset.call(on_write_callback,[source_record_id],function(ids){_(ids).each(function(id){var record=
self.records.get(id);if(!record){var index=self.records.indexOf(self.records.get(source_record_id))+1;record=new openerp.web.list.Record({id:id});self.records.add(record,{at:index});self.dataset.ids.splice(index,0,id)}self.reload_record(record)})})},save_row:function(){var self=this,done=$.Deferred();return this.edition_form.do_save(null,this.options.editable==="top").pipe(function(result){if(result.created&&!self.edition_id){self.records.add({id:result.result},{at:self.options.editable==="top"?0:
null});self.edition_id=result.result}var edited_record=self.records.get(self.edition_id);return $.when(self.handle_onwrite(self.edition_id),self.cancel_pending_edition().then(function(){$(self).trigger("saved",[self.dataset])})).pipe(function(){return{created:result.created||false,edited_record:edited_record}},null)},null)},ensure_saved:function(){if(this.edition)return this.save_row();return $.Deferred().resolve().promise()},cancel_edition:function(){this.cancel_pending_edition()},edit_record:function(record_id){this.render_row_as_form(this.$current.find("[data-id="+
record_id+"]"));$(this).trigger("edit",[record_id,this.dataset])},new_record:function(){this.dataset.index=null;this.render_row_as_form()},render_record:function(record){var index=this.records.indexOf(record),self=this;return QWeb.render("ListView.row",{columns:this.columns,options:this.options,record:record,row_parity:index%2===0?"even":"odd",view:this.view,render_cell:function(){return self.render_cell.apply(self,arguments)},edited:!!this.edition_form})}});if(!openerp.web.list)openerp.web.list=
{};if(!openerp.web.list.form)openerp.web.list.form={};openerp.web.list.form.WidgetFrame=openerp.web.form.WidgetFrame.extend({template:"ListView.row.frame"});var form_widgets=openerp.web.form.widgets;openerp.web.list.form.widgets=form_widgets.extend({"frame":"openerp.web.list.form.WidgetFrame"});var list_form_widgets=openerp.web.list.form.widgets;_(form_widgets.map).each(function(widget_path,key){if(key==="frame")return;var new_path="openerp.web.list.form."+key;openerp.web.list.form[key]=form_widgets.get_object(key).extend({update_dom:function(){this.$element.children().css("visibility",
"");if(this.modifiers.tree_invisible){var old_invisible=this.invisible;this.invisible=true;this._super();this.invisible=old_invisible}else if(this.invisible)this.$element.children().css("visibility","hidden");else this._super()}});list_form_widgets.add(key,new_path)});openerp.web.ListEditableFormView=openerp.web.FormView.extend({init_view:function(){},_render_and_insert:function(){return this.start()}})};
openerp.web.view_tree=function(openerp){var QWeb=openerp.web.qweb,_lt=openerp.web._lt;openerp.web.views.add("tree","openerp.web.TreeView");openerp.web.TreeView=openerp.web.View.extend({display_name:_lt("Tree"),searchable:false,init:function(parent,dataset,view_id,options){this._super(parent);this.dataset=dataset;this.model=dataset.model;this.view_id=view_id;this.records={};this.options=_.extend({},this.defaults,options||{});_.bindAll(this,"color_for")},start:function(){this._super();return this.rpc("/web/treeview/load",
{model:this.model,view_id:this.view_id,view_type:"tree",toolbar:this.view_manager?!!this.view_manager.sidebar:false,context:this.dataset.get_context()},this.on_loaded)},fields_list:function(){var fields=_.keys(this.fields);if(!_(fields).contains(this.children_field))fields.push(this.children_field);return fields},on_loaded:function(fields_view){var self=this;var has_toolbar=!!fields_view.arch.attrs.toolbar;this.children_field=fields_view["field_parent"];this.fields_view=fields_view;_(this.fields_view.arch.children).each(function(field){if(field.attrs.modifiers)field.attrs.modifiers=
JSON.parse(field.attrs.modifiers)});this.fields=fields_view.fields;this.hook_row_click();this.$element.html(QWeb.render("TreeView",{"title":this.fields_view.arch.attrs.string,"fields_view":this.fields_view.arch.children,"fields":this.fields,"toolbar":has_toolbar}));this.dataset.read_slice(this.fields_list()).then(function(records){if(!has_toolbar){self.getdata(null,_(records).pluck("id"));return}var $select=self.$element.find("select").change(function(){var $option=$(this).find(":selected");self.getdata($option.val(),
$option.data("children"))});_(records).each(function(record){self.records[record.id]=record;$("<option>").val(record.id).text(record.name).data("children",record[self.children_field]).appendTo($select)});if(!_.isEmpty(records))$select.change()});this.do_push_state({});if(!this.fields_view.arch.attrs.colors)return;this.colors=_(this.fields_view.arch.attrs.colors.split(";")).chain().compact().map(function(color_pair){var pair=color_pair.split(":"),color=pair[0],expr=pair[1];return[color,py.parse(py.tokenize(expr)),
expr]}).value()},color_for:function(record){if(!this.colors)return"";var context=_.extend({},record,{uid:this.session.uid,current_date:(new Date).toString("yyyy-MM-dd")});for(var i=0,len=this.colors.length;i<len;++i){var pair=this.colors[i],color=pair[0],expression=pair[1];if(py.evaluate(expression,_.extend({bool:py.bool},context)))return"color: "+color+";"}return""},hook_row_click:function(){var self=this;this.$element.delegate(".treeview-td span, .treeview-tr span","click",function(e){e.stopImmediatePropagation();
self.activate($(this).closest("tr").data("id"))});this.$element.delegate(".treeview-tr","click",function(){var is_loaded=0,$this=$(this),record_id=$this.data("id"),record=self.records[record_id],children_ids=record[self.children_field];_(children_ids).each(function(childid){if(self.$element.find("#treerow_"+childid).length)if(self.$element.find("#treerow_"+childid).is(":hidden"))is_loaded=-1;else is_loaded++});if(is_loaded===0){if(!$this.parent().hasClass("oe-open"))self.getdata(record_id,children_ids)}else self.showcontent(record_id,
is_loaded<0)})},getdata:function(id,children_ids){var self=this;self.dataset.read_ids(children_ids,this.fields_list()).then(function(records){_(records).each(function(record){self.records[record.id]=record});var $curr_node=self.$element.find("#treerow_"+id);var children_rows=QWeb.render("TreeView.rows",{"records":records,"children_field":self.children_field,"fields_view":self.fields_view.arch.children,"fields":self.fields,"level":$curr_node.data("level")||0,"render":openerp.web.format_value,"color_for":self.color_for});
if($curr_node.length){$curr_node.addClass("oe-open");$curr_node.after(children_rows)}else self.$element.find("tbody").html(children_rows)})},activate:function(id){var self=this;var local_context={active_model:self.dataset.model,active_id:id,active_ids:[id]};return this.rpc("/web/treeview/action",{id:id,model:this.dataset.model,context:new openerp.web.CompoundContext(this.dataset.get_context(),local_context)}).pipe(function(actions){if(!actions.length)return;var action=actions[0][2];var c=new openerp.web.CompoundContext(local_context);
if(action.context)c.add(action.context);return self.rpc("/web/session/eval_domain_and_context",{contexts:[c],domains:[]}).pipe(function(res){action.context=res.context;return self.do_action(action)},null)},null)},showcontent:function(record_id,show){this.$element.find("#treerow_"+record_id).toggleClass("oe-open",show);_(this.records[record_id][this.children_field]).each(function(child_id){var $child_row=this.$element.find("#treerow_"+child_id);if($child_row.hasClass("oe-open"))this.showcontent(child_id,
false);$child_row.toggle(show)},this)},do_show:function(){this.$element.show()},do_hide:function(){this.$element.hide();this.hidden=true}})};
openerp.web.view_editor=function(openerp){var _t=openerp.web._t;var QWeb=openerp.web.qweb;openerp.web.ViewEditor=openerp.web.OldWidget.extend({init:function(parent,element_id,dataset,view,options){this._super(parent);this.element_id=element_id;this.parent=parent;this.dataset=new openerp.web.DataSetSearch(this,"ir.ui.view",null,null),this.model=dataset.model;this.xml_element_id=0;this.property=openerp.web.ViewEditor.property_widget;this.one_object=false},start:function(){this.init_view_editor()},init_view_editor:function(){var self=
this,action_title=_.str.sprintf(_t("Manage Views (%s)"),this.model);var action={name:action_title,context:this.session.user_context,domain:[["model","=",this.model]],res_model:"ir.ui.view",views:[[false,"list"]],type:"ir.actions.act_window",target:"current",limit:this.dataset.limit||80,auto_search:true,flags:{sidebar:false,deletable:false,views_switcher:false,action_buttons:false,search_view:false,pager:false,radio:true,select_view_id:self.parent.fields_view.view_id}};this.view_edit_dialog=(new openerp.web.Dialog(this,
{title:action_title,width:850,buttons:[{text:_t("Create"),click:function(){self.on_create_view()}},{text:_t("Edit"),click:function(){self.xml_element_id=0;self.get_arch()}},{text:_t("Remove"),click:function(){self.do_delete_view()}},{text:_t("Close"),click:function(){self.view_edit_dialog.close();window.location.reload()}}]})).open();this.view_edit_dialog.on_close.add_last(function(){window.location.reload()});this.main_view_id=this.parent.fields_view.view_id;this.action_manager=new openerp.web.ActionManager(this);
this.action_manager.appendTo(this.view_edit_dialog);$.when(this.action_manager.do_action(action)).then(function(){var viewmanager=self.action_manager.inner_viewmanager,controller=viewmanager.views[viewmanager.active_view].controller;controller.on_loaded.add_last(function(){$(controller.groups).bind({"selected":function(e,ids,records){self.main_view_id=ids[0]}})})})},on_create_view:function(){var self=this;this.create_view_dialog=(new openerp.web.Dialog(this,{title:_.str.sprintf(_t("Create a view (%s)"),
self.model),buttons:[{text:_t("Save"),click:function(){var view_values={};var warn=false;_.each(self.create_view_widget,function(widget){if(widget.is_invalid){warn=true;return false}if(widget.dirty&&!widget.is_invalid)view_values[widget.name]=widget.get_value()});if(warn)self.on_valid_create_view(self.create_view_widget);else $.when(self.do_save_view(view_values)).then(function(){self.create_view_dialog.close();var controller=self.action_manager.inner_viewmanager.views[self.action_manager.inner_viewmanager.active_view].controller;
controller.reload_content()})}},{text:_t("Cancel"),click:function(){self.create_view_dialog.close()}}]})).open();var view_widget=[{"name":"view_name","string":"View Name","type":"char","required":true,"value":this.model+".custom_"+Math.round(Math.random()*1E3)},{"name":"view_type","string":"View Type","type":"selection","required":true,"value":"Form","selection":[["",""],["tree","Tree"],["form","Form"],["graph","Graph"],["calendar","Calender"]]},{"name":"proirity","string":"Priority","type":"float",
"required":true,"value":"16"}];this.create_view_dialog.$element.append('<table id="create_view"  style="width:400px" class="oe_forms"></table>');this.create_view_widget=[];_.each(view_widget,function(widget){var type_widget=new (self.property.get_any([widget.type]))(self.create_view_dialog,widget);self.create_view_dialog.$element.find("table[id=create_view]").append('<tr><td width="100px" align="right">'+widget.string+":</td>"+type_widget.render()+"</tr>");var value=null;if(widget.value){value=widget.value;
type_widget.dirty=true}type_widget.start();type_widget.set_value(value);self.create_view_widget.push(type_widget)})},do_save_view:function(values){def=$.Deferred();var field_dataset=new openerp.web.DataSetSearch(this,this.model,null,null);var model_dataset=new openerp.web.DataSetSearch(this,"ir.model",null,null);var view_string="",field_name=false,self=this;field_dataset.call("fields_get",[],function(fields){_.each(["name","x_name"],function(value){if(_.include(_.keys(fields),value)){field_name=value;
return false}});if(field_name)model_dataset.read_slice(["name","field_id"],{"domain":[["model","=",self.model]]}).then(function(records){if(records)view_string=records[0].name;var arch=_.str.sprintf("<?xml version='1.0'?>\n<%s string='%s'>\n\t<field name='%s'/>\n</%s>",values.view_type,view_string,field_name,values.view_type);var vals={"model":self.model,"name":values.view_name,"priority":values.priority,"type":values.view_type,"arch":arch};self.dataset.create(vals,function(suc){def.resolve()})})});
return def.promise()},on_valid_create_view:function(widgets){var msg="<ul>";_.each(widgets,function(widget){if(widget.is_invalid)msg+="<li>"+widget.name+"</li>"});msg+="</ul>";this.do_warn(" :",msg)},add_node_name:function(node){if(node.tagName.toLowerCase()=="button"||node.tagName.toLowerCase()=="field")return node.getAttribute("name")?_.str.sprintf("<%s name='%s'>",node.tagName.toLowerCase(),node.getAttribute("name")):_.str.sprintf("<%s>",node.tagName.toLowerCase());
else if(node.tagName.toLowerCase()=="group")return node.getAttribute("string")?_.str.sprintf("<%s>",node.getAttribute("string")):_.str.sprintf("<%s>",node.tagName.toLowerCase());else return node.getAttribute("string")?_.str.sprintf("<%s string='%s'>",node.tagName.toLowerCase(),node.getAttribute("string")):_.str.sprintf("<%s>",node.tagName.toLowerCase())},do_delete_view:function(){var self=this;if(confirm(_t("Do you really want to remove this view?"))){var controller=this.action_manager.inner_viewmanager.views[this.action_manager.inner_viewmanager.active_view].controller;
this.dataset.unlink([this.main_view_id]).then(function(){controller.reload_content();self.main_view_id=self.parent.fields_view.view_id})}},create_View_Node:function(node){ViewNode={"level":$(node).parents().length+1,"id":this.xml_element_id+=1,"att_list":[],"name":this.add_node_name(node),"child_id":[]};ViewNode.att_list.push(node.tagName.toLowerCase());_.each(node.attributes,function(att){ViewNode.att_list.push([att.nodeName,att.nodeValue])});return ViewNode},append_child_object:function(main_object,
parent_id,child_obj_list){var self=this;if(main_object.id==parent_id){main_object.child_id=child_obj_list;return main_object}else _.each(main_object.child_id,function(child_object){self.append_child_object(child_object,parent_id,child_obj_list)})},convert_arch_to_obj:function(xml_Node,main_object,parent_id){var self=this;var child_obj_list=[];_.each(xml_Node,function(element){child_obj_list.push(self.create_View_Node(element))});this.append_child_object(main_object,parent_id,child_obj_list);var obj_xml_list=
_.zip(xml_Node,child_obj_list);_.each(obj_xml_list,function(node){var children=_.filter(node[0].childNodes,function(child){return child.nodeType==1});if(children)self.convert_arch_to_obj(children,main_object,node[1].id)});return main_object},parse_xml:function(arch,view_id){main_object={"level":0,"id":this.xml_element_id+=1,"att_list":[],"name":_.str.sprintf("<view view_id = %s>",view_id),"child_id":[]};var xml_arch=QWeb.load_xml(arch);return[this.convert_arch_to_obj(xml_arch.childNodes,main_object,
this.xml_element_id)]},get_arch:function(){var self=this;var view_arch_list=[];this.dataset.read_ids([parseInt(self.main_view_id)],["arch","type","priority"]).then(function(arch){if(arch.length){var arch_object=self.parse_xml(arch[0].arch,self.main_view_id);self.main_view_type=arch[0].type=="tree"?"list":arch[0].type;view_arch_list.push({"view_id":self.main_view_id,"arch":arch[0].arch,"priority":arch[0].priority});self.dataset.read_slice([],{domain:[["inherit_id","=",parseInt(self.main_view_id)]]}).then(function(result){_.each(result,
function(res){view_arch_list.push({"view_id":res.id,"arch":res.arch,"priority":res.priority});self.inherit_view(arch_object,res)});return self.edit_view({"main_object":arch_object,"parent_child_id":self.parent_child_list(arch_object,[]),"arch":view_arch_list})})}else self.do_warn("Please select view in list :")})},parent_child_list:function(one_object,parent_list){var self=this;_.each(one_object,function(element){if(element.child_id.length!=0){parent_list.push({"key":element.id,"value":_.pluck(element.child_id,
"id")});self.parent_child_list(element.child_id,parent_list)}});return parent_list},inherit_view:function(arch_object,result){var self=this,xml_list=[],xml_arch=QWeb.load_xml(result.arch);if(xml_arch.childNodes[0].tagName=="data")xml_list=_.filter(xml_arch.childNodes[0].childNodes,function(child){return child.nodeType==1});else xml_list.push(xml_arch.childNodes[0]);_.each(xml_list,function(xml){var expr_to_list=[],xpath_arch_object=self.parse_xml(QWeb.tools.xml_node_to_string(xml),result.id);if(xml.tagName==
"xpath"){var part_expr=_.without(xml.getAttribute("expr").split("/"),"");_.each(part_expr,function(part){expr_to_list.push(_.without($.trim(part.replace(/[^a-zA-Z 0-9 _]+/g,"!")).split("!"),""))})}else{var temp=_.reject(xpath_arch_object[0].child_id[0].att_list,function(list){return list instanceof Array?_.include(list,"position"):false});expr_to_list=[_.flatten(temp)]}self.inherit_apply(expr_to_list,arch_object,xpath_arch_object)})},inherit_apply:function(expr_list,arch_object,xpath_arch_object){var self=
this;if(xpath_arch_object.length){var check=expr_list[0],obj=false;switch(check.length){case 2:if(parseInt(check[1])){var temp_list=_.select(arch_object,function(element){return _.include(_.flatten(element.att_list),check[0])});obj=arch_object[_.indexOf(arch_object,temp_list[parseInt(check[1])-1])]}else obj=_.detect(arch_object,function(element){return _.include(_.flatten(element.att_list),check[0])});break;case 3:obj=_.detect(arch_object,function(element){if(_.intersection(_.flatten(element.att_list),
_.uniq(check)).length==_.uniq(check).length)return element});break;case 1:var temp_list=_.select(arch_object,function(element){return _.include(_.flatten(element.att_list),check[0])});if(temp_list.length!=0)expr_list.length==1?obj=temp_list[0]:expr_list.shift();break}if(obj){expr_list.shift();if(expr_list.length)self.inherit_apply(expr_list,obj.child_id,xpath_arch_object);else{self.increase_level(xpath_arch_object[0],obj.level+1);obj.child_id.push(xpath_arch_object[0]);xpath_arch_object.pop()}}else _.each(arch_object,
function(element){self.inherit_apply(expr_list,element.child_id,xpath_arch_object)})}},increase_level:function(val,level){var self=this;val.level=level;_.each(val.child_id,function(val,key){self.increase_level(val,level+1)})},do_select_row:function(row_id){this.edit_xml_dialog.$element.find("tr[id^='viewedit-']").removeClass("ui-selected");this.edit_xml_dialog.$element.find("tr[id=viewedit-"+row_id+"]").addClass("ui-selected")},do_parent_img_hide_show:function(img){if($(img).attr("src")=="/web/static/src/img/collapse.gif"){$(img).attr("src",
"/web/static/src/img/expand.gif");this.on_expand(img)}else{$(img).attr("src","/web/static/src/img/collapse.gif");this.on_collapse(img)}},edit_view:function(one_object){var self=this;this.one_object=one_object;this.edit_xml_dialog=(new openerp.web.Dialog(this,{title:_.str.sprintf(_t("View Editor %d - %s"),self.main_view_id,self.model),height:"90%",buttons:[{text:_t("Inherited View"),click:function(){var selected_row=self.edit_xml_dialog.$element.find(".ui-selected");if(selected_row.length)if(selected_row.find("a").text().search("field")!=
-1){if(confirm(_t("Do you really wants to create an inherited view here?")))self.inherited_view(selected_row)}else alert("Can't Update View");else alert("Select an element")}},{text:_t("Preview"),click:function(){var action={context:self.session.user_context,res_model:self.model,views:[[self.main_view_id,self.main_view_type]],type:"ir.actions.act_window",target:"new",auto_search:true,flags:{sidebar:false,views_switcher:false,action_buttons:false}};var action_manager=new openerp.web.ActionManager(self);
action_manager.do_action(action)}},{text:_t("Close"),click:function(){self.action_manager.inner_viewmanager.views[self.action_manager.inner_viewmanager.active_view].controller.reload_content();self.edit_xml_dialog.close()}}]})).open();var no_property_att=[];_.each(_PROPERTIES,function(val,key){if(!val.length)no_property_att.push(key)});this.edit_xml_dialog.$element.html(QWeb.render("view_editor",{"data":one_object["main_object"],"no_properties":no_property_att}));this.edit_xml_dialog.$element.find("tr[id^='viewedit-']").click(function(){self.do_select_row(this.id.split("-")[1])});
this.edit_xml_dialog.$element.find("img[id^='parentimg-']").click(function(){self.do_parent_img_hide_show(this)});this.edit_xml_dialog.$element.find("img[id^='side-']").click(function(){self.on_select_img(this)})},inherited_view:function(selected_row){var self=this;var row_id=parseInt(selected_row.attr("id").split("-")[1]);var obj=self.get_object_by_id(row_id,self.one_object["main_object"],[])[0];var view_name=this.model+".inherit_"+Math.round(Math.random()*1E3);var view_find=selected_row;var view_id;
var min_level=parseInt(selected_row.attr("level"));while(1){view_find=view_find.prev();if(view_find.length==0||self.edit_xml_dialog.$element.find(view_find).find("a").text().search("view_id")!=-1&&parseInt(view_find.attr("level"))<min_level){view_id=parseInt($(view_find).find("a").text().replace(/[^0-9]+/g,""));break}if(view_find.attr("level")<min_level)min_level=parseInt(view_find.attr("level"))}var val=_.detect(obj.att_list,function(val){return val[0]=="name"});var priority=_.detect(self.one_object["arch"],
function(val){return val.view_id==view_id});var arch=_.str.sprintf("<?xml version='1.0'?>\n\t <field name='%s' position='after'> </field>",val[1]);var vals={"model":self.model,"name":view_name,"priority":priority.priority+1,"type":"form","arch":arch,"inherit_id":self.main_view_id};this.dataset.create(vals,function(suc){var arch_to_obj=self.parse_xml(arch,suc.result);obj.child_id.push(arch_to_obj[0]);self.one_object["parent_child_id"]=self.parent_child_list(self.one_object["main_object"],[]);self.one_object["arch"].push({"view_id":suc.result,
"arch":arch,"priority":priority.priority+1});self.increase_level(arch_to_obj[0],obj.level+1);self.render_inherited_view(selected_row,arch_to_obj[0])})},render_inherited_view:function(selected_row,obj){var self=this,row_id=parseInt(selected_row.attr("id").split("-")[1]);var clone=this.create_clone(selected_row.clone(),obj);if(selected_row.find("img[id^='parentimg-']").length==0)$(selected_row.find("a").parent()).siblings("td").append($('<img width="16" height="16"></img>').attr("src","/web/static/src/img/collapse.gif").attr("id",
"parentimg-"+row_id).click(function(){self.do_parent_img_hide_show(this)}));self.edit_xml_dialog.$element.find("tr[id='viewedit-"+row_id+"']").after(clone.removeClass("ui-selected"));_.each(obj.child_id,function(obj){self.render_inherited_view(clone,obj)})},on_select_img:function(element_img){var self=this;var side=$(element_img).closest("tr[id^='viewedit-']");this.one_object.clicked_tr_id=parseInt(side.attr("id").split("-")[1]);this.one_object.clicked_tr_level=parseInt(side.attr("level"));var img=
side.find("img[id='parentimg-"+this.one_object.clicked_tr_id+"']").attr("src");var view_id=0,view_xml_id=0,view_find=side;var min_level=this.one_object.clicked_tr_id;if($(side).find("a").text().search("view_id")!=-1){view_id=parseInt($(view_find).find("a").text().replace(/[^0-9]+/g,""));view_xml_id=view_find.attr("id").split("-")[1];this.one_object.clicked_tr_id+=1;this.one_object.clicked_tr_level+=1}else while(1){view_find=view_find.prev();if(view_find.length==0||self.edit_xml_dialog.$element.find(view_find).find("a").text().search("view_id")!=
-1&&parseInt(view_find.attr("level"))<min_level){view_id=parseInt($(view_find).find("a").text().replace(/[^0-9]+/g,""));view_xml_id=parseInt(view_find.attr("id").split("-")[1]);break}if(view_find.attr("level")<min_level)min_level=parseInt(view_find.attr("level"))}this.one_object.clicked_tr_view=[view_id,view_xml_id];switch(element_img.id){case "side-add":self.do_node_add(side);break;case "side-remove":if(confirm(_t("Do you really want to remove this node?")))self.do_save_update_arch("remove_node");
break;case "side-edit":self.do_node_edit(side);break;case "side-up":self.do_node_up(side,img);break;case "side-down":self.do_node_down(side,img);break}},do_node_add:function(side){var self=this;var tr=self.get_object_by_id(this.one_object.clicked_tr_id,this.one_object["main_object"],[])[0].att_list[0];var parent_tr=$(side).prevAll("tr[level="+String(this.one_object.clicked_tr_level-1)+"]")[0];var field_dataset=new openerp.web.DataSetSearch(this,this.model,null,null);parent_tr=$(parent_tr).find("a").text();
field_dataset.call("fields_get",[],function(result){var fields=_.keys(result);fields.push(" "),fields.sort();var property_to_check=[];_.each([tr,parent_tr],function(element){property_to_check.push(_.detect(_.keys(_CHILDREN),function(res){return _.str.include(element,res)}))});self.on_add_node(property_to_check,fields)})},do_node_edit:function(side){var self=this;var result=self.get_object_by_id(this.one_object.clicked_tr_id,this.one_object["main_object"],[]);if(result.length&&result[0]&&result[0].att_list){var properties=
_PROPERTIES[result[0].att_list[0]];self.on_edit_node(properties)}},do_node_down:function(cur_tr,img){var self=this,next_tr,last_tr,tr_to_move=[];tr_to_move.push(cur_tr);if(img)while(1){next_tr=cur_tr.next();if(parseInt(next_tr.attr("level"))<=this.one_object.clicked_tr_level||next_tr.length==0){last_tr=next_tr;break}else{tr_to_move.push(next_tr);cur_tr=next_tr}}else last_tr=cur_tr.next();if(self.edit_xml_dialog.$element.find(last_tr).find("a").text().search("view_id")!=-1)return false;if(last_tr.length!=
0&&parseInt(last_tr.attr("level"))==this.one_object.clicked_tr_level){var last_tr_id=last_tr.attr("id").split("-")[1];img=last_tr.find("img[id='parentimg-"+last_tr_id+"']").attr("src");if(img){self.edit_xml_dialog.$element.find("img[id='parentimg-"+last_tr_id+"']").attr("src","/web/static/src/img/expand.gif");while(1){var next_tr=last_tr.next();if(next_tr.attr("level")<=this.one_object.clicked_tr_level||next_tr.length==0)break;next_tr.hide();last_tr=next_tr}}tr_to_move.reverse();_.each(tr_to_move,
function(rec){$(last_tr).after(rec)});self.do_save_update_arch("down")}},do_node_up:function(cur_tr,img){var self=this,side=cur_tr,tr_to_move=[];tr_to_move.push(side);while(1){var prev_tr=cur_tr.prev();if(this.one_object.clicked_tr_level>=parseInt(prev_tr.attr("level"))||prev_tr.length==0){last_tr=prev_tr;break}cur_tr=prev_tr}if(img){self.edit_xml_dialog.$element.find("img[id='parentimg-"+this.one_object.clicked_tr_id+"']").attr("src","/web/static/src/img/expand.gif");while(1){next_tr=side.next();
if(parseInt(next_tr.attr("level"))<=this.one_object.clicked_tr_level||next_tr.length==0)break;else{next_tr.hide();tr_to_move.push(next_tr);side=next_tr}}}if(last_tr.length!=0&&parseInt(last_tr.attr("level"))==this.one_object.clicked_tr_level&&self.edit_xml_dialog.$element.find(last_tr).find("a").text().search("view_id")==-1){_.each(tr_to_move,function(rec){$(last_tr).before(rec)});self.do_save_update_arch("up")}},do_save_update_arch:function(move_direct,update_values){var self=this;var arch=_.detect(self.one_object["arch"],
function(element){return element.view_id==self.one_object.clicked_tr_view[0]});var obj=self.get_object_by_id(this.one_object.clicked_tr_view[1],this.one_object["main_object"],[]);var xml_arch=QWeb.load_xml(arch.arch);if(xml_arch.childNodes[0].tagName=="data"){var check_list=_.flatten(obj[0].child_id[0].att_list);var children=_.filter(xml_arch.childNodes[0].childNodes,function(child){return child.nodeType==1});arch.arch=_.detect(children,function(xml_child){var temp_obj=self.create_View_Node(xml_child),
insert=_.intersection(_.flatten(temp_obj.att_list),_.uniq(check_list));if(insert.length==_.uniq(check_list).length)return xml_child})}arch_to_pass=_.filter($(arch.arch),function(child){return child.nodeType==1});return self.do_save_xml(arch_to_pass[0],obj[0].child_id[0],obj[0].child_id,move_direct,update_values,arch)},get_object_by_id:function(id,one_object,result){var self=this;if(result.length==0){var check=_.detect(one_object,function(obj){return id==obj.id});if(check)result.push(check);_.each(one_object,
function(obj){self.get_object_by_id(id,obj.child_id,result)})}return result},create_clone:function(clone,new_node_obj){var self=this;clone.find("a").text(new_node_obj.name);$(clone.find("a").parent()).siblings("td").css("padding-left",20*new_node_obj.level);clone.attr("id","viewedit-"+new_node_obj.id);clone.attr("level",new_node_obj.level);clone.find("img[id^='parentimg-']").remove();clone.bind("click",function(){self.do_select_row(this.id.split("-")[1])});clone.find("img[id^='side-']").click(function(){self.on_select_img(this)});
return clone},do_save_xml:function(arch1,obj,child_list,move_direct,update_values,arch){var self=this,children_list=$(arch1).children(),list_obj_xml;try{list_obj_xml=_.zip(children_list,obj.child_id)}catch(err){return}if(this.one_object.clicked_tr_id){if(obj.id==this.one_object.clicked_tr_id){var parent=false,index=_.indexOf(child_list,obj);if(move_direct=="down"){var next=$(arch1).next();$(next).after(arch1);var re_insert_obj=child_list.splice(index,1);child_list.splice(index+1,0,re_insert_obj[0]);
parent=$(arch1).parents()}else if(move_direct=="up"){var prev=$(arch1).prev();$(prev).before(arch1);var re_insert_obj=child_list.splice(index,1);child_list.splice(index-1,0,re_insert_obj[0]);parent=$(arch1).parents()}else if(move_direct=="update_node"){_.each(update_values,function(val){if(val[1])$(arch1)[0].setAttribute(val[0],val[1]);else $(arch1)[0].removeAttribute(val[0])});var new_obj=self.create_View_Node(arch1);new_obj.id=obj.id,new_obj.child_id=obj.child_id;self.edit_xml_dialog.$element.find("tr[id='viewedit-"+
this.one_object.clicked_tr_id+"']").find("a").text(new_obj.name);child_list.splice(index,1,new_obj);parent=$(arch1).parents()}else if(move_direct=="add_node"){var tr_click=self.edit_xml_dialog.$element.find("tr[id='viewedit-"+self.one_object.clicked_tr_id+"']"),temp_xml=QWeb.load_xml(update_values[0]),object_xml=self.create_View_Node(temp_xml.childNodes[0]);update_values[1]=="Inside"?object_xml.level=obj.level+1:object_xml.level=obj.level;var clone=self.create_clone(tr_click.clone(),object_xml),after_append=
_.detect(self.one_object["parent_child_id"],function(ele){return self.one_object.clicked_tr_id==ele.key});after_append=after_append?_.last(after_append.value):self.one_object.clicked_tr_id;switch(update_values[1]){case "After":self.edit_xml_dialog.$element.find("tr[id='viewedit-"+after_append+"']").after(clone);$(arch1).after(update_values[0]);child_list.splice(index+1,0,object_xml);break;case "Before":tr_click.before(clone);$(arch1).before(update_values[0]);child_list.splice(index-1,0,object_xml);
break;case "Inside":if(tr_click.find("img[id^='parentimg-']").length==0)$(tr_click.find("a").parent()).siblings("td").append($('<img width="16" height="16"></img>').attr("src","/web/static/src/img/collapse.gif").attr("id","parentimg-"+self.one_object.clicked_tr_id).click(function(){self.do_parent_img_hide_show(this)}));$(arch1).append(update_values[0]);self.edit_xml_dialog.$element.find("tr[id='viewedit-"+after_append+"']").after(clone);obj.child_id.push(object_xml);break}self.edit_xml_dialog.$element.find("tr[id='viewedit-"+
object_xml.id+"']").removeClass("ui-selected");parent=$(arch1).parents()}else if(move_direct=="remove_node"){parent=$(arch1).parents();if(parent.length==0||parent[0].tagName.toLowerCase()=="data"){self.one_object.clicked_tr_id=self.one_object.clicked_tr_id-1;self.one_object.clicked_tr_level=self.one_object.clicked_tr_level-1;parent.length==0?parent.push("remove_view"):false}$(arch1).remove();child_list.splice(index,1);var cur_tr=self.edit_xml_dialog.$element.find("tr[id='viewedit-"+self.one_object.clicked_tr_id+
"']");_.each(self.get_list_tr(cur_tr,self.one_object.clicked_tr_level),function(tr_element){tr_element.remove()});cur_tr.remove();var parent_img=_.detect(self.one_object["parent_child_id"],function(element){return _.include(element.value,self.one_object.clicked_tr_id)});if(parent_img.value.length==1)self.edit_xml_dialog.$element.find("tr[id='viewedit-"+parent_img.key+"']").find("img[id^='parentimg-']").remove();self.one_object["parent_child_id"]=self.parent_child_list(self.one_object["main_object"],
[])}var convert_to_utf=parent.length!=0?parent[parent.length-1]:arch1;if(convert_to_utf!="remove_view"){convert_to_utf=QWeb.tools.xml_node_to_string(convert_to_utf);convert_to_utf=convert_to_utf.replace('xmlns="http://www.w3.org/1999/xhtml"',"");convert_to_utf='<?xml version="1.0"?>'+convert_to_utf;arch.arch=convert_to_utf;this.dataset.write(this.one_object.clicked_tr_view[0],{"arch":convert_to_utf},function(r){})}else this.dataset.unlink([this.one_object.clicked_tr_view[0]],function(res){});if(move_direct==
"add_node"){self.add_node_dialog.close();self.on_select_img(clone.find("img[id='side-edit']")[0]);self.one_object["parent_child_id"]=self.parent_child_list(self.one_object["main_object"],[])}}if(obj.level<=this.one_object.clicked_tr_level)_.each(list_obj_xml,function(child_node){self.do_save_xml(child_node[0],child_node[1],obj.child_id,move_direct,update_values,arch)})}},on_expand:function(expand_img){var level=parseInt($(expand_img).closest("tr[id^='viewedit-']").attr("level"));var cur_tr=$(expand_img).closest("tr[id^='viewedit-']");
_.each(this.get_list_tr(cur_tr,level),function(tr_element){tr_element.hide()})},get_list_tr:function(cur_tr,level){tr_list=[];while(1){var nxt_tr=cur_tr.next();if(parseInt(nxt_tr.attr("level"))>level){cur_tr=nxt_tr;tr_list.push(nxt_tr)}else return tr_list}},on_collapse:function(collapse_img){var self=this,id=collapse_img.id.split("-")[1];var datas=_.detect(self.one_object["parent_child_id"],function(res){return res.key==id});_.each(datas.value,function(rec){var tr=self.edit_xml_dialog.$element.find("tr[id='viewedit-"+
rec+"']");tr.find("img[id='parentimg-"+rec+"']").attr("src","/web/static/src/img/expand.gif");tr.show()})},on_edit_node:function(properties){var self=this;this.edit_node_dialog=(new openerp.web.Dialog(this,{title:_t("Properties"),width:450,buttons:[{text:_t("Update"),click:function(){var warn=false,update_values=[];_.each(self.edit_widget,function(widget){if(widget.is_invalid){warn=true;return false}if(widget.dirty&&!widget.is_invalid)update_values.push([widget.name,widget.get_value()])});if(warn)self.on_valid_create_view(self.edit_widget);
else{self.do_save_update_arch("update_node",update_values);self.edit_node_dialog.close()}}},{text:_t("Cancel"),click:function(){self.edit_node_dialog.close()}}]})).open();var _PROPERTIES_ATTRIBUTES={"name":{"name":"name","string":"Name","type":"char"},"string":{"name":"string","string":"String","type":"char"},"required":{"name":"required","string":"Required","type":"boolean"},"readonly":{"name":"readonly","string":"Readonly","type":"boolean"},"domain":{"name":"domain","string":"Domain","type":"char"},
"context":{"name":"context","string":"Context","type":"char"},"limit":{"name":"limit","string":"Limit","type":"float"},"min_rows":{"name":"min_rows","string":"Minimum rows","type":"float"},"date_start":{"name":"date_start","string":"Start date","type":"char"},"date_delay":{"name":"date_delay","string":"Delay date","type":"char"},"day_length":{"name":"day_length","string":"Day length","type":"char"},"mode":{"name":"mode","string":"Mode","type":"char"},"align":{"name":"align","string":"Alignment ",
"type":"selection","selection":[["",""],["0.0","Left"],["0.5","Center"],["1.0","Right"]]},"icon":{"name":"icon","string":"Icon","type":"selection","selection":_ICONS},"type":{"name":"type","string":"Type","type":"selection","selection":[["",""],["action","Action"],["object","Object"],["workflow","Workflow"],["server_action","Server Action"]]},"special":{"name":"special","string":"Special","type":"selection","selection":[["",""],["save","Save Button"],["cancel","Cancel Button"],["open","Open Button"]]},
"target":{"name":"target","string":"Target","type":"selection","selection":[["",""],["new","New Window"]]},"confirm":{"name":"confirm","string":"Confirm","type":"char"},"style":{"name":"style","string":"Style","type":"selection","selection":[["",""],["1","1"],["1-1","1-1"],["1-2","1-2"],["2-1","2-1"],["1-1-1","1-1-1"]]},"filename":{"name":"filename","string":"File Name","type":"char"},"width":{"name":"width","string":"Width","type":"float"},"height":{"name":"height","string":"Height","type":"float"},
"attrs":{"name":"attrs","string":"Attrs","type":"char"},"col":{"name":"col","string":"col","type":"float"},"link":{"name":"link","string":"Link","type":"char"},"position":{"name":"position","string":"Position","type":"selection","selection":[["",""],["after","After"],["before","Before"],["inside","Inside"],["replace","Replace"]]},"states":{"name":"states","string":"states","type":"char"},"eval":{"name":"eval","string":"Eval","type":"char"},"ref":{"name":"ref","string":"Ref","type":"char"},"on_change":{"name":"on_change",
"string":"On change","type":"char"},"nolabel":{"name":"nolabel","string":"No label","type":"boolean"},"completion":{"name":"completion","string":"Completion","type":"boolean"},"colspan":{"name":"colspan","string":"Colspan","type":"float"},"widget":{"name":"widget","string":"widget","type":"selection"},"colors":{"name":"colors","string":"Colors","type":"char"},"editable":{"name":"editable","string":"Editable","type":"selection","selection":[["",""],["top","Top"],["bottom","Bottom"]]},"groups":{"name":"groups",
"string":"Groups","type":"selection_multi"}};var arch_val=self.get_object_by_id(this.one_object.clicked_tr_id,this.one_object["main_object"],[]);this.edit_node_dialog.$element.append('<table id="rec_table"  style="width:400px" class="oe_forms"></table>');this.edit_widget=[];self.ready=$.when(self.on_groups(properties)).then(function(){_PROPERTIES_ATTRIBUTES["groups"]["selection"]=self.groups;var values=_.keys(openerp.web.form.widgets.map);values.push("");values.sort();_PROPERTIES_ATTRIBUTES["widget"]["selection"]=
values;var widgets=_.filter(_PROPERTIES_ATTRIBUTES,function(property){return _.include(properties,property.name)});_.each(widgets,function(widget){var type_widget=new (self.property.get_any([widget.type]))(self.edit_node_dialog,widget);var value=_.detect(arch_val[0]["att_list"],function(res){return res instanceof Array?_.include(res,widget.name):false});value=value instanceof Array?value[1]:value;self.edit_node_dialog.$element.find("table[id=rec_table]").append('<tr><td align="right">'+widget.string+
":</td>"+type_widget.render()+"</tr>");type_widget.start();type_widget.set_value(value);self.edit_widget.push(type_widget)})})},on_groups:function(properties){var self=this,def=$.Deferred();if(!_.include(properties,"groups")){self.groups=false;def.resolve()}var group_ids=[],group_names={},groups=[];var res_groups=new openerp.web.DataSetSearch(this,"res.groups",null,null),model_data=new openerp.web.DataSetSearch(self,"ir.model.data",null,null);res_groups.read_slice([],{}).done(function(res_grp){_.each(res_grp,
function(res){var key=res.id;group_names[key]=res.full_name;group_ids.push(res.id)});model_data.read_slice([],{domain:[["res_id","in",group_ids],["model","=","res.groups"]]}).done(function(model_grp){_.each(model_grp,function(res_group){groups.push([res_group.module+"."+res_group.name,group_names[res_group.res_id]])});self.groups=groups;def.resolve()})});return def.promise()},on_add_node:function(properties,fields){var self=this;var render_list=[{"name":"node_type","selection":_.keys(_CHILDREN).sort(),
"value":"field","string":"Node Type","type":"selection"},{"name":"field_value","selection":fields,"value":false,"string":"","type":"selection"},{"name":"position","selection":["After","Before","Inside"],"value":false,"string":"Position","type":"selection"}];this.add_widget=[];this.add_node_dialog=(new openerp.web.Dialog(this,{title:_t("Properties"),width:450,buttons:[{text:_t("Update"),click:function(){var check_add_node=true,values={};_.each(self.add_widget,function(widget){values[widget.name]=widget.get_value()||
false});values.position=="Inside"?check_add_node=_.include(_CHILDREN[properties[0]],values.node_type)?true:false:check_add_node=_.include(_CHILDREN[properties[1]],values.node_type)?true:false;if(values.node_type=="field"&&check_add_node)check_add_node=values.field_value!=" "?true:false;if(check_add_node){var tag=values.node_type=="field"?_.str.sprintf("<%s name='%s'> </%s>",values.node_type,values.field_value,values.node_type):_.str.sprintf("<%s> </%s>",values.node_type,values.node_type);self.do_save_update_arch("add_node",
[tag,values.position])}else alert("Can't Update View")}},{text:_t("Cancel"),click:function(){self.add_node_dialog.close()}}]})).open();this.add_node_dialog.$element.append('<table id="rec_table"  style="width:420px" class="oe_forms"><tbody><tr></tbody></table>');var table_selector=self.add_node_dialog.$element.find("table[id=rec_table] tbody");_.each(render_list,function(node){type_widget=new (self.property.get_any([node.type]))(self.add_node_dialog,node);if(node.name=="position")table_selector.append('</tr><tr><td align="right" width="100px">'+
node.string+"</td>"+type_widget.render()+"</tr>");else{table_selector.append('<td align="right">'+node.string+"</td>"+type_widget.render());if(node.name=="field_value")table_selector.append('<td id="new_field" align="right"  width="100px"> <button>New Field</button></td>')}type_widget.start();type_widget.set_value(node.value);self.add_widget.push(type_widget)});table_selector.find("td[id^=]").attr("width","100px");self.add_node_dialog.$element.find("#new_field").click(function(){model_data=new openerp.web.DataSetSearch(self,
"ir.model",null,null);model_data.read_slice([],{domain:[["model","=",self.model]]}).then(function(result){self.render_new_field(result[0].id)})})},render_new_field:function(id){var self=this;var action={context:{"default_model_id":id,"manual":true},res_model:"ir.model.fields",views:[[false,"form"]],type:"ir.actions.act_window",target:"new",flags:{action_buttons:true}};var action_manager=new openerp.web.ActionManager(self);$.when(action_manager.do_action(action)).then(function(){var controller=action_manager.dialog_viewmanager.views["form"].controller;
controller.on_button_cancel.add_last(function(){action_manager.stop()});controller.do_save.add_last(function(){action_manager.stop();var value=controller.fields.name.value;self.add_node_dialog.$element.find("select[id=field_value]").append($("<option selected></option>").attr("value",value).text(value));_.detect(self.add_widget,function(widget){widget.name=="field_value"?widget.selection.push(value):false})})})}});openerp.web.ViewEditor.Field=openerp.web.Class.extend({init:function(view,widget){this.$element=
view.$element;this.dirty=false;this.name=widget.name;this.selection=widget.selection||[];this.required=widget.required||false;this.string=widget.string||"";this.type=widget.type;this.is_invalid=false},start:function(){this.update_dom()},update_dom:function(){this.$element.find("td[id="+this.name+"]").toggleClass("invalid",this.is_invalid);this.$element.find("td[id="+this.name+"]").toggleClass("required",this.required)},on_ui_change:function(){this.validate();this.dirty=true;this.update_dom()},validate:function(){this.is_invalid=
false;try{var value=openerp.web.parse_value(this.get_value(),this,"");this.is_invalid=this.required&&value===""}catch(e){this.is_invalid=true}},render:function(){return _.str.sprintf("<td id = %s>%s</td>",this.name,QWeb.render(this.template,{widget:this}))}});openerp.web.ViewEditor.FieldBoolean=openerp.web.ViewEditor.Field.extend({template:"vieweditor_boolean",start:function(){var self=this;this._super();this.$element.find("input[id="+self.name+"]").change(function(){self.on_ui_change()})},set_value:function(value){if(value)this.$element.find("input[id="+
this.name+"]").attr("checked",true)},get_value:function(){return this.$element.find("input[id="+this.name+"]").is(":checked")?"1":null}});openerp.web.ViewEditor.FieldChar=openerp.web.ViewEditor.Field.extend({template:"vieweditor_char",start:function(){var self=this;this._super();this.$element.find("input[id="+this.name+"]").css("width","100%").change(function(){self.on_ui_change()})},set_value:function(value){this.$element.find("input[id="+this.name+"]").val(value)},get_value:function(){return this.$element.find("input[id="+
this.name+"]").val()}});openerp.web.ViewEditor.FieldSelect=openerp.web.ViewEditor.Field.extend({template:"vieweditor_selection",start:function(){var self=this;this._super();this.$element.find("select[id="+this.name+"]").css("width","100%").change(function(){self.on_ui_change();if(self.name=="node_type")if(self.get_value()=="field"){self.$element.find("#new_field").show();self.$element.find("select[id=field_value]").show()}else{self.$element.find("#new_field").hide();self.$element.find("select[id=field_value]").hide()}})},
set_value:function(value){var index=0;value=value===null?false:value;for(var i=0,ii=this.selection.length;i<ii;i++)if(this.selection[i]instanceof Array&&this.selection[i][0]===value||this.selection[i]===value)index=i;this.$element.find("select[id="+this.name+"]")[0].selectedIndex=index},get_value:function(){return this.$element.find("select[id="+this.name+"]").val()}});openerp.web.ViewEditor.FieldSelectMulti=openerp.web.ViewEditor.FieldSelect.extend({start:function(){this._super();this.$element.find("select[id="+
this.name+"]").css("height","100px").attr("multiple",true)},set_value:function(value){var self=this;self.$element.find("#groups option").attr("selected",false);if(!value)return false;_.each(this.selection,function(item){if(_.include(value.split(","),item[0]))self.$element.find("select[id="+self.name+"] option[value='"+item[0]+"']").attr("selected",1)})}});openerp.web.ViewEditor.FieldFloat=openerp.web.ViewEditor.FieldChar.extend({});var _PROPERTIES={"field":["name","string","required","readonly","domain",
"context","nolabel","completion","colspan","widget","eval","ref","on_change","attrs","groups"],"form":["string","col","link"],"notebook":["colspan","position","groups"],"page":["string","states","attrs","groups"],"group":["string","col","colspan","states","attrs","groups"],"image":["filename","width","height","groups"],"separator":["string","colspan","groups"],"label":["string","align","colspan","groups"],"button":["name","string","icon","type","states","readonly","special","target","confirm","context",
"attrs","colspan","groups"],"newline":[],"board":["style"],"column":[],"action":["name","string","colspan","groups"],"tree":["string","colors","editable","link","limit","min_rows"],"graph":["string","type"],"calendar":["string","date_start","date_stop","date_delay","day_length","color","mode"]};var _CHILDREN={"form":["notebook","group","field","label","button","board","newline","separator"],"tree":["field"],"graph":["field"],"calendar":["field"],"notebook":["page"],"page":["notebook","group","field",
"label","button","newline","separator"],"group":["field","label","button","separator","newline","group"],"board":["column"],"action":[],"field":["form","tree","graph","field"],"label":[],"button":[],"newline":[],"separator":[]};var _ICONS=["","STOCK_ABOUT","STOCK_ADD","STOCK_APPLY","STOCK_BOLD","STOCK_CANCEL","STOCK_CDROM","STOCK_CLEAR","STOCK_CLOSE","STOCK_COLOR_PICKER","STOCK_CONNECT","STOCK_CONVERT","STOCK_COPY","STOCK_CUT","STOCK_DELETE","STOCK_DIALOG_AUTHENTICATION","STOCK_DIALOG_ERROR","STOCK_DIALOG_INFO",
"STOCK_DIALOG_QUESTION","STOCK_DIALOG_WARNING","STOCK_DIRECTORY","STOCK_DISCONNECT","STOCK_DND","STOCK_DND_MULTIPLE","STOCK_EDIT","STOCK_EXECUTE","STOCK_FILE","STOCK_FIND","STOCK_FIND_AND_REPLACE","STOCK_FLOPPY","STOCK_GOTO_BOTTOM","STOCK_GOTO_FIRST","STOCK_GOTO_LAST","STOCK_GOTO_TOP","STOCK_GO_BACK","STOCK_GO_DOWN","STOCK_GO_FORWARD","STOCK_GO_UP","STOCK_HARDDISK","STOCK_HELP","STOCK_HOME","STOCK_INDENT","STOCK_INDEX","STOCK_ITALIC","STOCK_JUMP_TO","STOCK_JUSTIFY_CENTER","STOCK_JUSTIFY_FILL","STOCK_JUSTIFY_LEFT",
"STOCK_JUSTIFY_RIGHT","STOCK_MEDIA_FORWARD","STOCK_MEDIA_NEXT","STOCK_MEDIA_PAUSE","STOCK_MEDIA_PLAY","STOCK_MEDIA_PREVIOUS","STOCK_MEDIA_RECORD","STOCK_MEDIA_REWIND","STOCK_MEDIA_STOP","STOCK_MISSING_IMAGE","STOCK_NETWORK","STOCK_NEW","STOCK_NO","STOCK_OK","STOCK_OPEN","STOCK_PASTE","STOCK_PREFERENCES","STOCK_PRINT","STOCK_PRINT_PREVIEW","STOCK_PROPERTIES","STOCK_QUIT","STOCK_REDO","STOCK_REFRESH","STOCK_REMOVE","STOCK_REVERT_TO_SAVED","STOCK_SAVE","STOCK_SAVE_AS","STOCK_SELECT_COLOR","STOCK_SELECT_FONT",
"STOCK_SORT_ASCENDING","STOCK_SORT_DESCENDING","STOCK_SPELL_CHECK","STOCK_STOP","STOCK_STRIKETHROUGH","STOCK_UNDELETE","STOCK_UNDERLINE","STOCK_UNDO","STOCK_UNINDENT","STOCK_YES","STOCK_ZOOM_100","STOCK_ZOOM_FIT","STOCK_ZOOM_IN","STOCK_ZOOM_OUT","terp-account","terp-crm","terp-mrp","terp-product","terp-purchase","terp-sale","terp-tools","terp-administration","terp-hr","terp-partner","terp-project","terp-report","terp-stock","terp-calendar","terp-graph"];openerp.web.ViewEditor.property_widget=new openerp.web.Registry({"boolean":"openerp.web.ViewEditor.FieldBoolean",
"selection_multi":"openerp.web.ViewEditor.FieldSelectMulti","selection":"openerp.web.ViewEditor.FieldSelect","char":"openerp.web.ViewEditor.FieldChar","float":"openerp.web.ViewEditor.FieldFloat"})};
